"use strict";define("Tfs/Frame",["require","exports","react","VSS/Core/Observable","VSS/Platform/Layout","VSSUI/Expandable","VSSUI/Icon","VSSUI/Menu","VSSUI/Utilities/ScreenSize","VSS/Features/PlatformUI/ContributedItemUtil","VSS/Features/PlatformUI/ContributedMenu","VSSUI/ProgressBar","VSSUI/FocusZone","VSS/Platform/Context","VSS/Platform/Feature","VSSUI/Util","Tfs/Platform/DeviceType","VSS/Platform/Location","VSS/Platform/UserClaims","VSSUI/Observer","VSS/Features/PlatformUI/FPSLink","VSS/Core/Util/Screen","Tfs/Platform/Navigation","Tfs/Platform/ProjectPersona","VSS/Core/Util/String","VSS/Features/PlatformUI/ContributedIcon","VSS/Platform/FPS","VSSUI/Callout","VSSUI/FocusGroup","VSSUI/TooltipEx","VSSUI/Utilities/Focus","VSS/Features/Services/AccountMappingService","VSS/Features/Services/OrganizationsService","VSS/Platform/Util/Url","VSSUI/Link","VSS/Platform/Identity","VSSUI/VssPersona","Tfs/Platform/HeaderActions"],function(e,t,n,o,s,i,a,r,l,c,m,d,u,p,h,g,v,C,x,f,S,b,N,w,E,I,y,k,P,M,U,L,H,T,A,V,z,O){var R,D,F,j,G,W,_,B,K;R=t.Resources={},t.Resources.AccessLevels="Access levels",t.Resources.AlternateCredentials="Alternate credentials",t.Resources.AzureDevOpsProfile="Azure DevOps profile",t.Resources.CollectionSettings="Collection Settings",t.Resources.BrandName="Azure",t.Resources.ChangeTheme="Change theme",t.Resources.Collections="Collections",t.Resources.Create="Create",t.Resources.Documentation="Documentation",t.Resources.GetHelp="Get help",t.Resources.Help="Help",t.Resources.HelpAndActions="Help and actions",t.Resources.ManageUserSettings="Manage the currently logged in user settings",t.Resources.Marketplace="Marketplace",t.Resources.MoreOrganizations="{0} more organizations",t.Resources.MyOrgs="My organizations",t.Resources.MyWorkLabel="My Work",t.Resources.NavigationMenu="Expand navigation menu",t.Resources.NewOrg="New organization",t.Resources.Notifications="Notifications",t.Resources.OneMoreOrganization="1 more organization",t.Resources.OrgSettings="Organization settings",t.Resources.PATPage="Personal access tokens",t.Resources.PermissionsRefresh="Permissions",t.Resources.Preferences="Time and Locale",t.Resources.PreviewFeatures="Preview features",t.Resources.ProjectSettings="Project settings",t.Resources.ProductName="DevOps",t.Resources.Profile="Profile",t.Resources.RelatedPages="Related pages",t.Resources.ShowLess="Show less information",t.Resources.ShowMore="Show more information",t.Resources.SignIn="Sign in",t.Resources.SSHPublicKeys="SSH public keys",t.Resources.SuiteLogoLabel="Azure DevOps organization home page",t.Resources.SuiteLogoLabelOnPrem="Azure DevOps collection home page",t.Resources.TenantPicker="Switch directory",t.Resources.Theme="Theme",t.Resources.Usage="Usage",t.Resources.UserSettings="User settings",t.Resources.WhatsNew="What's new in DevOps",function(e){t.ComponentsCompositeComposite={};class d extends s.VssComponent{constructor(){super(...arguments),this.renderCallout=((e,t,s)=>{const i=(0,c.getContributedItems)(this.context.pageContext,"ms.vss-tfs-web.vertical-header-composite",void 0,"ms.vss-web.menu"),a=new o.ObservableCollection;for(const e of i){const t=(0,m.getMenuItems)(this.context.pageContext,e.id,void 0);for(const e of t.value)"service"!==e.groupKey&&"getting-started"!==e.groupKey||(e.groupKey="help");const n=t.value[0]&&t.value[0].groupKey,o=d.getMenuHeader(e,n||e.id);o&&a.push([o]),a.push(t)}return n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:s,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"composite-menu",items:a},menuOrigin:{horizontal:"end",vertical:"start"}})})}static getMenuHeader(e,t){return e.contribution.title?{id:`header_${e.id}`,itemType:2,groupKey:t,text:e.contribution.title,rank:d.headerRanks[e.id]||50}:null}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e<=0},n.createElement(i.ExpandableContainer,{ariaLabel:R.HelpAndActions,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(a.Icon,{iconName:"MoreVertical",size:"medium"})))}}t.ComponentsCompositeComposite.Composite=d,d.headerRanks={"ms.vss-tfs-web.market-menu":20,"ms.vss-tfs-web.help-menu":30},s.VssComponent.register("ms.vss-tfs-web.composite",d)}(),function(e){D=t.ComponentsHeaderWithHeaderProgressBar={};t.ComponentsHeaderWithHeaderProgressBar.WithHeaderProgressBar=class extends s.VssComponent{constructor(e,t){super(e,t),this.clearLoading=(()=>{this.setState({loading:void 0})}),this.startLoading=(()=>{this.setState({loading:new o.ObservableValue(!0)})}),this.setLoadingComplete=(()=>{this.state.loading&&(this.state.loading.value=!1)}),this.state={loading:new o.ObservableValue(!0)}}render(){return n.createElement(n.Fragment,null,this.props.children,void 0!==this.state.loading&&n.createElement(d.IndeterminateProgressBar,{className:"project-header-progress",loading:this.state.loading,loadingAnimationComplete:this.clearLoading}))}componentDidMount(){super.componentDidMount(),document.body.addEventListener("fpsLoading",this.startLoading),this.markCompletedAfterTTI()}componentWillUnmount(){super.componentWillUnmount(),this.context.pageContext.getService("IVssContributionEventService").unsubscribe(()=>{this.setLoadingComplete()},"page-rendered"),document.body.removeEventListener("fpsLoading",this.startLoading)}markCompletedAfterTTI(){this.context.pageContext.getService("IVssContributionEventService").subscribe(()=>{this.setLoadingComplete()},"page-rendered")}}}(),function(e){t.ComponentsHeaderProjectHeader={};s.Components.add("ms.vss-tfs-web.frame.project-header",class extends n.Component{render(){return n.createElement(u.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"project-header flex-row flex-noshrink",role:"navigation"},n.createElement(D.WithHeaderProgressBar,null,n.createElement(s.RegionComponent,{className:"flex-row flex-grow",componentRegion:"header",role:"menubar"}))))}})}(),function(e){t.ComponentsHeaderTopLevelHeader={};s.Components.add("ms.vss-tfs-web.frame.top-level-header",class extends s.VssComponent{render(){return n.createElement(u.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"top-level-header flex-row flex-noshrink",role:"navigation"},n.createElement(D.WithHeaderProgressBar,null,n.createElement(s.RegionComponent,{className:"flex-row flex-grow",componentRegion:"header",role:"menubar"}))))}})}(),function(e){t.ComponentsHelpUserSettingsService={};p.Services.add("IUserSettingsMenu",{serviceFactory:class extends p.VssService{expandUserSettingsMenu(){this.expandUserSettings()}setUserSettingsMenu(e){this.expandUserSettings=e}expandHelpMenu(){this.expandHelp()}setHelpMenu(e){this.expandHelp=e}}})}(),function(e){t.ComponentsHelpHelp={};class o extends s.VssComponent{constructor(){super(...arguments),this.expandableContainerRef=n.createRef(),this.service=this.context.pageContext.getService("IUserSettingsMenu"),this.renderCallout=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"help-menu",items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.help-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}))}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(i.ExpandableContainer,{ref:this.expandableContainerRef,ariaLabel:R.Help,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(a.Icon,{iconName:"Unknown",size:"medium",tooltipProps:{text:R.Help}})))}componentDidMount(){this.expandableContainerRef&&this.expandableContainerRef.current&&this.service.setHelpMenu(this.expandableContainerRef.current.expand)}}t.ComponentsHelpHelp.Help=o,s.VssComponent.register("ms.vss-tfs-web.help",o)}(),function(e){t.ComponentsHelpUserSettings={};const o="ms.vss-admin-web.user-admin-hub-route";class c extends s.VssComponent{constructor(){super(...arguments),this.service=this.context.pageContext.getService("IUserSettingsMenu"),this.expandableContainerRef=n.createRef(),this.renderCallout=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"user-settings-menu",items:this.getMenuItems()},menuOrigin:{horizontal:"end",vertical:"start"}})),this._showPreviewFeatures=(()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("UserSettingsMenu","PreviewFeature",{Action:"Show Preview Features"});this.context.pageContext.getService("IVssContributionService").executeCommandEx("preview-feature",{methodName:"show",serviceName:"IFeaturePanel",dependencies:["ms.vss-tfs-web.feature-management-content"]})}),this._showThemePanel=(()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("UserSettingsMenu","ChangeTheme",{Action:"Show Theme Panel"});this.context.pageContext.getService("IVssContributionService").executeCommandEx("change-theme",{methodName:"show",serviceName:"IThemePanelService",dependencies:["ms.vss-tfs-web.theme-management-content","ms.vss-tfs-web.available-themes-data-provider"]})})}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(i.ExpandableContainer,{ref:this.expandableContainerRef,ariaLabel:R.UserSettings,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(a.Icon,{iconName:"PlayerSettings",size:"medium",tooltipProps:{text:R.UserSettings}})))}componentDidMount(){this.expandableContainerRef&&this.expandableContainerRef.current&&this.service.setUserSettingsMenu(this.expandableContainerRef.current.expand)}getMenuItems(){const e=this.context.pageContext.getService("IVssLocationService");let t=e.routeUrl(o,{adminPivot:"about"});const n=[];return n.push({text:R.PreviewFeatures,rank:10,id:"previewFeatureLink",onActivate:this._showPreviewFeatures,iconProps:{iconName:"Preview",className:"admin-tab-icon"}}),n.push({id:"separator",itemType:1,rank:20}),n.push({text:R.Profile,rank:30,id:"profilePageLink",href:t,iconProps:{iconName:"ContactInfo",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"preferences"}),n.push({text:R.Preferences,rank:40,id:"preferencesPageLink",href:t,iconProps:{iconName:"WorldClock",className:"admin-tab-icon"}}),(0,h.isFeatureFlagEnabled)(this.context.pageContext,"VisualStudio.Services.AdminEngagement.ProfileSettingsView.EnableRefreshPermissionsTab",!1)&&(t=e.routeUrl(o,{adminPivot:"permissionsRefresh"}),n.push({text:R.PermissionsRefresh,rank:45,id:"permissionsRefreshPageLink",href:t,iconProps:{iconName:"Refresh",className:"admin-tab-icon"}})),n.push({id:"separator",itemType:1,rank:50}),t=e.routeUrl(o,{adminPivot:"notifications"}),n.push({id:"notifications",href:t,rank:60,text:R.Notifications,iconProps:{iconName:"CannedChat",className:"admin-tab-icon"}}),n.push({text:R.Theme,rank:70,id:"changeThemeLink",onActivate:this._showThemePanel,iconProps:{iconName:"Color",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"usage"}),n.push({id:"usage",href:t,rank:80,text:R.Usage,iconProps:{iconName:"ChartSeries",className:"admin-tab-icon"}}),n.push({id:"separator",itemType:1,rank:90}),t=e.routeUrl(o,{adminPivot:"tokens"}),n.push({id:"patPage",href:t,rank:100,text:R.PATPage,iconProps:{iconName:"Signin",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"keys"}),n.push({id:"sshkeyPage",href:t,rank:110,text:R.SSHPublicKeys,iconProps:{iconName:"TwoKeys",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"altcreds"}),n.push({id:"altcredPage",href:t,rank:120,text:R.AlternateCredentials,iconProps:{iconName:"View",className:"admin-tab-icon"}}),n}_initializeTelemetry(){this.telemetryService||(this.telemetryService=this.context.pageContext.getService("IVssTelemetryService"))}}t.ComponentsHelpUserSettings.UserSettings=c,s.VssComponent.register("ms.vss-tfs-web.user-settings",c)}(),function(e){t.ComponentsMarketMarket={};class o extends s.VssComponent{constructor(){super(...arguments),this.renderCallout=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.market-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}))}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(i.ExpandableContainer,{ariaLabel:R.Marketplace,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"market-menu",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(a.Icon,{iconName:"Shop",size:"medium"})))}}t.ComponentsMarketMarket.Market=o,s.VssComponent.register("ms.vss-tfs-web.market",o)}(),function(e){t.ComponentsMyWorkMyWork={};class o extends n.Component{constructor(){super(...arguments),this.renderDropdown=((e,t)=>n.createElement(s.WrappedComponent,{contentClassName:"flyout-my-work",defaultActiveElement:".bolt-tab",dependencies:["ms.vss-features.ui-layer-content"],id:t,modal:!1,onDismiss:e.collapse,wrappedType:"customPanel"},n.createElement(s.WrappedComponent,{wrappedType:"vertical-header-my-work-flyout"})))}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(i.ExpandableContainer,{ariaLabel:R.MyWorkLabel,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"my-work-panel",renderCallout:this.renderDropdown,role:"menuitem"},n.createElement(a.Icon,{iconName:"CheckList",size:"medium"})))}}t.ComponentsMyWorkMyWork.MyWork=o,s.VssComponent.register("ms.vss-tfs-web.my-work",o)}(),function(e){F=t.ComponentsNavigationSwitchToDesktopButton={};t.ComponentsNavigationSwitchToDesktopButton.SwitchToDesktopButton=(e=>{const t=e.context.pageContext.getService("IVssContributionService").getContribution("ms.vss-tfs-web.switch-to-desktop");return t?n.createElement(s.WrappedComponent,{dependencies:["ms.vss-tfs-web.mobile-content"],wrappedProps:{ariaLabel:t.ariaLabel,className:(0,g.css)(t.className,e.className),iconClassName:(0,g.css)(t.iconClassName,e.iconClassName),iconProps:Object.assign(Object.assign({},t.iconProps),{size:"medium"}),text:t.text,textClassName:(0,g.css)(t.textClassName,e.textClassName)},wrappedType:"ms.vss-tfs-web.switchToDesktopCommand"}):null})}(),function(e){j=t.UtilNavigation={};t.UtilNavigation.useFlyoutNavigation=((e,t)=>0===t||t<=2&&(0,v.getDeviceType)(e).phone)}(),function(e){G=t.ComponentsSuiteLogoSuiteLogo={};class o extends s.VssComponent{constructor(e,t){super(e,t),e.routeId&&(0,x.userHasClaim)(this.context.pageContext,"member")&&(this.href=(0,C.routeUrl)(this.context.pageContext,e.routeId));const n=t.pageContext.getService("IVssPageService").getData();if(this.isHosted=n.isHosted,this.props.alwaysExpanded)this.expanded=2;else{const e=t.pageContext.getService("ITfsNavigationService");this.expanded=e.getNavigationDisplayMode()}}render(){return n.createElement(b.ScreenContext.Consumer,null,e=>n.createElement(f.Observer,{key:"suite-logo",expanded:this.expanded,size:e.size},e=>n.createElement(S.FPSLink,{ariaLabel:this.isHosted?R.SuiteLogoLabel:R.SuiteLogoLabelOnPrem,className:"commandbar-item suite-logo flex-row flex-noshrink flex-center",href:this.href,id:"suite-logo",role:"menuitem",telemetrySource:"applicationLink"},n.createElement(a.Icon,{className:"suite-image commandbar-icon justify-center",iconName:"VSTSLogo"}),(2===e.expanded||this.props.alwaysExpanded||e.size<=0)&&n.createElement("span",{className:"brand body-m font-weight-heavy"},R.BrandName," ",R.ProductName))))}}t.ComponentsSuiteLogoSuiteLogo.SuiteLogo=o,s.VssComponent.register("ms.vss-tfs-web.suite-logo",o)}(),function(e){W=t.ComponentsNavigationProjectNavigation={};class c extends s.VssComponent{constructor(e,t){super(e),this.navListRef=n.createRef(),this.checkAvailableNavigationHeight=(e=>!(1===e&&!1!==this.props.collapse||this.props.collapse)||window.innerHeight>=this.navigationHeight+this.fixedElementHeight),this.onActivateMenuItem=((e,t)=>(0,y.onClickFPS)(this.context.pageContext,e.href,!0,t)),this.onExpandedChange=(e=>{const t=this.checkAvailableNavigationHeight(e);return t!==this.showHubs.value&&(this.showHubs.value=t),!0}),this.onKeyDownToggle=(e=>{e.defaultPrevented||32!==e.which&&13!==e.which||(this.props.onToggleExpand?this.props.onToggleExpand():this.toggleExpansion(),e.preventDefault())}),this.onFpsLoading=(e=>{if(e.detail&&e.detail.data&&e.detail.data.navigationId){const t=this.context.pageContext.getService("IVssNavigationService"),n=t.getNavigation(e.detail.data.navigationId);n&&n.parentId&&(this.displayedHubGroupId=n.parentId,this.displayedHubId=n.id,this.buildNavigationLists(t,this.displayedHubGroupCollectionId,this.displayedHubGroupId),this.forceUpdate())}}),this.onResize=(()=>{const e=this.checkAvailableNavigationHeight(this.expanded.value);e!==this.showHubs.value&&(this.showHubs.value=e)}),this.onTransitionEnd=(e=>{this.navListRef.current===e.target&&window.dispatchEvent(new CustomEvent("resize"))}),this.renderMenuCell=((e,t,o)=>{if(1===e){const e=t.data;return n.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-icon flex-row"},n.createElement(I.ContributedIcon,{alt:"",contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName||"ViewAll",iconSize:"medium",pageContext:this.context.pageContext}))}}),this.toggleExpansion=(()=>{this.context.pageContext.getService("ITfsNavigationService").setNavigationDisplayMode(2===this.expanded.value?1:2),this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","VerticalNavigation",{action:"vertical-nav-expanded",displayMode:this.expanded.value,hubsAreVisible:this.showHubs.value})}),this.toggleExpandedHubGroup=((e,t,n)=>{if(t.preventDefault(),this.touchMoveCounter>5)return;if(n&&(this.showHubs.value=!0),this.expandedHubGroup===e)return this.expandedHubGroup="",void this.forceUpdate();this.expandedHubGroup=e;const o=this.context.pageContext.getService("IVssNavigationService");this.buildNavigationLists(o,this.displayedHubGroupCollectionId,this.expandedHubGroup),this.forceUpdate()}),this.onTouchStart=(()=>{this.touchMoveCounter=0}),this.onTouchMove=(()=>{this.touchMoveCounter++});const s=t.pageContext.getService("ITfsNavigationService");this.expanded=s.getNavigationDisplayMode();const i=t.pageContext.getService("ITfsPageService").getData();i&&i.project&&(this.projectName=i.project.name,this.projectImageUrl=i.project.imageUrl,this.settingsUrl=(0,C.routeUrl)(t.pageContext,"ms.vss-admin-web.project-admin-hub-route",{project:this.projectName})),this.userIsMember=(0,x.userHasClaim)(t.pageContext,"member");const a=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.fixedElementHeight=144+(a&&a.length>0?22:0)+2+8+(this.userIsMember?48:0)+(this.settingsUrl?48:0);const r=t.pageContext.getService("IVssNavigationService"),l=r.getDisplayedNavigation();this.displayedHubGroupCollectionId=l[1],this.displayedHubGroupId=l[2],this.displayedHubId=l[3],this.expandedHubGroup=l[2],this.buildNavigationLists(r,this.displayedHubGroupCollectionId,this.displayedHubGroupId);let c=0;for(const e of this.hubGroups)c=Math.max(c,e.children.length);this.navigationHeight=48*this.hubGroups.length+40*c,this.showHubs=new o.ObservableValue(this.checkAvailableNavigationHeight(this.expanded.value))}render(){const{collapse:e,isCallout:t,onToggleExpand:o}=this.props;return n.createElement(f.Observer,{expanded:{filter:this.onExpandedChange,observableValue:this.expanded},showHubs:this.showHubs},s=>{let c,d,p;return!1===e||void 0===e&&2===s.expanded?(d=R.ShowLess,p="DoubleChevronLeft",c="expanded"):(d=R.ShowMore,p="DoubleChevronRight",c="collapsed"),n.createElement(u.FocusZone,{circularNavigation:!0,direction:2,focusGroupProps:{defaultElementId:"create-action"},focusOnMount:t,handleTabKey:t,postprocessKeyStroke:()=>2},n.createElement("div",{className:(0,g.css)("project-navigation region-navigation flex-column flex-grow",c),"data-renderedregion":"navigation",ref:this.navListRef,role:"navigation",onTransitionEnd:this.onTransitionEnd},t&&n.createElement("div",{className:"region-header flex-row flex-noshrink"},n.createElement(G.SuiteLogo,{alwaysExpanded:!0,routeId:"ms.vss-tfs-web.suite-me-page-route"})),n.createElement("div",{className:"collapsible-section flex-noshrink"},n.createElement("div",{className:"project-item flex-row flex-grow flex-center scroll-hidden"},n.createElement("span",{className:"navigation-icon flex-row flex-center flex-noshrink justify-center"},n.createElement(w.ProjectPersona,{displayName:this.projectName,size:"small",url:this.projectImageUrl})),n.createElement("span",{className:"font-weight-heavy expanded-only flex-grow text-ellipsis"},this.projectName)),this.userIsMember&&this.projectName&&n.createElement(i.ExpandableContainer,{ariaLabel:R.Create,className:"focus-treatment alt-hover-effect flex-row cursor-pointer",expandableId:"ms.vss-tfs-web.vertical-header-create-menu",expandKey:39,id:"create-action",renderCallout:(e,t,o)=>n.createElement(r.ContextualMenu,{anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:{id:t,items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.vertical-header-create-menu")},menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:e.collapse})},n.createElement(a.Icon,{className:"navigation-icon flex-row flex-center justify-center",iconName:"Add",size:"medium"}))),n.createElement("div",{className:"separator flex-row flex-noshrink"}),n.createElement("div",{className:(0,g.css)("navigation-section flex-column flex-grow scroll-hidden v-scroll-auto custom-scrollbar",(1===s.expanded&&!1!==e||!0===e)&&"custom-scrollbar-hidden"),role:"menubar",tabIndex:-1},this.hubGroups.map((e,t)=>this.renderNavigation(e,!0,e.id===this.expandedHubGroup&&s.showHubs,0===t))),n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement("div",{className:"separator flex-row flex-noshrink"})),n.createElement(F.SwitchToDesktopButton,{className:"flex-row flex-center",context:this.context,iconClassName:"navigation-icon flex-row flex-center flex-noshrink justify-center cursor-pointer",textClassName:"text-ellipsis"}),n.createElement("div",{className:"collapsible-section flex-noshrink"},this.userIsMember&&n.createElement(S.FPSLink,{className:(0,g.css)("hub stand-alone navigation-element navigation-link focus-treatment hover-effect flex-row flex-grow flex-center scroll-hidden relative","ms.vss-admin-web.project-admin-hub"===this.displayedHubId&&"displayed"),href:this.settingsUrl,id:"settings-link",telemetrySource:"vertical.settings"},n.createElement(a.Icon,{ariaLabelledBy:"project-settings-text",className:"navigation-icon flex-row flex-center justify-center",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"navigation-text expanded-only text-ellipsis",id:(0,g.getSafeId)("project-settings-text")},R.ProjectSettings)),n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(P.FocusGroupContext.Consumer,null,e=>n.createElement(u.FocusZoneContext.Consumer,null,t=>n.createElement(M.Tooltip,{text:d},n.createElement("div",{"aria-label":d,className:"hub stand-alone focus-treatment alt-hover-effect flex-row","data-focuszone":t.focuszoneId,id:"project-expansion-toggle",onClick:o||this.toggleExpansion,onFocus:()=>{e.onFocus("project-expansion-toggle")},onKeyDown:this.onKeyDownToggle,role:"button",tabIndex:(0,U.getTabIndex)({id:"project-expansion-toggle"},e)},n.createElement(a.Icon,{className:"navigation-icon flex-row flex-center flex-noshrink justify-center cursor-pointer",iconName:p,size:"medium"})))))))))})}componentDidMount(){super.componentDidMount(),this.addEventListener(window,"resize",this.onResize),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading)}buildNavigationLists(e,t,n){this.hubGroups=[],this.hubs=[];let o=e.getNavigation(t);if(o&&o.children)for(const e of o.children)32!=(32&(e.flags||0))&&e.children&&e.children.length&&this.hubGroups.push(e);if((o=e.getNavigation(n))&&o.children)for(const e of o.children)32!=(32&(e.flags||0))&&this.hubs.push(e);this.hubGroups=this.sortNavigationList(this.hubGroups),this.hubs=this.sortNavigationList(this.hubs)}getMenuProps(e){const t=[];t.push({id:e.id,itemType:2,text:e.name});for(let n=0;n<e.children.length;n++){const o=e.children[n];t.push({data:o,id:o.id,href:o.href,onActivate:this.onActivateMenuItem,renderMenuCell:this.renderMenuCell,text:o.name})}return{id:"menu-"+e.id,items:t}}navigationComparer(e,t){return e.order===t.order?(0,E.localeIgnoreCaseComparer)(e.id,t.id):e.order-t.order}renderNavigation(e,t,o,s){const c=t?(0,g.css)("hub-group",e.id===this.displayedHubGroupId&&"displayed"):(0,g.css)("hub",e.id===this.displayedHubId&&"displayed");let m=n.createElement("span",{className:"navigation-icon flex-row flex-center flex-noshrink justify-center"},n.createElement(I.ContributedIcon,{alt:"",contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName||"ViewAll",iconSize:"medium",pageContext:this.context.pageContext}));1!==this.expanded.value&&!this.props.collapse||t&&1!==e.children.length||(m=n.createElement(M.Tooltip,{text:e.name},m));let d=void 0;return t&&e.children.length>1&&(d=n.createElement(l.ScreenSizeConditional,{condition:e=>e<=1},n.createElement(a.Icon,{className:"touch-chevron justify-center flex-center",iconName:o?"ChevronUp":"ChevronDown",onClick:t=>this.toggleExpandedHubGroup(e.id,t),size:"small"}))),m=n.createElement(S.FPSLink,{ariaLabel:e.name,className:(0,g.css)(c,"navigation-element navigation-link focus-treatment flex-row flex-grow flex-center scroll-hidden relative"),href:e.href,id:e.id+"-link",key:e.id,onClick:()=>{this.expandedHubGroup=!t&&e.parentId?e.parentId:e.id},onTouchEnd:t&&e.children.length>1?t=>this.toggleExpandedHubGroup(e.id,t,!0):void 0,onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,navigationId:t?e.children[0].id:e.id,telemetrySource:"vertical.hub",tabIndex:s?0:void 0},m,n.createElement("span",{className:"navigation-text expanded-only text-ellipsis flex-grow"},e.name),d),t&&(e.children.length>1&&(o&&e.id===this.displayedHubGroupId||(m=n.createElement(i.ExpandableContainer,{className:"flex-row flex-noshrink",collapseDelay:90,expandKey:39,excludeFocusZone:!0,excludeTabStop:!0,expandableId:e.id,expandDelay:100,expandOnHover:!0,id:e.id+"-container",renderCallout:(t,o,s)=>n.createElement(r.ContextualMenu,{anchorElement:s,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:this.getMenuProps(e),menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:t.collapse}),role:"menuitem"},m)),o&&(m=n.createElement(n.Fragment,null,m,this.hubs.map(e=>this.renderNavigation(e,!1,!1))))),m=n.createElement("div",{key:e.id,className:(0,g.css)("hub-group-container flex-column flex-noshrink relative",e.id===this.expandedHubGroup&&"expanded-container",e.id===this.displayedHubGroupId&&"displayed-container",(!o||e.children.length<=1)&&"hub-group-only")},m)),m}sortNavigationList(e){const t=[],n=[];for(const o of e)(0,N.isNavigationItemBuiltinOrTrusted)(o)?n.push(o):(0===o.order&&(o.order=100),t.push(o));return n.sort(this.navigationComparer),t.sort(this.navigationComparer),[...n,...t]}}class d extends s.VssComponent{constructor(e,t){super(e),this.collapseCallout=(()=>{this.isCollapsing.value=!0}),this.onAnimationEnd=(()=>{this.isCollapsing.value&&this.props.closeCallout()}),this.isCollapsing=new o.ObservableValue(!1);const n=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.pageHasFooter=n&&n.length>0}render(){return n.createElement(f.Observer,{isCollapsing:this.isCollapsing},e=>n.createElement(k.Callout,{anchorElement:document.body,anchorPoint:{x:0,y:0},calloutOrigin:{horizontal:"start",vertical:"start"},className:(0,g.css)("navigation-callout scroll-hidden",this.pageHasFooter&&"pageHasFooter"),contentClassName:"flex-column",lightDismiss:!0,modal:!0,onDismiss:this.collapseCallout},n.createElement("div",{className:(0,g.css)("nav-animation-container flex-row flex-grow scroll-hidden",e.isCollapsing&&"collapsing"),onAnimationEnd:this.onAnimationEnd},n.createElement(c,{isCallout:!0,onToggleExpand:this.collapseCallout,collapse:this.props.collapse}))))}}t.ComponentsNavigationProjectNavigation.ProjectNavigationCallout=d;s.VssComponent.register("ms.vss-tfs-web.frame.project-navigation",e=>{const t=new o.ObservableValue(!1),i=n.useContext(b.ScreenContext),a=(0,s.useComponentContext)().pageContext,r=()=>{t.value=!t.value};return n.createElement(f.Observer,{showPanel:t,size:i.size},e=>!(0,j.useFlyoutNavigation)(a,e.size)&&n.createElement("div",{className:"navigation-container flex-column"},e.showPanel?n.createElement(n.Fragment,null,n.createElement("div",{className:"project-navigation region-navigation placeholder flex-column flex-grow flex-noshrink",role:"presentation"}),n.createElement(d,{collapse:!1,closeCallout:r})):n.createElement(c,{onToggleExpand:e.size<2?r:void 0,collapse:e.size<2||void 0})))})}(),function(e){t.ComponentsNavigationNavigationHeaderButton={};s.VssComponent.register("ms.vss-tfs-web.frame.navigation-header-button",()=>{const e=(0,s.useComponentContext)().pageContext;return n.createElement(l.ScreenSizeConditional,{condition:t=>(0,j.useFlyoutNavigation)(e,t)},n.createElement(i.ExpandableContainer,{className:"navigation-header-button commandbar-item commandbar-icon flex-noshrink justify-center cursor-pointer",renderCallout:e=>n.createElement(W.ProjectNavigationCallout,{collapse:!1,closeCallout:e.collapse}),tabIndex:0,expandKey:[13,32],ariaLabel:R.NavigationMenu},n.createElement(a.Icon,{iconName:"GlobalNavButton",size:"medium"})))})}(),function(e){t.ComponentsNavigationTopLevelNavigation={};const r="VisualStudio.Services.AdminEngagement.OrganizationNavigation.AccountMappingWhenOrgDiscrepancy";class c extends s.VssComponent{constructor(e,t){super(e,t),this.showMoreLink=!0,this.renderListItem=(e=>{const t="host-"+e.id;return n.createElement(A.Link,{ariaSelected:e.id===this.state.displayedHostId,className:(0,g.css)("host-link navigation-link top-navigation-item focus-treatment flex-row flex-center flex-noshrink relative",e.id===this.state.displayedHostId&&"displayed"),href:e.url,id:t,key:t,role:"option"},n.createElement(w.ProjectPersona,{displayName:e.name,size:"small"}),n.createElement("span",{className:"text-ellipsis"},e.name))}),this.updateCollectionList=(e=>{const t=(0,C.getServiceLocation)(this.context.pageContext,void 0,1),n=e.map((e,n)=>({id:e.id,name:e.name,url:(0,T.combineUrlPaths)(t,encodeURIComponent(e.name))}));n.sort((e,t)=>e.id===this.state.displayedHostId?-1:t.id===this.state.displayedHostId?1:(0,E.localeIgnoreCaseComparer)(e.name,t.name)),this.state.collections.push(...n)}),this.updateNewOrgUrl=(e=>{if(e){const t=new T.Uri(e);t.addQueryParam("campaign","o~msft~vsts~orghome",!0),this.state.newOrgLink.value=t.absoluteUri}}),this.showAllHostsClicked=(()=>{this.showMoreLink=!1,this.updateOrganizationList()}),this.updateOrganizationList=(()=>{let e=this.allOrganizations;if(this.mruOrganizations){const t=[];let n=!1;e=[];for(const o of[...this.mruOrganizations,...this.allOrganizations])if(t.indexOf(o.id)<0&&(t.push(o.id),o.id===this.state.displayedHostId?(e.unshift(o),n=!0):e.push(o),n&&this.showMoreLink&&e.length>=4))break}const t=this.showMoreLink&&e.length>4?e.slice(0,4):e;this.state.organizations.splice(0,this.state.organizations.length,...t)});const s=t.pageContext.getService("IVssPageService").getData();let i;if(!s.isHosted){if(t.pageContext.getService("IVssSecurityService").hasPermission("1f4179b3-6bac-4d01-b421-71ea09171400","FrameworkGlobalSecurity",2)){const e=(0,C.getServiceLocation)(t.pageContext,void 0,1);i=(0,C.routeUrl)(t.pageContext,"ms.vss-admin-web.admin-access-levels-route",{},e)}}if(this.state={accessLevelsLink:i,collections:new o.ObservableArray([]),displayedHostId:s.hostId,isHosted:s.isHosted,newOrgLink:new o.ObservableValue(void 0),organizations:new o.ObservableArray([]),settingsLink:(0,C.routeUrl)(t.pageContext,"ms.vss-admin-web.collection-admin-hub-route")},this.state.isHosted)this.trackPromise(Promise.all([(0,H.getMostRecentlyAccessedUserOrganizations)(t.pageContext),(0,H.getUserOrganizations)(t.pageContext)])).promise.then(e=>{this.mruOrganizations=e[0],this.allOrganizations=e[1],this.updateOrganizationList()}),this.trackPromise((0,H.getNewOrganizationUrl)(t.pageContext)).promise.then(this.updateNewOrgUrl);else{const e=t.pageContext.getRestClient("ICoreRestClient",{hostType:1});this.trackPromise(e.getProjectCollections(1e3)).promise.then(this.updateCollectionList)}}componentDidMount(){this._queueSyncUserAccountMapping()}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>this.props.showAlways||!(0,j.useFlyoutNavigation)(this.context.pageContext,e)},n.createElement("div",{className:(0,g.css)(this.props.className,"top-level-navigation region-navigation flex-column flex-noshrink scroll-hidden expanded"),role:"navigation"},n.createElement("div",{className:"top-level-section scroll-hidden flex-column flex-grow"},n.createElement(f.Observer,{hosts:this.state.isHosted?this.state.organizations:this.state.collections},e=>e.hosts.length?n.createElement(u.FocusZone,{direction:2,focusGroupProps:{defaultElementId:"host-"+e.hosts[0].id}},n.createElement("div",{className:"flex-column v-scroll-auto h-scroll-hidden custom-scrollbar",role:"listbox","aria-label":R.MyOrgs},e.hosts.map(this.renderListItem)),this.state.isHosted&&n.createElement("div",{className:"action-section flex-column flex-noshrink"},this.allOrganizations&&this.allOrganizations.length-e.hosts.length>0?n.createElement(A.Link,{className:"action-link top-navigation-item focus-treatment flex-row flex-noshrink",onClick:this.showAllHostsClicked},this.allOrganizations.length-e.hosts.length==1?R.OneMoreOrganization:(0,E.format)(R.MoreOrganizations,this.allOrganizations.length-e.hosts.length)):null,n.createElement(f.Observer,{newOrgUrl:this.state.newOrgLink},e=>e.newOrgUrl?n.createElement(A.Link,{className:"action-link top-navigation-item focus-treatment flex-row flex-noshrink",href:e.newOrgUrl,id:"new-org-link"},R.NewOrg):null))):null)),n.createElement("div",{className:"announcements-section flex-column flex-noshrink"},n.createElement(s.WrappedComponent,{wrappedType:"globalAnnouncement",dependencies:["ms.vss-tfs-web.suite-me-page-content"]})),this.state.isHosted?null:n.createElement("div",{className:"related-pages-section flex-column flex-noshrink"},n.createElement("span",{className:"section-header"},R.RelatedPages),this.state.isHosted&&n.createElement("span",{className:"related-link"},n.createElement(A.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/release-notes/"},R.WhatsNew)),n.createElement("span",{className:"related-link"},n.createElement(A.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/?view=azdevops"},R.Documentation)),n.createElement("span",{className:"related-link"},n.createElement(A.Link,{className:"link-text",href:"https://azure.microsoft.com/en-us/support/devops/"},R.GetHelp)),this.state.accessLevelsLink&&n.createElement("span",{className:"related-link"},n.createElement(A.Link,{className:"link-text",href:this.state.accessLevelsLink},R.AccessLevels))),n.createElement("div",{className:"navigation-footer"},n.createElement(S.FPSLink,{className:"action-link navigation-link focus-treatment top-navigation-item flex-row",href:this.state.settingsLink,id:"settings-link"},n.createElement(a.Icon,{className:"icon-margin",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"text-ellipsis"},this.state.isHosted?R.OrgSettings:R.CollectionSettings)),n.createElement(F.SwitchToDesktopButton,{className:"action-link top-navigation-item",context:this.context,iconClassName:"icon-margin",textClassName:"text-ellipsis"}))))}async _queueSyncUserAccountMapping(){if(await(0,H.isUserAccountMappingRequired)(this.context.pageContext)&&(await(0,L.queueSyncUserAccountMapping)(this.context.pageContext),(0,h.isFeatureFlagEnabled)(this.context.pageContext,r,!1))){const e=await this.context.pageContext.getService("IVssPageService"),t=await e.getData();t&&await(0,L.activateMapping)(this.context.pageContext,t.user.descriptor,t.hostId)}}}s.Components.add("ms.vss-tfs-web.frame.top-level-navigation",c);s.VssComponent.register("ms.vss-tfs-web.frame.top-navigation-header-button",()=>{const e=(0,s.useComponentContext)().pageContext;return n.createElement(l.ScreenSizeConditional,{condition:t=>(0,j.useFlyoutNavigation)(e,t)},n.createElement(i.ExpandableContainer,{className:"navigation-header-button commandbar-item commandbar-icon flex-noshrink justify-center cursor-pointer",renderCallout:e=>n.createElement(k.Callout,{className:"absolute-fill",contentClassName:"flex-column",lightDismiss:!0,modal:!0,onDismiss:e.collapse},n.createElement("div",{className:"region-header flex-row flex-noshrink"},n.createElement(G.SuiteLogo,{alwaysExpanded:!0})),n.createElement(c,{className:"flex-grow",showAlways:!0})),tabIndex:0,expandKey:[13,32],ariaLabel:R.NavigationMenu},n.createElement(a.Icon,{iconName:"GlobalNavButton",size:"medium"})))})}(),function(e){t.ComponentsProfileServiceMeControlService={};p.Services.add("IMeControlService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this._showChangeTenants=(()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","TenantPicker",{Action:"Show Tenant Picker"}),this.pageContext.getService("IVssContributionService").executeCommandEx("change-tenants",{methodName:"show",serviceName:"ITenantPickerPanel",dependencies:["ms.vss-tfs-web.tenant-picker-content"]})}),this._showUserSettings=(()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","UserSettings",{Action:"Show User Settings"}),this.pageContext.getService("IVssContributionService").executeCommandEx("show-user-settings-header-menu",{methodName:"expandUserSettingsMenu",serviceName:"IUserSettingsMenu",dependencies:[]})}),this._showHelp=(()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","HelpMenu",{Action:"Show Help Menu"}),this.pageContext.getService("IVssContributionService").executeCommandEx("show-help-header-menu",{methodName:"expandHelpMenu",serviceName:"IUserSettingsMenu",dependencies:[]})})}getConfigurations(e,t){const n=this.pageContext.getService("IVssThemeService").getCurrentTheme();return{apiGeneration:"GEN2",containerId:"me-control-container",currentAccount:e.currentAccount.isAnonymous?void 0:{type:!0===e.currentAccount.isMsaOrFpmsa?"msaFed":"aad",memberName:e.currentAccount.email,displayName:e.currentAccount.name,orgName:e.currentAccount.aadTenantDisplayName,pictureUrl:t,authenticatedState:"signedIn",profile:{profileName:e.currentAccount.name,profilePictureUrl:t,editProfilePictureUrl:""}},authProviderConfig:{type:"webAadWithMsaFed",appSignInUrl:e.authProviderConfig.signInUrl,appSignInToUrl:e.authProviderConfig.signInToUrl,appSignOutUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.signOutUrl,appSwitchUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchUrl,appSwitchToUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchToUrl,aad:{signOutUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutUrl,signOutAndForgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutAndForgetUrl,forgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpForgetUrl,rememberedAccountsUrl:e.aadIdpConfig.aadIdpRememberedAccountsUrl}},primaryUXConfig:e.currentAccount.isAnonymous?"":{displayModes:[{type:"compressed",widthBreakpoint:5e3}],theme:{type:n.isDark?"dark":"light"}},appContextConfig:e.currentAccount.isAnonymous?"":{commands:this.getCommands(e)}}}getCommands(e){const t=[];return(0,h.isFeatureFlagEnabled)(this.pageContext,"VisualStudio.Services.AdminEngagement.MeControl.MeControlTenantPicker",!1)||t.push({text:R.AzureDevOpsProfile,id:"userSettingsLink",ariaLabel:R.AzureDevOpsProfile,openInNewTab:!0,url:e.profileUrl,type:"link"}),(0,h.isFeatureFlagEnabled)(this.pageContext,"VisualStudio.Services.AdminEngagement.MeControl.MeControlTenantPicker",!1)&&t.push({text:R.TenantPicker,id:"tenantPickerLink",ariaLabel:R.TenantPicker,openInNewTab:!1,type:"link",onClick:this._showChangeTenants}),t.push({text:R.Help,id:"showHelp",ariaLabel:R.Help,openInNewTab:!1,type:"link",onClick:this._showHelp}),t.push({text:R.UserSettings,id:"showUserSettings",ariaLabel:R.UserSettings,openInNewTab:!1,type:"link",onClick:this._showUserSettings}),t}_initializeTelemetry(){this.telemetryService||(this.telemetryService=this.pageContext.getService("IVssTelemetryService"))}}})}(),_=t[K="ComponentsProfileUtilMeControlConstants"]={},(B=t[K].MeControlConstants||(t[K].MeControlConstants={})).LoadScriptScenario="LoadMeControlScriptScenario",B.Area="MeControl",B.LoadScriptFeature="LoadMeControlScript",B.LoadScriptFailAction="Load me control script failure",B.LoadComponentFeature="LoadMeControlComponent",B.LoadComponentFailAction="Load me control component failure",function(e){t.ComponentsProfileMeControl={};const o="ms.vss-tfs-web.vertical-header-me-control-data-provider";class i extends s.VssComponent{constructor(e,t){super(e,t),this._onSelectedThemeChanged=(e=>{const t=window.MeControl;t&&t.API&&t.API.setTheme({type:e.isDark?"dark":"light"})}),this._onLoadMeControlScript=(()=>{const e=this.context.pageContext.getService("IVssContentService"),t=this.context.pageContext.getService("IVssPerformanceService"),n=this.context.pageContext.getService("IVssTelemetryService");if(this.state.data.meControlScriptUrl){const o={url:this.state.data.meControlScriptUrl,contentLength:16e3,clientId:"me-control-script",contributionId:"vertical-header-profile",contentType:"text/javascript"};t.startScenario(_.MeControlConstants.LoadScriptScenario,!1),e.loadScripts([o]).then(e=>{t.endScenario(_.MeControlConstants.Area,_.MeControlConstants.LoadScriptScenario,!1),this._loadMeControlComponent(n)},e=>{t.endScenario(_.MeControlConstants.Area,_.MeControlConstants.LoadScriptScenario,!1,void 0,{status:"failed"}),n.publishEvent(_.MeControlConstants.Area,_.MeControlConstants.LoadScriptFeature,{Action:_.MeControlConstants.LoadScriptFailAction,ErrorMessage:JSON.stringify(e)})})}}),this._loadMeControlComponent=(e=>{window.MeControl.Loader.load(this.state.configDetails)?this.themeService.subscribe(this._onSelectedThemeChanged,"themeChanged"):e.publishEvent(_.MeControlConstants.Area,_.MeControlConstants.LoadComponentFeature,{Action:_.MeControlConstants.LoadComponentFailAction})});const n=t.pageContext.getService("IVssPageService").getData(),s=this.context.pageContext.getService("IVssContributionService").getData(o);let i="";n&&n.user&&(i=(0,V.getIdentityImageUrl)(t.pageContext,n.user,2)+"&"+(new Date).getTime()),this.themeService=this.context.pageContext.getService("IVssThemeService");const a=this.context.pageContext.getService("IMeControlService");this.state={data:s,configDetails:a.getConfigurations(s,i)}}render(){return n.createElement("div",{className:"me-control-div commandbar-item commandbar-icon flex-row flex-noshrink "+(this.state.data&&this.state.data.currentAccount.isAnonymous?"sign-in":"")},n.createElement("div",{id:"me-control-container"}))}componentDidMount(){super.componentDidMount(),this.state.data&&this._loadMeControlScriptAfterTTI()}componentWillUnmount(){super.componentWillUnmount(),this.context.pageContext.getService("IVssContributionEventService").unsubscribe(this._onLoadMeControlScript,"page-rendered"),this.themeService.unsubscribe(this._onSelectedThemeChanged,"themeChanged")}_loadMeControlScriptAfterTTI(){if(window.MeControl){const e=this.context.pageContext.getService("IVssTelemetryService");this._loadMeControlComponent(e)}else{this.context.pageContext.getService("IVssContributionEventService").subscribe(this._onLoadMeControlScript,"page-rendered")}}}t.ComponentsProfileMeControl.MeControl=i,s.VssComponent.register("ms.vss-tfs-web.me-control",i)}(),function(e){t.ComponentsProfileProfile={};class o extends s.VssComponent{constructor(e,t){super(e,t),this.renderDropdown=((e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.profile-menu")},menuOrigin:{horizontal:"end",vertical:"start"}}));const o=t.pageContext.getService("IVssPageService").getData();o&&o.user&&(this.displayName=o.user.displayName,this.imageUrl=(0,V.getIdentityImageUrl)(t.pageContext,o.user,1))}render(){return n.createElement(i.ExpandableContainer,{className:"navigation-profile-menu commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"profile-menu",role:"menuitem",renderCallout:this.renderDropdown},n.createElement(z.VssPersona,{imgAltText:R.ManageUserSettings,size:"small",suppressPersonaCard:!0,identityDetailsProvider:{getIdentityImageUrl:e=>this.imageUrl,getDisplayName:()=>this.displayName||""}}))}}t.ComponentsProfileProfile.Profile=o,s.VssComponent.register("ms.vss-tfs-web.profile",o)}(),function(e){t.ComponentsSignInSignIn={};class o extends s.VssComponent{constructor(e,t){super(e,t);const n=(0,O.getHeaderActionData)(t.pageContext)||{};this.state={signInUrl:n.signInUrl}}render(){return n.createElement(A.Link,{className:"sign-in-link commandbar-item",href:this.state.signInUrl},R.SignIn)}}t.ComponentsSignInSignIn.SignInLink=o,s.VssComponent.register("ms.vss-tfs-web.sign-in-link",o)}(),function(e){t.ComponentsUserMenuItemUserMenuItem={};s.Components.add("userMenuItem",class extends s.VssComponent{constructor(e,t){super(e,t);const n=t.pageContext.getService("IVssPageService").getData();n&&n.user&&(this.userDisplayName=n.user.displayName,this.userUniqueName=n.user.uniqueName,this.userImageUrl=(0,V.getIdentityImageUrl)(t.pageContext,n.user,1))}render(){return n.createElement("tr",{"aria-posinset":this.props.details.position,"aria-setsize":this.props.details.setSize,className:"bolt-menuitem-row bolt-list-row user-menuitem-row",role:"presentation"},n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell",colSpan:5},n.createElement("div",{className:"flex-row flex-center"},n.createElement("img",{className:"user-menu-item-image",src:this.userImageUrl,alt:""}),n.createElement("div",{className:"user-menu-item-details"},n.createElement("div",null,this.userDisplayName),n.createElement("div",{className:"user-menu-item-unique-name"},this.userUniqueName)))),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}))}})}()},["Resources","Components/Composite/Composite","Components/Header/WithHeaderProgressBar","Components/Header/ProjectHeader","Components/Header/TopLevelHeader","Components/Help/UserSettingsService","Components/Help/Help","Components/Help/UserSettings","Components/Market/Market","Components/MyWork/MyWork","Components/Navigation/SwitchToDesktopButton","Util/Navigation","Components/SuiteLogo/SuiteLogo","Components/Navigation/ProjectNavigation","Components/Navigation/NavigationHeaderButton","Components/Navigation/TopLevelNavigation","Components/Profile/Service/MeControlService","Components/Profile/Util/MeControlConstants","Components/Profile/MeControl","Components/Profile/Profile","Components/SignIn/SignIn","Components/UserMenuItem/UserMenuItem"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.frame-content"}}));