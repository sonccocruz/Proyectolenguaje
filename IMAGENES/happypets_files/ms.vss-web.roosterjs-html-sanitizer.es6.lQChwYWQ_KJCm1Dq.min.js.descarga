"use strict";define("roosterjs-html-sanitizer/utils/htmlToDom",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="\x3c!--StartFragment--\x3e",l="\x3c!--EndFragment--\x3e";function i(e){var t=e.indexOf(r),i=e.lastIndexOf(l);if(t>=0&&i>=0&&i>=t+r.length){var n=e.substr(0,t),o=e.substr(i+l.length);return[e=e.substring(t+r.length,i),n,o]}return[e,null,null]}t.default=function(e,t,r){var l=(new DOMParser).parseFromString(e||"","text/html");return l&&l.body&&l.body.firstChild?(t&&(r||function(e,t){var r=i(t)[0];e.body.innerHTML=r})(l,e),l):null},t.splitWithFragment=i}),define("roosterjs-html-sanitizer/utils/getInheritableStyles",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,l=t&&t.getComputedStyle(e),i={};return r.forEach(function(e){return i[e]=l&&l.getPropertyValue(e)||""}),i}}),define("roosterjs-html-sanitizer/utils/cloneObject",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var r=t||{};if(e)for(var l=0,i=Object.keys(e);l<i.length;l++){var n=i[l];r[n]=e[n]}return r};t.default=r}),define("roosterjs-html-sanitizer/utils/getAllowedValues",["require","exports","./cloneObject"],function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var l="BODY,H1,H2,H3,H4,H5,H6,FORM,P,BR,NOBR,HR,ACRONYM,ABBR,ADDRESS,B,BDI,BDO,BIG,BLOCKQUOTE,CENTER,CITE,CODE,DEL,DFN,EM,FONT,I,INS,KBD,MARK,METER,PRE,PROGRESS,Q,RP,RT,RUBY,S,SAMP,SMALL,STRIKE,STRONG,SUB,SUP,TEMPLATE,TIME,TT,U,VAR,WBR,XMP,INPUT,TEXTAREA,BUTTON,SELECT,OPTGROUP,OPTION,LABEL,FIELDSET,LEGEND,DATALIST,OUTPUT,IMG,MAP,AREA,CANVAS,FIGCAPTION,FIGURE,PICTURE,A,NAV,UL,OL,LI,DIR,UL,DL,DT,DD,MENU,MENUITEM,TABLE,CAPTION,TH,TR,TD,THEAD,TBODY,TFOOT,COL,COLGROUP,DIV,SPAN,HEADER,FOOTER,MAIN,SECTION,ARTICLE,ASIDE,DETAILS,DIALOG,SUMMARY,DATA".split(","),i="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),n={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"};function o(){return null}function s(e,t){var r=t.tagName;return!("LI"==r||"DIV"==r)}function a(e){return e.filter(function(e,t,r){return r.indexOf(e)==t})}t.getAllowedTags=function(e){return a(l.concat(e||[])).map(function(e){return e.toUpperCase()})},t.getAllowedAttributes=function(e){return a(i.concat(e||[])).map(function(e){return e.toLocaleLowerCase()})},t.getDefaultStyleValues=function(e){var t=r.default(n);return e&&Object.keys(e).forEach(function(r){var l=e[r];null!=l?t[r]=l:delete t[r]}),t},t.getStyleCallbacks=function(e){var t=r.default(e);return t.position=t.position||o,t.width=t.width||s,t}}),define("roosterjs-html-sanitizer/sanitizer/HtmlSanitizer",["require","exports","../utils/cloneObject","../utils/getInheritableStyles","../utils/htmlToDom","../utils/getAllowedValues"],function(e,t,r,l,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){e=e||{},this.elementCallbacks=r.default(e.elementCallbacks),this.styleCallbacks=n.getStyleCallbacks(e.styleCallbacks),this.attributeCallbacks=r.default(e.attributeCallbacks),this.allowedTags=n.getAllowedTags(e.additionalAllowedTags),this.allowedAttributes=n.getAllowedAttributes(e.additionalAllowAttributes),this.defaultStyleValues=n.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.allowPreserveWhiteSpace=e.allowPreserveWhiteSpace}return e.convertInlineCss=function(t,r){return new e({additionalGlobalStyleNodes:r}).exec(t,!0)},e.sanitizeHtml=function(t,r){var i=new e(r=r||{}),n=r.currentElementOrStyle instanceof HTMLElement?l.default(r.currentElementOrStyle):r.currentElementOrStyle;return i.exec(t,r.convertCssOnly,r.preserveFragmentOnly,n)},e.prototype.exec=function(e,t,r,l){var n=i.default(e,r);return n&&(this.convertGlobalCssToInlineCss(n),t||this.sanitize(n.body,l)),n&&n.body&&n.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=r.default(t,l.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=s(e.querySelectorAll("style")),r=0,l=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(t.map(function(e){return e.sheet}).reverse());r<l.length;r++)for(var i=l[r],n=function(t){var r=i.cssRules[t],l=r&&r.style?r.style.cssText:null;if(r.type!=CSSRule.STYLE_RULE||!l||!r.selectorText)return"continue";for(var n=0,o=r.selectorText.split(",");n<o.length;n++){var a=o[n];if(a&&a.trim()&&!(a.indexOf(":")>=0))s(e.querySelectorAll(a)).forEach(function(e){return e.setAttribute("style",l+(e.getAttribute("style")||""))})}},o=i.cssRules.length-1;o>=0;o--)n(o);t.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},e.prototype.processNode=function(e,t,l){var i=e.nodeType,n=i==Node.ELEMENT_NODE,o=i==Node.TEXT_NODE,s=e,a=n?s.tagName.toUpperCase():"";if(n&&!this.allowElement(s,a,l)||o&&/^[\r\n]*$/g.test(e.nodeValue)&&!t.insidePRE||!n&&!o)e.parentNode.removeChild(e);else if(o&&!this.allowPreserveWhiteSpace&&"pre"==t["white-space"])e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else if(n){var u=r.default(t);this.processAttributes(s,l),this.processCss(s,a,u,l),"PRE"==a&&(u.insidePRE="true");for(var d=s.firstChild,c=void 0;d;d=c)c=d.nextSibling,this.processNode(d,u,l)}},e.prototype.processCss=function(e,t,r,l){var i=this,n=e.getAttributeNode("style");if(n){var o=n.value.split(";"),s=o.filter(function(t){var n;if(!t||""==t.trim()||2!=(n=t.split(":")).length)return!1;var o=n[0].trim().toLowerCase(),s=n[1].trim().toLowerCase(),a=i.styleCallbacks[o],u=null!=r[o],d=(!a||a(s,e,l))&&"inherit"!=s&&s.indexOf("expression")<0&&"-"!=o.substr(0,1)&&i.defaultStyleValues[o]!=s&&(u&&s!=r[o]||!u&&"initial"!=s&&"normal"!=s);return d&&u&&(r[o]=s),d&&(i.allowPreserveWhiteSpace||"white-space"!=o)});o.length!=s.length&&(s.length>0?e.setAttribute("style",s.map(function(e){return e.trim()}).join("; ")):e.removeAttribute("style"))}},e.prototype.processAttributes=function(e,t){for(var r=e.attributes.length-1;r>=0;r--){var l=e.attributes[r],i=l.name.toLowerCase().trim(),n=l.value,o=this.attributeCallbacks[i];o?n=o(n,e,t):this.allowedAttributes.indexOf(i)<0&&(n=null),null==n||n.toLowerCase().indexOf("script:")>=0?e.removeAttribute(i):l.value=n}},e.prototype.allowElement=function(e,t,r){var l=this.elementCallbacks[t];return l?l(e,r):this.allowedTags.indexOf(t)>=0||t.indexOf(":")>0},e}();function s(e){return[].slice.call(e)}t.default=o}),define("roosterjs-html-sanitizer/index",["require","exports","./sanitizer/HtmlSanitizer","./utils/htmlToDom","./utils/getInheritableStyles"],function(e,t,r,l,i){Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlSanitizer=r.default,t.htmlToDom=l.default,t.splitWithFragment=l.splitWithFragment,t.getInheritableStyles=i.default}),define("roosterjs-html-sanitizer",["require","exports"],function(e,t){t.Sanitizer={},t.Sanitizer.sanitizeHtmlOptions={attributeCallbacks:{style:e=>e.replace(/(height|line-height)\s*:.+?(;[\s]?|$)/g,"")}}},["Sanitizer"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.roosterjs-html-sanitizer"}}));