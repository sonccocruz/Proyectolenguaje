"use strict";define("VSSUI",["require","exports","react","VSS/Core/Util/Screen","VSS/Core/EventManagement","VSS/Core/Util/Accessibility","VSS/Core/Util/String","VSS/Core/Util/Promise","VSS/Platform/Layout"],function(e,t,n,o,s,a,l,i,r){var c,u,m,h,d,p,f,C,g,b,P,D,v,y,E,S;c=t.ResourcesLayer={},t.ResourcesLayer.Close="Close",t.ResourcesLayer.Resize="Resize",t.ResourcesLayer.SizeFormat="Height {0}, Width {1}",function(e){u=t.ComponentsPanelCustomPanel={};class s extends n.Component{constructor(e){super(e),this.calloutContentRef=n.createRef(),this.defaultActiveElement=(()=>{const{defaultActiveElement:e}=this.props,t="function"==typeof e?e():e;if(t&&this.calloutContentRef.current){const e=this.calloutContentRef.current.querySelectorAll(t);if(e&&e.length)return t}return".bolt-panel-focus-element"}),this.state={isDisplayed:!0}}render(){const{ariaLabel:e,ariaLabelledBy:o,blurDismiss:s,calloutClassName:a,children:l,className:i,contentClassName:r,escDismiss:c,id:u,lightDismiss:m,modal:h,onDismiss:d,portalProps:p,size:f=1}=this.props,{isDisplayed:C}=this.state;return n.createElement(t.Observer.Observer,{size:this.context.size},g=>{const b=0===g.size;return n.createElement(t.Callout.Callout,{ariaLabel:e,ariaLabelledBy:o,blurDismiss:s,className:(0,t.Util.css)("bolt-panel",a,!1===C&&"no-events"),contentClassName:(0,t.Util.css)(r,"bolt-panel-callout-content scroll-auto",C?"in":"out",b?"bolt-panel-fullscreen absolute-fill":"relative"),contentJustification:3,contentLocation:2,contentOrientation:0,contentRef:this.calloutContentRef,contentShadow:!0,contentSize:b?void 0:f,escDismiss:c,id:u,focuszoneProps:{circularNavigation:!0,defaultActiveElement:this.defaultActiveElement,focusOnMount:!0,handleTabKey:!0,includeDefaults:!0,postprocessKeyStroke:function(e){return 9===e.which&&e.preventDefault(),2}},lightDismiss:m&&!1!==C,modal:h&&!1!==C,onDismiss:d,portalProps:p},n.createElement(t.Surface.SurfaceContext.Consumer,null,e=>n.createElement(t.Surface.Surface,Object.assign({},e,{spacing:1}),n.createElement("div",{className:(0,t.Util.css)(i,"bolt-panel-root flex-column flex-grow scroll-auto")},n.createElement("div",{className:"bolt-panel-focus-element no-outline",tabIndex:-1}),l))))})}animateOut(){return Promise.resolve()}}t.ComponentsPanelCustomPanel.CustomPanel=s,s.defaultProps={escDismiss:!0,lightDismiss:!0,modal:!0},s.contextType=o.ScreenContext}(),function(e){m=t.ComponentsPanelPanelContent={};t.ComponentsPanelPanelContent.PanelContent=(e=>n.createElement(t.Surface.SurfaceContext.Consumer,null,o=>n.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-panel-content flex-row flex-grow scroll-auto",o.horizontalClassName)},e.children)))}(),function(e){h=t.ComponentsPanelPanelFooter={};t.ComponentsPanelPanelFooter.PanelFooter=(e=>{const{buttonProps:o,className:s,showSeparator:a}=e;let l=null;return l=o?n.createElement(t.ButtonGroup.ButtonGroup,{className:"bolt-panel-footer-buttons flex-grow"},o.map((e,o)=>n.createElement(t.Button.Button,Object.assign({key:e.id||o},e)))):e.children,n.createElement(t.Surface.SurfaceContext.Consumer,null,e=>n.createElement(n.Fragment,null,a&&n.createElement("div",{className:"bolt-panel-separator flex-noshrink"}),n.createElement("div",{className:(0,t.Util.css)(s,"bolt-panel-footer flex-center",e.horizontalClassName)},l)))})}(),function(e){d=t.ComponentsPanelPanelHeader={};let o=1;t.ComponentsPanelPanelHeader.PanelHeader=(e=>{const{backButtonProps:s,description:a,onDismiss:l,closeButtonSize:i,showCloseButton:r,showSeparator:u,titleProps:m={}}=e;if(e.children)return n.createElement(n.Fragment,null,n.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-panel-header flex-noshrink flex-column scroll-hidden")},e.children),u&&n.createElement("div",{className:"bolt-panel-separator flex-noshrink"}));const h=[];return!1!==r&&h.push({ariaLabel:c.Close,iconProps:{iconName:0===i?"Cancel":"Clear"},id:`close-button-${o++}`,role:"button",onActivate:l,subtle:!0}),n.createElement(t.Header.Header,{backButtonProps:s,className:(0,t.Util.css)(e.className,"bolt-panel-header"),commandBarItems:h,description:a,separator:u,title:m.text,titleClassName:m.className,titleId:m.id,titleSize:void 0===m.size?1:m.size,titleIconProps:m.iconProps})})}(),function(e){p=t.ComponentsPanelPanelOverlay={};t.ComponentsPanelPanelOverlay.PanelOverlay=(e=>n.createElement(n.Fragment,null,n.createElement("div",{className:"absolute-fill bolt-panel-overlay sub-layer"}),n.createElement("div",{className:"absolute-fill flex-column flex-center justify-center sub-layer"},e.overlayContent)))}(),function(e){f=t.ComponentsPanelPanel={};let o=1;t.ComponentsPanelPanel.Panel=class extends n.Component{constructor(){super(...arguments),this.customPanelRef=n.createRef(),this.panelId=`panel-${o++}`}render(){const{props:e}=this,{backButtonProps:t,description:o,footerButtonProps:s,onDismiss:a,overlayContent:l,showSeparator:i,titleProps:r={}}=e,c=e.id||this.panelId,f=r.id?r.id:r.text?`${c}-title`:void 0;return n.createElement(u.CustomPanel,Object.assign({ariaLabelledBy:f},e,{id:c,lightDismiss:!l&&e.lightDismiss,ref:this.customPanelRef}),n.createElement(d.PanelHeader,{backButtonProps:t,description:o,onDismiss:a,showSeparator:i,titleProps:Object.assign({id:f},r)}),n.createElement(m.PanelContent,{className:e.contentClassName},e.children),s&&n.createElement(h.PanelFooter,{showSeparator:i,buttonProps:s}),l&&n.createElement(p.PanelOverlay,{overlayContent:l}))}animateOut(){return this.customPanelRef.current?this.customPanelRef.current.animateOut():Promise.resolve()}}}(),function(e){C=t.ComponentsPanelPanelCloseButton={};t.ComponentsPanelPanelCloseButton.PanelCloseButton=(e=>n.createElement(t.Button.Button,{className:(0,t.Util.css)(e.className,"close-button"),ariaLabel:c.Close,iconProps:{iconName:0===e.size?"Cancel":"Clear"},onClick:e.onDismiss,subtle:!0,tooltipProps:{showOnFocus:!0,text:c.Close}}))}(),g=t.Panel={},Object.defineProperty(t.Panel,"CustomPanel",{enumerable:!0,get:function(){return u.CustomPanel}}),Object.defineProperty(t.Panel,"Panel",{enumerable:!0,get:function(){return f.Panel}}),Object.defineProperty(t.Panel,"PanelCloseButton",{enumerable:!0,get:function(){return C.PanelCloseButton}}),Object.defineProperty(t.Panel,"PanelContent",{enumerable:!0,get:function(){return m.PanelContent}}),Object.defineProperty(t.Panel,"PanelFooter",{enumerable:!0,get:function(){return h.PanelFooter}}),Object.defineProperty(t.Panel,"PanelHeader",{enumerable:!0,get:function(){return d.PanelHeader}}),Object.defineProperty(t.Panel,"PanelOverlay",{enumerable:!0,get:function(){return p.PanelOverlay}}),function(e){b=t.ComponentsDialogCustomDialog={};const i=320,r=2;class u extends n.Component{constructor(e){super(e),this.events=new s.EventManagement,this.contentRef=n.createRef(),this.onGripperKeyDown=(e=>{if(this.contentRef.current){const t=this.contentRef.current.getBoundingClientRect();switch(this.currentHeight=t.height,this.currentWidth=t.width,e.keyCode){case 37:this.setState({width:Math.max(this.currentWidth-r,i)});break;case 39:this.setState({width:this.currentWidth+r});break;case 38:this.setState({height:Math.max(this.currentHeight-r,i)});break;case 40:this.setState({height:this.currentHeight+r});break;default:return}e.preventDefault(),e.stopPropagation(),(0,a.announce)((0,l.format)(c.SizeFormat,this.state.height||this.currentHeight,this.state.width||this.currentWidth))}}),this.onGripperMouseDown=(e=>{this.onGripperDown(e,e.clientX,e.clientY),this.attachMouseWindowEvents()}),this.onGripperDown=((e,t,n)=>{if(this.contentRef&&(e.preventDefault(),e.stopPropagation(),this.anchorX=t,this.anchorY=n,this.contentRef.current)){const e=this.contentRef.current.getBoundingClientRect();this.currentHeight=e.height,this.currentWidth=e.width}}),this.onGripperMouseMove=(e=>{this.handleDragEvent(e,e.clientX,e.clientY)}),this.onGripperMouseUp=(e=>{this.detachMouseWindowEvents(),(0,a.announce)((0,l.format)(c.SizeFormat,this.state.height,this.state.width))}),this.state={}}render(){const{ariaDescribedBy:e,ariaLabel:o,ariaLabelledBy:s,blurDismiss:a,calloutClassName:l,className:i,calloutContentClassName:r,contentJustification:u,contentLocation:m,defaultActiveElement:h,escDismiss:d,id:p,lightDismiss:f,onDismiss:C,overlay:g,modal:b,resizable:P,role:D,contentSize:v=1}=this.props;return n.createElement(t.Observer.Observer,{size:this.context.size},y=>{const E=0===y.size;return n.createElement(t.Callout.Callout,{ariaDescribedBy:e,ariaLabel:o,ariaLabelledBy:s,blurDismiss:a,className:(0,t.Util.css)(l,"bolt-dialog-callout"),contentClassName:(0,t.Util.css)(r,"bolt-dialog-callout-content relative scroll-auto",E&&"bolt-dialog-mobile flex-grow"),contentJustification:u,contentLocation:m,contentOrientation:0,contentRef:this.contentRef,contentShadow:!0,contentSize:E?void 0:v,escDismiss:d,focuszoneProps:{circularNavigation:!0,defaultActiveElement:h||".bolt-dialog-focus-element",focusOnMount:!0,handleTabKey:!0,includeDefaults:!0,postprocessKeyStroke:function(e){return 9===e.which&&e.preventDefault(),2}},id:p,lightDismiss:f,modal:b,onDismiss:C,role:D,height:this.state.height,width:this.state.width},n.createElement(t.Surface.SurfaceContext.Consumer,null,e=>n.createElement(t.Surface.Surface,Object.assign({},e,{spacing:1}),n.createElement("div",{className:(0,t.Util.css)(i,"bolt-dialog-root flex-column flex-grow scroll-hidden")},n.createElement("div",{className:"bolt-dialog-focus-element no-outline",tabIndex:-1}),this.props.children,!E&&P&&n.createElement(t.Icon.Icon,{ariaLabel:c.Resize,iconName:"GripperResize",onMouseDown:this.onGripperMouseDown,onKeyDown:this.onGripperKeyDown,tabIndex:0,wrapperClass:"bolt-dialog-resize-icon"}),g&&n.createElement("div",{className:"absolute-fill bolt-dialog-overlay flex-column justify-center"},n.createElement(t.Spinner.Spinner,{size:"large",ariaLabel:g.spinnerAriaLabel,ariaLive:"assertive",label:g.spinnerLabel}))))))})}handleDragEvent(e,t,n){const o=Math.max((this.currentWidth||0)+2*(t-this.anchorX),i),s=Math.max((this.currentHeight||0)+2*(n-this.anchorY),i);this.setState({width:o,height:s})}attachMouseWindowEvents(){this.events.addEventListener(window,"mousemove",this.onGripperMouseMove),this.events.addEventListener(window,"mouseup",this.onGripperMouseUp)}detachMouseWindowEvents(){this.events.removeEventListener(window,"mousemove",this.onGripperMouseMove),this.events.removeEventListener(window,"mouseup",this.onGripperMouseUp)}}t.ComponentsDialogCustomDialog.CustomDialog=u,u.defaultProps={contentJustification:1,contentLocation:1,escDismiss:!0,lightDismiss:!0},u.contextType=o.ScreenContext}(),function(e){P=t.ComponentsDialogDialogInternal={};let o=1;class s extends n.Component{constructor(){super(...arguments),this.dialogId=`dialog-${o++}`}render(){const{ariaDescribedBy:e,ariaLabel:o,ariaLabelledBy:s,blurDismiss:a,calloutClassName:l,calloutContentClassName:i,className:r,contentJustification:c,contentLocation:u,contentSize:m,defaultActiveElement:h,escDismiss:d,footerButtonProps:p,lightDismiss:f,modal:C,onDismiss:P,overlay:D,resizable:v,showCloseButton:y}=this.props,E=Object.assign({},this.props.titleProps),S=this.props.id||this.dialogId,w=E.id?E.id:E.text?`${S}-title`:void 0;return E.id=w,void 0===E.size&&(E.size=2),n.createElement(b.CustomDialog,{ariaDescribedBy:e,ariaLabel:o,ariaLabelledBy:s||w,blurDismiss:a,calloutClassName:l,calloutContentClassName:i,contentLocation:u,contentJustification:c,className:(0,t.Util.css)("bolt-dialog",r),defaultActiveElement:h,escDismiss:d,id:S,lightDismiss:f,modal:C,onDismiss:P,overlay:D,contentSize:m,resizable:v},n.createElement(g.PanelHeader,{onDismiss:P,closeButtonSize:0,showCloseButton:y,showSeparator:!1,titleProps:E}),n.createElement(t.Surface.SurfaceContext.Consumer,null,e=>n.createElement("div",{className:(0,t.Util.css)("bolt-dialog-content flex-column flex-grow",!p&&"bolt-dialog-content-bottom-padding",e.horizontalClassName)},this.props.children)),p&&n.createElement(g.PanelFooter,{className:(0,t.Util.css)(v&&"bolt-dialog-resizable-footer"),showSeparator:!1,buttonProps:p}))}}t.ComponentsDialogDialogInternal.DialogInternal=s,s.defaultProps={showCloseButton:!1}}(),function(e){D=t.ComponentsDialogCornerDialog={};t.ComponentsDialogCornerDialog.CornerDialog=class extends n.Component{render(){return n.createElement(P.DialogInternal,Object.assign({},this.props,{calloutContentClassName:(0,t.Util.css)(this.props.calloutContentClassName,"bolt-lower-right-corner-dialog-content"),calloutClassName:(0,t.Util.css)(this.props.calloutClassName,"no-events"),contentJustification:2,contentLocation:2,lightDismiss:!1,modal:!1,escDismiss:!1,showCloseButton:!0}))}}}(),function(e){v=t.ComponentsDialogDialog={};t.ComponentsDialogDialog.Dialog=class extends n.Component{render(){return n.createElement(P.DialogInternal,Object.assign({},this.props,{modal:!0}))}}}(),function(e){y=t.ComponentsToastToast={};t.ComponentsToastToast.Toast=class extends n.Component{constructor(e){super(e),this.callToActionRef=n.createRef(),this.onCallToActionClick=(e=>{this.props.onCallToActionClick&&this.props.onCallToActionClick(e)}),this.onKeyboardShortcut=(e=>{this.callToActionRef.current&&!this.state.fadingOut&&e.ctrlKey&&e.altKey&&84===e.which&&this.callToActionRef.current.focus()}),this.onMeasureCallToAction=((e,t)=>{this.setState({callToActionWidth:e})}),this.state={fadingOut:!1}}fadeOut(){this.fadeOutPromise&&this.fadeOutPromise.cancel();const e=new Promise(e=>{this.setState({fadingOut:!0}),setTimeout(()=>{e()},500)});return this.fadeOutPromise=(0,i.makeCancelable)(e),this.fadeOutPromise}render(){const{message:e,callToAction:o,className:s}=this.props,{callToActionWidth:a,fadingOut:l}=this.state,i=!o||!a||a<=120,r=i?"one-line flex-row":"multi-line flex-column",c=i?"flex-grow":void 0,u=l?"fade-out":void 0;return n.createElement(t.Callout.Callout,{className:(0,t.Util.css)(s,"bolt-toast no-events"),contentClassName:(0,t.Util.css)("bolt-toast-content",r,u),contentJustification:1,contentLocation:2},n.createElement("span",{className:(0,t.Util.css)("bolt-toast-message flex-shrink",c),id:(0,t.Util.getSafeId)("toast-message"),role:"alert"},e),o&&n.createElement(n.Fragment,null,n.createElement("span",{className:"bolt-toast-separator flex-noshrink"}),n.createElement(t.Measure.Measure,{onMeasure:this.onMeasureCallToAction},n.createElement("div",{className:"bolt-toast-call-to-action-container"},n.createElement(t.Button.Button,{ariaDescribedBy:"toast-message",className:"bolt-toast-call-to-action flex-noshrink",ref:this.callToActionRef,subtle:!0,onClick:this.onCallToActionClick},o)))))}componentDidMount(){document.addEventListener("keydown",this.onKeyboardShortcut)}componentWillUnmount(){this.fadeOutPromise&&this.fadeOutPromise.cancel(),document.removeEventListener("keydown",this.onKeyboardShortcut)}}}(),E=t.Dialog={},Object.defineProperty(t.Dialog,"CornerDialog",{enumerable:!0,get:function(){return D.CornerDialog}}),Object.defineProperty(t.Dialog,"CustomDialog",{enumerable:!0,get:function(){return b.CustomDialog}}),Object.defineProperty(t.Dialog,"Dialog",{enumerable:!0,get:function(){return v.Dialog}}),S=t.Toast={},Object.defineProperty(t.Toast,"Toast",{enumerable:!0,get:function(){return y.Toast}}),t.RegistrationLayerComponentRegistration={},r.VssComponent.register("cornerDialog",E.CornerDialog),r.VssComponent.register("customPanel",g.CustomPanel),r.VssComponent.register("dialog",E.Dialog),r.VssComponent.register("customDialog",E.CustomDialog),r.VssComponent.register("toast",S.Toast)},["Resources.Layer","Components/Panel/CustomPanel","Components/Panel/PanelContent","Components/Panel/PanelFooter","Components/Panel/PanelHeader","Components/Panel/PanelOverlay","Components/Panel/Panel","Components/Panel/PanelCloseButton","Panel","Components/Dialog/CustomDialog","Components/Dialog/DialogInternal","Components/Dialog/CornerDialog","Components/Dialog/Dialog","Components/Toast/Toast","Dialog","Toast","Registration/LayerComponentRegistration"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-layer-content"}}));