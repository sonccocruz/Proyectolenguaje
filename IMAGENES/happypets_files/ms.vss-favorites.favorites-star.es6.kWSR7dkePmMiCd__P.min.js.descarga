"use strict";define("Favorites/Star",["require","exports","Favorites/Common/Resources","react","VSS/Platform/Layout","VSSUI/Button","VSSUI/Util"],function(t,e,i,a,o,r,s){var v;!function(t){v=e.FavoritesStarButton={};class n extends a.Component{render(){const{isFavorited:t,buttonClassName:e,className:o,onToggleFavorite:v}=this.props,n=t?i.FavoriteStarFavoritedTitle:i.FavoriteStarUnfavoritedTitle,c=t?this.props.favoritedArialabel:this.props.unFavoritedArialabel,p={iconName:t?"FavoriteStarFill":"FavoriteStar",className:(0,s.css)(o,t?"vss-FavoriteItem--starIcon favorited":"vss-FavoriteItem--starIcon")};return a.createElement(r.Button,{subtle:!0,iconProps:p,onClick:v,ariaLabel:c||n,"aria-pressed":t,className:e,tooltipProps:{showOnFocus:!0,text:n}})}}e.FavoritesStarButton.FavoritesStarButton=n,n.componentType="favoritesStarButton",o.VssComponent.register(n.componentType,n)}(),function(t){var i;e.FavoritesStar={},function(t){t.AREA="Favorites",t.FAVORITE_TOGGLE_CLICK="ToggleFavoriteClick",t.FAVORITE_DELETE_CLICK="DeleteFavoriteClick"}(i=e.FavoritesStar.FavoritesCustomerIntelligenceConstants||(e.FavoritesStar.FavoritesCustomerIntelligenceConstants={}));class r extends o.VssComponent{constructor(t,e){super(t,e),this._isComponentMounted=!1,this._onFavoritesLoaded=(t=>{const e=t.value,i=e?e.find(t=>this._favoriteMatchesArtifact(t)):void 0;this._isComponentMounted&&this.setState({favorite:i})}),this._onToggleFavorite=(t=>{if(this.state.favorite)this.props.onRemoveFavorite&&this.props.onRemoveFavorite(t),this._favoritesService.removeFavorite(this.state.favorite);else{this.props.onAddFavorite&&this.props.onAddFavorite(t);const e={artifactId:this.props.artifact.artifactId,artifactName:this.props.artifact.artifactName,artifactScope:this.props.artifact.artifactScope,artifactType:this.props.artifact.artifactType};this._favoritesService.addFavorite(e)}this.state.favorite&&this.state.favorite.artifactIsDeleted?this._publish(i.FAVORITE_DELETE_CLICK,{favoriteType:this.props.artifact.artifactType}):this._publish(i.FAVORITE_TOGGLE_CLICK,{favoriteType:this.props.artifact.artifactType,favorited:!this.state.favorite})}),this._onFavoriteAdded=(t=>{this._favoriteMatchesArtifact(t)&&this.setState({favorite:t})}),this._onFavoriteRemoved=(t=>{this._favoriteMatchesArtifact(t)&&this.setState({favorite:void 0})}),this._favoriteMatchesArtifact=(t=>{const e=this.props.artifact;return t.artifactId===e.artifactId&&t.artifactType===e.artifactType}),this.state={favorite:void 0},this._favoritesService=this.context.pageContext.getService("IFavoritesService"),this._favoritesService.subscribe(this._onFavoriteAdded,"favoriteAdded"),this._favoritesService.subscribe(this._onFavoriteRemoved,"favoriteRemoved")}render(){return this._favoritesService.canUseFavorites()?a.createElement(v.FavoritesStarButton,{buttonClassName:this.props.buttonClassName,className:this.props.className,favoritedArialabel:this.props.favoritedArialabel,unFavoritedArialabel:this.props.unFavoritedArialabel,isFavorited:!!this.state.favorite,onToggleFavorite:this._onToggleFavorite}):null}componentDidMount(){this._isComponentMounted=!0,this._loadFavoritesData()}componentWillUnmount(){this._favoritesService.unsubscribe(this._onFavoriteAdded,"favoriteAdded"),this._favoritesService.unsubscribe(this._onFavoriteRemoved,"favoriteRemoved"),this._isComponentMounted=!1}_loadFavoritesData(){this._favoritesService.getFavorites(this.props.artifact.artifactType,this.props.artifact.artifactScope.type,this.props.artifact.artifactScope.id).then(this._onFavoritesLoaded)}_publish(t,e={}){this._navigationService=this.context.pageContext.getService("IVssNavigationService"),e.routeId=this._navigationService.getCurrentRoute().routeId,this._telemetryService=this.context.pageContext.getService("IVssTelemetryService"),this._telemetryService.publishEvent(i.AREA,t,e)}}e.FavoritesStar.FavoritesStar=r,r.componentType="favoritesStar",o.VssComponent.register(r.componentType,r)}()},["FavoritesStarButton","FavoritesStar"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-favorites.favorites-star"}}));