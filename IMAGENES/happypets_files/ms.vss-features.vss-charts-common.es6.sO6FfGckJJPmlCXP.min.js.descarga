"use strict";define("VSS/Features/Charts",["require","exports","VSS/Core/Util/String","react","VSS/Platform/Layout","highcharts"],function(e,t,r,a,n,s){var i,o,l,c,u,p,h,d,m,g,C,y,b,T,f;i=t.Resources={},t.Resources.AccessibleTabularFormButtonAvailable="{0} chart has updated data, you can now refresh the accessible tabular form of the chart using the link.",t.Resources.AccessibleTabularFormDescription="Refresh the accessible tabular form of the {0} chart.",t.Resources.AccessibleTabularFormUpdateSuccessful="Accessible tabular form of the {0} chart updated successfully.",t.Resources.ChartEditor_AvailableScreenreader_Format=" Interactive chart. {0}. {1}.",t.Resources.ChartEditor_AvailableScreenreader_NoTitle_Format=" Interactive chart. {0}.",t.Resources.ChartsRemainingItems="(other)",t.Resources.HtmlTable_DateLabel="Date",t.Resources.HtmlTable_DurationLabel="Duration",t.Resources.HtmlTable_FailureMessage="The alternate text-only table for this chart failed to load.",t.Resources.HtmlTable_SampleLabel="Sample",t.Resources.HtmlTable_SeriesLabel="Series {0}",t.Resources.HtmlTable_TabularViewDescription="A tabular view of chart content.",t.Resources.HtmlTable_SeriesHeaderName="Series name",t.Resources.ChartType_A11yLabel_Area="Area chart",t.Resources.ChartType_A11yLabel_AreaRange="Area range chart",t.Resources.ChartType_A11yLabel_Bar="Bar chart",t.Resources.ChartType_A11yLabel_Column="Column chart",t.Resources.ChartType_A11yLabel_ColumnLine="Combination column and line chart",t.Resources.ChartType_A11yLabel_Histogram="Histogram",t.Resources.ChartType_A11yLabel_Hybrid="Chart combining 2 or more chart types",t.Resources.ChartType_A11yLabel_Line="Line chart",t.Resources.ChartType_A11yLabel_Pie="Pie chart",t.Resources.ChartType_A11yLabel_Scatter="Scatter plot",t.Resources.ChartType_A11yLabel_Bubble="Bubble chart",t.Resources.ChartType_A11yLabel_StackedArea="Stacked area chart",t.Resources.ChartType_A11yLabel_StackedBar="Stacked bar chart",t.Resources.ChartType_A11yLabel_StackedColumn="Stacked column chart",t.Resources.ChartType_A11yLabel_Table="Table",t.Resources.ChartType_A11yLabel_Funnel="Funnel chart",t.Resources.FriendlyNumberThousandsFormat="{0}K",t.Resources.FriendlyNumberMillionsFormat="{0}M",t.Resources.FriendlyNumberBillionsFormat="{0}B",t.Resources.ChartColorValidationErrorMessage="Could not parse color format supplied to the chart. Please pass a valid color format of the form #AAAAAA.",t.Resources.A11yLabelPrefixFormat="{0}. {1}",t.Resources.A11yLabelElementSeparatorFormat="{0}, {1}",function(e){o=t.Contracts={};class r{}t.Contracts.ChartTypesConstants=r,r.Pie="pie",r.Bar="bar",r.StackedBar="stackedBar",r.Column="column",r.StackedColumn="stackedColumn",r.Histogram="histogram",r.Area="area",r.StackedArea="stackedArea",r.Line="line",r.Scatter="scatter",r.Bubble="bubble",r.ColumnLine="columnLine",r.Hybrid="hybrid",r.AreaRange="arearange",r.Table="table",r.Funnel="funnel";class a{}t.Contracts.LabelFormatModes=a,a.Textual="textual",a.Linear="linear",a.DateTime_DayInMonth="dateTime_DayInMonth",a.NumberSeconds_HourMinuteSeconds="numberSeconds_HourMinuteSeconds",a.Percentage="percentage";class n{}t.Contracts.ChartColorizer=n,n.Transparent="rgba(255,255,255,0)"}(),function(e){l=t.InternalCompatUtilities={},t.InternalCompatUtilities.isHighContrastMode=function(){let e=!1;const t=document.createElement("span");t.style.color="#123456",document.body.appendChild(t);const r=getComputedStyle(t);return r&&"rgb(18,52,86)"!==r.color.replace(/ /g,"")&&/^rgb\(\d+,\s?\d+,\s?\d+\)$/.test(r.color)&&(e=!0),t.parentNode.removeChild(t),e},t.InternalCompatUtilities.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},t.InternalCompatUtilities.shiftToUTC=function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())},t.InternalCompatUtilities.getShortMonth=function(e){return e.toLocaleDateString(navigator.language,{month:"short"})}}(),function(e){function a(e){const t=Math.ceil(Math.log(e)*Math.LOG10E),r=Math.max(2,t);return e.toPrecision(r)}c=t.InternalFriendlyNumberFormatter={},t.InternalFriendlyNumberFormatter.getFriendlyDisplayValue=function(e){let t="",n=!1;if(isNaN(e))return"";if(e<0&&(n=!0,e=-e),e<1e3)t=e.toString();else if(e<1e6){const n=a(e/1e3);t=(0,r.format)(i.FriendlyNumberThousandsFormat,n.toLocaleString())}else if(e<1e9){const n=a(e/1e6);t=(0,r.format)(i.FriendlyNumberMillionsFormat,n.toLocaleString())}else{const n=a(e/1e9);t=(0,r.format)(i.FriendlyNumberBillionsFormat,n.toLocaleString())}return(n?"-":"")+t}}(),function(e){function r(e){if(!e)return"";let t=e;return"string"!=typeof e&&(t=""+e),t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}function a(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}function n(e){return"string"==typeof e&&(e=r(e)),e}u=t[e]={},t[e].htmlEncode=r,t[e].decodeHtmlSpecialChars=a,t[e].encodeUntrustedString=n,t[e].encodeUntrustedStringArray=function(e){return e.map(e=>n(e))},t[e].decodeString=function(e){return"string"==typeof e&&(e=a(e)),e},t[e].truncateString=function(e,t){if("string"==typeof e&&(0,l.isNumeric)(t)){let r=e=a(e);r.length>t&&(e=r.substr(0,t)+"..."),e=n(e)}return e}}("InternalStringUtilities"),function(e){p=t[e]={};t[e].AxisMonthFormatter=class{getFormatter(){const e=this;return function(){const t=this,r=t.isFirst;let a=t.value;if("number"==typeof t.value){const n=t.value;a=e.formatLabel(new Date(n),r)}return a}}formatLabel(e,t){const r=(0,l.shiftToUTC)(e),a=(0,l.getShortMonth)(r);let n=r.getDate().toString();return(t||this.previousRenderedMonthName!=a)&&(this.previousRenderedMonthName=a,n=n+"<br/>"+a),n}};class r{static getFormatter(e=!1){return function(){let t=this.value;return e||(t=u.truncateString(t,r.MaxLabelLength)),t}}}t[e].TruncationFormatter=r,r.MaxLabelLength=15;t[e].AbbreviatedNumberFormatter=class{static getFormatter(){return function(){let e=this.value;return void 0===e&&(e=this.point&&this.point.value),isNaN(e)?e:(0,c.getFriendlyDisplayValue)(e)}}};t[e].PercentageNumberFormatter=class{static getFormatter(){return function(){const e=this.value;return null==e||isNaN(e)?e:e+"%"}}};t[e].TabularLabelFormatter=class{static getFormatter(){return function(){const e=this.point.value;if(isNaN(e))return"0";{const t=+e.toFixed(2);return(0,c.getFriendlyDisplayValue)(t)}}}};class a{static formatToTwoDigits(e){return e.length<2&&(e="0"+e),e}static getFormatter(){return function(){let e=this.value;return void 0===e&&(e=this.point&&this.point.value),isNaN(e)?e:a.convertToTimeFormat(e)}}static convertToTimeFormat(e){let t,r,n;return t=a.formatToTwoDigits(Math.floor(e/3600).toString()),e%=3600,r=a.formatToTwoDigits(Math.floor(e/60).toString()),e%=60,t+":"+r+":"+(n=a.formatToTwoDigits(Math.floor(e).toString()))}}t[e].TimeSpanFormatter=a}("InternalAxisLabelFormatter"),function(e){h=t.InternalAxisTickPositioner={};class r{getPositioner(){let e=this;return function(){return e.positionTicks(this)}}positionTicks(e){let t=[],a=Math.floor(e.dataMin),n=Math.ceil((e.dataMax-e.dataMin)/r._IdealNumSteps);if(null!==e.dataMax&&null!==e.dataMin&&0!==n)for(let r=a;r<=e.dataMax;r+=n)t.push(r);return t}}t.InternalAxisTickPositioner.AxisTickPositioner=r,r._IdealNumSteps=7}(),function(e){d=t.InternalColorUtilities={};class r{static getRelativeLuminance(e){const t=e.map(e=>e=(e/=255)<.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*t[0]+.7152*t[1]+.0722*t[2]}static getContrastRatio(e){return(r.getRelativeLuminance([255,255,255])+.05)/(r.getRelativeLuminance(e)+.05)}static toRgbArray(e){if(e.startsWith("rgba")){const t=e.substring(5,e.length-1).replace(/ /g,"").split(",");return[parseInt(t[0]),parseInt(t[1]),parseInt(t[2])]}{const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,(e,t,r,a)=>t+t+r+r+a+a),a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);if(null===a)throw i.ChartColorValidationErrorMessage;return a.splice(1,a.length-1).map(e=>parseInt(e,16))}}static selectForegroundColor(e){return r.isDark(e)?"#FFFFFF":"#000000"}static isDark(e){const t=r.toRgbArray(e);return r.getContrastRatio(t)>4.5}}t.InternalColorUtilities.ColorUtilities=r}(),function(e){m=t[e]={};class r{getFeatureColor(e,t=!1){let r=null;return e===i.ChartsRemainingItems&&(r=t?"#C8C5C6":"#959595"),null!=r?{background:r,foreground:d.ColorUtilities.selectForegroundColor(r)}:null}}t[e].DefaultFeatureColorProvider=r;t[e].DefaultColorDictionary=class{constructor(e,t,a=n.getInstance()){this._customColorDictionary={},this._featureColorProvider=null==t?new r:t,this._mergeUserColors(a,e)}toColorEntries(){let e,t=null;if(Object.keys(this._customColorDictionary).length>0)for(e in t=new Array,this._customColorDictionary)this._customColorDictionary.hasOwnProperty(e)&&t.push({value:e,backgroundColor:this._customColorDictionary[e].background});return t}getColorPair(e,t,r){let a=this._getCustomColorPair(e);return a||(a=this._featureColorProvider.getFeatureColor(e,r)),a||(a=this._getDefaultColorPair(t,r)),a}setColorPair(e,t){this._customColorDictionary[e]=t}hasCustomColorPair(e){return!!this._customColorDictionary[e]}hasCustomColors(){return!(0===Object.keys(this._customColorDictionary).length)}clearCustomColors(){this._customColorDictionary={}}_getDefaultColorPair(e,t){return t?o.getInstance().getColorPair(e):s.getInstance().getColorPair(e)}_getCustomColorPair(e){return this._customColorDictionary[e]}_mergeUserColors(e,t){if(t)for(const r of t){const t=e.getColorPairOfBackground(r.backgroundColor);this.setColorPair(r.value,t)}}};class a{constructor(){this.backgrounds=[]}get backgrounds(){return this._backgrounds.slice()}set backgrounds(e){this._backgrounds=a.toUpperCase(e)}static toUpperCase(e){return e.map(e=>e.toUpperCase())}getColorPair(e){e%=this.backgrounds.length;const t=this.backgrounds[e];return this.getColorPairOfBackground(t)}getColorPairOfBackground(e){return{background:e,foreground:d.ColorUtilities.selectForegroundColor(e)}}}t[e].ColorSetBase=a;class n extends a{constructor(){super(),this.backgrounds=["#222222","#292E6B","#009CCC","#00643A","#339947","#FBBC3D","#DB552C","#7F1725","#EC008C","#5C197B","#51399F","#444444","#1B478B","#43B4D5","#207752","#60AF49","#FBD144","#E87025","#B20B1E","#EF33A3","#71338D","#6951AA","#666666","#0D60AB","#86CDDE","#56987D","#8DC54B","#FBE74B","#F58B1F","#E60017","#F266BA","#9260A1","#8874C2","#888888","#007ACC","#C9E7E7","#7CAF9A","#A8CE4B","#FBFD52","#F7A24B","#EB3345","#F599D1","#AE88B9","#AA9CDF","#AAAAAA","#3F9BD8","#D6EDED","#9CC3B2","#C3D84C","#FCFD7D","#F9B978","#F06673","#F9CCE8","#C7ABD0","#C0B6E9","#CCCCCC","#7FBCE5","#E4F3F3","#BFD8CD","#D7E587","#FCFEA8","#FBD0A5","#F599A2","#FBDDEF","#E0CAE7","#DAD4F7"]}static getInstance(){return null==this._instance&&(this._instance=new n),this._instance}}t[e].V2PaletteColors=n,n._instance=null;class s extends a{constructor(){super(),this.backgrounds=["#009CCC","#F58B1F","#CCCCCC","#FBBC3D","#007ACC","#71338D","#A8CE4B","#888888","#444444","#F06673","#56987D","#86CDDE","#FBE74B","#AE88B9","#B20B1E","#D7E587","#DB552C","#7FBCE5","#EC008C","#00643A"]}static getInstance(){return null==this._instance&&(this._instance=new s),this._instance}}t[e].V2DefaultColors=s,s._instance=null;class o extends a{constructor(){super(),this.backgrounds=["#E0CAE7","#C0B6E9","#E4F3F3","#F9CCE8","#CCCCCC","#FBDDEF","#C9E7E7","#DAD4F7","#F599A2"]}static getInstance(){return null==this._instance&&(this._instance=new o),this._instance}}t[e].V2DefaultSubduedColors=o,o._instance=null}("InternalDefaultColorDictionary"),function(e){g=t.InternalLegendLabelFormatter={};t.InternalLegendLabelFormatter.LegendLabelFormatter=class{static getFormatter(e){return function(){let t=this.name;return(0,l.isNumeric)(e)&&(t=u.truncateString(t,e)),t}}}}(),t.InternalInternalContracts={},function(e){C=t.InternalTooltipFormatter={};class r{constructor(e){this._options=e}static isSharedTooltipContext(e){return null!=e.points}static decodeValuesToRender(e){return e.map(e=>"string"==typeof e?(0,u.decodeString)(e):e)}static isDateTime(e){return e.series.xAxis&&"datetime"===e.series.xAxis.options.type}static getColorBox(e,t){const r=0==t?4:12;return`<svg width='${r}' height='12' class='tooltip-color' style='margin-right:5px; margin-top:2px; veritical-align:middle;'>`+`<rect xmlns='http://www.w3.org/2000/svg' fill='${e=(0,u.encodeUntrustedString)(e)}' width='${r}' height='12' zIndex='3' /></svg>`}static buildTooltipHeader(e,t){let r=e;if(t){r=(0,l.shiftToUTC)(new Date(e)).toLocaleDateString(navigator.language)}return`<div class="header-block">${r}</div>`}static buildTooltipPoint(e){let t="";return e.styleType&&(e.styleType.renderCustomStyle?t=e.styleType.renderCustomStyle(e.styleType):(e.styleType.type||(e.styleType.type=0),t=this.getColorBox(e.styleType.color,e.styleType.type))),e.text=(0,u.encodeUntrustedString)(e.text),t+=`<span style='veritical-align:middle;'>${e.text}</span></br>`}getFormatter(e){const t=this;return function(){const a=r.isSharedTooltipContext(this)?this.points.map(e=>e.point):[this.point];t._options.reverseSeries&&r.isSharedTooltipContext(this)&&a.sort(function(e,t){return t.series.index-e.series.index});let n=r.isDateTime(a[0]);const s=a.map(t=>{const a=(0,u.decodeString)(t.series.name),n=e.interpretPointAsValuesForTooltip(t);return{values:r.decodeValuesToRender(n),seriesName:a,seriesCustomData:t.series.options?t.series.options.customData:null,seriesDataIndex:t.series.data.indexOf(t),color:t.color}}),i="function"==typeof t._options.tooltipMapping?t._options.tooltipMapping(s):e.mapDataPointsToTooltipLineItems(s);let o="",l=r.isSharedTooltipContext(this)?e.getTooltipHeaderValue(this.points[0]):e.getTooltipHeaderValue(this);if("function"==typeof t._options.tooltipHeader){const e=t._options.tooltipHeader(l);let r;r="number"==typeof e?e.toLocaleString(navigator.language):e,l=(0,u.encodeUntrustedString)(r),n=!1}return o=r.buildTooltipHeader(l,n),i.forEach(e=>{o+=r.buildTooltipPoint(e)}),o}}}t.InternalTooltipFormatter.TooltipFormatter=r,r.headerFormat='<div class="header-block">{0}</div>'}(),function(e){y=t.InternalTabularComponent={};t.InternalTabularComponent.TabularComponent=class extends n.VssComponent{constructor(e,t){super(e,t)}render(){if(!this.props.showAccessibleForm)return null;const e=null!=this.props.xAxis&&null!=this.props.xAxis.labelValues&&this.props.xAxis.labelsEnabled;let t=0;const r=[];if(e){t=this.props.xAxis.labelValues.length;const e=this.interpretAxisHeader(this.props);r.push(a.createElement("th",{scope:"col",key:"xAxisHeader"},e))}for(let e=0;e<this.props.series.length;e++){const n=this.interpretSeriesHeader(this.props,e);r.push(a.createElement("th",{scope:"col",key:e},n));const s=this.props.series[e].data.length;t=t>s?t:s}const n=this.hasSparseTrendFormat(this.props),s=[];for(let r=0;r<t;r++){const t=[];let i;e&&(i=this.interpretLabel(this.props,r),t.push(a.createElement("th",{scope:"row",key:"xAxisLabel"},i)));for(let e=0;e<this.props.series.length;e++){let s;if(n)s=this.getValueTextForSparseTrendFormat(this.props,e,i);else{const t=this.props.series[e].data[r];s=null==t?"":Array.isArray(t)?t.toLocaleString():"object"==typeof t?t.y:t}t.push(a.createElement("td",{scope:"row",key:e},s))}s.push(a.createElement("tr",{key:r},t))}return this.renderTable(r,s)}interpretAxisHeader(e){return e.xAxis.title?e.xAxis.title:e.xAxis.labelFormatMode==o.LabelFormatModes.DateTime_DayInMonth?i.HtmlTable_DateLabel:e.xAxis.labelFormatMode==o.LabelFormatModes.NumberSeconds_HourMinuteSeconds?i.HtmlTable_DurationLabel:i.HtmlTable_SampleLabel}interpretSeriesHeader(e,t){const a=e.series[t].name;return null!=a?a:(0,r.format)(i.HtmlTable_SeriesLabel,t)}interpretLabel(e,t){const r=e.xAxis,a=r.labelValues[t];if(null!=a&&r.labelFormatMode==o.LabelFormatModes.DateTime_DayInMonth){const r=new Date(e.xAxis.labelValues[t]);return this.formatShortDate(r)}return null!=a&&r.labelFormatMode==o.LabelFormatModes.NumberSeconds_HourMinuteSeconds?p.TimeSpanFormatter.convertToTimeFormat(e.xAxis.labelValues[t]):a}interpretXValue(e,t){if(null!=t&&e==o.LabelFormatModes.DateTime_DayInMonth){const e=new Date(t);return this.formatShortDate(e)}return null!=t&&e==o.LabelFormatModes.NumberSeconds_HourMinuteSeconds?p.TimeSpanFormatter.convertToTimeFormat(t):t}renderTable(e,t){return a.createElement("table",null,a.createElement("thead",null,a.createElement("tr",null,e)),a.createElement("tbody",null,t))}hasSparseTrendFormat(e){if(!e.xAxis||e.chartType!==o.ChartTypesConstants.Line||e.xAxis.labelFormatMode!==o.LabelFormatModes.DateTime_DayInMonth&&e.xAxis.labelFormatMode!==o.LabelFormatModes.NumberSeconds_HourMinuteSeconds)return!1;for(let t=0;t<e.series.length;t++)for(let r=0;r<e.series[t].data.length;r++){const a=e.series[t].data[r];if(Array.isArray(a)&&2===a.length)return!0}return!1}getValueTextForSparseTrendFormat(e,t,r){let a="";const n=e.series[t];for(let t=0;t<n.data.length;t++){const s=n.data[t];if(this.interpretXValue(e.xAxis.labelFormatMode,s[0])===r){a=void 0===s[1]?"":s[1];break}}return a}formatShortDate(e){return e.toLocaleDateString(navigator.language)}}}(),function(e){b=t.InternalAccessibilityUtilities={},t.InternalAccessibilityUtilities.translateAccessibilityOptions=function(e){const t={};return e.accessibility&&void 0!==e.accessibility.enabled&&(t.enabled=e.accessibility.enabled),e.xAxis&&e.xAxis.formatAccessibleLabelsUsingAxisCategories&&(t.point||(t.point={}),t.point.descriptionFormatter=(t=>{const a=e.xAxis.labelValues[t.index],n=a instanceof Date?a.toDateString():a,s=null!=t.index?(0,r.format)(i.A11yLabelPrefixFormat,t.index+1,n):n,o=e.series.length>1,l=Math.pow(10,2),c=Math.round(t.y*l)/l,u=e.yAxis&&e.yAxis.title?e.yAxis.title+" : "+c:c,p=o?(0,r.format)(i.A11yLabelPrefixFormat,c,t.series.name):u;return(0,r.format)(i.A11yLabelElementSeparatorFormat,s,p)})),t}}(),function(e){T=t.InternalCommonChartImplementation={};class r{constructor(){this._injectAxisNames=!1}getTabularComponent(e){return a.createElement(y.TabularComponent,e)}translateOptions(e){return this._chartOptions=e,this.translateOptionsImpl(e)}getColoringNames(e){return this.coloredBySeries()?e.series.map((e,t)=>e.name):e.xAxis&&e.xAxis.labelValues?e.xAxis.labelValues:[]}translateOptionsImpl(e){var t=new n(e.colorCustomizationOptions),r={chart:this.translateChartOptions(e),accessibility:(0,b.translateAccessibilityOptions)(e),title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},legend:this.translateLegendOptions(e,e.legend),xAxis:this.translateXAxisArrayOptions([e.xAxis]),yAxis:this.translateYAxisArrayOptions([e.yAxis,e.yAxisSecondary]),series:this.translateSeriesOptions(e,e.series,e.suppressAnimation,e.chartType,t),plotOptions:this.translatePlotOptions(e),tooltip:this.translateTooltipOptions(e.tooltip)};let a=null!=e.click?"pointer":void 0;return r.plotOptions.series={cursor:a,events:{click:e=>{this.onMouseClick(e)},legendItemClick:e=>this.onLegendClick(e)},enableMouseTracking:!e.tooltip||!1!==e.tooltip.enabled,point:{events:{click:e=>{"MouseEvent"!==e.constructor.name&&this.onKeyClick(e)}}},states:{inactive:{opacity:1}}},e.xAxis&&null!=e.xAxis.plotLines&&(r.chart.spacingTop=15),r}translateChartOptions(e){const t=[r.ChartRenderContainerClass];var a={animation:this.translateAnimationOptions(e.suppressAnimation),style:{fontFamily:r.LabelFonts}};if(!0===e.suppressMargin){const t=e.xAxis&&e.xAxis.retainAxisLine?r.DefaultAxisLineWidth:0,n=e.yAxis&&e.yAxis.retainAxisLine?r.DefaultAxisLineWidth:0;a.margin=[0,0,t,n]}e.legend&&e.legend.limitLabelSize&&t.push("limited-label-chart"),e.hostOptions&&(a.height=e.hostOptions.height,a.width=e.hostOptions.width);var n=this.getAxisZoomType(e);return void 0!==n&&(a.zoomType=n),a.backgroundColor="transparent",a.className=t.join(" "),a}translateAnimationOptions(e){return!0!==e&&{duration:200,easing:"easeOutBounce"}}hasLegendByDefault(){return!this.isOneDimensional()}translateLegendOptions(e,t){var a;a=null==t||null==t.enabled?this.hasLegendByDefault():t.enabled;var n=(0,l.isHighContrastMode)();const s=e.pageContext.getService("IVssThemeService"),i=s?s.getThemeValue("text-primary-color"):"#222222";var o;if(a){if(o={enabled:!0,useHTML:!1,layout:"horizontal",align:"left",alignColumns:!1,borderRadius:0,borderWidth:0,verticalAlign:"bottom",itemStyle:{fontFamily:r.LabelFonts,fontWeight:"normal",color:n?r.HighContrastLegendTextColor:i},itemHoverStyle:{color:n?r.HighContrastLegendTextHoverColor:i},labelFormatter:g.LegendLabelFormatter.getFormatter(),itemDistance:7,symbolWidth:12,symbolPadding:5,symbolRadius:0},t&&(t.rightAlign||t.stackVertically?(o.layout="vertical",o.align="right",o.verticalAlign="top"):"left"!==t.align&&"right"!==t.align&&"center"!==t.align||(o.align=t.align),t.limitLabelSize)){var c=o.itemStyle;c.textOverflow="ellipsis",c.overflow="hidden";var u=t.rightAlign?16:p.TruncationFormatter.MaxLabelLength;o.labelFormatter=g.LegendLabelFormatter.getFormatter(u)}}else o={enabled:!1};return o}translatePlotOptions(e){const t=!1!==this._chartOptions.interpolateNullValues;var r={series:{},area:{lineColor:e.specializedOptions&&e.specializedOptions.lineColor,trackByArea:!0,stacking:e.specializedOptions&&e.specializedOptions.disableStacking?void 0:"normal",lineWidth:e.specializedOptions&&e.specializedOptions.lineWidth||1,fillOpacity:1,marker:{enabled:e.specializedOptions&&!0===e.specializedOptions.includeMarkers||!1,symbol:"circle",radius:4,lineWidth:1,states:{hover:{radiusPlus:0,lineWidthPlus:0}}},connectNulls:t,fillColor:e.specializedOptions&&e.specializedOptions.gradientFill&&{linearGradient:e.specializedOptions.gradientFill.linearGradient,stops:this._generateStopsforAreaChart(e.specializedOptions.gradientFill.stops)}},line:{marker:{enabled:e.specializedOptions&&!0===e.specializedOptions.includeMarkers||!1,symbol:"circle",radius:4},connectNulls:t},bar:{stacking:"normal"},column:{stacking:"normal"},arearange:{marker:{enabled:!1}}};return e.chartType===o.ChartTypesConstants.Histogram&&(r.column.pointPadding=0,r.column.groupPadding=.01),r}_generateStopsforAreaChart(e){if(null!=e)return e.map(e=>[e.position,new s.Color(e.color).setOpacity(e.opacity).get("rgba").toString()])}translateSeriesOptions(e,t,r,a,n){var s=[];if(t)for(var i=0;i<t.length;i++)s[i]=this.translateSeriesOption(e,t[i],i,r,a,n);return s}mapSeriesType(e,t){return e}translateSeriesOption(e,t,r,a,n,s){var i={type:this.mapSeriesType(n,r)};i.name=u.encodeUntrustedString(t.name),t.stackGroup&&(i.stack=t.stackGroup);var o=s;if(this.coloredBySeries()){if(null==t.data)i.data=t.data;else{let e=[];t.data.forEach(t=>{"number"==typeof t?e.push(t):e.push(this.filterDatum(t))}),i.data=e}if(null==t.color){const e=o.getColor(r,t.name);i.color=u.encodeUntrustedString(e.background),i.dataLabels={color:e.foreground}}else i.color=u.encodeUntrustedString(t.color),i.dataLabels={color:d.ColorUtilities.selectForegroundColor(i.color)}}else{for(var l=[],c=t.data.length,p=0;p<c;p++){var h,m="";e.xAxis&&e.xAxis.labelValues&&(m=e.xAxis.labelValues[p]);const r=o.getColor(p,m);h="number"==typeof t.data[p]?{y:t.data[p],color:r.background,dataLabels:{color:r.foreground}}:Object.assign(Object.assign({dataLabels:{color:r.foreground}},{color:r.background}),t.data[p]),this._injectAxisNames&&(h.name=m),h=this.filterDatum(h),l.push(h)}i.data=l}return t.useSecondaryAxis&&(i.yAxis=1),t.markerType&&(i.marker={symbol:t.markerType}),t.markerRadius&&(null!=i.marker?i.marker.radius=t.markerRadius:i.marker={radius:t.markerRadius}),null!=t.enableTooltip&&(i.enableMouseTracking=t.enableTooltip),t.plotDashedStyle&&(i.dashStyle="ShortDash"),a&&(i.animation=!1),null!=t.customData&&(i.customData=t.customData),i}filterDatum(e){null!=e&&("object"==typeof e?Array.isArray(e)?e=e.map((e,t)=>"number"==typeof e?e:0):(e.name&&(e.name=u.encodeUntrustedString(e.name)),e.color&&(e.color=u.encodeUntrustedString(e.color)),"number"!=typeof e.y&&(e.y=0)):e={});return e}coloredBySeries(){return!this.isOneDimensional()}isOneDimensional(){return!1}mapDataPointsToTooltipLineItems(e){return e.map(e=>{let t={styleType:{color:e.color,type:1},text:""};var r=Number(e.values[0]).toLocaleString(navigator.language);return this.isOneDimensional()?t.text=r:t.text=`${e.seriesName} : ${r}`,t})}getTooltipHeaderValue(e){return e.point.category}interpretPointAsValuesForTooltip(e){return[e.y]}translateTooltipOptions(e){e=e||{};var t={};if(t.enabled=0!=e.enabled,t.enabled){t.shared=!0!==e.onlyShowFocusedSeries,t.backgroundColor=(0,l.isHighContrastMode)()?r.HighContrastTooltipBackgroundColor:"#FFF",t.borderColor="#ccc",t.useHTML=!0,t.outside=!0,t.style={fontFamily:r.LabelFonts};var a={reverseSeries:e.reverseSeries,isOneDimensional:this.isOneDimensional(),tooltipMapping:e.customTooltipMapping,tooltipHeader:e.customTooltipHeader},n=new C.TooltipFormatter(a);t.formatter=n.getFormatter(this)}return t}translateAxisArrayOptions(e){for(var t=[],r=0;r<e.length;r++)null==e[r]&&0!=r||t.push(this.translateAxisOptions(e[r]));return 2==t.length&&null!=t[1]&&(t[1].opposite=!0),t}translateXAxisArrayOptions(e){return this.translateAxisArrayOptions(e)}translateYAxisArrayOptions(e){var t=this.translateAxisArrayOptions(e),a=t[1];if(null!=a&&a.opposite&&a.title&&270===a.title.rotation){var n=Math.floor(2*r.DefaultAxisTitleFontSizePx/3);a.title.x=n}return t}translateAxisOptions(e){null==e&&(e={});var t={},a=(0,l.isHighContrastMode)(),n=a?r.HighContrastForeground:"#cccccc",s=a?r.HighContrastForeground:"#767676";if(t.reversedStacks=!1,null!=e.min&&(t.min=e.min),null!=e.max&&(t.max=e.max),null!=e.softMax&&(t.softMax=e.softMax),null!=e.startOnTick&&(t.startOnTick=e.startOnTick),null!=e.endOnTick&&(t.endOnTick=e.endOnTick),null!=e.enabled&&(t.visible=e.enabled),t.title={},null==e.title?t.title.text=null:(t.title.text=u.encodeUntrustedString(e.title),t.title.rotation=270,t.title.style={color:s,fontSize:r.DefaultAxisTitleFontSizePx+"px",fontFamily:r.LabelFonts}),t.labels={},!1===e.labelsEnabled?t.labels.enabled=!1:t.labels.style={color:s,fontSize:"12px",fontFamily:r.LabelFonts},!1===e.markingsEnabled?(t.minorTickLength=0,t.tickLength=0,t.lineColor=e.retainAxisLine?n:"transparent",t.lineWidth=e.retainAxisLine?r.DefaultAxisLineWidth:0):(t.lineWidth=r.DefaultAxisLineWidth,t.tickWidth=1,t.tickLength=6,t.tickColor=n,t.lineColor=n),e.gridLineOptions&&e.gridLineOptions.enabled||(t.gridLineWidth=0),e.gridLineOptions&&e.gridLineOptions.gridLineColor&&(t.gridLineColor=e.gridLineOptions.gridLineColor),t.showEmpty=!0,e.renderToEdges&&e.labelValues&&(t.min=.5,t.max=Math.max(1,e.labelValues.length-1.5)),e.labelFormatMode==o.LabelFormatModes.Linear)t.type="linear";else if(e.labelFormatMode==o.LabelFormatModes.Percentage)t.type="linear",t.labels.formatter=p.PercentageNumberFormatter.getFormatter();else if(e.labelFormatMode==o.LabelFormatModes.DateTime_DayInMonth){if(t.type="datetime",e.labelValues){for(var i=[],c=0;c<e.labelValues.length;c++){var d,m=e.labelValues[c];if(m.getDate)d=m;else{const e=m.substring(0,10).split("-");d=new Date(+e[0],+e[1]-1,+e[2])}i[c]=Date.UTC(d.getFullYear(),d.getMonth(),d.getDate())}t.tickPositioner=(new h.AxisTickPositioner).getPositioner(),t.categories=i}t.labels.rotation=0,t.tickmarkPlacement="on",t.labels.formatter=(new p.AxisMonthFormatter).getFormatter()}else e.labelFormatMode==o.LabelFormatModes.NumberSeconds_HourMinuteSeconds?t.labels.formatter=p.TimeSpanFormatter.getFormatter():e.labelValues?(t.categories=u.encodeUntrustedStringArray(e.labelValues),t.tickLength=0,t.labels.formatter=p.TruncationFormatter.getFormatter(e.suppressLabelTruncation)):t.labels.formatter=p.AbbreviatedNumberFormatter.getFormatter();return null!=e.allowDecimals&&(t.allowDecimals=e.allowDecimals),null!=e.plotLines&&(t.plotLines=this.translatePlotlines(e.plotLines)),null!=e.plotBands&&(t.plotBands=this.translatePlotBands(e.plotBands)),t}translatePlotBands(e){return e.map(e=>{return{color:e.color,from:e.start,to:e.end}})}translatePlotlines(e){return e.map(e=>{const t=e.lineColor||"#000000",r=e.labelColor||"#000000";return{color:t,label:{text:e.labelText,textAlign:"right",x:5,y:-5,rotation:0,style:{color:r}},value:e.axisPosition,width:2}})}onMouseClick(e){try{const t=e.point;let r;r=this.getChartOptions().xAxis&&this.getChartOptions().xAxis.labelFormatMode==o.LabelFormatModes.DateTime_DayInMonth?new Date(t.category):t.category;let a=t.series&&e.point.series.options&&t.series.options.customData?t.series.options.customData:null;const n={labelName:r,seriesName:null!=t.series?t.series.name:null,seriesCustomData:a,seriesDataIndex:t.index,itemX:t.x,itemY:t.y,itemZ:t.value,itemName:t.name,sourceChart:this,clientX:e.clientX,clientY:e.clientY,button:e.which,ctrlKey:e.ctrlKey};n.seriesName=u.decodeString(n.seriesName),n.labelName=u.decodeString(n.labelName),n.itemName=u.decodeString(n.itemName),this.notifyClick(n)}catch(e){console.error(e)}}onKeyClick(e){try{let r=e.target,a=r.series.index,n=this.getChartOptions().series[a];var t={sourceChart:this,itemX:r.x,labelName:void 0,itemName:void 0,clientX:void 0,clientY:void 0,button:void 0,ctrlKey:void 0};t.seriesName=n.name,t.seriesCustomData=n.customData,t.seriesDataIndex=r.index,t.itemY=r.y,t.seriesName=u.decodeString(t.seriesName),t.labelName=u.decodeString(t.labelName),t.itemName=u.decodeString(t.itemName),this.notifyClick(t)}catch(e){console.error(e)}}onLegendClick(e){try{let t=this.notifyLegendClick({});if(this.getChartOptions().yAxis&&this.getChartOptions().yAxis.updateMinOnLegendClick&&!1!==t){let t=e.target,r=t.index,a=t.chart.series.filter((e,t)=>t===r&&!e.visible||t!==r&&e.visible);if(a.length>0){let e=a[0].yData;t.yAxis.options.min=Math.min.apply(e,e)}}return t}catch(e){console.error(e)}}notifyClick(e){"function"==typeof this.getChartOptions().click&&this.getChartOptions().click(e)}notifyLegendClick(e){if("function"==typeof this.getChartOptions().legendClick)return this.getChartOptions().legendClick(e)}getChartOptions(){return this._chartOptions}getAxisZoomType(e){var t=e.xAxis&&!0===e.xAxis.canZoom?"x":void 0,r=e.yAxis&&!0===e.yAxis.canZoom?"y":void 0;return void 0!==t&&void 0!==r?"xy":void 0!==t?t:void 0!==r?r:void 0}}t.InternalCommonChartImplementation.CommonChartImplementation=r,r.LabelFonts="'Segoe UI', 'Helvetica Neue', Helvetica, Arial, Verdana",r.HighContrastForeground="WindowText",r.HighContrastLegendTextColor="ButtonText",r.HighContrastLegendTextHoverColor="ButtonHighlight",r.HighContrastTooltipBackgroundColor="Background",r.DefaultAxisTitleFontSizePx=12,r.DefaultAxisLineWidth=1,r.ChartRenderContainerClass="chart-render-container";class n{constructor(e){this.colorOptions=e||{},this.colorOptions.colorDictionary?this.dictionary=this.colorOptions.colorDictionary:this.dictionary=new m.DefaultColorDictionary(this.colorOptions.customColors)}isSubdued(){return 1==this.colorOptions.useSubduedPalette}getColor(e,t){return this.dictionary.getColorPair(t,e,this.isSubdued())}}}(),function(e){f=t.InternalChartTypesRegistry={};class a{constructor(){this._chartTypes=[]}static getInstance(){return null==a._instance&&(a._instance=new a),a._instance}getChartType(e){const t=this._chartTypes.findIndex(t=>(0,r.equals)(t.chartTypeName,e));return t>=0?this._chartTypes[t]:null}registerChartType(e){null==this.getChartType(e.chartTypeName)&&this._chartTypes.push(e)}instantiateType(e){const t=this.getChartType(e);if(null==t)throw Error("Unrecognized Chart Type");return new t.constructor}}t.InternalChartTypesRegistry.ChartTypesRegistry=a}(),function(e){t.Chart={};class o extends n.VssComponent{constructor(e,t){super(e,t),this.chart=null,this.state={chartContainer:null}}componentDidMount(){this.createChart()}componentDidUpdate(){this.props.updateOnChange?this.chart.update(this.getTranslatedOptions(),!0,!0):(this.deleteChart(),this.createChart())}componentWillUnmount(){this.deleteChart()}render(){const e=this.props.showAccessibleForm?"hidden":"layout-container chart-layout-container";return a.createElement("div",{className:"chart-component"},a.createElement("div",{className:e,ref:e=>{this.chartContainer=e}}),this.getTabularComponent())}createChart(){const e=this.getTranslatedOptions();this.chart=s.chart(this.chartContainer,e),this.chartContainer.setAttribute("aria-label",this.getAriaLabel())}deleteChart(){if(this.chart){try{this.chart.destroy()}catch(e){}this.chart=null}}getTranslatedOptions(){const e=this.props;return f.ChartTypesRegistry.getInstance().instantiateType(e.chartType).translateOptions(e)}getAriaLabel(){const e=this.props.title,t=f.ChartTypesRegistry.getInstance().getChartType(this.props.chartType).userFacingChartTypeName;return e?(0,r.format)(i.ChartEditor_AvailableScreenreader_Format,e,t):(0,r.format)(i.ChartEditor_AvailableScreenreader_NoTitle_Format,t)}getTabularComponent(){return f.ChartTypesRegistry.getInstance().instantiateType(this.props.chartType).getTabularComponent(this.props)}}t.Chart.Chart=o;t.Chart.PureChart=class extends o{shouldComponentUpdate(e){let t=!0;for(const r in e)if(this.props[r]!==e[r]){t=!1;break}if(t){const r=this.props,{pageContext:a}=r,n=__rest(r,["pageContext"]),{pageContext:s}=e,i=__rest(e,["pageContext"]);t=JSON.stringify(n)===JSON.stringify(i)}return!t}},n.Components.add("vss-chart",o)}(),function(e){t.InternalPieChartImplementation={};class r extends T.CommonChartImplementation{constructor(){super(),this._injectAxisNames=!0}isOneDimensional(){return!0}hasLegendByDefault(){return!0}getTooltipHeaderValue(e){return e.point.name}translateOptions(e){const t=super.translateOptions(e),r=this,a=e.specializedOptions;if(t.chart.events={load:function(e){r.onLoad(this,this.renderer,a)}},t.plotOptions.pie.dataLabels=t.plotOptions.pie.dataLabels||{},Array.isArray(t.plotOptions.pie.dataLabels))throw Error("Expected single dataLabels configuration, not an array");return t.plotOptions.pie.dataLabels.formatter=function(){if(this.percentage>2){const e=+this.y.toFixed(2);return(0,c.getFriendlyDisplayValue)(e)}return""},t}onLoad(e,t,r){if(r&&r.showLabels){let a=0;for(let t=0,r=e.series[0].yData.length;t<r;t++)a+=e.series[0].yData[t];let n=e.plotLeft+.5*e.plotWidth,s=e.plotTop+.5*e.plotHeight;if(r.center){const t=20;r.center[0]&&(n=e.plotLeft+r.center[0]+t),r.center[1]&&(s=e.plotTop+r.center[1]+t)}const i=(0,c.getFriendlyDisplayValue)(Math.round(a)),o=this.getfontSize(i.length),l=t.text(i,n,s).add(),u=this._chartOptions.pageContext.getService("IVssThemeService"),p=u?u.getThemeValue("text-primary-color"):"#222222";l.attr({class:"pie-chart-center-value",title:a}),l.css({"font-size":o,color:p});const h=l.getBBox();n-=.5*h.width,s+=.25*h.height,l.attr({x:n,y:s})}(null==r||r.showLabels)&&this.updateDataLabelDistance(e)}translatePlotOptions(e){const t=super.translatePlotOptions(e);t.pie={size:"100%",innerSize:"50%",dataLabels:{enabled:!(e.specializedOptions&&!e.specializedOptions.showLabels),style:{textOutline:!1,fontWeight:"normal"},formatter:function(){return(0,c.getFriendlyDisplayValue)(this.point.value)}},showInLegend:!0,states:{hover:{enabled:!1}},point:{events:{click:()=>!0,legendItemClick:e=>this.onLegendClick(e)}}};const r=e.specializedOptions;return r&&(r.innerSize&&(t.pie.innerSize=r.innerSize),r.size&&(t.pie.size=r.size),r.center&&(t.pie.center=r.center.map(e=>null!=e?e.toString():null))),t}translateTooltipOptions(e){const t=super.translateTooltipOptions(e);return null!=e&&null!=e.onlyShowFocusedSeries||(t.shared=!1),t}updateDataLabelDistance(e){const t=e.series[0].points[0].shapeArgs,r=(t.r-t.innerR)/2,a=e.series[0];a.options.dataLabels={distance:-r},a.update(a.options)}getfontSize(e){let t="36px";return e>6?t="24px":e>4&&(t="30px;"),t}}t.InternalPieChartImplementation.PieChartImplementation=r,f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Pie,constructor:r,userFacingChartTypeName:i.ChartType_A11yLabel_Pie})}(),function(e){t.InternalAxialChartImplementations={};class r extends T.CommonChartImplementation{}t.InternalAxialChartImplementations.AxialChartImplementation=r;f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Line,constructor:class extends r{},userFacingChartTypeName:i.ChartType_A11yLabel_Line});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Area,constructor:class extends r{isOneDimensional(){return!0}coloredBySeries(){return!0}},userFacingChartTypeName:i.ChartType_A11yLabel_Area});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.StackedArea,constructor:class extends r{mapSeriesType(e,t){return o.ChartTypesConstants.Area}translateSeriesOptions(e,t,r,a,n){const s=super.translateSeriesOptions(e,t,r,a,n);if(s)for(let e=0;e<s.length;e++)s[e].zIndex=s.length-e;return s}},userFacingChartTypeName:i.ChartType_A11yLabel_StackedArea});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Scatter,constructor:class extends r{translateSeriesOption(e,t,r,a,n,s){const i=super.translateSeriesOption(e,t,r,a,n,s);return i.stickyTracking=!1,i}},userFacingChartTypeName:i.ChartType_A11yLabel_Scatter});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.StackedBar,constructor:class extends r{mapSeriesType(e,t){return o.ChartTypesConstants.Bar}},userFacingChartTypeName:i.ChartType_A11yLabel_StackedBar});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Bar,constructor:class extends r{isOneDimensional(){return!0}},userFacingChartTypeName:i.ChartType_A11yLabel_Bar});class a extends r{isOneDimensional(){return!0}}f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Column,constructor:a,userFacingChartTypeName:i.ChartType_A11yLabel_Column});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.StackedColumn,constructor:class extends r{mapSeriesType(e,t){return o.ChartTypesConstants.Column}},userFacingChartTypeName:i.ChartType_A11yLabel_StackedColumn});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Histogram,constructor:class extends a{mapSeriesType(e,t){return o.ChartTypesConstants.Column}coloredBySeries(){return!0}},userFacingChartTypeName:i.ChartType_A11yLabel_Histogram});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.ColumnLine,constructor:class extends r{mapSeriesType(e,t){return 0==t?o.ChartTypesConstants.Column:o.ChartTypesConstants.Line}},userFacingChartTypeName:i.ChartType_A11yLabel_ColumnLine});f.ChartTypesRegistry.getInstance().registerChartType({chartTypeName:o.ChartTypesConstants.Hybrid,constructor:class extends T.CommonChartImplementation{translateOptions(e){const t=super.translateOptions(e),r=e.specializedOptions.chartTypes;if(t.series.length!==r.length)throw new Error("Hybrid chart Types list does not match series list.");return r.forEach(e=>{if(e===o.ChartTypesConstants.Bubble)throw new Error("Bubble chart cannot be combined with any other charts")}),super.translateOptions(e)}translateSeriesOption(e,t,r,a,n,s){const i=this.getChartTypes()[r];return f.ChartTypesRegistry.getInstance().instantiateType(i).translateSeriesOption(e,t,r,a,i,s)}getChartTypes(){return this._chartOptions.specializedOptions.chartTypes}},userFacingChartTypeName:i.ChartType_A11yLabel_Hybrid})}()},["Resources","Contracts","Internal/CompatUtilities","Internal/FriendlyNumberFormatter","Internal/StringUtilities","Internal/AxisLabelFormatter","Internal/AxisTickPositioner","Internal/ColorUtilities","Internal/DefaultColorDictionary","Internal/LegendLabelFormatter","Internal/InternalContracts","Internal/TooltipFormatter","Internal/TabularComponent","Internal/AccessibilityUtilities","Internal/CommonChartImplementation","Internal/ChartTypesRegistry","Chart","Internal/PieChartImplementation","Internal/AxialChartImplementations"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.vss-charts-common"}}));