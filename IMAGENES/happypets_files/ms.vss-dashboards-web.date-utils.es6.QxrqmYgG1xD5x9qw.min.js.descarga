"use strict";define("WidgetCommon/DateUtils",["require","exports"],function(e,t){!function(e){var n;function a(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function s(e,t){const n=t.valueOf()-e.getDay(),s=a(e,n);return s<e?a(s,7):s}function i(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}t.DateUtils={},function(e){e[e.Days=0]="Days",e[e.Weeks=1]="Weeks",e[e.Months=2]="Months"}(n=t.DateUtils.DateSampleInterval||(t.DateUtils.DateSampleInterval={})),t.DateUtils.addDays=a,t.DateUtils.addMonths=function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},t.DateUtils.daysBetweenDates=function(e,t,n=!1){return(e=new Date(e.getTime())).setHours(0,0,0,0),(t=new Date(t.getTime())).setHours(0,0,0,0),Math.round(Math.abs(t.getTime()-e.getTime())/864e5)+(n?0:1)},t.DateUtils.fetchTodayInAccountTimeZone=async function(e){const t=e.getService("IVssContributionService"),n=await t.getDataAsync("ms.vss-dashboards-web.collection-time-zone-data-provider");if(null==n){const e=["Failed to retrieve today in account time zone.",t.getDataProviderExceptions()["ms.vss-dashboards-web.collection-time-zone-data-provider"].message].join(" ");throw new Error(e)}return new Date(Date.now()+n.utcOffset).toISOString().substr(0,10)},t.DateUtils.getEndOfWeekDate=s,t.DateUtils.getStartOfMonth=function(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)},t.DateUtils.getEndOfMonth=i,t.DateUtils.shiftToUtc=function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())},t.DateUtils.getEndOfDateIntervalPeriod=function(e,t,a=5){switch(t){case n.Months:return i(e);case n.Weeks:return s(e,a);case n.Days:return e;default:throw new Error(`An unknown date Interval argument was recieved: ${t}`)}},t.DateUtils.parseIsoDateStringInLocalTime=function(e){const t=e.substring(0,10).split("-");return new Date(+t[0],+t[1]-1,+t[2])},t.DateUtils.toLocalDateIsoString=function(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substring(0,10)}}()},["DateUtils"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-dashboards-web.date-utils"}}));