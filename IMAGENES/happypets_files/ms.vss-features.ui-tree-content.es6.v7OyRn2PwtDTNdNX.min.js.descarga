"use strict";define("VSSUI",["require","exports","VSS/Core/Observable","react"],function(e,t,r,n){var s,i,o;!function(e){t.UtilitiesTreeItemProvider={};t.UtilitiesTreeItemProvider.TreeItemProvider=class{constructor(e=[]){this.itemMap=new Map;const t=[];this.rootItems=[...e],this.addItems(e,void 0,t),this.tableItems=new r.ObservableArray(t)}get length(){return this.tableItems.length}get roots(){return this.rootItems}get value(){return this.tableItems.value}subscribe(e,t){return this.tableItems.subscribe(e,t)}unsubscribe(e,t){return this.tableItems.unsubscribe(e,t)}add(e,t,r){return this.splice(t,void 0,[{insertAfter:r,items:[e]}])}clear(){this.tableItems.splice(0,this.tableItems.length),this.rootItems.splice(0,this.rootItems.length)}collapse(e){e.expanded&&this.toggle(e)}expand(e,t){let r=this.itemMap.get(e);if(!r)return;const n=[];do{r.underlyingItem.expanded||n.push(r),r=r.parentItem}while(t&&r);for(let e=n.length-1;e>=0;e--)this.toggle(n[e].underlyingItem)}remove(e,t){if(!t){let r=this.indexOf(e);if(-1===(r=this.indexOf(e)))return;const n=this.tableItems.value[r];t=n.parentItem&&n.parentItem.underlyingItem}return this.splice(t,[e])}splice(e,t,r){let n,s=!1,i=-1,o=this.rootItems;if(e){if(!(n=this.itemMap.get(e)))return;i=this.indexOf(e),o=n.underlyingItem.childItems||[]}if(t&&(t=t.slice(0)),r)for(let t=0;t<r.length;t++){const l=!e||i>=0&&e.expanded?[]:void 0,a=r[t];let c=i,d=0;if(a.insertAfter){if(-1===(d=o.indexOf(a.insertAfter)))continue;const e=this.indexOf(a.insertAfter,i+1);-1!==e&&(c=e+this.getTableChildCount(a.insertAfter))}else d--;this.addItems(a.items,n,l),o.splice(d+1,0,...a.items),n&&!n.underlyingItem.childItems&&(n.underlyingItem.childItems=o,s=!0),l&&(this.tableItems.splice(c+1,0,...l),s=!0)}if(t)for(let r=0;r<t.length;r++){const n=t[r],l=!e||e.expanded?[]:void 0;let a;if(-1===(a=o.indexOf(n)))continue;this.removeItem(n,l),o.splice(a,1),0===o.length&&e&&(delete e.childItems,s=!0);const c=this.indexOf(n,i+1);-1!==c&&l&&(this.tableItems.splice(c,l.length),s=!0)}s&&n&&-1!==i&&this.tableItems.change(i,n)}toggle(e){const t=this.indexOf(e);if(t>=0&&(e.expanded=!e.expanded,e.childItems)){const r=[];for(let t=0;t<e.childItems.length;t++)this.getTableItems(e.childItems[t],r);e.expanded?this.tableItems.splice(t+1,0,...r):this.tableItems.splice(t+1,r.length)}}addItems(e,t,r){for(let n=0;n<e.length;n++){const s=e[n],i={depth:t?t.depth+1:0,parentItem:t,underlyingItem:s};this.itemMap.set(s,i),r&&r.push(i),s.childItems&&this.addItems(s.childItems,i,s.expanded?r:void 0)}}getTableItems(e,t){const r=this.itemMap.get(e);if(r&&(t.push(r),e.childItems&&e.expanded))for(const r of e.childItems)this.getTableItems(r,t)}getTableChildCount(e){let t=0;if(e.childItems&&e.expanded)for(let r=0;r<e.childItems.length;r++)t+=this.getTableChildCount(e.childItems[r])+1;return t}indexOf(e,t=0){for(let r=t;r<this.tableItems.length;r++)if(e===this.tableItems.value[r].underlyingItem)return r;return-1}removeItem(e,t){if(this.itemMap.delete(e),t&&t.push(e),e.childItems)for(let r=0;r<e.childItems.length;r++)this.removeItem(e.childItems[r],e.expanded?t:void 0)}}}(),function(e){s=t.ComponentsTreeExTreeExpand={};const r={iconName:"ChevronRightMed"},i={iconName:"ChevronDownMed"};t.ComponentsTreeExTreeExpand.TreeExpand=class extends n.Component{constructor(){super(...arguments),this.onClick=(e=>{var t,r;e.defaultPrevented||1!==e.buttons&&0!==e.buttons||this.props.onToggle&&(this.props.onToggle(e),e.preventDefault()),null===(r=(t=this.props).onClick)||void 0===r||r.call(t,e)})}render(){const{children:e,className:s,depth:o,expanded:l,iconCollapsedProps:a=r,iconExpandedProps:c=i,indentationSize:d=16}=this.props,p=l?c:a;return n.createElement(n.Fragment,null,n.createElement(t.Icon.Icon,Object.assign({},p,{className:(0,t.Util.css)(s,"bolt-tree-expand-button font-size cursor-pointer",!this.props.onToggle&&"invisible"),onClick:this.onClick,role:"presentation",size:"small",style:{marginLeft:o>0?o*d+"px":void 0}})),e)}}}(),function(e){i=t.ComponentsTreeExTree={};t.ComponentsTreeExTree.Tree=class extends n.Component{constructor(){super(...arguments),this.table=n.createRef(),this.onActivateExpand=((e,t)=>{!e.defaultPrevented&&t.data.underlyingItem.childItems&&(this.props.onToggle&&this.props.onToggle(e,t.data),e.preventDefault())}),this.renderRow=((e,r,i)=>(i.singleClickActivation=this.props.onActivate&&i.singleClickActivation,this.props.columns.length<=1&&!i.role&&(i.role="treeitem"),n.createElement(t.Observer.UncheckedObserver,{data:r.underlyingItem.data},a=>{if(a.data){r.onToggle=r.underlyingItem.childItems?this.props.onToggle:void 0;const t=r.underlyingItem.data.renderRow||this.props.renderRow;return t?t(e,r,i):l(e,r,i,this.props.columns,a.data)}{const{renderLoadingRow:r}=this.props;return r?r(e,i):n.createElement(o,{index:e,details:i},this.props.columns.map((e,r)=>{let o=(0,t.Table.renderLoadingCell)(e.columnLayout);return e.hierarchical&&(o=n.createElement(s.TreeExpand,{depth:i.data.depth},o)),(0,t.Table.SimpleTableCell)({className:"bolt-tree-cell",columnIndex:r,children:o})}))}})))}render(){const{role:e=(this.props.columns.length>1?"treegrid":"tree")}=this.props,r=this.props.onActivate?this.props.onActivate:this.props.onToggle?this.onActivateExpand:void 0;return n.createElement(t.Table.Table,{ariaLabel:this.props.ariaLabel,behaviors:this.props.behaviors,className:this.props.className,columns:this.props.columns,containerClassName:this.props.containerClassName,eventDispatch:this.props.eventDispatch,focuszoneProps:this.props.focuszoneProps,id:this.props.id,itemProvider:this.props.itemProvider,maxHeight:this.props.maxHeight,onActivate:r,onFocus:this.props.onFocus,onSelect:this.props.onSelect,pageSize:this.props.pageSize,renderHeader:this.props.renderHeader,renderRow:this.renderRow,renderSpacer:this.props.renderSpacer,role:e,rowHeight:this.props.rowHeight,ref:this.table,scrollable:this.props.scrollable,selectableText:this.props.selectableText,selection:this.props.selection,singleClickActivation:this.props.singleClickActivation,showHeader:this.props.showHeader,showLines:this.props.showLines,showScroll:this.props.showScroll,tableBreakpoints:this.props.tableBreakpoints,virtualize:this.props.virtualize})}addOverlay(e,t,r,n=0){if(this.table.current)return this.table.current.addOverlay(e,t,r,n)}removeOverlay(e){if(this.table.current)return this.table.current.removeOverlay(e)}focusRow(e,t=1){return this.table.current?this.table.current.focusRow(e,t):Promise.resolve()}getFocusIndex(){return this.table.current?this.table.current.getFocusIndex():-1}getStats(){return this.table.current?this.table.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}}scrollIntoView(e,t){if(this.table.current)return this.table.current.scrollIntoView(e,t)}};class o extends n.Component{constructor(){super(...arguments),this.rowElement=n.createRef(),this.onFocus=(e=>{this.props.details.onFocusItem(this.props.index,e)}),this.onKeyDown=(e=>{if(!e.defaultPrevented&&this.rowElement.current===e.nativeEvent.srcElement){const{data:t}=this.props.details;if(t&&t.onToggle){const{expanded:r}=t.underlyingItem;(39===e.which&&!r||37===e.which&&r)&&(t.onToggle(e,t),e.preventDefault())}}}),this.onPostprocessKeyStroke=(e=>(e.defaultPrevented||37===e.which&&(this.rowElement.current.focus(),e.preventDefault()),1))}render(){const{details:e,index:r,linkProps:s}=this.props,{ariaRowOffset:i,data:o,excludeFocusZone:l,renderSpacer:a,selectableText:c,selection:d,singleClickActivation:p}=e,h=s?"a":"tr",m=(0,t.Link.getDefaultAnchorProps)(s);return n.createElement(t.FocusWithin.FocusWithin,{onFocus:this.onFocus},u=>n.createElement(t.FocusZone.FocusZoneContext.Consumer,null,g=>{var b;return n.createElement(t.FocusZone.FocusZone,{direction:1,postprocessKeyStroke:this.onPostprocessKeyStroke},n.createElement(h,Object.assign({},m,{"aria-busy":void 0===o,"aria-expanded":o&&o.underlyingItem.childItems?void 0!==o.underlyingItem.expanded&&o.underlyingItem.expanded:void 0,"aria-level":o?o.depth+1:void 0,"aria-rowindex":r+i,"aria-selected":!(!d||!d.selected(r))||void 0,className:(0,t.Util.css)(this.props.className,"bolt-tree-row bolt-table-row bolt-list-row",0===r&&"first-row",u.hasFocus&&"focused",d&&d.selected(r)&&"selected",p&&"single-click-activation",c&&"selectable-text",s&&"v-align-middle"),"data-focuszone":l||d&&!d.selectable(r)?void 0:g.focuszoneId,"data-row-index":r,id:(0,t.Util.getSafeId)(null!==(b=e.data.underlyingItem.id)&&void 0!==b?b:r.toString()),onBlur:u.onBlur,onFocus:u.onFocus,onKeyDown:this.onKeyDown,ref:this.rowElement,role:e.role||"row",tabIndex:(0,t.UtilitiesFocus.getTabIndex)(e)}),n.createElement("td",{key:"left-spacer",className:"bolt-table-cell-compact bolt-table-cell bolt-list-cell",role:"presentation"},a&&a(r,!0)),this.props.children,n.createElement("td",{key:"right-spacer",className:"bolt-table-cell-compact bolt-table-cell bolt-list-cell",role:"presentation"},a&&a(r,!1))))}))}}function l(e,r,s,i,l,a){return n.createElement(o,{index:e,details:s,linkProps:l?l.linkProps:void 0,className:a},(0,t.Table.renderColumns)(e,i,r,s))}function a(e){const{colspan:r,columnIndex:i,contentClassName:o,treeItem:l,treeColumn:a}=e,{depth:c,onToggle:d,underlyingItem:p}=l,{expanded:h}=p,m=n.createElement(s.TreeExpand,{expanded:h,depth:c,indentationSize:a&&a.indentationSize,onClick:t.Util.preventDefault,onToggle:d?e=>d(e,l):void 0},e.children);return(0,t.Table.SimpleTableCell)({children:m,className:(0,t.Util.css)(e.className,"bolt-tree-cell"),colspan:r,columnIndex:i,contentClassName:o,tableColumn:a})}t.ComponentsTreeExTree.TreeRow=o,t.ComponentsTreeExTree.renderTreeRow=l,t.ComponentsTreeExTree.ExpandableTreeCell=a,t.ComponentsTreeExTree.renderExpandableTreeCell=function(e,n,s,i){const{underlyingItem:o}=i,l=r.ObservableLike.getValue(o.data),c=l&&l[s.id],d=!(!c||"string"==typeof c||"number"==typeof c||!c.href);return a({children:c&&(0,t.List.renderListCell)(c),className:s.className,columnIndex:n,contentClassName:d?"bolt-table-cell-content-with-link":void 0,treeItem:i,treeColumn:s})},t.ComponentsTreeExTree.renderTreeCell=function(e,n,s,i){const{underlyingItem:o}=i,l=r.ObservableLike.getValue(o.data),a=l&&l[s.id],c=!(!a||"string"==typeof a||"number"==typeof a||!a.href);return(0,t.Table.SimpleTableCell)({className:s.className,children:a&&(0,t.List.renderListCell)(a),columnIndex:n,contentClassName:c?"bolt-table-cell-content-with-link":void 0,tableColumn:s})},t.ComponentsTreeExTree.renderTreeCellWithClassName=function(e,n,s,i,o){const{underlyingItem:l}=i,a=r.ObservableLike.getValue(l.data),c=a&&a[s.id],d=!(!c||"string"==typeof c||"number"==typeof c||!c.href);return(0,t.Table.SimpleTableCell)({className:s.className,children:c&&(0,t.List.renderListCell)(c),columnIndex:n,contentClassName:(0,t.Util.css)(o,d?"bolt-table-cell-content-with-link":void 0),tableColumn:s})}}(),function(e){o=t.ComponentsTreeExFixedHeightTree={};t.ComponentsTreeExFixedHeightTree.FixedHeightTree=class extends n.Component{constructor(){super(...arguments),this.list=n.createRef(),this.onActivateExpand=((e,t)=>{!e.defaultPrevented&&t.data.underlyingItem.childItems&&(this.props.onToggle&&this.props.onToggle(e,t.data),e.preventDefault())}),this.renderRow=((e,r,s)=>{if(!this.props.renderRow||!s.data)return n.createElement("div",null);const i={ariaRowOffset:s.ariaRowOffset,eventDispatch:s.eventDispatch,data:s.data,itemProvider:this.props.itemProvider,listProps:s.listProps,onFocusItem:s.onFocusItem};return n.createElement(t.Observer.UncheckedObserver,{data:r.underlyingItem.data},t=>{if(t.data)return r.onToggle=r.underlyingItem.childItems?this.props.onToggle:void 0,(r.underlyingItem.data.renderRow||this.props.renderRow)(e,r,i);{const{renderLoadingRow:t}=this.props;return t?t(e,i):n.createElement("div",{className:"bolt-list-row-loading"},n.createElement("div",{className:"shimmer shimmer-line",style:{width:80*Math.random()+20+"%"}}," "))}})})}render(){const{role:e="tree"}=this.props;return n.createElement(t.List.FixedHeightList,{className:this.props.className,eventDispatch:this.props.eventDispatch,focuszoneProps:this.props.focuszoneProps,id:this.props.id,itemProvider:this.props.itemProvider,maxHeight:this.props.maxHeight,onActivate:this.onActivateExpand,onFocus:this.props.onFocus,onSelect:this.props.onSelect,pageSize:this.props.pageSize,renderRow:this.renderRow,role:e,rowHeight:this.props.rowHeight,ref:this.list,selection:this.props.selection,singleClickActivation:this.props.singleClickActivation||!0,width:this.props.width||"100%"})}getFocusIndex(){return this.list.current?this.list.current.getFocusIndex():-1}getStats(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,lastMaterialized:-1}}scrollIntoView(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)}}}(),t.TreeEx={},Object.defineProperty(t.TreeEx,"FixedHeightTree",{enumerable:!0,get:function(){return o.FixedHeightTree}}),Object.defineProperty(t.TreeEx,"ExpandableTreeCell",{enumerable:!0,get:function(){return i.ExpandableTreeCell}}),Object.defineProperty(t.TreeEx,"renderExpandableTreeCell",{enumerable:!0,get:function(){return i.renderExpandableTreeCell}}),Object.defineProperty(t.TreeEx,"renderTreeCell",{enumerable:!0,get:function(){return i.renderTreeCell}}),Object.defineProperty(t.TreeEx,"renderTreeCellWithClassName",{enumerable:!0,get:function(){return i.renderTreeCellWithClassName}}),Object.defineProperty(t.TreeEx,"renderTreeRow",{enumerable:!0,get:function(){return i.renderTreeRow}}),Object.defineProperty(t.TreeEx,"Tree",{enumerable:!0,get:function(){return i.Tree}}),Object.defineProperty(t.TreeEx,"TreeRow",{enumerable:!0,get:function(){return i.TreeRow}}),Object.defineProperty(t.TreeEx,"TreeExpand",{enumerable:!0,get:function(){return s.TreeExpand}})},["Utilities/TreeItemProvider","Components/TreeEx/TreeExpand","Components/TreeEx/Tree","Components/TreeEx/FixedHeightTree","TreeEx"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-tree-content"}}));