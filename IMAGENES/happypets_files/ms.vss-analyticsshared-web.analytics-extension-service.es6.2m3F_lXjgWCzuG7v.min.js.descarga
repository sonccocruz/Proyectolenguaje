"use strict";define("Analytics/Shared/ExtensionService",["require","exports","VSS/Platform/Context","VSS/Platform/RestClientBase"],function(e,n,t,s){!function(e){n.AnalyticsExtensionService={};class s extends t.VssService{async isAnalyticsEnabled(){if(this.pageContext.getService("IVssPageService").getData().isHosted)return!0;{const e=this.pageContext.getRestClient("IAnalyticsRestClient"),n=(await e.getState()).analyticsState;return 4===n||1===n}}}n.AnalyticsExtensionService.AnalyticsExtensionStateService=s,t.Services.add("IAnalyticsExtensionStateService",{serviceFactory:s})}(),function(e){n[e]={};n[e].ExtensionManagementClientName="ExtensionManagementServiceForAnalytics.IExtensionManagementRestClient",n[e].getExtensionManagementClient=function(t,s){return t.getRestClient(n[e].ExtensionManagementClientName,s)},t.RestClients.add(n[e].ExtensionManagementClientName,{factory:class extends s.RestClientBase{constructor(e){super(e)}async getAcquisitionOptions(e,n,t,s,i,a,o){const r={itemId:e,testCommerce:n,isFreeOrTrialInstall:t,isAccountOwner:s,isLinked:i,isConnectedServer:a,isBuyOperationValid:o};return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/AcquisitionOptions",queryParams:r})}async requestAcquisition(e){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/AcquisitionRequests",body:e})}async registerAuthorization(e,n,t){return this.beginRequest({apiVersion:"3.2-preview.1",method:"PUT",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Authorizations/{registrationId}",routeValues:{publisherName:e,extensionName:n,registrationId:t}})}async createDocumentByName(e,n,t,s,i,a){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:n,extensionName:t,scopeType:s,scopeValue:i,collectionName:a},body:e})}async deleteDocumentByName(e,n,t,s,i,a){return this.beginRequest({apiVersion:"3.2-preview.1",method:"DELETE",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:e,extensionName:n,scopeType:t,scopeValue:s,collectionName:i,documentId:a}})}async getDocumentByName(e,n,t,s,i,a){return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:e,extensionName:n,scopeType:t,scopeValue:s,collectionName:i,documentId:a}})}async getDocumentsByName(e,n,t,s,i){return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:e,extensionName:n,scopeType:t,scopeValue:s,collectionName:i}})}async setDocumentByName(e,n,t,s,i,a){return this.beginRequest({apiVersion:"3.2-preview.1",method:"PUT",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:n,extensionName:t,scopeType:s,scopeValue:i,collectionName:a},body:e})}async updateDocumentByName(e,n,t,s,i,a){return this.beginRequest({apiVersion:"3.2-preview.1",method:"PATCH",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/Data/Scopes/{scopeType}/{scopeValue}/Collections/{collectionName}/Documents/{documentId}",routeValues:{publisherName:n,extensionName:t,scopeType:s,scopeValue:i,collectionName:a},body:e})}async queryCollectionsByName(e,n,t){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{publisherName}/{extensionName}/ExtensionDataCollectionQuery",routeValues:{publisherName:n,extensionName:t},body:e})}async getStates(e,n,t,s){const i={includeDisabled:e,includeErrors:n,includeInstallationIssues:t,forceRefresh:s};return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/ExtensionStates",queryParams:i})}async queryExtensions(e){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/InstalledExtensionQuery",body:e})}async getInstalledExtensions(e,n,t,s){const i={includeDisabledExtensions:e,includeErrors:n,assetTypes:t&&t.join(":"),includeInstallationIssues:s};return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{extensionId}",queryParams:i})}async updateInstalledExtension(e){return this.beginRequest({apiVersion:"3.2-preview.1",method:"PATCH",routeTemplate:"_apis/ExtensionManagement/InstalledExtensions/{extensionId}",body:e})}async getInstalledExtensionByName(e,n,t){const s={assetTypes:t&&t.join(":")};return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/InstalledExtensionsByName/{publisherName}/{extensionName}/{version}",routeValues:{publisherName:e,extensionName:n},queryParams:s})}async installExtensionByName(e,n,t){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/InstalledExtensionsByName/{publisherName}/{extensionName}/{version}",routeValues:{publisherName:e,extensionName:n,version:t}})}async uninstallExtensionByName(e,n,t,s){const i={reason:t,reasonCode:s};return this.beginRequest({apiVersion:"3.2-preview.1",method:"DELETE",routeTemplate:"_apis/ExtensionManagement/InstalledExtensionsByName/{publisherName}/{extensionName}/{version}",routeValues:{publisherName:e,extensionName:n},queryParams:i})}async getPolicies(e){return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/Policies/{userId}",routeValues:{userId:e}})}async resolveRequest(e,n,t,s,i){const a={state:i};return this.beginRequest({apiVersion:"3.2-preview.1",method:"PATCH",routeTemplate:"_apis/ExtensionManagement/RequestedExtensions/{publisherName}/{extensionName}/requests/{requesterId}",routeValues:{publisherName:n,extensionName:t,requesterId:s},queryParams:a,body:e})}async getRequests(){return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/RequestedExtensions"})}async resolveAllRequests(e,n,t,s){const i={state:s};return this.beginRequest({apiVersion:"3.2-preview.1",method:"PATCH",routeTemplate:"_apis/ExtensionManagement/RequestedExtensions/{publisherName}/{extensionName}",routeValues:{publisherName:n,extensionName:t},queryParams:i,body:e})}async deleteRequest(e,n){return this.beginRequest({apiVersion:"3.2-preview.1",method:"DELETE",routeTemplate:"_apis/ExtensionManagement/RequestedExtensions/{publisherName}/{extensionName}/requests/me",routeValues:{publisherName:e,extensionName:n}})}async requestExtension(e,n,t){return this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/ExtensionManagement/RequestedExtensions/{publisherName}/{extensionName}/requests/me",routeValues:{publisherName:e,extensionName:n},body:t})}async getToken(){return this.beginRequest({apiVersion:"3.2-preview.1",routeTemplate:"_apis/ExtensionManagement/Token"})}},options:{resourceAreaId:"6c2b0933-3600-42ae-bf8b-93d4f7e83594",serviceInstanceType:"00000028-0000-8888-8000-000000000000"}})}("RestClientExtensionManagement")},["AnalyticsExtensionService","RestClient/ExtensionManagement"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-analyticsshared-web.analytics-extension-service"}}));