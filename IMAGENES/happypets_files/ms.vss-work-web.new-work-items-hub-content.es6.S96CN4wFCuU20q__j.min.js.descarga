"use strict";define("WorkItemsHub",["require","exports","VSS/Reflux/Action","VSS/Platform/Trace","VSSUI/TooltipEx","react","VSS/Core/Util/String","VSS/Platform/Location","Wit/Common/Utilities/TempQueryUtils","VSSUI/Link","Wit/UI/WorkItemTypeIcon","OfficeFabric/DetailsList","Wit/Common/Generated/Constants","Wit/UI/TagsList","Wit/Identity/Utilities/WorkItemIdentityHelper","Wit/Filter/Utilities/Utilities","Wit/UI/WorkItemState","Wit/UI/IdentityView","Wit/Filter/AreaPathHelper","Wit/Filter/FilterStateManager","Wit/Common/Utilities/Array","VSS/Legacy/Legacy","Wit/Clients/Wit/RestClient/WorkItemTracking","Wit/Common/Utilities/Core","react-dom","VSS/Core/Util/Accessibility","VSS/Core/Util/Promise","VSSUI/Callout","VSSUI/ContextualMenuButton","VSS/Platform/Feature","VSS/Reflux/Store","Wit/Filter/FilterValueProviders","Wit/Filter/WorkItemFilter","Wit/Filter/AssignedToFilterProvider","Wit/Filter/FieldFilterProvider","Wit/Filter/AreaPathFilterProvider","Wit/Filter/FilterManager","Wit/Filter/TagsFilterProvider","Wit/Filter/TextFilterProvider","VSS/Platform/FPS","VSSUI/Util","VSS/Platform/Layout","VSS/Features/Frame/ContributedPivotBarItemProvider","VSSUI/Hub","VSSUI/HubHeader","VSSUI/Utilities/HubViewState","VSSUI/ZeroData","VSS/Core/Observable","VSSUI/Utilities/ViewOptions","VSSUI/Navigation/VssHubViewState","OfficeFabric/Selection","VSS/Core/TimerManagement","VSSUI/Components/VssDetailsList/VssDetailsList","VSSUI/Spinner","VSSUI/Utilities/Filter"],function(e,t,o,i,s,r,a,n,l,c,m,d,u,p,h,g,I,b,C,_,k,y,T,f,S,w,D,W,v,F,R,P,H,A,N,x,M,O,U,E,V,L,B,Z,G,j,K,q,Q,z,$,Y,X,J,ee){var te,oe,ie,se,re,ae,ne,le,ce,me,de,ue,pe,he,ge,Ie,be,Ce,_e,ke,ye,Te,fe,Se,we,De,We,ve,Fe,Re,Pe,He,Ae,Ne,xe,Me,Oe,Ue,Ee,Ve,Le,Be,Ze,Ge,je,Ke,qe,Qe;te=t.Resources={},t.Resources.UnableToLoadHubData="Unable to load data for this tab",t.Resources.WorkItemsHubTitle="Work items",t.Resources.WorkItemUnassigned="Unassigned",t.Resources.OpenInQueriesCommand="Open in Queries",t.Resources.CheckButtonLabel="Select the row",t.Resources.OpenSelectionInQueriesCommand="Open selected items in Queries",t.Resources.OpenFilteredInQueriesCommand="Open filtered view in Queries",t.Resources.KeyboardShortcutGroup_Work="Work",t.Resources.KeyboardShortcutGroup_WorkItems="Work Items",t.Resources.KeyboardShortcutDescription_ToggleFullScreen="Toggle full screen mode",t.Resources.CompletedItemsViewOptionName="Completed Work Items",t.Resources.CompletedItemsHidden="Hidden",t.Resources.CompletedItemsShown="Shown",t.Resources.SortAscendingText="Ascending",t.Resources.SortByLabel="Sort by",t.Resources.SortDescendingText="Descending",t.Resources.BackToWorkItems="Back to Work Items",t.Resources.TriageNextWorkItemTooltip='Next work item in the "{0}" tab (Alt + N)',t.Resources.TriagePreviousWorkItemTooltip='Previous work item in the "{0}" tab (Alt + P)',t.Resources.TriageBackToTabTooltip='Back to "{0}" tab (Alt + Q)',t.Resources.KeyboardShortcutDescription_BackToWorkItemsHub="Back to Work Items",t.Resources.CompletedWorkItemsOffText="Completed work items hidden",t.Resources.CompletedWorkItemsOnText="Completed work items shown",t.Resources.CompletedWorkItemsToggleLabel="{0}. Press to toggle the completed work items option.",t.Resources.FilterChangedAnnouncementFormat="Filter has changed: {0}",t.Resources.WorkItemsHubGridLandmarkLabel="Work Items Hub grid",t.Resources.ColumnOptions="Column Options",t.Resources.ActivityDateColumnDisplayName="Activity Date",t.Resources.MentionedDateColumnDisplayName="Mentioned Date",t.Resources.MyActivityDetailsColumnDisplayName="Activity Details",t.Resources.MyActivityDetailsUpdated="Updated",t.Resources.MyActivityDetailsViewed="Viewed",t.Resources.WorkItemsHubTruncatedCommentCount="{0}+",t.Resources.WorkItemsHubComments="Comments",t.Resources.CopySelectedWorkitemsOpenAsQuery="Open as query",t.Resources.CommandBarTitle_CopyWorkItems="(Ctrl+C)",t.Resources.CommandBarTitle_DeleteWorkItems="(Del)",t.Resources.CopiedContentDialogTitle="Copied!",t.Resources.EmailSelectedWorkItems="Email...",t.Resources.DeleteSelectedWorkItems="Delete",t.Resources.RecycleBin="Recycle Bin",t.Resources.ImportWorkItems="Import Work Items",t.Resources.CopyToClipboard="Copy to clipboard",t.Resources.Loading="Loading...",t.Resources.NewWorkItemButtonText="New Work Item",t.Resources.FilterByKeyword="Filter by keyword",t.Resources.FilterByTypes="Types",t.Resources.FilterNoTypes="No types available",t.Resources.FilterByStates="States",t.Resources.FilterNoStates="No states available",t.Resources.FilterByTags="Tags",t.Resources.FilterNoTags="No tags available",t.Resources.FilterByAreaPath="Area",t.Resources.FilterNoArea="No areas available",t.Resources.FilterByAssignedTo="Assigned to",t.Resources.FilterResults="Filter results",t.Resources.SelectAllAriaLabel="Select all work items",t.Resources.SingleWorkItemFiltered="{0} work item found",t.Resources.MultipleWorkItemsFiltered="{0} work items found",t.Resources.Illustrations_GetBackToRecentWorkAltText="Get back to your recent work",t.Resources.Illustrations_KeepAnEyeOnImportantWorkAltText="Keep an eye on important work",t.Resources.Illustrations_MentionSomeoneAltText="Mention someone",t.Resources.Illustrations_SomethingWrongOnServerAltText="Server error",t.Resources.Illustrations_YourWorkInOnePlaceAltText="Your work, all in one place",t.Resources.ZeroData_SecondaryMessageLinkText="Learn more about work items",t.Resources.ZeroData_AssignedToMe_PrimaryMessage="Your work, all in one place",t.Resources.ZeroData_AssignedToMe_SecondaryMessage="Quickly take action on work items assigned to you.",t.Resources.ZeroData_AssignedToMe_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t.Resources.ZeroData_Filter_WorkItems_ArtifactName="work items",t.Resources.ZeroData_Following_NotConfigured_PrimaryMessage="Feature not supported",t.Resources.ZeroData_Following_NotConfigured_SecondaryMessage="Enable this feature to keep an eye on important work.",t.Resources.ZeroData_Following_NotConfigured_SecondaryMessageLinkText="Learn more about how to enable following",t.Resources.ZeroData_Following_NotConfigured_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010112",t.Resources.ZeroData_Following_PrimaryMessage="Keep an eye on important work",t.Resources.ZeroData_Following_SecondaryMessageFormat="Click {0} to get updates about the items you want to track.",t.Resources.ZeroData_Following_SecondaryMessageLinkText="Learn more about following",t.Resources.ZeroData_Following_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010009",t.Resources.ZeroData_Mentioned_PrimaryMessage="Don't miss important work",t.Resources.ZeroData_Mentioned_SecondaryMessage="Quickly take action on items where you have been @mentioned.",t.Resources.ZeroData_Mentioned_SecondaryMessageLinkText="Learn more about @mentions",t.Resources.ZeroData_Mentioned_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=852411",t.Resources.ZeroData_MyActivity_PrimaryMessage="Get back to your recent work",t.Resources.ZeroData_MyActivity_SecondaryMessage="Find work items you have recently opened or edited.",t.Resources.ZeroData_MyActivity_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t.Resources.ZeroData_RecentlyUpdated_PrimaryMessage="Find recently updated items",t.Resources.ZeroData_RecentlyUpdated_SecondaryMessage="View items that have been recently updated.",t.Resources.ZeroData_RecentlyUpdated_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t.Resources.ZeroData_RecentlyCreated_PrimaryMessage="Find recently created items",t.Resources.ZeroData_RecentlyCreated_SecondaryMessage="View items that are being created for this project.",t.Resources.ZeroData_RecentlyCreated_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t.Resources.ZeroData_ServerError_PrimaryText="Server error",t.Resources.ZeroData_RecentlyCompleted_PrimaryMessage="Find recently completed items",t.Resources.ZeroData_RecentlyCompleted_SecondaryMessage="View items that are being completed for this project.",t.Resources.ZeroData_RecentlyCompleted_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t.Resources.ZeroData_MyTeams_PrimaryMessage="Find what my team is working on",t.Resources.ZeroData_MyTeams_SecondaryMessage="View items from your team(s) that have been recently updated.",t.Resources.ZeroData_MyTeams_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t.Resources.ZeroData_MyTeams_NotConfigured_PrimaryMessage="Feature not supported",t.Resources.ZeroData_MyTeams_NotConfigured_SecondaryMessage="You need to be a member of a team to find what your team is working on.",t.Resources.GenericFilterZeroData_Message="No {0} match your filter",t.DataContractsIActionsDataContract={},function(e){oe=t.ActionsActionsHub={};t.ActionsActionsHub.ActionsHub=class{constructor(){this.endRefreshDataProvider=new o.Action,this.invalidateAllTabsData=new o.Action,this.removeWorkItems=new o.Action,this.invalidateTabData=new o.Action,this.updateFilter=new o.Action,this.setCompletedItemsVisibility=new o.Action,this.sortItems=new o.Action,this.endPageWorkItems=new o.Action}}}(),ie=t.GeneratedConstants={},(t.GeneratedConstants.MentionedTabDataProvider||(t.GeneratedConstants.MentionedTabDataProvider={})).MentionedDateField="MentionedDate",(Ge=t.GeneratedConstants.RecentActivityConstants||(t.GeneratedConstants.RecentActivityConstants={})).MyActivityDateField="MyActivityDate",Ge.MyActivityDetailsField="MyActivityDetails",Ge.RecentlyUpdatedDateField="RecentlyUpdatedDate",(Ze=t.GeneratedConstants.WorkItemsHubPaging||(t.GeneratedConstants.WorkItemsHubPaging={})).MaxWorkItems=1e3,Ze.InitialPageSize=100,(t.GeneratedConstants.WorkItemsHubRouteConstants||(t.GeneratedConstants.WorkItemsHubRouteConstants={})).TabRouteParameterName="name",(Be=t.GeneratedConstants.WorkItemsHubSettingsHelper||(t.GeneratedConstants.WorkItemsHubSettingsHelper={})).WorkItemsHubRecentTabIdKey="WorkItemsHub/RecentTabId",Be.WorkItemsHubColumnSettingsKeyTemplate="WorkItemsHub/ColumnSettings/{0}",Be.WorkItemsHubShowCompletedKeyTemplate="WorkItemsHub/ShowCompleted/{0}",Be.InjectedCommentCount=1,Be.NonexistentCommentCount=0,(Le=t.GeneratedConstants.WorkItemsHubTabs||(t.GeneratedConstants.WorkItemsHubTabs={}))[Le.AssignedToMe=0]="AssignedToMe",Le[Le.Following=1]="Following",Le[Le.Mentioned=2]="Mentioned",Le[Le.MyActivity=3]="MyActivity",Le[Le.RecentlyCreated=4]="RecentlyCreated",Le[Le.RecentlyUpdated=5]="RecentlyUpdated",Le[Le.RecentlyCompleted=6]="RecentlyCompleted",Le[Le.MyTeams=7]="MyTeams",function(e){se=t[e]={},t[e].TabEnumValueByTabIdMap={},t[e].TabIdByTabEnumValueMap={},t[e].TabIds=[],Object.keys(ie.WorkItemsHubTabs).every(o=>{if("number"==typeof ie.WorkItemsHubTabs[o])return!1;const i=parseInt(o,10),s=ie.WorkItemsHubTabs[i].toLowerCase();return t[e].TabEnumValueByTabIdMap[s]=i,t[e].TabIdByTabEnumValueMap[i]=s,t[e].TabIds.push(s),!0}),t[e].getTabIdByName=function(o){if(o){const i=o.toLowerCase();if(t[e].TabIds.indexOf(i)>=0)return i}return null}}("UtilsWorkItemsHubTabUtils"),function(e){var o;re=t[e]={},function(e){e.DefaultDataProvider="ms.vss-work-web.new-work-items-hub-default-data-provider",e.AssignedToMeDataProvider="ms.vss-work-web.new-work-items-hub-assignedtome-tab-data-provider",e.FollowingDataProvider="ms.vss-work-web.new-work-items-hub-following-tab-data-provider",e.MentionedDataProvider="ms.vss-work-web.new-work-items-hub-mentioned-tab-data-provider",e.MyActivityDataProvider="ms.vss-work-web.new-work-items-hub-myactivity-tab-data-provider",e.RecentlyUpdatedDataProvider="ms.vss-work-web.new-work-items-hub-recentlyupdated-tab-data-provider",e.RecentlyCreatedDataProvider="ms.vss-work-web.new-work-items-hub-recentlycreated-tab-data-provider",e.RecentlyCompletedDataProvider="ms.vss-work-web.new-work-items-hub-recentlycompleted-tab-data-provider",e.MyTeamsDataProvider="ms.vss-work-web.new-work-items-hub-myteams-tab-data-provider"}(o=t[e].WorkItemsHubDataProviderConstants||(t[e].WorkItemsHubDataProviderConstants={}));const i={[ie.WorkItemsHubTabs.AssignedToMe]:o.AssignedToMeDataProvider,[ie.WorkItemsHubTabs.Following]:o.FollowingDataProvider,[ie.WorkItemsHubTabs.Mentioned]:o.MentionedDataProvider,[ie.WorkItemsHubTabs.MyActivity]:o.MyActivityDataProvider,[ie.WorkItemsHubTabs.RecentlyUpdated]:o.RecentlyUpdatedDataProvider,[ie.WorkItemsHubTabs.RecentlyCreated]:o.RecentlyCreatedDataProvider,[ie.WorkItemsHubTabs.RecentlyCompleted]:o.RecentlyCompletedDataProvider,[ie.WorkItemsHubTabs.MyTeams]:o.MyTeamsDataProvider};!function(e){function t(e,t){const o=s(t);return e.getService("IVssContributionService").getData(o)}function s(e){const t=se.TabEnumValueByTabIdMap[e];let s=i[t];return s||(s=o.DefaultDataProvider),s}function r(e){const t=e.getService("IVssHistoryService").getCurrentRouteValues()[ie.WorkItemsHubRouteConstants.TabRouteParameterName];return se.getTabIdByName(t)}e.refreshDataAsync=function(e,t,o){const i=s(t);return e.getService("IVssContributionService").getDataAsync(i,{pageSize:o},!0)},e.getData=t,e.getDataForCurrentTab=function(e){return t(e,r(e))},e.getDataProviderId=s,e.getCurrentTabId=r,e.pageWorkItems=function(e,t,o,i){const r=s(t);return e.getService("IVssContributionService").getDataAsync(r,{workItemIds:o,fieldReferenceNames:i},!0)}}(t[e].WorkItemsHubDataProvider||(t[e].WorkItemsHubDataProvider={}))}("DataProvidersWorkItemsHubDataProvider"),t.StoresIWorkItemsHubFilterDataSource={},function(e){var o,i;ae=t.UtilsTelemetry={},function(e){e.Area="WorkItemsHub",e.WorkItemsHubInitialLoad="WorkItemsHubInitialLoad",e.WorkItemsHubTabSwitch="WorkItemsHubTabSwitch",e.CreateWorkItem="CreateWorkItem",e.OpenInQueries="OpenInQueries",e.ColumnOptionsCommand="ColumnOptionsCommand",e.RecycleBin="RecycleBin",e.ImportWorkItems="ImportWorkItems",e.CopyToClipboard="CopyToClipboard",e.Email="Email",e.Delete="Delete",e.DeleteCommand="DeleteCommand",e.CompletedWorkItems="CompletedWorkItems",e.ColumnOptionsChange="ColumnOptionsChange",e.ColumnResize="ColumnResize",e.ColumnHeaderClick="ColumnHeaderClick",e.BackCompatOpenWorkItem="BackCompatOpenWorkItem",e.BackCompatQuery="BackCompatQuery",e.LoadWorkItemsHub="LoadWorkItemsHub",e.ClickOnWorkItem="ClickOnWorkItem",e.ChangedTabValue="ChangedTabValue"}(o=t.UtilsTelemetry.TelemetryConstants||(t.UtilsTelemetry.TelemetryConstants={})),function(e){e[e.Unknown=0]="Unknown",e[e.PageLoad=1]="PageLoad",e[e.TabSwitch=2]="TabSwitch"}(i||(i={}));class s{constructor(e){this._service=e.getService("IVssPerformanceService")}static getInstance(e){return s._instance||(s._instance=new s(e)),s._instance}startPageLoad(){this._scenarioType=i.PageLoad}startTabSwitch(){this._scenarioType=i.TabSwitch,this._service.startScenario(o.WorkItemsHubTabSwitch,!1)}endScenario(e){switch(this._scenarioType){case i.TabSwitch:this._service.endScenario(o.Area,o.WorkItemsHubTabSwitch,!1,void 0,e);break;case i.PageLoad:this._service.markTimeToInteractive(o.Area,o.WorkItemsHubInitialLoad,void 0,e)}this._scenarioType=i.Unknown}split(e){this._service.addSplitTiming(e)}}t.UtilsTelemetry.PerformanceTelemetryHelper=s,function(e){function t(e,t,i){e.getService("IVssTelemetryService").publishEvent(o.Area,t,i)}e.publishCreateNewWorkItemTelemetry=function(e,i){t(e,o.CreateWorkItem,{workItemType:i})},e.publishImportWorkItemsCommand=function(e,i){t(e,o.ImportWorkItems,{tabId:i})},e.publishRecycleBinCommand=function(e,i){t(e,o.RecycleBin,{tabId:i})},e.publishColumnOptionsCommandpageContext=function(e,i){t(e,o.ColumnOptionsCommand,{tabId:i})},e.publishOpenInQueriesTelemetry=function(e,i,s,r){t(e,o.OpenInQueries,{tabId:i,hasFilter:s,hasSelection:r})},e.publishCopyToClipboardTelemetry=function(e,i,s){t(e,o.CopyToClipboard,{tabId:i,keyboardShortcutEvent:s})},e.publishDeleteTelemetry=function(e,i,s){t(e,o.Delete,{tabId:i,keyboardShortcutEvent:s})},e.publishEmailTelemetry=function(e,i){t(e,o.Email,{tabId:i})},e.publishCompletedWorkItemsViewOptionTelemetry=function(e,i,s){t(e,o.CompletedWorkItems,{tabId:i,isOn:s})},e.publishColumnOptionsChange=function(e,i,s){t(e,o.ColumnOptionsChange,Object.assign({tabId:i},s))},e.publishColumnOptionsCommand=function(e,i){t(e,o.ColumnOptionsCommand,{tabId:i})},e.publishColumnResize=function(e,i,s){t(e,o.ColumnResize,Object.assign({tabId:i},s))},e.publishColumnHeaderClick=function(e,i,s){t(e,o.ColumnHeaderClick,Object.assign({tabId:i},s))},e.publishBackCompatUrlOpenWorkItem=function(e,i){t(e,o.BackCompatOpenWorkItem,{hash:i})},e.publishBackCompatUrlQuery=function(e,i){t(e,o.BackCompatQuery,{hash:i})},e.publishLoadWorkItemsHub=function(e,i){t(e,o.LoadWorkItemsHub,{tabId:i})},e.publishClickOnWorkItem=function(e,i){t(e,o.ClickOnWorkItem,{workItemId:i})},e.publishChangedTabValue=function(e,i){t(e,o.ChangedTabValue,{tabId:i})}}(t.UtilsTelemetry.UsageTelemetryHelper||(t.UtilsTelemetry.UsageTelemetryHelper={}))}(),function(e){ne=t.ActionsActionsCreator={};t.ActionsActionsCreator.ActionsCreator=class{constructor(e,t){this._pageContext=e,this._actionsHub=t}invalidateTabData(e){this._actionsHub.invalidateTabData.invoke(e)}refreshDataProviderAsync(e,t=!1,o=ie.WorkItemsHubPaging.MaxWorkItems){t&&this._actionsHub.invalidateAllTabsData.invoke(null),re.WorkItemsHubDataProvider.refreshDataAsync(this._pageContext,e,o).then(t=>{this._actionsHub.endRefreshDataProvider.invoke({tabId:e,tabData:t})},t=>{this._actionsHub.endRefreshDataProvider.invoke({tabId:e,tabData:null}),(0,i.traceError)(this._pageContext,ae.TelemetryConstants.Area,"refreshDataAsync",t)})}removeWorkItemFromDataProvider(e,t){this._actionsHub.removeWorkItems.invoke({tabId:e,workItemIds:t})}updateFilterState(e,t){this._actionsHub.updateFilter.invoke({tabId:e,updatedFilter:t})}sortColumn(e,t){this._actionsHub.sortItems.invoke({tabId:e,sortOptions:t})}setCompletedItemsVisibility(e,t){this._actionsHub.setCompletedItemsVisibility.invoke({tabId:e,showCompletedItems:t})}pageWorkItems(e,t){const o=t.getNextPageIds(),s=t.getPageableFieldReferenceNames();re.WorkItemsHubDataProvider.pageWorkItems(this._pageContext,e,o,s).then(t=>{this._actionsHub.endPageWorkItems.invoke({tabId:e,fieldReferenceNames:s,fieldValuesList:t.fieldValues})}).then(null,e=>{(0,i.traceError)(this._pageContext,ae.TelemetryConstants.Area,"pageWorkItems",e)})}}}(),t.ComponentsIWorkItemsTabContentData={},le=t.Constants={},t.Constants.MyActivityDateFieldValues={},(Ke=t.Constants.ActionUrl||(t.Constants.ActionUrl={})).ACTION="action",Ke.ACTION_QUERY="query",Ke.ACTION_EDIT="edit",(je=t.Constants.ActionParameters||(t.Constants.ActionParameters={})).TEMPQUERYID="tempQueryId",je.PATH="path",je.ID="id",je.IMPORTDATA="importData",(t.Constants.FeatureFlags||(t.Constants.FeatureFlags={})).UseTokenFiltering="WebAccess.WorkItemTracking.UseTokenFiltering",t.Constants.WorkItemsHubViewName="new-work-items-hub-view",t.Constants.WorkItemsHubTabGroupContributionId="ms.vss-work-web.new-work-items-hub-tab-group",t.Constants.WorkItemsHubRouteId="ms.vss-work-web.new-work-items-hub-view-route",t.Constants.CreateWorkItemRouteId="ms.vss-work-web.work-items-create-route",t.Constants.OpenWorkItemRouteId="ms.vss-work-web.work-items-form-route-with-id",t.Constants.QueriesRouteId="ms.vss-work-web.query-route-basic",t.Constants.TabContent_BaseClassName="work-items-tab-content",t.Constants.TabContent_GridBaseClassName="work-items-hub-grid",t.Constants.TabContent_WorkItemsHubDetailsListClassName="work-items-hub-detailslist",t.Constants.TabContent_WorkItemsHubGridRowClassName="work-items-hub-row",t.DataContractsIWorkItemsGridData={},function(e){ce=t.UtilsArray={},t.UtilsArray.shallowEquals=function(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let o=0,i=e.length;o<i;++o)if(e[o]!==t[o])return!1;return!0},t.UtilsArray.toDictionary=function(e,t,o,i){var s={};return e.forEach((e,r)=>{var a=t(e,r);if(a){var n;if(n=o?o(e,r):e,i&&s[a])throw new Error("toDictionary: Duplicate entries for key: "+a);s[a]=n}}),s},t.UtilsArray.findIndex=function(e,t){for(var o=0,i=e.length;o<i;o++)if(t(e[o]))return o;return-1},t.UtilsArray.uniqueSort=function(e,t){e.sort(t);for(var o=1,i=e.length;o<i;o++)0===t(e[o],e[o-1])&&(e.splice(o--,1),i--);return e}}(),function(e){me=t.ComponentsCellsWorkItemDateTimeCell={},t.ComponentsCellsWorkItemDateTimeCell.createWorkItemDateTimeCell=function(e){const{dateTime:t,contentFormat:o="{0}"}=e,i=t.toLocaleString().replace(",",""),n=i;return r.createElement(s.Tooltip,{text:i,overflowOnly:!0},r.createElement("span",{className:"work-item-date-time-cell"},a.format(o,n)))}}(),function(e){function o(e,t,o){return`${(0,n.routeUrl)(e,le.QueriesRouteId,{project:t})}?${o}`}function i(e){var t=[];for(let i in e){let s=e[i];if(null!=s){var o="action"===i?"_a":i;t.push(o+"="+encodeURIComponent(s))}}return t.join("&")}de=t.UtilsUrlUtils={},t.UtilsUrlUtils.getCurrentHashString=function(){let e=window.location.hash;return e&&"#"===e[0]&&(e=e.substr(1)),e},t.UtilsUrlUtils.deserializeState=function(e){const t={};return(e||"").split("&").forEach(e=>{let o=e.split("=",2);if(2===o.length){let e=o[0];"_a"===e&&(e="action");const i=o[1].replace(/\+/g,"%20");try{t[e]=decodeURIComponent(i)}catch(o){t[e]=i}}}),t},t.UtilsUrlUtils.getWorkItemHubUrl=function(e){return(0,n.routeUrl)(e,le.WorkItemsHubRouteId)},t.UtilsUrlUtils.getQueriesHubUrl=o,t.UtilsUrlUtils.getEditWorkItemUrl=function(e,t,o){return t?(0,n.routeUrl)(e,le.OpenWorkItemRouteId,{project:t,id:`${o}`}):""},t.UtilsUrlUtils.getCreateWorkItemUrl=function(e,t,o){return`${(0,n.routeUrl)(e,le.CreateWorkItemRouteId,{project:t})}/${o}`},t.UtilsUrlUtils.getImportWorkItemsUrl=function(e,t){return`${o(e,t,i({[le.ActionUrl.ACTION]:le.ActionUrl.ACTION_QUERY,[le.ActionParameters.IMPORTDATA]:"csv"}))}`},t.UtilsUrlUtils.getRecycleBinUrl=function(e,t){return`${o(e,t,i({[le.ActionUrl.ACTION]:le.ActionUrl.ACTION_QUERY,[le.ActionParameters.PATH]:te.RecycleBin}))}`},t.UtilsUrlUtils.getTempQueryUrl=function(e,t,s){return`${o(e,t,i({[le.ActionUrl.ACTION]:le.ActionUrl.ACTION_QUERY,[le.ActionParameters.TEMPQUERYID]:s}))}`}}(),function(e){ue=t.UtilsNavigationUtils={},t.UtilsNavigationUtils.openInQueries=function(e,t,o,s,r){if(s){const a=o=>{n.location.href=de.getTempQueryUrl(e,t,o)},n=window.open("","_blank"),c=r&&r.length>0,m=s.hasFilter();let d;if(c)d=s.generateWiqlForSelectedIds(r);else if(m){const e=s.getFilteredIds();d=s.generateWiqlForSelectedIds(e)}else d=s.generateWiqlForTab();l.TempQueryUtils.beginCreateTemporaryQueryId(e,d).then(a,t=>i.traceError(e,ae.TelemetryConstants.Area,ae.TelemetryConstants.OpenInQueries,t.message)),ae.UsageTelemetryHelper.publishOpenInQueriesTelemetry(e,o,m,c)}}}(),function(e){pe=t.ComponentsCellsWorkItemIconTitleCell={},t.ComponentsCellsWorkItemIconTitleCell.createWorkItemIconTitleCell=function(e,t){return r.createElement("div",{className:"work-item-icon-title-cell"},r.createElement(m.WorkItemTypeIcon,{data:t.icon}),r.createElement("div",{className:"work-item-title"},r.createElement(c.Link,{className:"work-item-title-link",href:de.getEditWorkItemUrl(e,t.projectName,t.workItemId),onClick:o=>{t.onOpenWorkItem(t.workItemId,o),ae.UsageTelemetryHelper.publishClickOnWorkItem(e,t.workItemId)},tooltipProps:{className:"work-item-title-tooltiphost",overflowOnly:!0,showOnFocus:!0,text:t.workItemTitle}},t.workItemTitle)))}}(),function(e){he=t.ComponentsCellsWorkItemCommentCountCell={};const o=99,i=a.format(te.WorkItemsHubTruncatedCommentCount,o);t.ComponentsCellsWorkItemCommentCountCell.createWorkItemCommentCountCell=function(e){var t=Number(e.workItemCommentCount)>o?i:e.workItemCommentCount;return r.createElement(s.Tooltip,{text:t,overflowOnly:!0},r.createElement("div",{className:"work-item-comment-count-cell"},r.createElement("span",{className:"bowtie-icon bowtie-comment-discussion work-item-comment-count-icon"}),r.createElement("span",null,t)))}}(),function(e){ge=t.ComponentsCellsWorkItemSimpleCell={},t.ComponentsCellsWorkItemSimpleCell.createWorkItemSimpleCell=function(e){return r.createElement(s.Tooltip,{text:e.text,overflowOnly:!0},r.createElement("span",{className:"work-item-simple-cell"},e.text))}}(),function(e){Ie=t.UtilsWorkItemsGridColumnFactory={};class o{static getDefaultColumnWidth(e){return o.KnownColumnDefaultWidths[e]||o.DefaultWidth}create(e,t,i,s,r,a,n,l,c,m){return{key:i,name:s,minWidth:o.MinWidth,calculatedWidth:m,isPadded:!1,isResizable:!0,isSorted:l,isSortedDescending:c,columnActionsMode:d.ColumnActionsMode.clickable,onRender:(o,s,l)=>this._createCell(e,t,o,i,r,l,a,n)}}_createCell(e,t,i,s,a,n,l,c){if(s===u.CoreFieldRefNames.Title)return this._createTitleCell(e,t,i,a,c);if(s===u.CoreFieldRefNames.State)return this._createStateCell(e,t,i,a);const m=a[s];let d,I=i.values[m];if(s===u.CoreFieldRefNames.Tags){const e=(0,g.splitAndTrimTags)(I);return I?r.createElement(p.TagsList,{tags:e,className:"work-item-tags"}):null}return s===u.CoreFieldRefNames.AssignedTo?o._createIdentityCell(e,I):s===u.CoreFieldRefNames.CommentCount?0!==Number(I)?o._createCommentCountCell(I):null:I instanceof Date?o._createDateTimeCell(i.values[m],"{0}",l,!1):(0,h.isWorkItemIdentityRef)(I)?o._createIdentityCell(e,I):(s===ie.RecentActivityConstants.MyActivityDetailsField&&(I=le.MyActivityDateFieldValues[I]),null!=I&&"string"!=typeof I&&"number"!=typeof I&&(I=String(I)),(d=o.DefaultCreateMethod)(I,l))}_createStateCell(e,t,o,i){const s=o.values[i[u.CoreFieldRefNames.State]],a=o.values[i[u.CoreFieldRefNames.WorkItemType]],n=e.getService("work-item-state-color-metadata-service").getWorkItemStateColor(t,a,s);if(!(n instanceof Promise))return r.createElement(I.WorkItemState,{data:n,hideText:!1});console.warn("Failed to fetch work item state data from the data provider.")}_createTitleCell(e,t,o,i,s){const r=o.values[i[u.CoreFieldRefNames.Id]],a=o.values[i[u.CoreFieldRefNames.Title]],n=o.values[i[u.CoreFieldRefNames.WorkItemType]],l=e.getService("work-item-type-icon-metadata-service").getWorkItemIcon(t,n);if(!(l instanceof Promise))return(0,pe.createWorkItemIconTitleCell)(e,{workItemId:r,workItemTitle:a,projectName:t,workItemType:n,onOpenWorkItem:s,icon:l});console.warn("Failed to fetch work item icon data from data provider.")}static _createDateTimeCell(e,t,o,i=!0){return(0,me.createWorkItemDateTimeCell)({dateTime:new Date(e),contentFormat:t,showFriendlyDateTime:i,friendlyStartDateTime:o})}static _createIdentityCell(e,t){const o=(0,h.convertWorkItemIdentityRefFromFieldValue)(e,t),i=t&&o.identityRef;return r.createElement(b.IdentityView,{identityRef:i,viewMode:0,size:"extra-small-plus"})}static _createCommentCountCell(e){return(0,he.createWorkItemCommentCountCell)({workItemCommentCount:e})}}t.UtilsWorkItemsGridColumnFactory.WorkItemsGridColumnFactory=o,o.DefaultWidth=150,o.MinWidth=10,o.KnownColumnDefaultWidths={[u.CoreFieldRefNames.Id]:60,[u.CoreFieldRefNames.WorkItemType]:90,[u.CoreFieldRefNames.Title]:450,[u.CoreFieldRefNames.AreaPath]:200,[u.CoreFieldRefNames.IterationPath]:200,[u.CoreFieldRefNames.AssignedTo]:200,[u.CoreFieldRefNames.State]:100,[u.CoreFieldRefNames.Tags]:200,[u.CoreFieldRefNames.CommentCount]:75,[ie.RecentActivityConstants.MyActivityDetailsField]:110},o.DefaultCreateMethod=(e=>(0,ge.createWorkItemSimpleCell)({text:e}))}(),function(e){be=t.StoresWorkItemsHubFilterDataSource={};class o{constructor(e,t,o,i){this.pageContext=e,this._hubData=t;const{userSettings:s,processSettings:r}=t;let n=void 0,l=r.defaultSortOptions,c=void 0,m=ie.WorkItemsHubSettingsHelper.NonexistentCommentCount;const d=(0,ce.findIndex)(t.processSettings.fieldReferenceNames,e=>(0,a.equals)(e,u.CoreFieldRefNames.CommentCount,!0))>=0;s&&(n=s.filter,s.columnSettings&&s.columnSettings.sortOptions&&s.columnSettings.sortOptions.length>0&&(l=s.columnSettings.sortOptions),s.columnSettings&&s.columnSettings.columnOptions&&s.columnSettings.columnOptions.length>0&&(c=s.columnSettings.columnOptions),s.columnSettings&&s.columnSettings.version&&(m=s.columnSettings.version)),c||(d&&(m=ie.WorkItemsHubSettingsHelper.InjectedCommentCount),c=this.getDisplayedFieldReferenceNames().map(e=>({fieldReferenceName:e,width:Ie.WorkItemsGridColumnFactory.getDefaultColumnWidth(e)}))),this._columnOptions=c,this._version=m,this._filterStateManager=new _.FilterStateManager(this.pageContext,o,this._getFilterRegistryKey(),n),this._columnMap=this._getColumnMap(t);const p=this._columnMap[u.CoreFieldRefNames.Id];isNaN(p)&&console.warn("id column doesn't exist"),this._fillIdMaps(t,p),this._showCompletedItems=r.tabId===se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted]||i,this._isCompleteItemsLoaded=t.processSettings.completedItemsLoaded,this.setSortInfo(l),this._visibleIds=this._sortItems(this._ids)}static SortValueGetter(e,t){return(0,h.isWorkItemIdentityRef)(t)?o._getDistinctDisplayName(e,t):t}getDataSourceName(){return`WorkItemHub-${this._hubData.processSettings.tabId}`}getItemCount(){return this.getPagedItemsCount()+this._getUnpagedItemsCount()}getVisibleItemsCount(){return this._visibleIds.length}getPagedItemsCount(){return this._ids.length}getCurrentColumnSettingsVersion(){return this._version}setCompletedItemsVisibility(e){this._showCompletedItems=e}setSortInfo(e){let t=e.filter(e=>void 0!==this._columnMap[e.fieldReferenceName]);if(0===t.length){const e=this.getFieldReferenceNames();t=[{fieldReferenceName:e[e.length-1],isAscending:!1}]}this._sortOptions=t}getCurrentColumnOptions(){return this._columnOptions}isFeatureSupported(){return!this._hubData.processSettings.featureNotSupported}getSortOptions(){return this._sortOptions}isSortableField(e){return!(this._hubData.processSettings.unsortableFieldReferenceNames&&this._hubData.processSettings.unsortableFieldReferenceNames.indexOf(e)>=0)}hasAreaPath(){return this._hubData.processSettings.fieldReferenceNames.indexOf(u.CoreFieldRefNames.AreaPath)>=0}shouldShowCompletedItems(){return this._showCompletedItems}isCompletedItemsLoaded(){return!!this._isCompleteItemsLoaded}getIds(){let e=this._ids;return this._showCompletedItems||(e=this.getIdsInDoingStates(this._hubData.fieldValues)),e}_sortItems(e){const t=this._columnMap[u.CoreFieldRefNames.Id],{fieldValues:o}=this._hubData;let i=this._sortOptions.map(e=>e.fieldReferenceName).map(e=>this._columnMap[e]),s=this._sortOptions.map(e=>e.isAscending);const r=o.map(e=>e.data).filter(o=>e.indexOf(o[t])>=0);return r.sort(this._sortFunction.bind(this,i,s)),r.map(e=>e[t])}_sortFunction(e,t,i,s){for(let r=0;r<e.length;r++){const n=e[r],l=t[r];let c=i[n],m=s[n];if(c=null==c?null:o.SortValueGetter(this.pageContext,c),m=null==m?null:o.SortValueGetter(this.pageContext,m),!l){const e=c;c=m,m=e}if(c!==m)return null===c?1:null===m?-1:"string"==typeof c&&"string"==typeof m?(0,a.localeIgnoreCaseComparer)(c,m):c<m?-1:1}return 0}getIdToWorkItemMap(){return this._idToWorkItemMap}getPageSize(){return o.NextPageSize}getFieldReferenceNames(){return this._hubData.processSettings.fieldReferenceNames}getDisplayedFieldReferenceNames(){let e;if(this._hubData.userSettings){const t=this._hubData.userSettings.columnSettings;t&&t.columnOptions&&t.columnOptions.length>0&&(e=t.columnOptions.map(e=>e.fieldReferenceName))}return e||(e=this._hubData.processSettings.fieldReferenceNames.filter(e=>o.ExcludedFieldsFromDefaultColumns.indexOf(e)<0)),e}getPageableFieldReferenceNames(){return this._hubData.processSettings.fieldReferenceNames.filter(e=>o.NonPageableFields.indexOf(e)<0)}getNextPageIds(){const e=this._hubData.pageContext;return e&&e.unpagedWorkItemIds?e.unpagedWorkItemIds.slice(0,this.getPageSize()):[]}canPageMoreItems(){const e=this._hubData.pageContext;return e&&e.unpagedWorkItemIds&&e.unpagedWorkItemIds.length>0}isPagingSupported(){return!!this._hubData.pageContext}removeWorkItems(e){let t=!1;if(null!=e)for(const o of e){const e=this._ids.indexOf(o);e>=0&&(this._ids.splice(e,1),t=!0);const i=this._visibleIds.indexOf(o);i>=0&&this._visibleIds.splice(i,1);const s=this._columnMap[u.CoreFieldRefNames.Id];if(this._hubData.fieldValues){const e=this._hubData.fieldValues.map(e=>e.data),t=(0,ce.findIndex)(e,e=>e[s]===o);t>=0&&this._hubData.fieldValues.splice(t,1)}delete this._idToWorkItemMap[o]}return t}_mergeFieldValues(e,t){const o=t.fieldReferenceNames.indexOf(u.CoreFieldRefNames.Id),i={},s={};t.fieldReferenceNames.forEach((e,t)=>{s[e]=t});for(const e of t.fieldValuesList){i[e.data[o]]=e.data}const r=this._hubData.pageContext,a={},n={};if(r.fieldReferenceNames&&r.fieldReferenceNames.length>0&&r.fieldReferenceNames.forEach((e,t)=>{n[e]=t}),r.fieldValues&&r.fieldValues.length>0)for(let t=0,o=e.length;t<o;t++)a[e[t]]=r.fieldValues[t].data;const l=this.getFieldReferenceNames();for(const t of e)if(i.hasOwnProperty(t)){const e=[];for(const o of l){let r=-1,l=void 0;(r=s[o])>=0?l=i[t][r]:(r=n[o])>=0&&(l=a[t][r]),e.push(l)}this._ids.push(t),this._visibleIds.push(t),this._idToWorkItemMap[t]=e,this._hubData.fieldValues.push({data:e})}}addWorkItems(e){if(e){const t=this._hubData.pageContext,o=this.getNextPageIds();this._mergeFieldValues(o,e);const i=this.getPageSize();return t.unpagedWorkItemIds&&t.unpagedWorkItemIds.length>0&&t.unpagedWorkItemIds.splice(0,i),t.fieldValues&&t.fieldValues.length>0&&t.fieldValues.splice(0,i),!0}return!1}getValue(e,t){const o=this._columnMap[t];if(o>=0){const i=this._idToWorkItemMap[e];return(0,a.equals)(t,u.CoreFieldRefNames.AreaPath,!0)?i&&i[o]:(0,a.equals)(t,u.CoreFieldRefNames.AssignedTo,!0)?i&&(0,h.convertWorkItemIdentityRefFromFieldValue)(this.pageContext,i[o]):i&&i[o]}return null}getVisibleFields(){return this._hubData.processSettings.fieldReferenceNames}getUniqueValues(e){const t=this._columnMap[e];if(void 0===t)return[];let o,i=this._hubData.fieldValues.filter(e=>e.data[t]).map(e=>e.data);if(!this._showCompletedItems){const e=this._hubData.processSettings.doneStateNames,t=this._columnMap[u.CoreFieldRefNames.State];i=i.filter(o=>(0,ce.findIndex)(e,e=>(0,a.equals)(e,o[t],!0))<0)}if((0,a.equals)(e,u.CoreFieldRefNames.AssignedTo,!0)){const e=i.map(e=>(0,h.convertWorkItemIdentityRefFromFieldValue)(this.pageContext,e[t]));return(0,h.uniqueSortWorkItemIdentityRefObjects)(e)}if(o=(0,a.equals)(e,u.CoreFieldRefNames.AreaPath,!0)?i.map(e=>(0,C.getAreaPathLeafNode)(e[t])):i.map(e=>e[t]),(0,a.equals)(e,u.CoreFieldRefNames.Tags,!0)){const e={};for(const t of o){const o=(0,g.splitAndTrimTags)(t);for(const t of o)e[t]=!0}return(0,k.uniqueSort)(Object.keys(e),a.localeIgnoreCaseComparer)}return(0,k.uniqueSort)(o,a.localeIgnoreCaseComparer)}getFilteredData(){return Object.assign(Object.assign({},this._hubData),{fieldValues:this._getFieldValuesByIds(this._visibleIds)})}hideCompletedItems(){const e=this._getFieldValuesByIds(this._visibleIds);this._visibleIds=this.getIdsInDoingStates(e)}getIdsInDoingStates(e){const t=this._hubData.processSettings.doneStateNames,o=this._columnMap[u.CoreFieldRefNames.State],i=this._columnMap[u.CoreFieldRefNames.Id],s=[];for(const r of e){const e=r.data;(0,ce.findIndex)(t,t=>(0,a.equals)(t,e[o],!0))<0&&s.push(e[i])}return s}getFilteredIds(){return this._visibleIds}setVisibleIds(e){this._visibleIds=this._sortItems(e)}resetFilter(e){this.setVisibleIds(this._ids),e?this._filterStateManager.resetFilter():this._filterStateManager.setFilterState({})}saveFilters(e){this._filterStateManager.saveFilter(e)}setFilters(e){this._filterStateManager.setFilterState(e)}getFilterState(){return this._filterStateManager.getFilterState()}hasFilter(){const e=this.getFilterState();return e&&Object.keys(e).length>0}generateWiqlForSelectedIds(e){0===(e=e||[]).length&&e.push(0);const t=`${u.CoreFieldRefNames.Id} IN (${e.join(", ")})`;return(0,a.format)(this._hubData.processSettings.wiqlTemplate,t,this._getOrderByClause())}generateWiqlForTab(){const{wiqlTemplate:e,defaultWhereClause:t,doneStateNames:o}=this._hubData.processSettings;let i=t;return this._showCompletedItems||(i+=` and ${u.CoreFieldRefNames.State} NOT IN (${o.map(e=>`"${e}"`).join(",")})`),(0,a.format)(e,i,this._getOrderByClause())}getFieldValues(e,t){const o=(0,ce.toDictionary)(this._hubData.processSettings.fieldReferenceNames,e=>e,(e,t)=>t),i=[];return e.forEach(e=>{if(this._idToWorkItemMap.hasOwnProperty(e.toString())){const s=this._idToWorkItemMap[e],r=t.map(e=>s[o[e]]);i.push(r)}}),i}_getOrderByClause(){const{defaultOrderByClause:e}=this._hubData.processSettings;let t="";return this._sortOptions.forEach(e=>{const{fieldReferenceName:i,isAscending:s}=e;if(o.NonWiqlSortableFields.indexOf(i)<0){const e=`[${i}] ${s?"asc":"desc"}`;t+=""===t?e:`, ${e}`}}),""===t?e:t}_getFilterRegistryKey(){return`Filters/WorkItemsHub/${this._hubData.processSettings.tabId}/Filter`}_getColumnMap(e){const t={};return e.processSettings.fieldReferenceNames.forEach((e,o)=>{t[e]=o}),t}_getFieldValuesByIds(e){const t=[];return e.forEach(e=>{this._idToWorkItemMap.hasOwnProperty(e.toString())&&t.push({data:this._idToWorkItemMap[e]})}),t}_fillIdMaps(e,t){this._ids=[],this._idToWorkItemMap={};for(const o of e.fieldValues){const e=o.data,i=e[t];this._ids.push(i),this._idToWorkItemMap[i]=e}}_getUnpagedItemsCount(){return this.isPagingSupported()?this._hubData.pageContext.unpagedWorkItemIds.length:0}static _getDistinctDisplayName(e,t){return(0,h.convertWorkItemIdentityRefFromFieldValue)(e,t).distinctDisplayName}}t.StoresWorkItemsHubFilterDataSource.WorkItemsHubFilterDataSource=o,o.NextPageSize=ie.WorkItemsHubPaging.MaxWorkItems-ie.WorkItemsHubPaging.InitialPageSize,o.NonPageableFields=[ie.RecentActivityConstants.MyActivityDateField,ie.RecentActivityConstants.MyActivityDetailsField,ie.RecentActivityConstants.RecentlyUpdatedDateField,ie.MentionedTabDataProvider.MentionedDateField],o.ExcludedFieldsFromDefaultColumns=[u.CoreFieldRefNames.WorkItemType,ie.RecentActivityConstants.MyActivityDetailsField],o.NonWiqlSortableFields=[...o.NonPageableFields,u.CoreFieldRefNames.Tags]}(),function(e){Ce=t.UtilsWorkItemsHubDataUtils={},t.UtilsWorkItemsHubDataUtils.getFieldFriendlyName=function(e,t){if(t.fieldReferenceNames){if(a.equals(e,u.CoreFieldRefNames.CommentCount,!0))return te.WorkItemsHubComments;const o=t.fieldReferenceNames.indexOf(e);if(o>=0)return t.fieldFriendlyNames[o]}return e},t.UtilsWorkItemsHubDataUtils.getNormalizedValue=function(e){return(e=e||"").trim().toLowerCase()}}(),_e=t[Qe="DataProvidersWorkItemsGridDataProvider"]={},(qe=t[Qe].WorkItemsGridDataProvider||(t[Qe].WorkItemsGridDataProvider={})).buildColumns=function(e,t,o,i,s,r,n){const l=function(e){return(0,ce.toDictionary)(e.processSettings.fieldReferenceNames,e=>e,(e,t)=>t)}(o);return function(e){let t;if(e.userSettings){const o=e.userSettings.columnSettings;o&&o.columnOptions&&o.columnOptions.length>0&&(t=e.userSettings.columnSettings.columnOptions)}if(!t){const o=e.processSettings.fieldReferenceNames.filter(e=>be.WorkItemsHubFilterDataSource.ExcludedFieldsFromDefaultColumns.indexOf(e)<0);t=o.map(e=>({fieldReferenceName:e,width:Ie.WorkItemsGridColumnFactory.getDefaultColumnWidth(e)}))}return t}(o).map(c=>s.create(e,t,c.fieldReferenceName,(0,Ce.getFieldFriendlyName)(c.fieldReferenceName,o.processSettings),l,r,n,function(e,t){let o=!1;return t&&t.forEach(t=>{(0,a.equals)(t.fieldReferenceName,e,!0)&&(o=!0)}),o}(c.fieldReferenceName,i),function(e,t){let o=!1;return t.forEach(t=>{(0,a.equals)(t.fieldReferenceName,e,!0)&&(o=!t.isAscending)}),o}(c.fieldReferenceName,i),c.width))},qe.getData=function(e,t){if(!(e&&e.processSettings&&e.processSettings.fieldReferenceNames&&e.fieldValues))return null;const o=(0,ce.findIndex)(e.processSettings.fieldReferenceNames,e=>(0,a.equals)(e,u.CoreFieldRefNames.State,!0));return e.fieldValues.map((t,i)=>{const s=t.data,r=s[0],n=s[o],l=(0,ce.findIndex)(e.processSettings.doneStateNames,e=>(0,a.equals)(e,n,!0))>=0;return{key:i.toString(10),id:r,isCompleted:l,values:s}})},function(e){function o(e){return(e=e||"").trim().toLowerCase()}ke=t[e]={},t[e].getNormalizedValue=o;class i{constructor(){this._items={}}static getDefault(){return{color:i.DEFAULT_WORKITEMTYPE_COLOR,icon:i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}}setColorAndIcon(e,t,s){const r=o(e);return this._items[r]={color:i.transformColor(t),icon:i.transformIcon(s)},this._items[r]}getColorAndIcon(e){const t=o(e);return this._items[t]||i.getDefault()}static transformColor(e){return e?`#${e.substr(e.length-6)}`:i.DEFAULT_WORKITEMTYPE_COLOR}static transformIcon(e){return(e=o(e))&&i.ICON_NAME_MAPPINGS[e]?i.ICON_NAME_MAPPINGS[e]:i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}}t[e].WorkItemTypeColorAndIcons=i,i.ICON_NAME_MAPPINGS={icon_crown:"bowtie-symbol-crown",icon_trophy:"bowtie-symbol-trophy",icon_list:"bowtie-symbol-list",icon_book:"bowtie-symbol-book",icon_sticky_note:"bowtie-symbol-stickynote",icon_clipboard:"bowtie-symbol-task",icon_insect:"bowtie-symbol-bug",icon_traffic_cone:"bowtie-symbol-impediment",icon_chat_bubble:"bowtie-symbol-review",icon_flame:"bowtie-symbol-flame",icon_megaphone:"bowtie-symbol-ask",icon_test_plan:"bowtie-test-plan",icon_test_suite:"bowtie-test-suite",icon_test_case:"bowtie-test-case",icon_test_step:"bowtie-test-step",icon_test_parameter:"bowtie-test-parameter",icon_code_review:"bowtie-symbol-review-request",icon_code_response:"bowtie-symbol-review-response",icon_review:"bowtie-symbol-feedback-request",icon_response:"bowtie-symbol-feedback-response",icon_ribbon:"bowtie-symbol-ribbon",icon_chart:"bowtie-symbol-finance",icon_headphone:"bowtie-symbol-headphone",icon_key:"bowtie-symbol-key",icon_airplane:"bowtie-symbol-airplane",icon_car:"bowtie-symbol-car",icon_diamond:"bowtie-symbol-diamond",icon_asterisk:"bowtie-symbol-asterisk",icon_database_storage:"bowtie-symbol-storage-database",icon_government:"bowtie-symbol-government",icon_gavel:"bowtie-symbol-decision",icon_parachute:"bowtie-symbol-parachute",icon_paint_brush:"bowtie-symbol-paint-brush",icon_palette:"bowtie-symbol-color-palette",icon_gear:"bowtie-settings-gear",icon_check_box:"bowtie-status-success-box",icon_gift:"bowtie-package-fill",icon_test_beaker:"bowtie-test-fill",icon_broken_lightbulb:"bowtie-symbol-defect",icon_clipboard_issue:"bowtie-symbol-issue",icon_github:"bowtie-brand-github",icon_pull_request:"bowtie-tfvc-pull-request",icon_github_issue:"bowtie-status-error-outline"},i.DEFAULT_UNPARENTED_WORKITEM_COLOR="#A6A6A6",i.DEFAULT_UNPARENTED_WORKITEM_BOWTIE_ICON="bowtie-square",i.DEFAULT_WORKITEMTYPE_COLOR_HEX="009CCC",i.DEFAULT_WORKITEMTYPE_COLOR=`#${i.DEFAULT_WORKITEMTYPE_COLOR_HEX}`,i.DEFAULT_WORKITEMTYPE_ICON=u.WorkItemTypeIcons.DefaultWorkItemTypeIconName,i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON=i.ICON_NAME_MAPPINGS[i.DEFAULT_WORKITEMTYPE_ICON];class s{constructor(){this._cachedPromises={},this._projectToColorAndIconsMap={}}static getInstance(e){return s._instance||(s._instance=this._getDataProvider(e)),s._instance}isPopulated(e){return!!e&&(e=o(e),this._projectToColorAndIconsMap.hasOwnProperty(e))}getColorAndIcon(e,t){return e&&t&&(e=o(e),this._projectToColorAndIconsMap[e])?this._projectToColorAndIconsMap[e].getColorAndIcon(t):i.getDefault()}getColor(e,t){return this.getColorAndIcon(e,t).color}ensureColorAndIconsArePopulated(e){const t={};for(let i of e)i=o(i),t.hasOwnProperty(i)||this.isPopulated(i)||(t[i]=null);return Object.keys(t).length,Promise.resolve()}getColorAndIconAsync(e,t){return this.isPopulated(e)?Promise.resolve(this.getColorAndIcon(e,t)):this.queueEnsureColorAndIconsArePopulated(e).then(()=>this.getColorAndIcon(e,t))}getColorAsync(e,t){return this.getColorAndIconAsync(e,t).then(e=>e.color)}queueEnsureColorAndIconsArePopulated(e){return e=o(e),this._cachedPromises[e]?this._cachedPromises[e]:(this._cachedPromises[e]=this.ensureColorAndIconsArePopulated([e]),this._cachedPromises[e].then(()=>{delete this._cachedPromises[e]},t=>{delete this._cachedPromises[e]}))}_setColors(e,t){const s=new i;for(const e of t)s.setColorAndIcon(e.workItemTypeName,e.color,e.icon);e=o(e),this._projectToColorAndIconsMap[e]=s}static _getDataProvider(e){const t=e.getService("ITfsPageService").getData().project;let o=e.getService("IVssContributionService").getData("ms.vss-work-web.work-item-type-color-icon-data-provider");const i=new s;return t&&o&&i._setColors(t.name,o),i}static _toWorkItemTypeColorAndIcon(e){const{color:t,icon:o,name:i}=e;return{color:t,icon:o&&o.id,workItemTypeName:i}}}t[e].WorkItemTypeColorAndIconsProvider=s}("ExternalNewWorkItemWorkItemTypeColorAndIconsProvider"),t.ExternalNewWorkItemINewWorkItemData={},function(e){ye=t.ExternalNewWorkItemNewWorkItem={};class o{static getNewWorkItemPivotBarActions(e,t){const i=new ke.WorkItemTypeColorAndIcons;return o._getWorkItemTypeMenuItems(e,t,i)}static getNewWorkItemPivotBarAction(e,t){const i=null==t.important||t.important,s=new ke.WorkItemTypeColorAndIcons,r={iconName:"bowtie-math-plus-light",iconType:1};return t.workItemTypesNames&&1===t.workItemTypesNames.length?{key:o.newWorkItemCommandKey,disabled:t.disabled,name:te.NewWorkItemButtonText,iconProps:r,important:i,onClick:(o,i)=>t.addNewItem(e,o,i,t.workItemTypesNames[0])}:{key:o.newWorkItemCommandKey,disabled:t.disabled,name:te.NewWorkItemButtonText,iconProps:r,important:i,children:o._getWorkItemTypeMenuItems(e,t,s)}}static _getWorkItemTypeMenuItems(e,t,i){const s=e.getService("IVssContributionService").getData("ms.vss-work-web.new-workitem-data-provider-non-cached");if(!s||!s.workItemTypes)return[];let r;return(r=t.workItemTypesNames&&t.workItemTypesNames.length>0?(0,k.uniqueSort)(t.workItemTypesNames,a.localeIgnoreCaseComparer):(0,k.uniqueSort)(s.workItemTypes,a.localeIgnoreCaseComparer)).map(r=>o._createMenuItem(e,t,i,s,r))}static _createMenuItem(e,t,i,s,r){const a=o._getWorkItemTypeColorAndIcon(i,s,r),n={iconName:a.icon,iconType:1,style:{color:a.color}};return{key:r,disabled:t.disabled,name:r,iconProps:n,onClick:(o,i)=>t.addNewItem(e,o,i,r)}}static _getWorkItemTypeColorAndIcon(e,t,o){let i;if((o=(0,ke.getNormalizedValue)(o))&&t.colorAndIcons){const s=t.colorAndIcons[o];s&&(i=e.setColorAndIcon(o,s.color,s.icon))}return i||(i=ke.WorkItemTypeColorAndIcons.getDefault()),i}}t.ExternalNewWorkItemNewWorkItem.PivotBarActionHelper=o,o.newWorkItemCommandKey="new-work-item"}(),function(e){function o(e,t,o,i){const s={[t]:o};return e.getService("ISettingsService").setEntries(s,0,"Project",i)}Te=t.UtilsWorkItemsHubTabSettings={},t.UtilsWorkItemsHubTabSettings.updateRecentTabId=function(e,t,i){o(e,ie.WorkItemsHubSettingsHelper.WorkItemsHubRecentTabIdKey,i,t),ae.UsageTelemetryHelper.publishChangedTabValue(e,i)},t.UtilsWorkItemsHubTabSettings.updateColumnSettings=function(e,t,i,s,r,n){const l={columnOptions:s,sortOptions:r,version:n};return o(e,(0,a.format)(ie.WorkItemsHubSettingsHelper.WorkItemsHubColumnSettingsKeyTemplate,i),l,t)},t.UtilsWorkItemsHubTabSettings.updateShowCompletedForTab=function(e,t,i,s){return o(e,(0,a.format)(ie.WorkItemsHubSettingsHelper.WorkItemsHubShowCompletedKeyTemplate,i),s,t)}}(),function(e){fe=t.UtilsColumnOptionsPanelContracts={};t.UtilsColumnOptionsPanelContracts.LegacyFieldDefinition=class{canSortBy(){return this.canSort}isQueryable(){return this.canQuery}isIgnored(){return!(!a.equals(this.referenceName,u.CoreFieldRefNames.AreaId,!0)&&!a.equals(this.referenceName,u.CoreFieldRefNames.IterationId,!0))}}}(),function(e){Se=t.UtilsColumnOptionsPanelLauncher={};t.UtilsColumnOptionsPanelLauncher.ColumnOptionsPanelLauncher=class{constructor(e,t){this._actionCreator=e,this._pageContext=t,this._onOkClick=((e,t)=>{if(!t)return;const o=e.display.map(e=>({fieldReferenceName:e.name,width:e.width})),s=e.sort.map(e=>({fieldReferenceName:e.name,isAscending:e.asc}));(0,Te.updateColumnSettings)(this._pageContext,this._projectId,this._tabId,o,s,this._version).then(()=>{this._actionCreator.invalidateTabData(this._tabId),this._actionCreator.refreshDataProviderAsync(this._tabId),ae.UsageTelemetryHelper.publishColumnOptionsChange(this._pageContext,this._tabId,{columns:e.display.map(e=>e.name).join(),sortOptions:e.sort.map(e=>e.name).join(),addedColumns:e.added.join(),removedColumns:e.removed.join(),addedColumnsCount:e.added.length,removedColumnsCount:e.removed.length})},e=>{(0,i.traceError)(this._pageContext,ae.TelemetryConstants.Area,ae.TelemetryConstants.ColumnOptionsChange,`Failed to store column settings for work items hub ${this._tabId}, columns: ${o.length}, sort: ${s.length}, ${e}`)})}),this._getAvailableFields=(()=>{let e=0;const t=[];return this._pageContext.getRestClient("IWorkItemTrackingRestClient").getFields(this._projectId).then(o=>{for(const i of o)if(!a.equals(i.referenceName,u.CoreFieldRefNames.Parent,!0)){const o=!!a.equals(i.referenceName,u.CoreFieldRefNames.Tags,!0)||i.canSortBy;t.push(this._createWorkItemsHubField(e++,i.referenceName,i.name,o,i.isQueryable))}const i=this._getAdditionalField(e);return i&&t.push(...i),t},e=>Promise.reject(e))}),this._getAdditionalField=(e=>{const t=[];switch(se.TabEnumValueByTabIdMap[this._tabId]){case ie.WorkItemsHubTabs.Mentioned:t.push(this._createWorkItemsHubField(++e,ie.MentionedTabDataProvider.MentionedDateField,te.MentionedDateColumnDisplayName));break;case ie.WorkItemsHubTabs.MyActivity:t.push(this._createWorkItemsHubField(++e,ie.RecentActivityConstants.MyActivityDetailsField,te.MyActivityDetailsColumnDisplayName)),t.push(this._createWorkItemsHubField(++e,ie.RecentActivityConstants.MyActivityDateField,te.ActivityDateColumnDisplayName));break;case ie.WorkItemsHubTabs.RecentlyUpdated:t.push(this._createWorkItemsHubField(++e,ie.RecentActivityConstants.RecentlyUpdatedDateField,te.ActivityDateColumnDisplayName));break;default:return null}return t}),this._getFieldWidth=(e=>150);const o=t.getService("ITfsPageService").getData();this._projectId=o.project.id}openColumnOptionPanel(e,t,o,i){const s=t.map(e=>({fieldRefName:e.fieldReferenceName,width:e.width})),a=o.map(e=>({fieldRefName:e.fieldReferenceName,descending:!e.isAscending}));this._version=i,this._tabId=e;const n={getFieldWidth:this._getFieldWidth,getAvailableFields:this._getAvailableFields,displayColumns:s,sortColumns:a,allowSort:!0,project:this._projectId};this._pageContext.getService("IVssLayoutManager").renderCallout(e=>r.createElement(y.LegacyComponent,Object.assign(Object.assign({modules:["WorkItemTracking/Scripts/Queries/Components/ColumnOptions/ColumnOptionsPanel"],wrappedType:"columnOptionsPanel"},n),{onOkClick:(t,o)=>{e(),this._onOkClick(t,o)},onDismiss:e}),null))}_createWorkItemsHubField(e,t,o,i=!0,s=!0){const r=new fe.LegacyFieldDefinition;return r.id=e,r.name=o,r.referenceName=t,r.canSort=i,r.canQuery=s,r}}}(),function(e){we=t.UtilsWorkItemsHubDeleteHelper={};t.UtilsWorkItemsHubDeleteHelper.WorkItemsHubDeleteHelper=class{constructor(e,t){this._pageContext=e,this._actionCreator=t,this._testWorkItemTypesMap=null,this._hasDeletePermission=null,this.testCategories=["Microsoft.TestCaseCategory","Microsoft.TestPlanCategory","Microsoft.TestSuiteCategory","Microsoft.SharedParameterCategory","Microsoft.SharedStepCategory"],this.hasDeletePermission()&&this._beginPopulateTestWorkItemTypes()}shouldShowDeleteCommand(e,t){if(this.hasDeletePermission()&&null!=this._testWorkItemTypesMap&&null!=t&&t.length>0){for(const o of t){const t=e.getValue(o,u.CoreFieldRefNames.WorkItemType);if(this._testWorkItemTypesMap.hasOwnProperty(t))return!1}return!0}return!1}deleteWorkItems(e,t,o){null!=o&&0!==o.length&&e.getService("IVssLayoutManager").renderCallout(()=>r.createElement(y.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/DeleteConfirmationDialog"],wrappedType:"deleteConfirmationDialog",workItemIds:o,onDelete:()=>{this._actionCreator.removeWorkItemFromDataProvider(t,o)}},null))}_beginPopulateTestWorkItemTypes(){const e={},t=this._pageContext.getService("ITfsPageService").getData().project.id;this._pageContext.getRestClient(T.WorkItemTrackingClientName).getWorkItemTypeCategories(t).then(t=>{t&&(this.testCategories.forEach(o=>{t.filter(e=>0===(0,a.localeIgnoreCaseComparer)(e.referenceName,o)).forEach(t=>{t.workItemTypes.forEach(t=>{e[t.name]=o})})}),this._testWorkItemTypesMap=e)})}hasDeletePermission(){if(null==this._hasDeletePermission){const e=this._pageContext.getService("IVssContributionService").getData("ms.vss-work-web.work-item-permissions-data-provider");e&&e.workItemDeletePermission&&(this._hasDeletePermission=e.workItemDeletePermission.hasPermission)}return!!this._hasDeletePermission}}}(),function(e){De=t.UtilsClipboard={};const o="text";function i(e,t){let i=!1;if(t||void 0===window.clipboardData){let o,s,r=document.createElement("div");const a="copyDiv";r.id=a;try{if(r.style.backgroundColor="white",t?r.innerHTML+=e:(r.style.whiteSpace="pre",r.textContent=e),document.body.createTextRange){let e=document.getElementsByTagName("body")[0];e.insertBefore(r,e.firstChild),(o=document.body.createTextRange()).moveToElementText(document.getElementById(a)),o.select(),i=o.execCommand("copy")}else if(document.createRange&&window.getSelection){document.getElementsByTagName("body")[0].appendChild(r),o=document.createRange(),(s=window.getSelection()).removeAllRanges(),o.selectNodeContents(document.getElementById(a)),s.addRange(o),i=document.execCommand("copy")}}finally{r.parentElement.removeChild(r)}}else window.clipboardData.setData(o,e),i=!0;return i}function s(e,t,o){e.getService("IVssLayoutManager").renderCallout(()=>r.createElement(y.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/CopyContentDialog"],wrappedType:"copyContentDialog",data:t,copyAsHtml:o.copyAsHtml},null))}function a(){return document.queryCommandSupported("copy")||void 0!==window.clipboardData}function n(){return void 0!==document.body.createTextRange||document.queryCommandSupported("copy")&&void 0!==document.createRange}t.UtilsClipboard.copyToClipboard=function(e,t,o){if(t&&"string"==typeof t)if(o&&o.showCopyDialog)s(e,t,o);else{var r=!1;if(o&&o.copyAsHtml){if(n())try{r=i(t,!0)}catch(e){}}else if(a())try{r=i(t,!1)}catch(e){}r||s(e,t,o)}},t.UtilsClipboard.supportsNativeCopy=a,t.UtilsClipboard.supportsNativeHtmlCopy=n}(),function(e){We=t.UtilsHtmlTableFormatter={};class o{constructor(e,t,o){this._rows=e,this._columns=t,this._options=o}_getCellValue(e,t){return this._rows[e][t.index]}_getSafeCellValue(e,t){const o=this._getCellValue(e,t),s=t.isValueHtml?o:i(o);return""===s?"&nbsp;":s}getHtml(){if(0===this._rows.length||0===this._columns.length)return"<div></div>";const e=this._columns.map(e=>`<th style="${o.COLUMN_STYLE}">${i(e.name)}</th>`),t=`<thead style="${o.HEADER_STYLE}"><tr>${e.join("")}</tr></thead>`,s=`<tbody>${this._rows.map((e,t)=>{const i=this._columns.map(e=>`<td style="${o.COLUMN_STYLE}">${this._getSafeCellValue(t,e)}</td>`);return`<tr style="${t%2?o.ROW_ALT_BACKGROUND_COLOR:o.ROW_BACKGROUND_COLOR}">${i.join("")}</tr>`}).join("")}</tbody>`,r=this._options&&this._options.extendedHtml?`<div style="${o.FONT_FAMILY+o.FONT_SIZE}">${this._options.extendedHtml}</div>`:"";return`<div><table border="0" cellpadding="0" cellspacing="0" style="${o.TABLE_STYLE}">${t}${s}</table>${r}</div>`}}function i(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}t.UtilsHtmlTableFormatter.HtmlTableFormatter=o,o.HEADER_BACKGROUND_COLOR="background-color: #106EBE;",o.HEADER_COLOR="color: white;",o.FONT_SIZE="font-size: 11pt;",o.FONT_FAMILY="font-family: Calibri, sans-serif;",o.BORDER_COLLAPSE="border-collapse: collapse;",o.COLUMN_BORDER="border: 1px solid white;",o.COLUMN_VERTICAL_ALIGN="vertical-align: top;",o.COLUMN_PADDING="padding: 1.45pt .05in;",o.ROW_BACKGROUND_COLOR="background-color: #FFFFFF",o.ROW_ALT_BACKGROUND_COLOR="background-color: #F8F8F8",o.COLUMN_STYLE=o.COLUMN_BORDER+o.COLUMN_VERTICAL_ALIGN+o.COLUMN_PADDING,o.HEADER_STYLE=o.HEADER_BACKGROUND_COLOR+o.HEADER_COLOR,o.TABLE_STYLE=o.FONT_FAMILY+o.FONT_SIZE+o.BORDER_COLLAPSE,t.UtilsHtmlTableFormatter.htmlEncode=i}(),function(e){var o;ve=t[e]={},function(e){e[e.PlainText=0]="PlainText",e[e.Date=1]="Date",e[e.Identity=2]="Identity"}(o=t[e].WorkItemHtmlTableFormatType||(t[e].WorkItemHtmlTableFormatType={}));class i extends We.HtmlTableFormatter{constructor(e,t,o){super(e,t.map(e=>Object.assign(Object.assign({},e),{isValueHtml:i.isHtmlField(e.fieldReferenceName)}))),this._pageContext=o}_getCellValue(e,t){const s=this._rows[e][t.index];if(a.equals(t.fieldReferenceName,u.CoreFieldRefNames.Id,!0))return i.getIdColumnValue(parseInt(s,10),this._pageContext);let r=t.formatType;return null==r&&(r=i._getColumnFormatType(s)),r===o.Identity?i.getIdentityValue(this._pageContext,s):r===o.Date?(0,f.convertValueToDisplayString)(new Date(s)):(0,f.convertValueToDisplayString)(s)}static getIdentityValue(e,t){return(0,h.convertWorkItemIdentityRefFromFieldValue)(e,t).identityRef.displayName||""}static getIdColumnValue(e,t){const o=t.getService("ITfsPageService").getData().project;return`<a href="${(0,de.getEditWorkItemUrl)(t,o.name,e)}" style="color:#106ebe" target="_blank">${e}</a>`}static isHtmlField(e){return a.equals(u.CoreFieldRefNames.Id,e,!0)}static _getColumnFormatType(e){return(0,h.isWorkItemIdentityRef)(e)||(0,h.isIdentityRef)(e)?o.Identity:e instanceof Date?o.Date:o.PlainText}}t[e].WorkItemHtmlTableFormatter=i}("UtilsWorkItemHtmlTableFormatter"),function(e){Fe=t.UtilsWorkItemsHubReportUtils={};class o{static copyWorkItemsToClipboard(e,t,i,s,r,a){const n=e.map((e,i)=>({index:i,fieldReferenceName:e,name:t[i],formatType:o.HtmlTableFormatterType[e]})).filter(e=>o.ColumnsToExclude.indexOf(e.fieldReferenceName)<0),l=new ve.WorkItemHtmlTableFormatter(i,n,s).getHtml();De.copyToClipboard(s,l,{copyAsHtml:!0}),r&&o._showCopiedCallout(r,a)}static openSendEmailDialog(e,t,i,s){const a=t.filter(e=>o.ColumnsToExclude.indexOf(e)<0);e.getService("IVssLayoutManager").renderCallout(()=>r.createElement(y.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/SendMailDialog"],wrappedType:"sendMailDialog",workItemIds:i,fields:a,subject:s},null))}static _showCopiedCallout(e,t){let o=document.createElement("div");document.body.appendChild(o);const i=()=>{o&&(S.unmountComponentAtNode(o),o.parentElement.removeChild(o),o=null)},s={anchorOrigin:{horizontal:"center",vertical:"end"},calloutOrigin:{horizontal:"center",vertical:"start"},onDismiss:i,contentClassName:"work-items-hub-callout"};!t||e.clientX>0&&e.clientY>0?s.anchorPoint={x:e.clientX,y:e.clientY}:s.anchorElement=document.querySelector(`.${le.TabContent_WorkItemsHubGridRowClassName}[role="row"][data-item-key="${t.key}"] .${v.ContextualMenuButton.ButtonContainerClassName}`),S.render(r.createElement(W.Callout,Object.assign({},s),te.CopiedContentDialogTitle),o),(0,D.wait)(500).then(i),w.announce(te.CopiedContentDialogTitle,!0)}}t.UtilsWorkItemsHubReportUtils.WorkItemsHubReportUtils=o,o.ColumnsToExclude=[ie.RecentActivityConstants.MyActivityDateField,ie.RecentActivityConstants.MyActivityDetailsField,ie.RecentActivityConstants.RecentlyUpdatedDateField,ie.MentionedTabDataProvider.MentionedDateField],o.HtmlTableFormatterType={[u.CoreFieldRefNames.ChangedDate]:ve.WorkItemHtmlTableFormatType.Date,[u.CoreFieldRefNames.CreatedDate]:ve.WorkItemHtmlTableFormatType.Date,[u.CoreFieldRefNames.AssignedTo]:ve.WorkItemHtmlTableFormatType.Identity,[u.CoreFieldRefNames.CreatedBy]:ve.WorkItemHtmlTableFormatType.Identity}}(),function(e){Re=t.StoresWorkItemsHubStore={};t.StoresWorkItemsHubStore.WorkItemsHubStore=class extends R.Store{constructor(e,t,o,i,s,r=null){super("WorkItemsHubStoreChangedEvent"),this._actionListenerPairs=[],this._filterManager={},this._dataSource={},this._invalidateTabData=(e=>{this._dataSource[e]=void 0,this.emitChanged()}),this._removeWorkItems=(e=>{if(!e)return;let t=!1;for(const o in this._dataSource){const i=this._dataSource[o];i&&(o===e.tabId?t=i.removeWorkItems(e.workItemIds):(this._dataSource[o]=void 0,t=!0))}if(t){const t=this._filterManager[e.tabId];t&&t.dataUpdated(),this.emitChanged()}}),this._addWorkItems=(e=>{const t=this._dataSource[e.tabId];if(e&&t.addWorkItems(e)){const t=this._filterManager[e.tabId];t&&(t.dataUpdated(),this._updateDisplayData(e.tabId))}this.emitChanged()}),this._invalidateAllTabsData=(()=>{this._dataSource={},this.emitChanged()}),this._endRefreshDataProvider=(e=>{this._initializeData(e.tabId,e.tabData),this.emitChanged()}),this._setCompletedItemsVisibility=(e=>{const{showCompletedItems:t,tabId:o}=e;o!==se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted]&&this._setViewOptions(o,e=>e.setCompletedItemsVisibility(t)),this.emitChanged()}),this._sortItems=(e=>{const{tabId:t,sortOptions:o}=e;this._setViewOptions(t,e=>e.setSortInfo(o)),this.emitChanged()}),this._onUpdateFilter=(e=>{this._onUpdateFilterInternal(e)&&this.emitChanged()}),this._pageContext=t;const a=t.getService("ITfsPageService").getData();this._project=a.project,i&&this._setPermissions(i.permission),this._initializeData(o,i,r),s&&s.forEach(e=>{e&&this._initializeData(e.processSettings.tabId,e)}),this._addListenerToActionsHub(e.invalidateAllTabsData,this._invalidateAllTabsData),this._addListenerToActionsHub(e.invalidateTabData,this._invalidateTabData),this._addListenerToActionsHub(e.removeWorkItems,this._removeWorkItems),this._addListenerToActionsHub(e.endRefreshDataProvider,this._endRefreshDataProvider),this._addListenerToActionsHub(e.updateFilter,this._onUpdateFilter),this._addListenerToActionsHub(e.setCompletedItemsVisibility,this._setCompletedItemsVisibility),this._addListenerToActionsHub(e.sortItems,this._sortItems),this._addListenerToActionsHub(e.endPageWorkItems,this._addWorkItems)}getHubFilterDataSource(e){return this._dataSource[e]}getHubDisplayData(e){return this.isHubDataInitialized(e)?this._dataSource[e].getFilteredData():null}getVisibleItemsCount(e){return this.isHubDataInitialized(e)?this._dataSource[e].getVisibleItemsCount():0}getTotalItemsCount(e){return this.isHubDataInitialized(e)?this._dataSource[e].getItemCount():0}isHubDataInitialized(e){return!!this._dataSource[e]}isHubDataError(e){return null===this._dataSource[e]}isSupportedFeature(e){return!this.isHubDataInitialized(e)||this._dataSource[e].isFeatureSupported()}getWorkItemsHubPermission(){return this._permission}getFilterManager(e){return this._filterManager[e]}getHubFilterFields(e){const t=this._dataSource[e],o=this._project.name,i=[{displayType:H.WorkItemFilterFieldType.Text,fieldName:"text",placeholder:te.FilterByKeyword},{displayType:H.WorkItemFilterFieldType.CheckboxList,fieldName:u.CoreFieldRefNames.WorkItemType,placeholder:te.FilterByTypes,noItemsText:te.FilterNoTypes,valueProvider:new P.WorkItemTypeFilterValueProvider(o,t)},{displayType:H.WorkItemFilterFieldType.CheckboxList,fieldName:u.CoreFieldRefNames.State,placeholder:te.FilterByStates,noItemsText:te.FilterNoStates,valueProvider:new P.StateFilterValueProvider(o,t)},{displayType:H.WorkItemFilterFieldType.CheckboxList,fieldName:u.CoreFieldRefNames.Tags,placeholder:te.FilterByTags,noItemsText:te.FilterNoTags,showOrAndOperators:!0}];if(t.hasAreaPath()){const e=[{displayType:H.WorkItemFilterFieldType.CheckboxList,fieldName:u.CoreFieldRefNames.AreaPath,placeholder:te.FilterByAreaPath,noItemsText:te.FilterNoArea,valueProvider:new H.DataSourceFilterValueProvider(u.CoreFieldRefNames.AreaPath,t)}];i.splice(3,0,e[0])}if(0!==(0,a.localeIgnoreCaseComparer)(e,ie.WorkItemsHubTabs[ie.WorkItemsHubTabs.AssignedToMe])){const e=!this._permission.personalView.hasPermission,o=[{displayType:H.WorkItemFilterFieldType.CheckboxList,fieldName:u.CoreFieldRefNames.AssignedTo,placeholder:te.FilterByAssignedTo,valueProvider:new P.AssignedToFilterValueProvider(this._pageContext,t,e)}];i.splice(2,0,o[0])}return i}dispose(){this._actionListenerPairs&&(this._actionListenerPairs.forEach(e=>e.action.removeListener(e.listener)),this._actionListenerPairs=null)}_setPermissions(e){this._permission={personalView:{hasPermission:!1},query:{hasPermission:!1},sendEmail:{hasPermission:!1},newWorkItem:{hasPermission:!1}},e&&(this._permission.personalView.hasPermission=!!e.personalView&&e.personalView.hasPermission,this._permission.query.hasPermission=!!e.query&&e.query.hasPermission,this._permission.sendEmail.hasPermission=!!e.sendEmail&&e.sendEmail.hasPermission,this._permission.newWorkItem.hasPermission=!!e.newWorkItem&&e.newWorkItem.hasPermission)}_setViewOptions(e,t){t(this._dataSource[e]),this._filterManager[e].dataUpdated(),this._updateDisplayData(e)}_addListenerToActionsHub(e,t){this._actionListenerPairs.push({action:e,listener:t}),e.addListener(t)}_initializeData(e,t,o=null){if(!t)return void(this._dataSource[e]=null);if(this._dataSource[e])return void console.warn("Should not reinitialized the data for same tab");if(e!==t.processSettings.tabId)return void console.warn("Provided tabId must match the tab data");let i=!0;i=null==o?t.userSettings&&t.userSettings.showCompleted:o;const s=new be.WorkItemsHubFilterDataSource(this._pageContext,t,this._project.id,i);this._dataSource[e]=s;const r=this._pageContext.getService("IVssPageService").getData(),a=new M.FilterManager(s);this._filterManager[e]=a,a.clearFilterProviders(),(0,F.isFeatureFlagEnabled)(this._pageContext,le.FeatureFlags.UseTokenFiltering,!1)?a.registerFilterProvider(U.TextFilterProvider.PROVIDER_TYPE,new U.TextFilterProviderWithUnassigned):a.registerFilterProvider(U.TextFilterProvider.PROVIDER_TYPE,new U.SubstringTextFilterProvider),a.registerFilterProvider(u.CoreFieldRefNames.WorkItemType,new N.FieldFilterProvider(u.CoreFieldRefNames.WorkItemType)),a.registerFilterProvider(u.CoreFieldRefNames.State,new N.FieldFilterProvider(u.CoreFieldRefNames.State)),a.registerFilterProvider(u.CoreFieldRefNames.AssignedTo,new A.AssignedToFilterProvider(r.user)),a.registerFilterProvider(u.CoreFieldRefNames.AreaPath,new x.AreaPathFilterProvider),a.registerFilterProvider(u.CoreFieldRefNames.Tags,new O.TagsFilterProvider),a.activate(this._pageContext);const n=s.getFilterState();this._onUpdateFilterInternal({tabId:e,updatedFilter:n},!0)}_onUpdateFilterInternal(e,t=!1){const{tabId:o,updatedFilter:i}=e,s=this._filterManager[o];if(s){const e=i;return t?this._dataSource[o].setFilters(e):this._dataSource[o].saveFilters(e),s.setFilters(e),this._updateDisplayData(o,t),!0}return!1}_updateDisplayData(e,t=!1){const o=this._dataSource[e],i=this._filterManager[e];if(i)if(i.isFiltering()){const e=i.filter(this._pageContext);o.setVisibleIds(e)}else{const e=!t;o.resetFilter(e)}e===se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted]||o.shouldShowCompletedItems()||o.hideCompletedItems()}}}(),function(e){Pe=t.DataProvidersWorkItemsHubCommandProvider={};class o{constructor(e,t,i,s){this._pageContext=e,this._store=t,this._hubViewState=i,this._actionCreator=s,this._openFilteredInQueriesAction={key:o.openQueryCommandKey,name:te.OpenFilteredInQueriesCommand,important:!0,iconProps:{iconName:"bowtie-arrow-open",iconType:1},onClick:()=>{this._onOpenQueryClick(this._pageContext)}},this._openInQueriesAction={key:o.openQueryCommandKey,name:te.OpenInQueriesCommand,important:!0,iconProps:{iconName:"bowtie-arrow-open",iconType:1},onClick:()=>{this._onOpenQueryClick(this._pageContext)}},this._importWorkItemsAction={key:o.importWorkItemsCommandKey,name:te.ImportWorkItems,important:!0,iconProps:{iconName:"Upload",iconType:0},onClick:()=>{this._onImportWorkItemsClick(this._pageContext)}},this._recycleBinAction={key:o.recycleBinCommandKey,name:te.RecycleBin,important:!0,iconProps:{iconName:"bowtie-recycle-bin",iconType:1},onClick:()=>{this._onRecycleBinClick(this._pageContext)}},this._tabContentData=null,this._deleteCommandHelper=null,this._columnOptionsPanelLauncher=null,this._onColumnOptionsClick=(()=>{ae.UsageTelemetryHelper.publishColumnOptionsCommand(this._pageContext,this._getSelectedTabId());const e=this.getHubFilterDataSource(),t=this._getSelectedTabId(),o=e.getCurrentColumnOptions(),i=e.getSortOptions(),s=e.getCurrentColumnSettingsVersion();this._columnOptionsPanelLauncher.openColumnOptionPanel(t,o,i,s)}),this._onImportWorkItemsClick=(e=>{ae.UsageTelemetryHelper.publishImportWorkItemsCommand(e,this._getSelectedTabId());const t=e.getService("ITfsPageService").getData().project.name;window.open(de.getImportWorkItemsUrl(e,t))}),this._onRecycleBinClick=(e=>{ae.UsageTelemetryHelper.publishRecycleBinCommand(e,this._getSelectedTabId());const t=e.getService("ITfsPageService").getData().project.name;window.open(de.getRecycleBinUrl(e,t))}),this._onOpenQueryClick=(e=>{const t=this.getHubFilterDataSource(),o=e.getService("ITfsPageService").getData().project.name;ue.openInQueries(e,o,this._getSelectedTabId(),t)}),this._onOpenSelectedInQueryClick=(e=>{const t=this.getHubFilterDataSource(),o=e.getService("ITfsPageService").getData().project.name;ue.openInQueries(e,o,this._getSelectedTabId(),t,this._tabContentData.selectionIds)}),this._onAddNewItem=((e,t,o,i)=>{const s=e.getService("work-item-service"),r=this._getSelectedTabId();e.getService("IWorkItemsHubNavDataService").setNavigationData({tabId:r}),s.createWorkItem(o.key,0),t.preventDefault(),t.stopPropagation()}),this._onEmailWorkItemsClick=(e=>{const t=this._tabContentData.selectionIds;if(0===t.length)return;const o=this.getHubFilterDataSource(),i=o.getDisplayedFieldReferenceNames();let s;if(1===t.length){const e=t[0];s=`${t[0]} - ${o.getValue(e,u.CoreFieldRefNames.Title)}`}Fe.WorkItemsHubReportUtils.openSendEmailDialog(e,i,t,s),ae.UsageTelemetryHelper.publishEmailTelemetry(e,this._getSelectedTabId())}),this._columnOptionsAction={key:o.columnOptionsCommandKey,name:te.ColumnOptions,important:!0,iconProps:{iconName:"Repair"},onClick:this._onColumnOptionsClick},this._deleteCommandHelper=new we.WorkItemsHubDeleteHelper(e,s),this._addNewWorkItemPrimary=ye.PivotBarActionHelper.getNewWorkItemPivotBarAction(this._pageContext,{addNewItem:this._onAddNewItem,important:!0}),this._columnOptionsPanelLauncher=new Se.ColumnOptionsPanelLauncher(s,e)}setTabData(e){this._tabContentData=e}getCommands(e,t){if(!e)return[];const{hasFilter:o}=this._tabContentData,i=[];if(e.newWorkItem.hasPermission&&i.push(this._addNewWorkItemPrimary),e.query.hasPermission){if(t){const e=o?this._openFilteredInQueriesAction:this._openInQueriesAction;i.push(e),i.push(this._columnOptionsAction)}(0,F.isFeatureFlagEnabled)(this._pageContext,"WebAccess.WorkItemTracking.EnableCSVImport",!1)&&i.push(this._importWorkItemsAction),i.push(this._recycleBinAction)}return i}getContextMenuItems(e,t,i){const s=this._tabContentData.selectionIds?[...this._tabContentData.selectionIds]:[];if(0===s.length)return;const r=[];t.query.hasPermission&&r.push({name:te.OpenSelectionInQueriesCommand,key:o.openQueryCommandKey,onClick:()=>{this._onOpenSelectedInQueryClick(e)},iconProps:{className:"bowtie-icon bowtie-arrow-open"}}),r.push({name:te.CopyToClipboard,key:o.copyToClipboardCommandKey,title:te.CommandBarTitle_CopyWorkItems,onClick:(t,o)=>{this.copyWorkItemsToClipboard(e,!1,t,o&&o.data)},data:i,iconProps:{className:"bowtie-icon bowtie-edit-copy"}}),t.sendEmail.hasPermission&&r.push({name:te.EmailSelectedWorkItems,key:o.emailCommandKey,onClick:()=>{this._onEmailWorkItemsClick(e)},iconProps:{className:"bowtie-icon bowtie-mail-message"}});const a=this.getHubFilterDataSource();return this.getDeleteHelper().shouldShowDeleteCommand(a,s)&&r.push({name:te.DeleteSelectedWorkItems,key:o.deleteCommandKey,title:te.CommandBarTitle_DeleteWorkItems,onClick:()=>{this.deleteWorkItems(e,!1)},iconProps:{className:"bowtie-icon bowtie-trash"}}),r}copyWorkItemsToClipboard(e,t,o,i){if(0===this._tabContentData.selectionIds.length)return;const s=this.getHubFilterDataSource(),r=s.getFilteredData(),a=s.getDisplayedFieldReferenceNames(),n=a.map(e=>(0,Ce.getFieldFriendlyName)(e,r.processSettings)),l=s.getFieldValues(this._tabContentData.selectionIds,a);Fe.WorkItemsHubReportUtils.copyWorkItemsToClipboard(a,n,l,e,o,i),ae.UsageTelemetryHelper.publishCopyToClipboardTelemetry(e,this._getSelectedTabId(),t)}deleteWorkItems(e,t){const o=this._tabContentData.selectionIds,i=this.getDeleteHelper(),s=this.getHubFilterDataSource();if(i.shouldShowDeleteCommand(s,o)){const s=this._getSelectedTabId();i.deleteWorkItems(e,s,o),ae.UsageTelemetryHelper.publishDeleteTelemetry(e,s,t)}}getDeleteHelper(){return this._deleteCommandHelper}getHubFilterDataSource(){return this._store.getHubFilterDataSource(this._getSelectedTabId())}_getSelectedTabId(){return this._hubViewState.selectedPivot.value.toLowerCase()}}t.DataProvidersWorkItemsHubCommandProvider.WorkItemsHubCommandProvider=o,o.columnOptionsCommandKey="column-options",o.recycleBinCommandKey="recycle-bin",o.importWorkItemsCommandKey="import-workitems",o.openQueryCommandKey="open-in-queries",o.copyToClipboardCommandKey="copy-to-clipboard",o.emailCommandKey="email",o.deleteCommandKey="delete"}(),t.UtilsCommon={},function(e){He=t.UtilsWorkItemsXhrNavigationUtils={},t.UtilsWorkItemsXhrNavigationUtils.navigateToNewWorkItemForm=function(e,t,o){(0,E.FastPageSwitch)(e,de.getCreateWorkItemUrl(e,t,o),!0)},t.UtilsWorkItemsXhrNavigationUtils.navigateToWorkEditWorkItemForm=function(e,t,o,i){const s=de.getEditWorkItemUrl(e,t,o);return(0,E.onClickFPS)(e,s,!0,i)}}(),t.UtilsWorkItemTempQueryUtils={},(t.UtilsWorkItemTempQueryUtils.WorkItemTempQueryUtils||(t.UtilsWorkItemTempQueryUtils.WorkItemTempQueryUtils={})).createTempQueryUrl=function(e,t,o){return(0,de.getQueriesHubUrl)(e,t,o)},function(e){Ae=t.ComponentsWorkItemsTabFilter={};t.ComponentsWorkItemsTabFilter.WorkItemsTabFilter=class extends L.VssComponent{constructor(){super(...arguments),this._onStoreChange=(()=>{const e=this.getState();this.setState(e)}),this._resolveWorkItemFilter=(e=>{this._workItemFilter=e}),this.onFilterContentChanged=(()=>{this._workItemFilter&&this._workItemFilter.update()})}componentDidMount(){super.componentDidMount(),this.getStore().addChangedListener(this._onStoreChange),this._filterManager=this.getFilterManager(),this._filterManager&&this._filterManager.attachEvent(M.FilterManager.EVENT_DATA_UPDATED,this.onFilterContentChanged)}componentWillUnmount(){super.componentWillUnmount(),this.getStore().removeChangedListener(this._onStoreChange),this._filterManager&&this._filterManager.detachEvent(M.FilterManager.EVENT_DATA_UPDATED,this.onFilterContentChanged)}render(){const e=this.getStore(),t=this.props.tabId;return e.isHubDataInitialized(t)?r.createElement("div",{className:(0,V.css)("work-items-tab-filter-control",this.props.className)},this._renderFilterControl()):null}focusFilterBar(){this._workItemFilter&&this._workItemFilter.focus()}_renderFilterControl(){const{filter:e,tabId:t,onDismissClicked:o}=this.props;return r.createElement(H.WorkItemFilter,{key:t,pageContext:this.context.pageContext,fields:this.props.store.getHubFilterFields(t),dataSource:this.props.store.getHubFilterDataSource(t),filter:e,setDefaultFilter:!1,ref:this._resolveWorkItemFilter,onDismissClicked:o})}getState(){return{}}getStore(){return this.props.store}getFilterManager(){return this.props.store.getFilterManager(this.props.tabId)}}}(),function(e){Ne=t.ComponentsWorkItemsHubView={};t.ComponentsWorkItemsHubView.WorkItemsHubView=class extends L.VssComponent{constructor(e,t){super(e,t),this._resolveWorkItemsTabFilter=(e=>{this._workItemsTabFilter=e,e?this._focusFilterBarOnMount&&(this._focusFilterBarOnMount=!1,this._workItemsTabFilter.focusFilterBar()):this._focusFilterBarOnMount=!0}),this._pivotProvider=new B.ContributedPivotBarItemProvider({pageContext:this.props.pageContext,tabGroupIds:[le.WorkItemsHubTabGroupContributionId]})}render(){const{hubViewState:e,viewActions:t,commands:o,store:i}=this.props;return r.createElement(Z.Hub,{className:"work-items-hub-view flex-grow",hubViewState:e,commands:o,viewActions:t,pivotProviders:[this._pivotProvider],pivotRenderingModeOptions:this._getPivotRenderingModeOptions(),onRenderFilterBar:()=>r.createElement(Ae.WorkItemsTabFilter,{filter:e.filter,tabId:e.selectedPivot.value.toLowerCase(),store:i,ref:this._resolveWorkItemsTabFilter})},r.createElement(G.HubHeader,{title:te.WorkItemsHubTitle}))}activateFilter(){this.props.hubViewState.viewOptions.setViewOption(j.HubViewOptionKeys.showFilterBar,!0),this._workItemsTabFilter?this._workItemsTabFilter.focusFilterBar():this._focusFilterBarOnMount=!0}_getPivotRenderingModeOptions(){return{mode:1,props:{dropdownWidth:180}}}toggleFullScreen(){const e=this.props.hubViewState.viewOptions.getViewOption(j.HubViewOptionKeys.fullScreen);this.props.hubViewState.viewOptions.setViewOption(j.HubViewOptionKeys.fullScreen,!e)}}}(),function(e){xe=t.WorkItemsHubShortcutGroup={};t.WorkItemsHubShortcutGroup.WorkItemsHubShortcutGroup=class{constructor(e,t){this._commandProvider=null,this._workItemsHubView=null,this._commandProvider=e,this._workItemsHubView=t}ReRegisterWorkItemsHubShortcuts(e){const t=e.getService("IVssKeyboardShortcutService");t.registerShortcut(te.KeyboardShortcutGroup_Work,{combos:["z"],description:te.KeyboardShortcutDescription_ToggleFullScreen,action:()=>{this._workItemsHubView.toggleFullScreen()}}),t.registerShortcut(te.WorkItemsHubTitle,{combos:["mod+shift+f"],description:te.FilterResults,action:()=>{this._workItemsHubView.activateFilter()}}),t.registerShortcut(te.WorkItemsHubTitle,{combos:["mod+c"],description:te.CopyToClipboard,element:".region-page",action:()=>{this._commandProvider.copyWorkItemsToClipboard(e,!0)}}),this._commandProvider.getDeleteHelper().hasDeletePermission()&&t.registerShortcut(te.WorkItemsHubTitle,{combos:["del"],description:te.DeleteSelectedWorkItems,element:".work-items-tab-content",action:()=>{this._commandProvider.deleteWorkItems(e,!0)}})}}}(),function(e){Me=t[e]={},function(e){e.SomethingWrongOnServer="ms.vss-work-web/new-work-items-hub-content/Illustrations/general-something-wrong-on-server.svg"}(t[e].GeneralZeroDataIllustrationPaths||(t[e].GeneralZeroDataIllustrationPaths={})),function(e){e.GetBackToRecentWork="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-get-back-to-recent-work.svg",e.KeepAnEyeOnImportantWork="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-keep-an-eye-on-important-work.svg",e.MentionSomeone="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-mention-someone.svg",e.YourWorkInOnePlace="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-your-work-in-one-place.svg",e.GeneralNoResultsFound="ms.vss-work-web/new-work-items-hub-content/Illustrations/general-no-results-found.svg"}(t[e].WorkZeroDataIllustrationPaths||(t[e].WorkZeroDataIllustrationPaths={})),function(e){e.YouDontHavePermission="ms.vss-work-web/new-work-items-hub-content/Illustrations/widget-you-dont-have-permission.svg"}(t[e].WorkWidgetIllustrationPaths||(t[e].WorkWidgetIllustrationPaths={}))}("ZeroDataIllustrationUrlUtils"),function(e){Oe=t[e]={},t[e].createForAssignedToMe=function(e,t=null){const o={primaryText:te.ZeroData_AssignedToMe_PrimaryMessage,secondaryText:te.ZeroData_AssignedToMe_SecondaryMessage,actionHref:t?t.href:te.ZeroData_AssignedToMe_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.YourWorkInOnePlace),imageAltText:te.Illustrations_YourWorkInOnePlaceAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForFollowing=function(e,t=null){const o=te.ZeroData_Following_SecondaryMessageFormat.split("{0}"),i={primaryText:te.ZeroData_Following_PrimaryMessage,secondaryText:r.createElement("span",null,o[0],r.createElement("span",{className:"bowtie-icon bowtie-watch-eye"}),o[1]),actionHref:t?t.href:te.ZeroData_Following_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_Following_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:te.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(K.ZeroData,Object.assign({},i))},t[e].createForFollowingNotconfigured=function(e,t=null){const o={primaryText:te.ZeroData_Following_NotConfigured_PrimaryMessage,secondaryText:te.ZeroData_Following_NotConfigured_SecondaryMessage,actionHref:t?t.href:te.ZeroData_Following_NotConfigured_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_Following_NotConfigured_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:te.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForMyActivity=function(e,t=null){const o={primaryText:te.ZeroData_MyActivity_PrimaryMessage,secondaryText:te.ZeroData_MyActivity_SecondaryMessage,actionHref:t?t.href:te.ZeroData_MyActivity_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:te.Illustrations_GetBackToRecentWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForMentioned=function(e,t=null){const o={primaryText:te.ZeroData_Mentioned_PrimaryMessage,secondaryText:te.ZeroData_Mentioned_SecondaryMessage,actionHref:t?t.href:te.ZeroData_Mentioned_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_Mentioned_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.MentionSomeone),imageAltText:te.Illustrations_MentionSomeoneAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForRecentlyCreated=function(e,t=null){const o={primaryText:te.ZeroData_RecentlyCreated_PrimaryMessage,secondaryText:te.ZeroData_RecentlyCreated_SecondaryMessage,actionHref:t?t.href:te.ZeroData_RecentlyCreated_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:te.Illustrations_GetBackToRecentWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForRecentlyCompleted=function(e,t=null){const o={primaryText:te.ZeroData_RecentlyCompleted_PrimaryMessage,secondaryText:te.ZeroData_RecentlyCompleted_SecondaryMessage,actionHref:t?t.href:te.ZeroData_RecentlyCompleted_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:te.Illustrations_GetBackToRecentWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForRecentlyUpdated=function(e,t=null){const o={primaryText:te.ZeroData_RecentlyUpdated_PrimaryMessage,secondaryText:te.ZeroData_RecentlyUpdated_SecondaryMessage,actionHref:t?t.href:te.ZeroData_RecentlyUpdated_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:te.Illustrations_GetBackToRecentWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForMyTeams=function(e,t=null){const o={primaryText:te.ZeroData_MyTeams_PrimaryMessage,secondaryText:te.ZeroData_MyTeams_SecondaryMessage,actionHref:t?t.href:te.ZeroData_MyTeams_SecondaryMessageLinkUrl,actionText:t?t.linkText:te.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:te.Illustrations_GetBackToRecentWorkAltText};return r.createElement(K.ZeroData,Object.assign({},o))},t[e].createForMyTeamsNotconfigured=function(e){const t={primaryText:te.ZeroData_MyTeams_NotConfigured_PrimaryMessage,secondaryText:te.ZeroData_MyTeams_NotConfigured_SecondaryMessage,imagePath:(0,n.getAssetLocation)(e,Me.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:te.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(K.ZeroData,Object.assign({},t))},t[e].createForServerError=function(e){return r.createElement(K.ZeroData,{primaryText:te.ZeroData_ServerError_PrimaryText,secondaryText:e,imagePath:"",imageAltText:te.Illustrations_SomethingWrongOnServerAltText})}}("ZeroDataWorkItemTrackingZeroDataUtils"),function(e){Ue=t.ZeroDataGenericFilterZeroData={};t.ZeroDataGenericFilterZeroData.GenericFilterZeroData=class extends r.Component{render(){return r.createElement(K.ZeroData,{imagePath:(0,n.getAssetLocation)(this.props.pageContext,Me.WorkZeroDataIllustrationPaths.GeneralNoResultsFound),imageAltText:"",primaryText:(0,a.format)(te.GenericFilterZeroData_Message,this.props.artifactName)})}}}(),Ee=t.ZeroDataZeroDataFactory={},function(e){const t={[ie.WorkItemsHubTabs.AssignedToMe]:e=>Oe.createForAssignedToMe(e),[ie.WorkItemsHubTabs.MyActivity]:e=>Oe.createForMyActivity(e),[ie.WorkItemsHubTabs.RecentlyUpdated]:e=>Oe.createForRecentlyUpdated(e),[ie.WorkItemsHubTabs.Following]:(e,t)=>t?Oe.createForFollowing(e):Oe.createForFollowingNotconfigured(e),[ie.WorkItemsHubTabs.Mentioned]:e=>Oe.createForMentioned(e),[ie.WorkItemsHubTabs.RecentlyCreated]:e=>Oe.createForRecentlyCreated(e),[ie.WorkItemsHubTabs.RecentlyCompleted]:e=>Oe.createForRecentlyCompleted(e),[ie.WorkItemsHubTabs.MyTeams]:(e,t)=>t?Oe.createForMyTeams(e):Oe.createForMyTeamsNotconfigured(e)};e.createForEmptyData=function(e,o,i=!1,s){if(i)return r.createElement(Ue.GenericFilterZeroData,{artifactName:te.ZeroData_Filter_WorkItems_ArtifactName,pageContext:s});const a=t[se.TabEnumValueByTabIdMap[e]];return a?a(s,o):null},e.createForMissingTabData=function(e){return r.createElement(K.ZeroData,{primaryText:te.UnableToLoadHubData,imagePath:(0,n.getAssetLocation)(e,Me.GeneralZeroDataIllustrationPaths.SomethingWrongOnServer),imageAltText:te.Illustrations_SomethingWrongOnServerAltText})},e.createForServerError=Oe.createForServerError}(t.ZeroDataZeroDataFactory.ZeroDataFactory||(t.ZeroDataZeroDataFactory.ZeroDataFactory={})),function(e){Ve=t.WorkItemsHubViewProvider={};const o="show-completed-items",i=["filterText","viewOption"];class s extends L.VssComponent{constructor(e,t){super(e,t),this.isCompatUrl=!1;const o=this.context.pageContext.getService("ITfsPageService").getData().project,i=(0,de.getCurrentHashString)();if(i){const e=(0,de.deserializeState)(i),t=e[le.ActionParameters.ID],s=e[le.ActionUrl.ACTION];t&&s&&a.equals(s,le.ActionUrl.ACTION_EDIT,!0)&&(ae.UsageTelemetryHelper.publishBackCompatUrlOpenWorkItem(this.context.pageContext,i),window.location.href=(0,de.getEditWorkItemUrl)(this.context.pageContext,o.name,t),this.isCompatUrl=!0),s&&a.equals(s,le.ActionUrl.ACTION_QUERY,!0)&&(ae.UsageTelemetryHelper.publishBackCompatUrlQuery(this.context.pageContext,i),window.location.href=(0,de.getQueriesHubUrl)(this.context.pageContext,o.name,i),this.isCompatUrl=!0)}}render(){return this.isCompatUrl?null:r.createElement(n,null)}}t.WorkItemsHubViewProvider.WorkItemsHubViewComponent=s;class n extends L.VssComponent{constructor(e,t){super(e,t),this._onPivotChanging=(e=>{ae.PerformanceTelemetryHelper.getInstance(this.context.pageContext).startTabSwitch(),n.hubViewState.viewOptions.setViewOption(ie.WorkItemsHubRouteConstants.TabRouteParameterName,e),Te.updateRecentTabId(this.context.pageContext,this._project.id,e)}),this._onViewOptionsChanged=((e,t)=>{const{selectedPivot:i}=n.hubViewState,s=i.value,r=n.getStore();if(!r.getHubDisplayData(s))return null;if(e.hasOwnProperty(o)&&s!==se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted]){const{pageContext:t}=this.context,i=e[o],a=n.getActionsCreator(),l=r.getHubFilterDataSource(s).isCompletedItemsLoaded();a.setCompletedItemsVisibility(s,i),Te.updateShowCompletedForTab(this.context.pageContext,this._project.id,s,i).then(()=>{i&&!l&&(a.invalidateTabData(s),a.refreshDataProviderAsync(s))}),ae.UsageTelemetryHelper.publishCompletedWorkItemsViewOptionTelemetry(t,s,i)}}),this.resolveWorkItemsHubView=(e=>{e&&(this._workItemsHubShortcutGroup=new xe.WorkItemsHubShortcutGroup(n.getWorkItemsHubCommandProvider(),e),this._workItemsHubShortcutGroup.ReRegisterWorkItemsHubShortcuts(this.context.pageContext))}),n.mountCount++;const s=t.pageContext.getService("IVssHistoryService");let r=s.getState();const{filterText:a,viewOption:l}=r;(a||l)&&(i.forEach(e=>r[e]=void 0),s.replaceState(r));const c=this.context.pageContext.getService("ITfsPageService").getData();this._project=c.project,this._initializeFlux(l),this._initView(),null!=a&&n.actionsCreator.updateFilterState(this._initialTabId,{text:{values:[a]}}),ae.PerformanceTelemetryHelper.getInstance(this.context.pageContext).startPageLoad(),ae.UsageTelemetryHelper.publishLoadWorkItemsHub(this.context.pageContext,this._initialTabId)}_initializeFlux(e){const t=new oe.ActionsHub,o=re.WorkItemsHubDataProvider.getDataForCurrentTab(this.context.pageContext),i=o?o.processSettings.tabId:se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.AssignedToMe];this._setInitialViewAction(i);let s=null;e&&(a.equals(e,"showCompleted",!0)?s=!0:a.equals(e,"hideCompleted",!0)&&(s=!1),null!=s&&o&&o.userSettings&&o.userSettings.showCompleted!==s&&Te.updateShowCompletedForTab(this.context.pageContext,this._project.id,this._initialTabId,s)),n.store=new Re.WorkItemsHubStore(t,this.context.pageContext,this._initialTabId,o,null,s),n.actionsCreator=new ne.ActionsCreator(this.context.pageContext,t)}_initView(){n.hubViewState=new z.VssHubViewState(this.context.pageContext,{defaultPivot:this._initialTabId,pivotNavigationParamName:ie.WorkItemsHubRouteConstants.TabRouteParameterName,viewOptionNavigationParameters:[{key:j.HubViewOptionKeys.showFilterBar,behavior:0}]}),n.hubViewState.viewOptions.setViewOption(j.HubViewOptionKeys.showFilterBar,!0),n.hubViewState.viewOptions.setViewOption(ie.WorkItemsHubRouteConstants.TabRouteParameterName,this._initialTabId),n.setViewOptions(this._initialTabId),n.workItemsHubCommandProvider=new Pe.WorkItemsHubCommandProvider(this.context.pageContext,n.getStore(),n.hubViewState,n.getActionsCreator()),n.observableCommands=this._getObservableCommands({selectionIds:[],hasFilter:!1,tabId:this._initialTabId}),n.viewActions=n.getHubViewActions(this._initialTabId),n.observableViewActions=new q.ObservableArray([...n.viewActions]),n.hubViewState.subscribe(this._onPivotChanging,j.HubViewStateEventNames.pivotChanging),n.hubViewState.viewOptions.subscribe(this._onViewOptionsChanged,Q.VIEW_OPTIONS_CHANGE_EVENT)}static getHubViewActions(e){if(!n.getStore().getHubDisplayData(e))return[];let t=n.viewActionCache[e];if(n.viewActionCache[e])return t;t=n.viewActionCache[e]=[];const i=e===se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted];return t.push({key:o,name:te.CompletedItemsViewOptionName,actionType:1,important:!1,actionProps:{onText:te.CompletedItemsShown,offText:te.CompletedItemsHidden,onAriaLabel:a.format(te.CompletedWorkItemsToggleLabel,te.CompletedWorkItemsOnText),offAriaLabel:a.format(te.CompletedWorkItemsToggleLabel,te.CompletedWorkItemsOffText)},disabled:i}),t}_setInitialViewAction(e){const t=this.context.pageContext.getService("IVssHistoryService"),o=t.getState(),i=o[ie.WorkItemsHubRouteConstants.TabRouteParameterName];i&&null!==se.getTabIdByName(i)?this._initialTabId=se.getTabIdByName(i):(o[ie.WorkItemsHubRouteConstants.TabRouteParameterName]=e,t.replaceState(o),this._initialTabId=e)}componentWillUnmount(){super.componentWillUnmount(),n.hubViewState&&(n.hubViewState.unsubscribe(this._onPivotChanging),n.hubViewState.viewOptions.unsubscribe(this._onViewOptionsChanged,Q.VIEW_OPTIONS_CHANGE_EVENT)),n.mountCount--,0==n.mountCount&&(n.hubViewState&&(n.hubViewState.dispose(),n.hubViewState=null),n.store&&(n.store.dispose(),n.store=null))}static setViewOptions(e){const t=n.getStore();if(!t.isHubDataInitialized(e))return;const{viewOptions:i}=n.hubViewState,s=i.getViewOptions(),r=t.getHubFilterDataSource(e),a=e===se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.RecentlyCompleted]||r.shouldShowCompletedItems();s[o]=a,i.setViewOptions(s,!0)}_getObservableCommands(e){const{tabId:t}=e;n.workItemsHubCommandProvider.setTabData(e);const o=n.getStore();return new q.ObservableArray(n.workItemsHubCommandProvider.getCommands(o.getWorkItemsHubPermission(),o.isSupportedFeature(t)))}render(){return r.createElement(Ne.WorkItemsHubView,{pageContext:this.context.pageContext,hubViewState:n.hubViewState,store:n.getStore(),actionsCreator:n.getActionsCreator(),commands:n.observableCommands,viewActions:n.observableViewActions,ref:this.resolveWorkItemsHubView})}static getStore(){return n.store}static getActionsCreator(){return n.actionsCreator}static getHubViewState(){return n.hubViewState}static getWorkItemsHubCommandProvider(){return n.workItemsHubCommandProvider}static updateCommandsActionsAndViewOptions(e){const t=n.store,o=n.workItemsHubCommandProvider.getCommands(t.getWorkItemsHubPermission(),t.isSupportedFeature(e));(0,ce.shallowEquals)(n.observableCommands.value,o)||(n.observableCommands.value=o);const i=n.getHubViewActions(e);(0,ce.shallowEquals)(n.observableViewActions.value,i)||(n.observableViewActions.value=i),n.setViewOptions(e)}}t.WorkItemsHubViewProvider.WorkItemsHubViewProvider=n,n.mountCount=0,n.viewActionCache={},L.VssComponent.register("work-items-hub-view-component",s)}(),function(e){t.ComponentsWorkItemsTabContent={};class o extends L.VssComponent{constructor(e,t){super(e,t),this._selectedIds=[],this._telemetrySent=!1,this._recreateColumns=!1,this._isDataCached=!1,this._onColumnClick=((e,t)=>{const o=e.shiftKey;let i;const s=t.key,r=this.getStore().getHubFilterDataSource(this.props.tabId);if(!r.isSortableField(s))return;const a=r.getSortOptions(),n=a.findIndex(e=>e.fieldReferenceName===s);if(o)i=a.slice(),n<0?i.push({fieldReferenceName:s,isAscending:!0}):i[n].isAscending=!a[n].isAscending;else{const e=n<0||!a[n].isAscending;i=[{fieldReferenceName:s,isAscending:e}]}this._actionsCreator.sortColumn(this.props.tabId,i);const l=r.getCurrentColumnOptions();ae.UsageTelemetryHelper.publishColumnHeaderClick(this.context.pageContext,this.props.tabId,{sortedColumnCount:i.length,sortedColumns:i.map(e=>e.fieldReferenceName).join(),sortedOrder:i.map(e=>e.isAscending).join()});const c=r.getCurrentColumnSettingsVersion(),m=this.context.pageContext.getService("ITfsPageService").getData().project.id;(0,Te.updateColumnSettings)(this.context.pageContext,m,this.props.tabId,l,i,c),this._recreateColumns=!0}),this._onColumnResize=((e,t)=>{const o=e.key,i=this._store.getHubFilterDataSource(this.props.tabId),s=i.getCurrentColumnOptions(),r=i.getSortOptions();t=Math.ceil(t),s.forEach(e=>{a.equals(e.fieldReferenceName,o,!0)&&(e.width=t)}),ae.UsageTelemetryHelper.publishColumnResize(this.context.pageContext,this.props.tabId,{columnName:o,width:t});const n=i.getCurrentColumnSettingsVersion(),l=this.context.pageContext.getService("ITfsPageService").getData().project.id;(0,Te.updateColumnSettings)(this.context.pageContext,l,this.props.tabId,s,r,n)}),this._onDetailsListRef=(e=>{this._vssDetailsList=e}),this._handleNavigateToEdit=(e=>this._onOpenWorkItem(e.id)),this._onOpenWorkItem=((e,t)=>{if(!t){const t=this._initTriageData(e);return void He.navigateToWorkEditWorkItemForm(this.context.pageContext,this._project.name,t)}const o=this._initTriageData(e,!0);He.navigateToWorkEditWorkItemForm(this.context.pageContext,this._project.name,o,t)&&(t.preventDefault(),t.stopPropagation())}),this._getPageHeight=(()=>o.ItemHeight*this._getItemCountForPage()),this._getItemCountForPage=(()=>o.DetailsListPageSize),this._onRenderRow=(e=>r.createElement(d.DetailsRow,Object.assign({},e,{className:le.TabContent_WorkItemsHubGridRowClassName,"data-item-key":e.item.key}))),this._onRowDidMount=(()=>{if(!this._vssDetailsList||!this._vssDetailsList.detailsList||!this.state.selection||-1===this._initialSelectedIndex)return;this._tryEndPerformanceScenario();const{selection:e}=this.state,t=this._initialSelectedIndex;this._trySetEffectiveScrollPosition(t)||this._vssDetailsList.detailsList.scrollToIndex(t),requestAnimationFrame(()=>e.setIndexSelected(t,!0,!0)),this._initialSelectedIndex=-1}),this._fetchMoreItems=(()=>{const{tabId:e}=this.props,t=this._store.getHubFilterDataSource(e);t.canPageMoreItems()&&this._actionsCreator.pageWorkItems(e,t)}),this._loadLegacyEventHandlers=(()=>{const e=this.context.pageContext.getService("ILegacyPlatformService");this._workItemEventHandler||e.requireModules(["WorkItemsHub/Scripts/LegacyPlatform/LegacyWorkItemEventHandler"]).then(([e])=>{this._workItemEventHandler=new e.LegacyWorkItemEventHandler({onSave:this._onSave,onDelete:this._onDelete,onFollowsStateChanged:this._onFollowsStateChanged})})}),this._onSave=(()=>{const e=re.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);this._actionsCreator.refreshDataProviderAsync(e,!0)}),this._onDelete=(e=>{const t=re.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);this._actionsCreator.removeWorkItemFromDataProvider(t,[e])}),this._onFollowsStateChanged=(()=>{const e=se.TabIdByTabEnumValueMap[ie.WorkItemsHubTabs.Following],t=re.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);t===e?this._actionsCreator.refreshDataProviderAsync(t,!0):this._actionsCreator.invalidateTabData(e)}),this._filterChanged=(()=>{const{tabId:e}=this.props;this._actionsCreator.updateFilterState(e,(0,H.mapToFilterState)(this._filter.getState())),this._onTabContentChanged()}),this._onStoreChange=(()=>{const e=this.getState();this.setState(e)}),this._onTabContentChanged=(()=>{const{selection:e}=this.state,{tabId:t}=this.props,o=e.getSelection().map(e=>e.id),i=this.getStore(),s=i.getHubFilterDataSource(t),r={selectionIds:o,hasFilter:!!s&&s.hasFilter(),tabId:t};this._lastContentData=r,this._workItemsHubCommandProvider.setTabData(r),i&&Ve.WorkItemsHubViewProvider.updateCommandsActionsAndViewOptions(t)}),this._store=Ve.WorkItemsHubViewProvider.getStore(),this._actionsCreator=Ve.WorkItemsHubViewProvider.getActionsCreator(),this._filter=Ve.WorkItemsHubViewProvider.getHubViewState().filter,this._workItemsHubCommandProvider=Ve.WorkItemsHubViewProvider.getWorkItemsHubCommandProvider(),this._gridColumnFactory=new Ie.WorkItemsGridColumnFactory,this._perfTelemetryHelper=ae.PerformanceTelemetryHelper.getInstance(this.context.pageContext);const i=this.context.pageContext.getService("ITfsPageService").getData();this._project=i.project,this._timerManagement=new Y.TimerManagement(this),this._delayedOnColumnResize=this._timerManagement.debounce(this._onColumnResize,o.ColumnResizeDefaultDelayTimeInMilliseconds,{leading:!1,trailing:!0}),this.state=this.getState()}render(){const{initialized:e,totalItemCount:t,visibleItemCount:o,gridData:i,isError:s,isSupportedFeature:n,isFiltered:l}=this.state,{tabId:c}=this.props;let m;return s?m=Ee.ZeroDataFactory.createForMissingTabData(this.context.pageContext):e?0===o?(l&&(0,w.announce)(a.format(te.MultipleWorkItemsFiltered,o)),m=Ee.ZeroDataFactory.createForEmptyData(c,n,t>0,this.context.pageContext)):(l&&(0,w.announce)(1==o?a.format(te.SingleWorkItemFiltered,o):a.format(te.MultipleWorkItemsFiltered,o)),m=r.createElement("div",{role:"navigation","aria-label":te.WorkItemsHubGridLandmarkLabel},this._buildDetailList(i))):m=r.createElement(J.Spinner,{size:"large",className:"work-items-hub-spinner",label:te.Loading}),r.createElement("div",{className:le.TabContent_BaseClassName},m)}_buildDetailList(e){const{columns:t,selection:o,isFiltered:i}=this.state;return r.createElement(X.VssDetailsList,{className:(0,V.css)(le.TabContent_WorkItemsHubDetailsListClassName,`${this.props.tabId}-grid`),usePresentationStyles:!0,items:e,columns:t,isHeaderVisible:!0,ariaLabelForSelectionColumn:te.SelectAllAriaLabel,onColumnHeaderClick:this._onColumnClick,onColumnResize:this._delayedOnColumnResize,constrainMode:d.ConstrainMode.unconstrained,selectionMode:d.SelectionMode.multiple,checkboxVisibility:d.CheckboxVisibility.onHover,checkButtonAriaLabel:te.CheckButtonLabel,actionsColumnKey:u.CoreFieldRefNames.Title,getMenuItems:e=>this._workItemsHubCommandProvider.getContextMenuItems(this.context.pageContext,this._store.getWorkItemsHubPermission(),e),layoutMode:d.DetailsListLayoutMode.fixedColumns,selection:o,onItemInvoked:this._handleNavigateToEdit,listProps:{getPageHeight:this._getPageHeight,getItemCountForPage:this._getItemCountForPage,renderedWindowsAhead:i?0:void 0,renderedWindowsBehind:i?0:void 0},onRenderRow:this._onRenderRow,onRowDidMount:this._onRowDidMount,setKey:le.TabContent_GridBaseClassName,initialFocusedIndex:this._initialSelectedIndex,componentRef:this._onDetailsListRef})}_initTriageData(e,t=!1){if(this._lastContentData){const{tabId:o,selectionIds:i}=this._lastContentData,s=this.props.tabName;let r=i,a=this._scrollableContentContainer?this._scrollableContentContainer.scrollTop:0;const n=this._store.getHubFilterDataSource(o),l=n?n.getFilteredIds():null;if(!i||i.length<2?l&&(r=l):t||(e=i[0]),!r||0===r.length)return this._setWorkItemsHubNavigationData(null),e;(i&&0===i.length||-1===r.indexOf(e))&&(e=r[0],a=0);const c=(0,ce.findIndex)(l,t=>t===e);this._setWorkItemsHubNavigationData({tabId:o,tabName:s,workItemIds:r,lastTriagedWorkItemId:e,selectedItemIndexInVisibleList:c,selectedIndexScrollTopValue:a})}else this._setWorkItemsHubNavigationData(null);return e}componentDidMount(){super.componentDidMount(),this._performanceScenarioSplit("TabContentDidMount"),this.getStore().addChangedListener(this._onStoreChange);const e=this._store.isHubDataInitialized(this.props.tabId);this._isDataCached=e,e?this._filter&&this._setFilterForTab():(this._performanceScenarioSplit("FetchData"),this._actionsCreator.refreshDataProviderAsync(this.props.tabId,!1,ie.WorkItemsHubPaging.InitialPageSize)),setTimeout(()=>this._tryEndPerformanceScenario(),0),this._scrollableContentContainer=document.querySelector("[data-is-scrollable='true']"),this._loadLegacyEventHandlersAfterTTI(3e3)}componentWillUnmount(){super.componentWillUnmount(),this._unsubscribeFilter(),this.getStore().removeChangedListener(this._onStoreChange),this._timerManagement&&(this._timerManagement.dispose(),this._timerManagement=null),this._workItemEventHandler&&(this._workItemEventHandler.dispose(),this._workItemEventHandler=null)}_loadLegacyEventHandlersAfterTTI(e){let t=this.setTimeout(()=>{this._loadLegacyEventHandlers(),this.clearTimeout(t)},e);this.context.pageContext.getService("IVssContributionEventService").subscribe(()=>{t&&(this._loadLegacyEventHandlers(),this.clearTimeout(t))},"page-interactive")}componentWillUpdate(e,t){const{selection:o}=this.state;this._selectedIds=o.getSelectedCount()>0?o.getSelection().map(e=>e.id):[],this.state.initialized&&!t.initialized?this._unsubscribeFilter():!this.state.initialized&&t.initialized&&this._setFilterForTab()}_trySetEffectiveScrollPosition(e){let t=!1;if(0!==e){const i=this._getWorkItemsHubNavigationData();if(this._scrollableContentContainer&&i&&i.lastTriagedWorkItemId){let s=i.selectedIndexScrollTopValue;s-=(i.selectedItemIndexInVisibleList-e)*o.ItemHeight,this._scrollableContentContainer.scrollTop=s,t=!0}}return t}_unsubscribeFilter(){this._filter.unsubscribe(this._filterChanged,ee.FILTER_CHANGE_EVENT)}_setFilterForTab(){const e=this.getStore(),{tabId:t}=this.props,o=this._filter,i=e.getHubFilterFields(t),s=e.getHubFilterDataSource(t),r=s?s.getFilterState():null;o.setDefaultState((0,H.generateDefaultFilterState)(i)),o.reset(),(0,M.isFilterStateEmpty)(r)?o.subscribe(this._filterChanged,ee.FILTER_CHANGE_EVENT):(0,H.resolveFilterState)(i,s,r).then(e=>{o.setState(e),o.subscribe(this._filterChanged,ee.FILTER_CHANGE_EVENT)},()=>{o.reset()}),this._onTabContentChanged()}componentDidUpdate(){const{gridData:e,selection:t}=this.state;if(e&&(t.setItems(e,!0),this._selectedIds.length>0)){const o=[];e.forEach((e,t)=>{this._selectedIds.indexOf(e.id)>-1&&o.push(t)}),requestAnimationFrame(()=>o.forEach(e=>t.setIndexSelected(e,!0,!0)))}this._tryEndPerformanceScenario()}_buildColumns(e,t,o){let i=null;if(!e)return i;if(this.state&&this.state.columns&&!this._recreateColumns){const e=this.state.columns.map(e=>e.fieldName);if((0,V.arrayEquals)(e,o))return this.state.columns}return i=_e.WorkItemsGridDataProvider.buildColumns(this.context.pageContext,this._project.name,e,t,this._gridColumnFactory,new Date,this._onOpenWorkItem),this._recreateColumns=!1,i}getState(){const e=this.getStore(),t=this.props.tabId,i=e.isHubDataInitialized(t),s=e.isHubDataError(t),r=e.isSupportedFeature(t),n=e.getTotalItemsCount(t),l=e.getVisibleItemsCount(t),c=e.getHubFilterDataSource(t);let m=null,d=null,u=!1,p=null,h=null;c&&(m=c.getSortOptions(),d=c.getDisplayedFieldReferenceNames(),u=c.hasFilter()),i&&(p=e.getHubDisplayData(t),h=_e.WorkItemsGridDataProvider.getData(p,u));const g=this.state&&this.state.selection||new $.Selection({onSelectionChanged:this._onTabContentChanged});if(!(this.state&&this.state.initialized)&&h&&h.length>0){let e=0;const t=this._getWorkItemsHubNavigationData();t&&null!=t.lastTriagedWorkItemId&&(e=(0,ce.findIndex)(h,e=>e.id===t.lastTriagedWorkItemId)),this._initialSelectedIndex=Math.max(0,e)}const I=this._buildColumns(p,m,d);return null!==h&&0===(0,a.localeIgnoreCaseComparer)(t,ie.WorkItemsHubTabs[ie.WorkItemsHubTabs.AssignedToMe])&&(h=h.filter(e=>"Removed"!==e.values[o.WorkItemStateIndex])),{initialized:i,totalItemCount:n,visibleItemCount:l,gridData:h,columns:I,selection:g,isFiltered:u,isError:s,isSupportedFeature:r}}getStore(){return this._store}_getWorkItemsHubNavigationData(){return this.context.pageContext.getService("IWorkItemsHubNavDataService").getNavigationData()}_setWorkItemsHubNavigationData(e){this.context.pageContext.getService("IWorkItemsHubNavDataService").setNavigationData(e)}_tryEndPerformanceScenario(){if(this._telemetrySent)return;const e=this.getStore(),t=this.props.tabId;if(e.isHubDataInitialized(t)){const o=e.getHubFilterDataSource(t),i=o?o.getItemCount():-1,s=o?o.getPagedItemsCount():-1,r=o?o.getVisibleItemsCount():-1,a=!!o&&o.hasFilter(),n=o.getCurrentColumnOptions(),l={tabId:t,newWorkItemsHub:!0,isDataCached:this._isDataCached,totalWorkItemsCount:i,pageItemsCount:s,visibleItemsCount:r,hasFilters:a,completedItems:o.shouldShowCompletedItems(),columnCount:o.getDisplayedFieldReferenceNames().length,columnNames:n.map(e=>e.fieldReferenceName),columnWidths:n.map(e=>e.width),sortedColumnCount:o.getSortOptions().length,sortedColumnNames:o.getSortOptions().map(e=>e.fieldReferenceName)};this._perfTelemetryHelper.endScenario(l),this._telemetrySent=!0,setTimeout(()=>this._fetchMoreItems(),0)}}_performanceScenarioSplit(e){this._perfTelemetryHelper.split(e)}}t.ComponentsWorkItemsTabContent.WorkItemsTabContent=o,o.ItemHeight=41,o.DetailsListPageSize=10,o.WorkItemStateIndex=3,o.ColumnResizeDefaultDelayTimeInMilliseconds=500,L.VssComponent.register("work-items-tab-content",o)}()},["Resources","DataContracts/IActionsDataContract","Actions/ActionsHub","Generated/Constants","Utils/WorkItemsHubTabUtils","DataProviders/WorkItemsHubDataProvider","Stores/IWorkItemsHubFilterDataSource","Utils/Telemetry","Actions/ActionsCreator","Components/IWorkItemsTabContentData","Constants","DataContracts/IWorkItemsGridData","Utils/Array","Components/Cells/WorkItemDateTimeCell","Utils/UrlUtils","Utils/NavigationUtils","Components/Cells/WorkItemIconTitleCell","Components/Cells/WorkItemCommentCountCell","Components/Cells/WorkItemSimpleCell","Utils/WorkItemsGridColumnFactory","Stores/WorkItemsHubFilterDataSource","Utils/WorkItemsHubDataUtils","DataProviders/WorkItemsGridDataProvider","External/NewWorkItem/WorkItemTypeColorAndIconsProvider","External/NewWorkItem/INewWorkItemData","External/NewWorkItem/NewWorkItem","Utils/WorkItemsHubTabSettings","Utils/ColumnOptionsPanelContracts","Utils/ColumnOptionsPanelLauncher","Utils/WorkItemsHubDeleteHelper","Utils/Clipboard","Utils/HtmlTableFormatter","Utils/WorkItemHtmlTableFormatter","Utils/WorkItemsHubReportUtils","Stores/WorkItemsHubStore","DataProviders/WorkItemsHubCommandProvider","Utils/Common","Utils/WorkItemsXhrNavigationUtils","Utils/WorkItemTempQueryUtils","Components/WorkItemsTabFilter","Components/WorkItemsHubView","WorkItemsHubShortcutGroup","ZeroData/IllustrationUrlUtils","ZeroData/WorkItemTrackingZeroDataUtils","ZeroData/GenericFilterZeroData","ZeroData/ZeroDataFactory","WorkItemsHubViewProvider","Components/WorkItemsTabContent"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-work-web.new-work-items-hub-content"}}));