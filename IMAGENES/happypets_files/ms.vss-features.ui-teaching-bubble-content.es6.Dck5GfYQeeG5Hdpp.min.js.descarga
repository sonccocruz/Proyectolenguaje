"use strict";define("VSSUI",["require","exports","react"],function(e,t,n){var i,s;!function(e){i=t.ComponentsTeachingBubbleCustomTeachingBubble={};t.ComponentsTeachingBubbleCustomTeachingBubble.CustomTeachingBubble=class extends n.Component{constructor(e){super(e),this.dismiss=(()=>{this.setState({fadingOut:!0})}),this.onAnimationEnd=(()=>{this.state.fadingOut?this.props.onDismiss&&this.props.onDismiss():this.state.newPosition&&this.setState({anchorElement:this.props.anchorElement,anchorOrigin:this.props.anchorOrigin,children:this.props.children,cornerPlacement:this.props.cornerPlacement,newPosition:!1},this.props.onLocationChange)}),this.getCalloutOrigin=((e,t)=>("center"===e.horizontal?t=1:"center"===e.vertical&&(t=0),0===t?"start"===e.horizontal?{horizontal:"end",vertical:e.vertical}:"end"===e.horizontal?{horizontal:"start",vertical:e.vertical}:{horizontal:"center",vertical:e.vertical}:"start"===e.vertical?{horizontal:e.horizontal,vertical:"end"}:"end"===e.vertical?{horizontal:e.horizontal,vertical:"start"}:{horizontal:e.horizontal,vertical:"center"})),this.getBeakClassName=((e,n)=>{let i,s;return i="start"===n.horizontal?"end"===e.horizontal?"left-primary":"left-secondary":"end"===n.horizontal?"start"===e.horizontal?"right-primary":"right-secondary":"center-h",s="start"===n.vertical?"end"===e.vertical?"top-primary":"top-secondary":"end"===n.vertical?"start"===e.vertical?"bottom-primary":"bottom-secondary":"center-v",(0,t.Util.css)(i,s)}),this.state={anchorElement:e.anchorElement,anchorOrigin:e.anchorOrigin,children:e.children,cornerPlacement:this.props.cornerPlacement}}static getDerivedStateFromProps(e,t){return t.anchorElement!==e.anchorElement||t.anchorOrigin.horizontal!==e.anchorOrigin.horizontal||t.anchorOrigin.vertical!==e.anchorOrigin.vertical?Object.assign(Object.assign({},t),{newPosition:!0}):{children:e.children,cornerPlacement:e.cornerPlacement}}render(){const{anchorElement:e,anchorOrigin:i,children:s,cornerPlacement:o=1,fadingOut:r,newPosition:a}=this.state,l=this.getCalloutOrigin(i,o);return n.createElement(t.UtilitiesScreenSize.ScreenSizeObserver,null,o=>{const c=0===o.screenSize;let b;return c||(b="end"===i.vertical?window.innerHeight-e.getBoundingClientRect().bottom:"start"===i.vertical?e.getBoundingClientRect().top:window.innerHeight),n.createElement(t.Callout.Callout,{anchorElement:c?void 0:e,anchorPoint:c?{x:0,y:0}:void 0,anchorOrigin:i,ariaDescribedBy:this.props.ariaDescribedBy,ariaLabelledBy:this.props.ariaLabeledBy,blurDismiss:this.props.textOnly,calloutOrigin:l,className:(0,t.Util.css)(c&&"absolute-fill"),contentClassName:(0,t.Util.css)("bolt-bubble-callout",(r||a)&&"fade-out",this.getBeakClassName(i,l),c?"bolt-bubble-fullscreen absolute-fill flex-grow scroll-auto":"relative"),contentShadow:!0,escDismiss:!0,fixedLayout:!0,focuszoneProps:{circularNavigation:!0,defaultActiveElement:this.props.defaultActiveElement||".bolt-bubble-focusable-element",focusOnMount:!0,handleTabKey:!0,includeDefaults:!0,postprocessKeyStroke:function(e){return 9===e.which&&e.preventDefault(),2}},onAnimationEnd:this.onAnimationEnd,onDismiss:this.dismiss,updateLayout:!0,viewportChangeDismiss:!1},n.createElement("div",{"aria-live":"polite","aria-relevant":"text",className:"bolt-bubble-container"},!c&&n.createElement("div",{className:"bolt-bubble-beak depth-8"}),n.createElement("div",{className:"bolt-bubble-content relative scroll-auto",style:{maxHeight:b}},n.createElement("div",{className:"bolt-bubble-focusable-element no-outline",tabIndex:-1}),s)))})}}}(),function(e){s=t.ComponentsTeachingBubbleTeachingBubble={};let o=1;t.ComponentsTeachingBubbleTeachingBubble.TeachingBubble=class extends n.Component{constructor(){super(...arguments),this.customBubble=n.createRef(),this.bubbleId=`bubble-${o++}`,this.getContent=(()=>{const{children:e,imageProps:i,primaryButtonProps:s,text:o,textOnly:r,title:a}=this.props;return r?n.createElement("div",{className:"bolt-bubble-text-only body-m"},o):n.createElement(t.Surface.Surface,{background:2,spacing:0},n.createElement("div",{className:"flex-row justify-center"},i&&n.createElement(t.Image.Image,Object.assign({},i))),n.createElement(t.Panel.PanelCloseButton,{className:"bolt-bubble-close",onDismiss:this.dismiss}),n.createElement(t.Header.Header,{className:(0,t.Util.css)("bolt-bubble-text",!s&&"no-buttons"),description:o,descriptionClassName:"bolt-bubble-description",descriptionId:`${this.bubbleId}-description`,title:a,titleSize:2,titleId:`${this.bubbleId}-title`}),e,s&&n.createElement(t.FocusZone.FocusZone,{direction:1},n.createElement("div",{className:"bolt-bubble-buttons"},n.createElement(t.Panel.PanelFooter,{buttonProps:this.getButtons()}))))}),this.getButtons=(()=>{const{primaryButtonProps:e,secondaryButtonProps:n}=this.props,i=[Object.assign(Object.assign({},e),{className:(0,t.Util.css)("bolt-bubble-primary-button",e.className)})];return n&&i.push(n),i}),this.setFocus=(()=>{const{onLocationChange:e,primaryButtonProps:t,secondaryButtonProps:n}=this.props;if(t&&!n){const e=document.getElementsByClassName("bolt-bubble-primary-button")[0];e&&e.focus()}else if(!t){const e=document.getElementsByClassName("bolt-bubble-close")[0];e&&e.focus()}e&&e()}),this.dismiss=(()=>{this.customBubble.current&&this.customBubble.current.dismiss()})}render(){let e=this.props.defaultActiveElement;return e||this.props.textOnly||(e=this.props.primaryButtonProps?".bolt-bubble-primary-button":".bolt-bubble-close"),n.createElement(i.CustomTeachingBubble,Object.assign({},this.props,{ariaDescribedBy:this.props.ariaDescribedBy||`${this.bubbleId}-description`,ariaLabeledBy:this.props.ariaLabeledBy||`${this.bubbleId}-title`,defaultActiveElement:e,onLocationChange:this.setFocus,ref:this.customBubble}),this.getContent())}}}(),t.TeachingBubble={},Object.defineProperty(t.TeachingBubble,"TeachingBubble",{enumerable:!0,get:function(){return s.TeachingBubble}})},["Components/TeachingBubble/CustomTeachingBubble","Components/TeachingBubble/TeachingBubble","TeachingBubble"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-teaching-bubble-content"}}));