"use strict";define("VSS/Features/PlatformUI",["require","exports","react","VSS/Platform/Location","VSS/Platform/Theming","VSS/Platform/Util/Url","VSSUI/Icon","VSSUI/Image","VSSUI/Util","VSSUI/Button","VSSUI/ButtonGroup","VSS/Platform/Layout","VSS/Platform/Context","VSS/Core/Observable","VSS/Platform/Trace","VSSUI/Observer","VSSUI/Pill","VSSUI/PillGroup","VSSUI/TooltipEx","VSS/Platform/FPS","VSSUI/Link"],function(e,t,n,o,i,r,s,c,a,u,d,l,p,m,b,g,h,C,f,v,S){var I,y,P,x,D,O,w,M,E,T,k,B;I=t.Resources={},t.Resources.cancel="Cancel",t.Resources.leave="Leave",t.Resources.leavePageDialogTitle="Are you sure you want to leave the page?",t.Resources.loading="Loading",t.Resources.ok="OK",t.Resources.stay="Stay",t.Resources.unsavedChangesDefaultMessage="You have unsaved changes.",function(e){function u(e,t,o,s){let u;if(o){let d,l;if("object"==typeof o?d=o[(0,i.getCurrentTheme)(e).isDark?"dark":"light"]:(l="non-themed",d=o),d&&!d.startsWith("css://")){if(!d.match(/^https?:\/\//)&&t){const n=e.getService("IVssContributionService").getContributionProvider(t);n&&(d=(0,r.combineUrlPaths)(n.baseUri,d))}u={render:e=>n.createElement(c.Image,{alt:s,className:(0,a.css)(e,l,"contributed-icon-image"),src:d})}}}return u}y=t[e]={},t[e].contributedIconToIconProps=u,t[e].ContributedIcon=function(e){const t=(0,a.css)(e.className,"contributed-icon");if(e.iconProps)return n.createElement(s.Icon,Object.assign({},e.iconProps,{className:(0,a.css)(t,e.iconProps.className)}));if(e.iconAsset){const i=(0,o.getAssetLocation)(e.pageContext,e.iconAsset);if(i)return n.createElement(c.Image,{alt:e.alt,className:(0,a.css)(t,"contributed-icon-image"),src:i})}if(e.icon){const o=u(e.pageContext,e.contributionId,e.icon,e.alt);if(o)return n.createElement(s.Icon,Object.assign({className:t},o,{size:e.iconSize}))}return e.iconName?n.createElement(s.Icon,{className:t,iconName:e.iconName,size:e.iconSize}):null}}("ComponentsContributedIconContributedIcon"),function(e){function o(e,t){const n={disabled:t.disabled,href:t.href,primary:t.primary,target:t.target,text:t.text};return t.tooltip&&(n.ariaLabel=t.tooltip,n.tooltipProps={text:t.tooltip}),t.href&&t.target&&(n.rel="noopener noreferrer"),t.icon&&(n.iconProps=(0,y.contributedIconToIconProps)(e,t.contributionId,t.icon)),t.command&&(n.onClick=(()=>{const n=t.commandArguments||[];if("string"==typeof t.command){e.getService("IVssContributionService").executeCommand(t.command,...n)}else if(t.contributionId){e.getService("IVssContributionService").executeCommandEx(t.contributionId,t.command,...n)}})),n}P=t[e]={},t[e].contributedButtonToButtonProps=o,t[e].ContributedButtonGroup=function(e){const{pageContext:t,className:i,buttons:r}=e;return n.createElement(d.ButtonGroup,{className:i},r.map(e=>n.createElement(u.Button,Object.assign({},o(t,e)))))}}("ComponentsContributedButtonContributedButton"),function(e){x=t.ComponentsContributedContentContributedContent={},t.ComponentsContributedContentContributedContent.ContributedContent=function(e){const{className:t,componentProperties:o,contribution:i,contributionId:r,dependencies:s}=e,c=(0,l.useComponentContext)(),u=Object.assign(Object.assign(Object.assign({},o),i.componentProperties),{className:(0,a.css)(t,o&&o.className,i.componentProperties&&i.componentProperties.className)}),d=[...s||[],...i.dependencies||[]];if(i.uri)return n.createElement(l.WrappedComponent,{dependencies:d.concat(["ms.vss-web.ext-content"]),onDependenciesResolved:e.onDependenciesResolved,wrappedType:"ExternalContent",wrappedProps:Object.assign(Object.assign({initialHandshakeData:o&&o.context},u),{contributionId:r})});if(i.componentType&&c.pageContext.getService("IVssContributionService").isContributionTrusted(r))return n.createElement(l.WrappedComponent,{dependencies:d,onDependenciesResolved:e.onDependenciesResolved,wrappedType:i.componentType,wrappedProps:u});return null}}(),function(e){D=t.ContributedItemUtil={},t.ContributedItemUtil.getContributedItems=function(e,t,n,o){const i=[],r=e.getService("IVssContributionService"),s=[],c={},a=r.getContributionChildren(t,o);if(a)for(const e of a)c[e]=!0,s.push(e);if(n){const e=r.getContributionsByType(o);if(e)for(const o in e)if(!c[o]){const i=e[o];i&&i[n]===t&&s.push(o)}}for(const e of s){const t=r.getContribution(e);t&&i.push({id:e,contribution:t})}return i},t.ContributedItemUtil.wrapExternalObservable=function(e){if(e){const t=e,n=t.subscribe;"function"==typeof n&&(t.subscribe=((o,i)=>{const r=(t,n)=>{const i=e;"set"===n&&void 0!==i.value&&(i.value=t),o(t,n)};return(0,p.setRemoteSerializationSettings)(r,{proxyFunctions:!0}),n.call(t,r,i)}))}return e}}(),function(e){function o(e,t,n,o,i,r){const s=n.getPills(o,r),c=s,a=s;c&&"function"==typeof c.then?c.then(e=>{e&&t.push((0,D.wrapExternalObservable)(e),e=>Object.assign(Object.assign({},e),{contributionId:i}))},t=>{const n=`Failed to load pills for ${o}: ${JSON.stringify(t||"")}`;(0,b.traceWarning)(e,"extensions","ContributedPillGroup",n,{pillGroupId:o}),console.warn(n)}):a&&t.push(a,e=>Object.assign(Object.assign({},e),{contributionId:i}))}function i(e,t,n,i){const r=e.getService("IVssContributionService"),s=(0,D.getContributedItems)(e,n,"pillGroupId","ms.vss-web.pill-provider");for(const c of s){const s=r.getServiceSync(c.id);s?o(e,t,s,n,c.id,i):r.getService(c.id).then(r=>{r&&o(e,t,r,n,c.id,i)})}}O=t[e]={},t[e].getPills=function(e,t,n){const o=new m.ObservableCollection;return i(e,o,t,n),o},t[e].addPills=i,t[e].ContributedPillGroup=function(e){const{className:t,overflow:o,pageContext:i,pills:r,size:s}=e;return n.createElement(g.Observer,{pills:r},e=>e.pills.length?n.createElement(C.PillGroup,{className:t,overflow:o},e.pills.map((e,t)=>n.createElement(h.Pill,Object.assign({},function(e,t){return{children:n.createElement(f.Tooltip,{text:""+(t.tooltip||t.text),overflowOnly:!t.tooltip},n.createElement("span",null,""+t.text)),color:t.color,iconProps:(0,y.contributedIconToIconProps)(e,t.contributionId,t.icon),onClick:t.onClick?()=>t.onClick():void 0,onRemoveClick:t.onClick?()=>t.onRemoveClick():void 0,variant:t.color?2:0}}(i,e),{key:t,size:s})))):null)}}("ComponentsContributedPillGroupContributedPillGroup"),function(e){w=t.ComponentsFPSLinkFPSLink={};t.ComponentsFPSLinkFPSLink.FPSLink=class extends l.VssComponent{constructor(){super(...arguments),this.onClick=(e=>{this.props.onClick&&this.props.onClick(e),e.isDefaultPrevented()||(this.props.href&&!1!==this.props.supportsFPS?(0,v.onClickFPS)(this.context.pageContext,this.props.href,!0,e,{telemetrySource:this.props.telemetrySource,telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId}):this.props.telemetrySource&&this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign(Object.assign({},this.props.telemetryProperties||{}),{source:this.props.telemetrySource})))})}render(){const e=Object.assign(Object.assign({},this.props),{onClick:this.onClick});return n.createElement(S.Link,Object.assign({},e))}}}(),function(e){M=t[e]={};let o=1;t[e].MessageDialog=(e=>{const t=`message-dialog-dialog-content-${o++}`,i={ariaDescribedBy:t,lightDismiss:!1!==e.lightDismiss,onDismiss:()=>{e.onClose(!1)},role:"alertdialog",titleProps:{text:e.title}},r=[];if(!1!==e.showCancel){const t=Object.assign({id:`message-dialog-cancel-button-${o}`,text:I.cancel},e.cancelButtonProps);t.onClick=(()=>{e.onClose(!1)}),r.push(t),i.defaultActiveElement="#"+t.id}const s=Object.assign({id:`message-dialog-ok-button-${o}`,text:I.ok,primary:!0},e.okButtonProps);return s.onClick=(()=>{e.onClose(!0)}),r.push(s),i.defaultActiveElement||(i.defaultActiveElement="#"+s.id),i.footerButtonProps=r,i.defaultActiveElement=`#${(0,a.getSafeId)(r[0].id)}`,n.createElement(l.WrappedComponent,{dependencies:["ms.vss-features.ui-layer-content"],wrappedType:"dialog",wrappedProps:i},n.createElement("div",{id:(0,a.getSafeId)(t)},e.message))}),t[e].showMessageDialog=function(o,i){o.getService("IVssLayoutManager").renderCallout(o=>n.createElement(t[e].MessageDialog,Object.assign({},i,{onClose:e=>{i.onClose(e),o()}})))}}("ComponentsMessageDialogMessageDialog"),function(e){t.ContributedBreadcrumb={},t.ContributedBreadcrumb.getBreadcrumbItems=function(e,t){const n=new m.ObservableCollection,o=e.getService("IVssContributionService"),i=o.getSharedData("_breadcrumbItems");if(i){const e=i[t];e&&n.push(e)}const r=(0,D.getContributedItems)(e,t,"breadcrumbId","ms.vss-web.breadcrumb-item");n.push(r,e=>({hidden:e.contribution.hidden,href:e.contribution.href,key:e.contribution.key||e.id,text:e.contribution.text,rank:e.contribution.rank,priority:e.contribution.priority}));const s=(0,D.getContributedItems)(e,t,"breadcrumbId","ms.vss-web.breadcrumb-provider");for(const i of s){const r=o.getServiceSync(i.id);if(r){const e=r.getBreadcrumbItems(t);e&&n.push(e)}else o.getService(i.id).then(o=>{if(o)if(o.getBreadcrumbItems){const i=o.getBreadcrumbItems(t),r=i;r&&"function"==typeof r.then?r.then(e=>{e&&n.push((0,D.wrapExternalObservable)(e))},n=>{const o=`Failed to load tabs for ${t}: ${JSON.stringify(n||"")}`;(0,b.traceWarning)(e,"extensions","ContributedBreadcrumb",o,{breadcrumbId:t}),console.warn(o)}):i&&n.push(i)}else n.push((0,D.wrapExternalObservable)(o))})}return n}}(),t.ContributedButton={},Object.defineProperty(t.ContributedButton,"ContributedButtonGroup",{enumerable:!0,get:function(){return P.ContributedButtonGroup}}),Object.defineProperty(t.ContributedButton,"contributedButtonToButtonProps",{enumerable:!0,get:function(){return P.contributedButtonToButtonProps}}),E=t.ContributedContent={},Object.defineProperty(t.ContributedContent,"ContributedContent",{enumerable:!0,get:function(){return x.ContributedContent}}),T=t.ContributedIcon={},Object.defineProperty(t.ContributedIcon,"ContributedIcon",{enumerable:!0,get:function(){return y.ContributedIcon}}),Object.defineProperty(t.ContributedIcon,"contributedIconToIconProps",{enumerable:!0,get:function(){return y.contributedIconToIconProps}}),function(e){function o(e,t){return n=>{const o=`Failed to load menu items for ${t}: ${JSON.stringify(n||"")}`;(0,b.traceWarning)(e,"extensions","ContributedMenu",o,{menuId:t}),console.warn(o)}}function i(e,t,n,o,i){let r;if(t.contribution.uri||!o){if(r=new d(e,t.id,t.contribution,n),i&&i.processExternalMenuItem&&(r=i.processExternalMenuItem(r,t.contribution)),r&&!r.text&&!r.iconProps&&!r.subMenuProps)return void console.warn("Ignored invalid external menu item: "+t.id)}else r=new a(e,t.contribution,n);return r}function r(e,t,n,o,i){const r=new m.ObservableCollection;return s(e,r,t,n,o,i),r}async function s(e,t,n,r,s,a){var u,l;const p=e.getService("IVssContributionService"),b=p.getSharedData("_menuItems");if(b){const o=b[n];o&&o.length>0&&t.push(o,t=>i(e,{id:t.id,contribution:t},r,!0,s))}t.push((0,D.getContributedItems)(e,n,"menuId","ms.vss-web.menu-item"),t=>i(e,t,r,p.isContributionTrusted(t.id),s)),t.push((0,D.getContributedItems)(e,n,"menuId","ms.vss-web.action"),t=>i(e,t,r,p.isContributionTrusted(t.id),s));const g=[...(0,D.getContributedItems)(e,n,"menuId","ms.vss-web.menu-provider"),...(0,D.getContributedItems)(e,n,"menuId","ms.vss-web.action-provider")];for(const i of g){const b=p.getServiceSync(i.id,!0);if(b){if(b.getMenuItems){const e=b.getMenuItems(n,r);e&&t.push(e)}}else{const b=i.contribution;if(b.uri){const c={serviceName:b.registeredObjectId||i.id,uri:b.uri};p.getServiceEx(i.id,c,!0).then(c=>{if(c){let u;s&&s.getExternalMenuItems?u=s.getExternalMenuItems(c,n,r):c.getMenuItems&&(u=!a||c._sdkVersion>=3?c.getMenuItems(n,r):c.getMenuItems(r)),u&&u.then(n=>{t.push(null!=n?n:[],t=>{const n=new d(e,i.id,Object.assign({uri:b.uri},t),r);return s&&s.processExternalMenuItem?s.processExternalMenuItem(n,t):n})},o(e,i.id))}},o(e,i.id))}else if(c(p,i)){const n=e.getService("ILegacyPlatformService"),o=await n.requireModules(["VSS/SDK/Shim",...i.contribution.content.require]);if("function"==typeof(null===(l=null===(u=o[0])||void 0===u?void 0:u.VSS)||void 0===l?void 0:l.getRegisteredObject)){const n=o[0].VSS.getRegisteredObject(i.id);if("function"==typeof(null==n?void 0:n.getMenuItems)){const o=new m.ObservableArray([]),c=t=>{const n=new d(e,i.id,t,r);return s&&s.processExternalMenuItem?s.processExternalMenuItem(n,t):n},a=e=>Array.isArray(e)?e.map(c).filter(e=>!!e):[],u=Object.assign(Object.assign({},r),{updateMenuItems:e=>{o.value=a(e)}}),l=await Promise.resolve(n.getMenuItems(u));o.value=a(l),t.push(o)}}}else p.getService(i.id).then(e=>{if(e&&e.getMenuItems){const o=e.getMenuItems(n,r);o&&t.push(o)}},o(e,i.id))}}}function c(e,t){var n,o;if(!e.isContributionTrusted(t.id))return!1;const i=t.contribution;return!!(null===(o=null===(n=null==i?void 0:i.content)||void 0===n?void 0:n.require)||void 0===o?void 0:o[0])&&"string"==typeof i.content.require[0]}k=t.ContributedMenu={},t.ContributedMenu.getMenuItems=r,t.ContributedMenu.addMenuItems=s;class a{constructor(e,t,o){this.onActivateCommand=(e=>{const t=this.pageContext.getService("IVssContributionService"),n=this.contextualData?Object.assign(Object.assign({},this.data),this.contextualData):this.data;this.command?t.executeCommandEx(e.id,this.command,n):t.getService(e.id,!0).then(e=>{e&&e.execute&&e.execute(n)})}),this.renderMenuItemCustom=((e,t,o)=>n.createElement(l.WrappedComponent,{key:this.id,wrappedType:this.componentType,wrappedProps:{index:e,item:t,details:o}})),this.pageContext=e,this.className=t.className,this.checked=t.checked,this.data=t.data,this.contextualData=o,this.disabled=t.disabled,this.groupKey=t.groupKey,this.href=t.href,this.iconProps=t.iconProps,this.id=t.id||t.key||"",this.rank=t.rank,this.rel=t.rel,this.target=t.target,this.text=t.text||t.name,"-"===t.name?this.itemType=1:this.itemType=t.itemType,this.command=t.command,!this.command&&this.href||(this.onActivate=this.onActivateCommand);const i=t.subMenuId;i&&(this.subMenuProps={id:i,items:r(e,i,o)}),this.componentType=t.componentType,this.componentType&&(this.renderMenuItem=this.renderMenuItemCustom)}}let u=0;class d{constructor(e,t,n,i){if(this.onActivateExternalCommand=(()=>{this.pageContext.getService("IVssContributionService").getServiceEx(this.contributionId,this.externalContributedService,!0).then(e=>{e&&e.execute&&e.execute(this.contextualData)},o(this.pageContext,this.contributionId))}),this.pageContext=e,this.contributionId=t,this.contextualData=i,this.disabled=n.disabled,this.groupKey=n.groupId,this.hidden=n.hidden,this.href=n.href,this.id=n.id||"ext-menu-"+ ++u,this.rank=n.rank,this.text=n.text||n.title,n.icon&&(this.iconProps=(0,T.contributedIconToIconProps)(e,t,n.icon)),!this.iconProps&&n.iconName&&(this.iconProps={iconName:n.iconName}),n.action?this.onActivate=(()=>{n.action(this.contextualData)}):n.uri&&(this.externalContributedService={serviceName:n.registeredObjectId||t,uri:n.uri,configuration:this.contextualData},this.onActivate=this.onActivateExternalCommand),n.childItems){const i=new m.ObservableArray;"function"==typeof n.childItems.then?n.childItems.then(o=>{i.push(...o.map(o=>new d(e,t,Object.assign({uri:n.uri},o),this.contextualData)))},o(e,this.contributionId)):i.push(...n.childItems.map(o=>new d(e,t,Object.assign({uri:n.uri},o),this.contextualData))),this.subMenuProps={id:"ext-sub-menu-"+ ++u,items:i}}}}}(),t.ContributedPillGroup={},Object.defineProperty(t.ContributedPillGroup,"addPills",{enumerable:!0,get:function(){return O.addPills}}),Object.defineProperty(t.ContributedPillGroup,"ContributedPillGroup",{enumerable:!0,get:function(){return O.ContributedPillGroup}}),Object.defineProperty(t.ContributedPillGroup,"getPills",{enumerable:!0,get:function(){return O.getPills}}),function(e){function o(e,t,o,i){if(t.preProcessTabContribution&&t.preProcessTabContribution(o),!o.render){const r=o,s=e=>n.createElement(l.WrappedComponent,{key:r.moduleContent,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",loadingComponent:t.loadingComponent,wrappedProps:{componentType:"vssLegacyContributionContentHost",modules:["VSSPreview/Providers/ContentHost"],dependentContributionIds:r.dependencies,wrappedProps:{className:"flex-grow",context:e.context,contribution:e.contribution}}});r.moduleContent?o.fpsRequired||t.fpsRequired?o.render=(()=>n.createElement(l.WrappedComponent,{key:r.moduleContent,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",loadingComponent:t.loadingComponent,wrappedProps:{className:"flex-grow",componentType:"legacyHubShimComponent",dependentContributionIds:r.dependencies,modules:["VSSPreview/Flux/Components/ExternalHubShim"],contributionId:r.moduleContent}})):o.render=(()=>n.createElement(s,{contribution:r.moduleContent,context:e})):r.content?o.render=(()=>n.createElement(s,{contribution:r.id,context:t.contextualData})):o.render=(()=>n.createElement(E.ContributedContent,{key:i,className:"flex-grow",contributionId:i,contribution:o,dependencies:o.dependencies,componentProperties:Object.assign({context:t.contextualData},t.props),loadingComponent:t.loadingComponent}))}if(o.id||(o.id=i),o.routeId){const n=e.getService("IVssLocationService");o.url=n.routeUrl(o.routeId,Object.assign(Object.assign({},t.routeValues),o.routeValues))}else if(t.defaultRouteId){const n=e.getService("IVssLocationService"),r={};r[t.routeStateKey||"contributionId"]=o.id||i,o.url=n.routeUrl(t.defaultRouteId,r)}else if(t.routeStateKey){const n=e.getService("IVssHistoryService"),i={};i[t.routeStateKey]=o.id,o.url=n.generateUrl(i,1)}o.fpsRequired||t.fpsRequired?o.onBeforeTabChange=((t,n,o)=>!o||((0,v.FastPageSwitch)(e,o,!0),t&&t.preventDefault(),!1)):o.url&&t.updateUrlOnPivotChange&&(o.onBeforeTabChange=((t,n,i)=>{return e.getService("IVssHistoryService").pushState(void 0,o.url&&m.ObservableLike.getValue(o.url)),!0}));const r=o;return r.commandBarMenuId&&!o.commandBarItems&&(o.commandBarItems=(0,k.getMenuItems)(e,r.commandBarMenuId,{tabId:o.id})),o}function i(e,t,n,i={}){const r=e.getService("IVssContributionService"),s=(0,D.getContributedItems)(e,n,"tabGroupId","ms.vss-web.tab");t.push(s,t=>o(e,i,t.contribution,t.id));const c=(0,D.getContributedItems)(e,n,"tabGroupId","ms.vss-web.tab-provider");for(const s of c){const c=r.getServiceSync(s.id,!0);if(c){const r=c.getTabs(n,i.contextualData);r&&t.push(r,t=>o(e,i,t,t.id))}else r.getService(s.id).then(r=>{if(r){const s=r.getTabs(n,i.contextualData),c=s;c&&"function"==typeof c.then?c.then(n=>{n&&t.push((0,D.wrapExternalObservable)(n),t=>((0,D.wrapExternalObservable)(t.name),(0,D.wrapExternalObservable)(t.badgeCount),o(e,i,t,t.id)))},t=>{const o=`Failed to load tabs for ${n}: ${JSON.stringify(t||"")}`;(0,b.traceWarning)(e,"extensions","Contributedtab",o,{tabGroupId:n}),console.warn(o)}):s&&t.push(s,t=>o(e,i,t,t.id))}})}}t.ContributedTab={},t.ContributedTab.processTabContribution=o,t.ContributedTab.getTabs=function(e,t,n={}){const o=new m.ObservableCollection;return i(e,o,t,n),o},t.ContributedTab.addTabs=i}(),t.FPSLink={},Object.defineProperty(t.FPSLink,"FPSLink",{enumerable:!0,get:function(){return w.FPSLink}}),B=t.MessageDialog={},Object.defineProperty(t.MessageDialog,"MessageDialog",{enumerable:!0,get:function(){return M.MessageDialog}}),Object.defineProperty(t.MessageDialog,"showMessageDialog",{enumerable:!0,get:function(){return M.showMessageDialog}}),function(e){t.UnsavedChangesService={};p.Services.add("IUnsavedChangesService",{serviceFactory:class extends p.VssService{constructor(){super(...arguments),this.documents=[],this.onBeforeUnload=(e=>{const t=this.getDirtyDocumentMessage();if(t)return e.returnValue=t,e.preventDefault(),t}),this.onFpsStarting=(e=>{const t=this.getDirtyDocumentMessage(),n=this.getDirtyDocumentTitle(),o=this.getDirtyDocumentOnLeaveBtn(),i=this.getDirtyDocumentOnStayBtn();!(t&&n&&o&&i)||e.detail.data&&e.detail.data.userConfirmed||(e.preventDefault(),e.detail.cancellationReason="dirtyState",this.showMessage(n,t,o,i,()=>{(0,v.FastPageSwitch)(e.detail.pageContext,e.detail.href,e.detail.recordHistoryEntry,Object.assign(Object.assign({},e.detail.data),{userConfirmed:!0}))}))}),this.getDirtyDocumentMessage=(()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyMessage&&e.getDirtyMessage()||I.unsavedChangesDefaultMessage}),this.getDirtyDocumentTitle=(()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyTitle&&e.getDirtyTitle()||I.leavePageDialogTitle}),this.getDirtyDocumentOnStayBtn=(()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyOnStayBtn&&e.getDirtyOnStayBtn()||I.stay}),this.getDirtyDocumentOnLeaveBtn=(()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyOnLeaveBtn&&e.getDirtyOnLeaveBtn()||I.leave})}_serviceStart(e){super._serviceStart(e),document.body.addEventListener("fpsStarting",this.onFpsStarting),window.addEventListener("beforeunload",this.onBeforeUnload)}_serviceEnd(e){super._serviceEnd(e),document.body.removeEventListener("fpsStarting",this.onFpsStarting),window.removeEventListener("beforeunload",this.onBeforeUnload)}register(e){this.documents.push(e)}registerFirst(e){this.documents.unshift(e)}unregister(e){this.documents=this.documents.filter(t=>t!==e)}triggerNavigateAway(e,t){const n=this.getDirtyDocumentMessage(),o=this.getDirtyDocumentTitle(),i=this.getDirtyDocumentOnLeaveBtn(),r=this.getDirtyDocumentOnStayBtn();n&&o&&i&&r?this.showMessage(o,n,i,r,e,t):e()}showMessage(e,t,n,o,i,r){(0,B.showMessageDialog)(this.pageContext,{cancelButtonProps:{text:o},lightDismiss:!1,message:t,onClose:e=>{e?i():r&&r()},okButtonProps:{text:n},title:e})}}})}()},["Resources","Components/ContributedIcon/ContributedIcon","Components/ContributedButton/ContributedButton","Components/ContributedContent/ContributedContent","ContributedItemUtil","Components/ContributedPillGroup/ContributedPillGroup","Components/FPSLink/FPSLink","Components/MessageDialog/MessageDialog","ContributedBreadcrumb","ContributedButton","ContributedContent","ContributedIcon","ContributedMenu","ContributedPillGroup","ContributedTab","FPSLink","MessageDialog","UnsavedChangesService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.platform-ui-content"}}));