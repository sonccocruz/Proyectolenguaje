"use strict";define("Analytics/Shared/Visuals/Common",["require","exports","react","roosterjs-html-sanitizer/index","roosterjs-html-sanitizer/Sanitizer","VSS/Platform/Layout","VSS/Platform/Location","VSSUI/Button","VSSUI/Image","VSSUI/Link","VSSUI/Util","VSSUI/Menu","VSSUI/TooltipEx"],function(e,t,s,a,n,o,i,l,r,p,c,m,u){var h,d;t.SupportedColors={},(d=t.SupportedColors.SupportedColors||(t.SupportedColors.SupportedColors={})).Passed="#107C10",d.Failed="#E81123",d.NotApplicable="#F8A800",d.Blocked="#374649",d.NotRun="#A6A6A6",function(e){t.ComponentsAnalyticsUnavailableMessage={};t.ComponentsAnalyticsUnavailableMessage.AnalyticsUnavailableMessage=class extends o.VssComponent{render(){const e=(0,i.getAssetLocation)(this.context.pageContext,"ms.vss-analyticsshared-web/analytics-shared-common/images/"+this.props.imageName);return s.createElement("div",{className:(0,c.css)("ax-message-div","flex-column","flex-center",this.props.className||"")},this.props.imageName&&s.createElement(r.Image,{className:"ax-message-image",src:e,alt:""}),this.props.iconName&&s.createElement("span",{className:(0,c.css)("ax-message-icon fabric-icon fontSizeXXXL","ms-Icon--"+this.props.iconName)}),this.props.message&&s.createElement("span",{className:(0,c.css)(this.props.messageClassName||"ax-message-message-font","ax-message-message")},this.props.message),this.props.suggestion&&s.createElement("span",{className:"ax-message-suggestion",dangerouslySetInnerHTML:{__html:a.HtmlSanitizer.sanitizeHtml(this.props.suggestion,n.sanitizeHtmlOptions)}}),this.props.buttonText&&s.createElement(l.Button,{primary:!0,className:"ax-message-button",href:this.props.buttonUrl,target:"_blank",ariaLabel:this.props.ariaDescription},this.props.buttonText),this.props.linkText&&s.createElement(p.Link,{className:"ax-message-link",href:this.props.linkUrl,ariaLabel:this.props.ariaDescription},this.props.linkText),this.props.info&&s.createElement("span",{className:"ax-message-info"},this.props.info))}}}(),function(e){h=t.ComponentsLabelledContextualMenu={};t.ComponentsLabelledContextualMenu.LabelledContextualMenu=class extends s.PureComponent{constructor(){super(...arguments),this._onMetricChanged=((e,t)=>{this.props.onMetricChange&&this.props.onMetricChange(Number(e.id))})}render(){return s.createElement("div",{className:"labelledContextualMenu"},s.createElement(m.MenuButton,{className:"labelledContextualMenu-options",text:this._getSelectedOptionText(),ariaLabel:this.props.contextualMenuAriaLabel,contextualMenuProps:{menuProps:{id:"labelledContextualMenu",items:this._convertToContextualMenuItemArray(this.props.metricOptions||[])},onActivate:this._onMetricChanged}}))}_convertToContextualMenuItemArray(e){return Object.keys(e).map(t=>({id:t,text:e[t],onActivate:this._onMetricChanged}))}_getSelectedOptionText(){return this.props.metricOptions&&"number"==typeof this.props.selectedMetricOption&&this.props.metricOptions[this.props.selectedMetricOption]||""}}}(),function(e){t.ComponentsVisualTemplate={};t.ComponentsVisualTemplate.VisualTemplate=class extends o.VssComponent{render(){return s.createElement("div",{className:(0,c.css)("visual-template",this.props.className),tabIndex:this.props.tabIndex,"aria-labelledby":this.props.arialabelledby,style:this.props.style},this._getTitleBar(),this.props.subTitle&&s.createElement("div",{className:"sub-title fontSizeM fontWeightLighter"},this.props.subTitle),this.props.children)}_getTitleBar(){if(this.props.labelledMenuProps){const e=this.props.labelledMenuProps;return s.createElement(u.Tooltip,{text:e.tooltipHostContent||""},e.metricOptions&&"number"==typeof e.selectedMetricOption&&e.metricOptions[e.selectedMetricOption]&&s.createElement(h.LabelledContextualMenu,Object.assign({},this.props.labelledMenuProps)))}return s.createElement("h2",{className:(0,c.css)("title fontWeightNormal",this.props.titleClassName),id:this.props.titleId},this.props.title)}}}()},["SupportedColors","Components/AnalyticsUnavailableMessage","Components/LabelledContextualMenu","Components/VisualTemplate"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-analyticsshared-web.visuals-common"}}));