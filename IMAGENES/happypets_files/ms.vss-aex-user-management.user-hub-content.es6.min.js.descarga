"use strict";define("Aex/UserManagement/UserHub",["require","exports","Aex/Platform/UI/Contexts/AexPageContextService","Aex/Platform/UI/Contexts/GeneralErrorContext","Aex/Platform/UI/Hooks/useContributionData","react","VSS/Core/Util/Memoize","VSS/Platform/Layout","VSS/Platform/Location","VSSUI/Spinner","VSS/Platform/Context","VSS/Platform/RestClientBase","Aex/Platform/Utils/useAsyncState","Aex/Platform/UI/Components/TemplateString","Aex/Platform/UI/Hooks/useSelection","Aex/Platform/UI/Styling/Sizing","Aex/Platform/UI/Styling/Spacing","VSSUI/Dropdown","VSSUI/FormItem","VSSUI/Link","VSSUI/Util","VSSUI/Utilities/DropdownSelection","VSS/Core/Util/Accessibility","VSS/Features/Identities/IdentityPickerProvider","Aex/Platform/UI/Hooks/useMutableCallback","VSS/Core/Observable","VSSUI/Table","Aex/Platform/UI/Styling/CoreClassNames","VSSUI/Icon","VSSUI/Checkbox","VSSUI/List","VSSUI/ZeroData","Aex/Platform/Utils/useResolvedPromise","VSS/Core/Util/String","Aex/Platform/UI/Models/HandledError","Aex/Platform/UI/Hooks/useCollectionDataIterator","Aex/Platform/UI/Util/CollectionDataStore","Aex/Platform/Utils/useDependentState","VSS/Platform/Util/Serialization","Aex/Platform/UI/Styling/ColorClassNames","Aex/Platform/UI/Styling/CssClassNames","VSSUI/Button","VSSUI/ButtonGroup","VSSUI/Panel","VSS/Core/Util/Object","VSSUI/Dialog","VSSUI/Surface","Aex/Platform/Utils/useVersionKey","VSSUI/IdentityPicker","VSSUI/Pill","VSSUI/PillGroup","VSSUI/TooltipEx","VSSUI/VssPersona","VSSUI/MessageCard","VSSUI/Status","VSSUI/Clipboard","VSSUI/TextField","VSS/Core/Util/Promise","VSSUI/TreeEx","VSSUI/Utilities/TreeItemProvider","VSSUI/Tabs","Aex/Platform/Utils/useAsyncAction","VSSUI/Card","VSSUI/Utilities/Provider","VSSUI/Ago","VSSUI/FilterBar","VSSUI/TextFilterBarItem","VSSUI/Utilities/Filter","VSSUI/Header","VSSUI/HeaderCommandBar","VSSUI/Page","Aex/Platform/UI/Util/PerfUtil"],function(e,t,s,n,r,i,o,a,l,c,u,m,d,p,g,C,b,v,h,f,y,S,E,x,A,U,T,R,I,N,P,M,L,D,F,_,G,k,w,j,B,H,O,V,z,q,W,K,$,J,Q,Y,Z,X,ee,te,se,ne,re,ie,oe,ae,le,ce,ue,me,de,pe,ge,Ce,be,ve){var he,fe,ye,Se,Ee,xe,Ae,Ue,Te,Re,Ie,Ne,Pe,Me,Le,De,Fe,_e,Ge,ke,we,je,Be,He,Oe,Ve,ze,qe,We,Ke,$e,Je,Qe,Ye,Ze,Xe,et,tt,st,nt,rt,it,ot,at,lt,ct,ut,mt,dt,pt,gt,Ct,bt,vt,ht,ft,yt,St,Et,xt,At,Ut,Tt,Rt,It,Nt,Pt,Mt,Lt,Dt,Ft,_t,Gt,kt,wt,jt,Bt,Ht,Ot,Vt,zt,qt,Wt,Kt,$t,Jt,Qt,Yt,Zt,Xt,es,ts,ss,ns,rs,is,os,as,ls,cs,us,ms,ds,ps,gs,Cs,bs,vs,hs,fs,ys,Ss,Es,xs,As,Us,Ts,Rs,Is,Ns,Ps,Ms,Ls,Ds,Fs,_s,Gs,ks,ws,js,Bs,Hs,Os,Vs,zs,qs,Ws,Ks,$s,Js,Qs,Ys,Zs,Xs,en,tn;he=t.Resources={},t.Resources.ActionDisplayName_AddUsers="Add users",t.Resources.AccessLevel_IsDisabled="Access level is disabled",t.Resources.AssetsReinstated="The previous user's assets have been reinstated to the current user.",t.Resources.BulkStatusDialogColumnName_Action="Action",t.Resources.BulkStatusDialogColumnName_Extension="Extension",t.Resources.BulkStatusDialogColumnName_Message="Message",t.Resources.BulkStatusDialogColumnName_Status="Status",t.Resources.BulkStatusDialogColumnName_Project="Project",t.Resources.BulkStatusDialogColumnName_User="User",t.Resources.BulkStatusDialogText_LabelFailed="Failed",t.Resources.BulkStatusDialogText_LabelSuccess="Success",t.Resources.BulkStatusDialogText_LabelWarning="Warning",t.Resources.BulkStatusDialogText_LabelCanceled="Canceled",t.Resources.BulkStatusDialogText_LabelCanceling="Canceling",t.Resources.BulkStatusDialogText_LabelRunning="Running",t.Resources.BulkStatusDialogText_ActionStatus2="{0}: {1}",t.Resources.BulkStatusDialogText_NumSuccessful1="{0} successful",t.Resources.BulkStatusDialogText_NumFailed1="{0} failed",t.Resources.BulkStatusDialogText_NumCanceled1="{0} canceled",t.Resources.BulkStatusDialogText_NumWarning1="{0} completed with warnings",t.Resources.BulkStatusDialogTitle_ViewStatus="View status",t.Resources.BulkStatusDialogTitle_Action="Action",t.Resources.BulkStatusDialogTitle_StatusSummary="Status summary",t.Resources.BulkStatusMessage_ExtensionNotAssignedToAccessLevel2="{0} cannot be assigned to users with a {1} access level.",t.Resources.BulkStatusMessage_ProjectMembershipInheritedWarning="If membership is given through a group, project membership was not removed.",t.Resources.ButtonAnnounce_AddAll="All project added",t.Resources.ButtonText_AddAll="Add all",t.Resources.ButtonText_Assign="Assign",t.Resources.ButtonText_Close="Close",t.Resources.ButtonText_Details="Details",t.Resources.ButtonText_MoreDetails="More details",t.Resources.ButtonText_LessDetails="Less details",t.Resources.ButtonText_Dismiss="Dismiss",t.Resources.ButtonText_DismissAll="Dismiss all",t.Resources.ButtonText_Manage="Manage",t.Resources.ButtonText_ManageCount1="Manage ({0})",t.Resources.ButtonText_Refresh="Refresh",t.Resources.ButtonText_ResoveAllGroupRules="Re-evaluate rules",t.Resources.ButtonText_Revoke="Revoke",t.Resources.ButtonText_Summary="Summary",t.Resources.ButtonText_ViewAll="View all",t.Resources.ButtonText_Invite="Add users",t.Resources.ButtonText_ReEvaluate="Re-evaluate",t.Resources.ContextualMenuOptionExportCSV="Export users",t.Resources.ContextualMenuOptionManageMembers="Manage members",t.Resources.ContextualMenuOptionReinstateAssets="Reinstate Assets",t.Resources.ContextualMenuOptionRemoveDirectAssignment="Remove direct assignments",t.Resources.ContextualMenuOptionResendInvite="Resend invite",t.Resources.DescriptionText_NotificationsPanel="System issues are problems in the system that require admin attention. Session notifications are triggered by user activities in this session.",t.Resources.DialogColProjectName="Projects",t.Resources.DialogErrorMessage_Remove="during the removal process",t.Resources.DialogErrorMessage_ServicePageLinkText="service page for updates",t.Resources.DialogErrorMessage_Template2="Oops! Something went wrong {0}. Please check our {1}, and try again later.",t.Resources.EditGroupMembers_DialogTitle="Manage group members",t.Resources.EditGroupMembers_IdentityPickerAddMembersLabel="Add members",t.Resources.EditGroupMembers_IdentityPickerRemoveMembersLabel="Remove members",t.Resources.EditGroupMembers_LoadUsersButtonTitle="Load more members",t.Resources.EditUserBulkDialog_RemoveFromAccount="Remove from organization",t.Resources.ExtensionsListEmptyMessage="There are no extensions installed",t.Resources.FilterBar_FilterUsers="Filter users",t.Resources.FilterBar_FilterRules="Filter rules",t.Resources.FormText_UserEditDialogBulk_AddToProjects="Select the projects you want the users to be added to",t.Resources.FormText_UserEditDialogBulk_AssignExtensions="Select the extensions you want to assign to the users",t.Resources.FormText_UserEditDialogBulk_ChangeAccessLevel="Select the access level to apply to the users",t.Resources.FormText_UserEditDialogBulk_RemoveFromProjects="Select the projects you want the users to be removed from",t.Resources.FormText_UserEditDialogBulk_RevokeExtensions="Select the extensions you want to revoke from the users",t.Resources.GroupCommandBar_ReevaluateRules="Re-evaluate Rules",t.Resources.GroupResolve_BuyMissingItemsAndRefreshHeader="Buy the missing items below and click Fix errors to update.",t.Resources.GroupResolve_CalculatingMissingResources="calculating all missing resources",t.Resources.GroupResolve_ClickFixErrorsToPerformActions="Click Fix errors to assign the items below to users.",t.Resources.GroupResolve_FixAssignmentIssues="Fix assignment errors",t.Resources.GroupResolve_FixErrors="Fix errors",t.Resources.GroupResolve_FixingAssignmentErrors="fixing assignment errors",t.Resources.GroupResolve_GroupTooLarge="This group is too large to calculate all possible missing resources.",t.Resources.GroupResolve_NothingToFix="There are no missing group assignments or access level assignments at this time.",t.Resources.GroupResolve_OneMoment="One moment... we're working on",t.Resources.GroupResolve_RunningApplyJob="There is already a job running to apply all rules. Wait till job completes to resolve group rules",t.Resources.GroupResolve_toAssign1="{0} to assign",t.Resources.GroupResolve_Running="Applying group rule is currently in progress",t.Resources.GroupResolve_Deleting="Deleting group rule is currently in progress",t.Resources.GroupResolve_UsersMissingLicenses="Users are missing extensions and basic access levels.",t.Resources.HubButtonTextCancel="Cancel",t.Resources.HubButtonTextReinstate="Reinstate Assets",t.Resources.HubButtonTextRemove="Remove",t.Resources.HubColEmail="Email",t.Resources.HubSummary_Assigned="Assigned",t.Resources.HubSummary_Available="Available",t.Resources.HubSummary_BrowseExtensions="Browse extensions",t.Resources.HubSummary_Free="Free",t.Resources.HubSummary_InvalidAccessLevelDropdownInformation="Some of these users have invalid access levels, and the Stakeholder experience",t.Resources.HubSummary_NoExtensionsInstalled="There are no extensions installed",t.Resources.HubSummary_Paid="Paid",t.Resources.HubSummary_Total="Total",t.Resources.HubSummary_TrialExtension1="Trial expires in {0} days",t.Resources.HubSummary_TrialExtensionExpired="This trial has expired",t.Resources.HubTitleManageUsers="Users",t.Resources.LabelText_ProjectSecurityGroups="Azure DevOps Groups",t.Resources.LabelText_VstsGroupName="Azure DevOps group name",t.Resources.LabelText_WithUsers="With users...",t.Resources.LabelText_SelectExtensions="Select extensions",t.Resources.LabelText_Filtered="Filtered",t.Resources.LabelText_Selected="Selected",t.Resources.LabelText_Total="Total",t.Resources.ListHeaderText_AssignedExtensions="Assigned extensions",t.Resources.ListHeaderText_OtherExtensions="Other extensions",t.Resources.ListItemSeparatorAlt=" | ",t.Resources.ListItemSeparator_And=" and ",t.Resources.ListItemSeparator_LastAnd=", and ",t.Resources.NoResults_NoGroupRulesFound="No group rules found",t.Resources.NoResults_NoGroupRulesMatchFilter="No group rules match your filter",t.Resources.NoResults_NoUsersMatchFilter="No users match your filter",t.Resources.NoResults_NoDirectMembersFound="No direct members found",t.Resources.Notification_AddUsers_Action2="Add {0} {1}",t.Resources.Notification_AddGroupRule_Action1="Add group rule {0}",t.Resources.Notification_BulkChangeMembers_Action_AddToProjects3="Add {0} users to {1} {2}",t.Resources.Notification_BulkChangeMembers_Action_RemoveFromProjects3="Remove {0} users from {1} {2}",t.Resources.Notification_BulkChangeMembers_Action_AssignExtensions3="Assign {1} {2} to {0} users",t.Resources.Notification_BulkChangeMembers_Action_RevokeExtensions3="Revoke {1} {2} for {0} users",t.Resources.Notification_BulkChangeMembers_Action_ChangeAccessLevel2="Change access level to {0} for {1} users",t.Resources.Notification_BulkChangeMembers_Action_RemoveUsers1="Remove {0} users",t.Resources.Notification_ChangeMember_Description_ChangeAccessLevel1="Change access level to {0}",t.Resources.Notification_ChangeMember_Description_AddToProject2="Add to project {0} with Azure DevOps group of {1}",t.Resources.Notification_ChangeMember_Description_Summary_AddToProject2="Add to {0} {1}",t.Resources.Notification_ChangeMember_Description_RemoveFromProject1="Remove {0} from project",t.Resources.Notification_ChangeMember_Description_Summary_RemoveFromProject2="Remove from {0} {1}",t.Resources.Notification_ChangeMember_Description_Summary_ChangeProjectPermissions2="Change Azure DevOps group for {0} {1}",t.Resources.Notification_ChangeMember_Description_ChangeProjectPermissions2="Change Azure DevOps group of project {0} to {1}",t.Resources.Notification_ChangeMember_Description_Summary_AssignExtension2="Assign {0} {1}",t.Resources.Notification_ChangeMember_Description_AssignExtension1="Assign extension: {0}",t.Resources.Notification_ChangeMember_Description_Summary_RevokeExtension2="Revoke {0} {1}",t.Resources.Notification_ChangeMember_Description_RevokeExtension1="Revoke extension: {0}",t.Resources.Notification_ChangeSingleUser_Action1="Change {0}",t.Resources.Notification_ChangeGroup_Action1="Change group rule {0}",t.Resources.Notification_ReinstateAssets_Action1="Reinstate assets for user: {0}",t.Resources.Notification_RemoveDirectAssignments_Action2="Remove direct assignments for {0} {1}",t.Resources.Notification_RemoveGroup_Action1="Remove group rule {0}",t.Resources.Notification_RemoveUser_Action1="Remove {0} from organization",t.Resources.Num_Extensions_Plural1="{0} extensions",t.Resources.Num_Extensions_Singular="1 extension",t.Resources.Num_Projects_Plural1="{0} projects",t.Resources.Num_Projects_Singular="1 project",t.Resources.Num_Users_Plural1="{0} users",t.Resources.OperationName_AddToProject1="Add to project: {0}",t.Resources.OperationName_AssignExtension1="Assign extension: {0}",t.Resources.OperationName_RemoveFromProject1="Remove from project: {0}",t.Resources.OperationName_RemoveUser="Remove user",t.Resources.OperationName_RevokeExtension1="Revoke extension: {0}",t.Resources.PickerStatusText_NoExtensionsFound="No extensions found.",t.Resources.ProjectInviteDialog_AccessLevelAssignedPlural1=" and assigned an access level to {0} users",t.Resources.ProjectInviteDialog_AccessLevelAssignedSingular=" and assigned an access level to 1 user",t.Resources.ProjectInviteDialog_AddToTeam1="Add to {0}.",t.Resources.ProjectInviteDialog_AddToTeams="Add to team(s)",t.Resources.ProjectInviteDialog_AddUsersTitleTemplate1="Invite members to {0}",t.Resources.ProjectInviteDialog_AddUsersSubTitle1="Search and add users to your {0}",t.Resources.ProjectInviteDialog_AssignLicenseAndTeams="Assign license and add to selected teams.",t.Resources.ProjectInviteDialog_UserAddSingular2="Added 1 user to {0}{1}.",t.Resources.ProjectInviteDialog_UsersAddedPlural3="Added {0} users to {1}{2}.",t.Resources.ProjectInviteDialog_UserNotInAccountWarning1="{0} has not been assigned an access level, we will attempt to assign {1}.",t.Resources.ProjectInviteDialog_UserNotInAccountWarning1_Fallback="default license.",t.Resources.ProjectInviteDialog_UserNotInAccountAssignmentBillingWarning1="{0} will be assigned {1} access if available.",t.Resources.ProjectInviteDialog_UserNotInAccountAssignmentBillingLinkText="Learn more about default access levels",t.Resources.ReEvaluateRulesDialog_Description="Users' resources will be updated based on their latest AAD group memberships. If a user has no group memberships, they will remain unaffected. This process may take up to 10 minutes. User resources may change during this time.",t.Resources.ReEvaluateRulesDialog_RunningJobExplaination="Users' resources will be updated based on their latest AAD group memberships. If a user has no group memberships, they will remain unaffected.",t.Resources.ReinstateAssetsDialog_DialogTitleSingular="Reinstate Assets",t.Resources.ReinstateAssetsDialog_LoseAssetsWarning="This action is not reversible.",t.Resources.ReinstateAssetsDialog_ReinstateAssetsPrompt1='A previous user with the same signin address "{0}" existed in this organization. Reinstating assets will give the new user full ownership of these previous assets.',t.Resources.RemoveDirectAssignmentDialog_NoChanges1="{0} will not lose access to any resources",t.Resources.ResendInvite_NoAadAdminPermissions="You are trying to resend an invite to a user from outside your directory, but you don't have permission to do so. Please contact your directory admin.",t.Resources.ResendInvite_GenericError="There was an error in resending your invite. Please wait and try again or contact your directory admin.",t.Resources.ResendInviteSingle_ActionDisplayName="Resend organization invite.",t.Resources.ResendInviteSingle_ActionDisplayNameFailure="Unable to resend invitation to 1 user. Please contact your directory admin.",t.Resources.ResendInviteSingle_ActionDisplayNameSuccess="1 organization invite resent.",t.Resources.RuleRunner_ErrorMessage="Something went wrong when performing the operation. Please try again later.",t.Resources.SpinnerLabelText_RemoveDirectAssignmentsPreview="Collection preview data for removing direct assignments",t.Resources.StatusText_ActionCanceling="Canceling, please wait...",t.Resources.StatusText_ActionCompletionProgress2="{0}/{1} actions completed",t.Resources.TabLabel_AllUsers="All users",t.Resources.TabLabel_Groups="Group rules",t.Resources.TextNumberOfUsersSelected="{0} users selected",t.Resources.TextTeamPickerNoSuggestions="No Teams Found",t.Resources.TextTeamsPlural1="{0} teams",t.Resources.TextTeamSingular="1 team",t.Resources.TitleText_EditUserBulkDialog_ChangeAccessLevels="Change access levels",t.Resources.TitleText_EditUserBulkDialog_RemoveFromProjects="Remove from projects",t.Resources.TitleText_EditUserBulkDialog_RevokeExtensions="Revoke extensions",t.Resources.TitleText_EditUserBulkDialog_RemoveFromOrganization="Remove from organization",t.Resources.TitleText_Issues="System issues",t.Resources.TitleText_Messages="Session notifications",t.Resources.TitleText_Notifications="Notifications",t.Resources.TitleText_Users="Users",t.Resources.TitleText_ReEvaluateRulesDialog_ReEvaluateRules="Re-evaluate group rules",t.Resources.TextProjectPickerNoSuggestions="No Projects Found",t.Resources.Text_Issue_Singular="system issue",t.Resources.Text_Issue_Plural="system issues",t.Resources.Text_Message_Singular="session notification",t.Resources.Text_Message_Plural="session notifications",t.Resources.Text_Project_Singular="project",t.Resources.Text_Project_Plural="projects",t.Resources.Text_Extension_Singular="extension",t.Resources.Text_Extension_Plural="extensions",t.Resources.Text_RunningTask_Singular="running task",t.Resources.Text_RunningTask_Plural="running tasks",t.Resources.Text_User_Singular="user",t.Resources.Text_User_Plural="users",t.Resources.TextTemplate_CountItems2="{0} {1}",t.Resources.IdentityPickerText_AddUsers="Add users",t.Resources.UserDialog_LearnMore="Learn more",t.Resources.UserDialog_LearnMore_AriaLabel="Learn more about inviting users from oustside your directory",t.Resources.UserManagemengMessageBar_ShouldBackMsaAccount="We suggest connecting your Azure DevOps organization to an Azure Active Directory tenant.",t.Resources.UserInviteDialog_CreateAProject="Create a project",t.Resources.UserInviteDialog_NoProjectsFound="No projects found.",t.Resources.UserInviteDialog_NoProjectsFound1="No projects found. {0}",t.Resources.UserRemoveDialog_AADWarning1="{0} will continue to have access even after removal if the user is a member of an AAD group that has been added to this organization.",t.Resources.UserRemoveDialog_AADWarningLink_AriaLabel="Learn more about AAD groups",t.Resources.UserRemoveDialog_ActionDisplayName1="Remove {0} users from organization.",t.Resources.UserRemoveDialog_DialogTitlePlural="Remove existing users",t.Resources.UserRemoveDialog_DialogTitleSingular="Remove existing user",t.Resources.UserRemoveDialog_GenericWarning="Deleting a user from the organization will remove their permissions permanently.",t.Resources.UserRemoveDialog_RemoveUserPrompt2="Are you sure you want to remove {0} from the organization {1}?",t.Resources.UserRemoveDialog_SomeUsers="Some users",t.Resources.UserRemoveDialog_TheseUsers="these users",t.Resources.UserRemovedSingular="1 user removed.",t.Resources.WarningMessageText_AccessLevelChange2="{0} will have access level changed to {1}.",t.Resources.WarningMessageText_LoseAccessTo2="{0} will lose access to {1}.",t.Resources.WarningMessageText_Missing1="{0}+ missing",t.Resources.ExtensionDisabled_AccessLevelLimitation="This extension requires Basic access level for assignment",t.Resources.Hub_AllUsersHaveTrialExtensions="trial available to all users",t.Resources.Text_LicensesAvailableCount1="{0} available",t.Resources.Text_LicensesMissingCount1="{0} missing",t.Resources.Text_LicensesMissingCountPlus1="{0} or more missing",t.Resources.ExtensionDisabled_MsdnInheritance1="from {0}",t.Resources.UserBuyLink="Buy more",t.Resources.RefreshIcon_ExtensionRefreshDescription="Refreshes extension license information for this organization with most recent data",t.Resources.InviteDialog_ExtensionUnassignable="This extension has no licenses available to assign",t.Resources.UserInviteDialog_Extensions="Extensions",t.Resources.UserInviteDialog_SendEmailAriaLabel="Send email to invited users",t.Resources.UserInviteDialog_AddButton="Add",t.Resources.UserInviteDialog_SendEmails="Send email invites",t.Resources.GroupRules_BuildGroupEntitlementFailed="The group rule was added successfully, but there was an error fetching the results. Please try reloading the page.",t.Resources.ProjectInviteDialog_FailedToAddNoPermissions="You do not have permission to add users to this team.",t.Resources.DialogErrorMessage_Generic1="Oops! Something went wrong. Please check our {0}, and try again later.",t.Resources.UserInviteDialog_ValidRefreshTokenNotFound="When attempting to invite a guest user to the AAD tenant, a valid refresh token was not found. Please sign out and try again.",t.Resources.DialogErrorMessage_AddUsers="when adding users",t.Resources.GuestInviteError_GuestAadInviteGenericFailure1="You are trying to invite a user from outside your directory, but something went wrong. Please try again later. If the issue persists, please {0}.",t.Resources.UserDialog_ContactSupport="contact support",t.Resources.UserInviteDialog_AccessLevel="Access level",t.Resources.TitleText_EditUserBulkDialog_AddToProjects="Add to projects",t.Resources.SearchProjects_AriaLabel="Search projects",t.Resources.UserInviteDialog_AddUserMessageSingle="Adding 1 user",t.Resources.UserInviteDialog_AddUserMessagePlural1="Adding {0} users",t.Resources.PunctuationPeriod=".",t.Resources.PunctuationSuffix=" ",t.Resources.ListItemSeparator=", ",t.Resources.UserInviteDialog_AddUserStatusBarCommandTo="to",t.Resources.UserInviteDialog_AddUserStatusBarCommandSingle2="Add 1 user with {0} access level{1}.",t.Resources.UserInviteDialog_AddUserStatusBarCommandPlural3="Add {0} users with {1} access level{2}.",t.Resources.UserInviteDialog_AddUserSuccess="Successfully added user.",t.Resources.OperationName_AddUser="Add user",t.Resources.TitleText_EditUserBulkDialog_AssignExtensions="Assign extensions",t.Resources.UserInviteDialog_AccessLevelBasic="Basic",t.Resources.UserInviteDialog_Users="Users",t.Resources.UserInviteDialog_IdentityPickerPlaceholder="Use semicolons to separate multiple email addresses.",t.Resources.UserInviteDialog_InviteUserToAadWarning1="You are inviting users from outside your directory. The user(s) {0} will need to click the link in their invitation e-mail to be able to access the organization and its resources. ",t.Resources.UserInviteDialog_InviteUserFromGitHubWarning1="Invitation emails cannot be sent to GitHub user(s) {0}. To help them sign-in, share the Organization URL with them",t.Resources.UserInviteDialog_MaxUsersToAdd1="There can not be more than {0} users added at once.",t.Resources.UserInviteDialog_DialogTitle="Add new users",t.Resources.GroupAssignmentIcon_CalloutTitle="Inheriting from Group Rules:",t.Resources.GroupAssignmentIcon_CalloutNoMatchesExplaination="Missing resources granted by group rules. Please resolve assignments or re-evaluate rules.",t.Resources.GroupAssignmentIcon_CalloutGroupTypeAad="AAD group",t.Resources.GroupAssignmentIcon_CalloutGroupTypeVsts="Azure DevOps group",t.Resources.AccessLevelIcon_CalloutLabel="Access level information regarding Visual Studio Subscriber",t.Resources.AccessLevelInfo_StatusMessageTitle="Access level status message:",t.Resources.AccessLevelIcon_HoverInfoLabel="Focus or hover for dialog regarding Visual Studio Subscriber",t.Resources.CommandButtonText_AddSingleGroupRule="Add a group rule",t.Resources.DialogErrorMessage_AddGroup="when adding the group rule",t.Resources.ButtonText_CreateNewVstsGroup="Create a new Azure DevOps group",t.Resources.ButtonText_SelectFromSingleExistingGroup="Select from an existing Azure DevOps or AAD group",t.Resources.BulkStatusDialogColumnName_Group="Group",t.Resources.AddGroupConfirmation1="Add {0} group rule.",t.Resources.OperationName_AddGroup="Add group rule",t.Resources.IdentityPickerLabelText_Group="Azure DevOps or AAD group",t.Resources.UserInviteDialog_IdentityPickerGroupPlaceholder="Search groups",t.Resources.ButtonText_SaveChanges="Save",t.Resources.EditUserDialog_AccessLevelUnchangable="The access level is unchangeable because the user has a valid Visual Studio subscription.",t.Resources.EditUserDialog_DowngradeWithExtensions="Downgrading access level to Stakeholder may cause some extensions to be removed.",t.Resources.ContextualMenuButtonText_ChangeAccessLevel="Change access level",t.Resources.ContextualMenuButtonText_ManageGroupRule="Manage group rule",t.Resources.ContextualMenuButtonText_ManageUser="Manage user",t.Resources.TextLastAccessedDateNever="Never",t.Resources.EditUserDialog_PendingSubscriber="This user’s subscription will be validated when the user signs in. At that time, they will be assigned an access level and/or set of extensions based on their subscription.",t.Resources.EditUserDialog_InvalidSubscriber="We could not find a Visual Studio subscription assigned to this user. Please ensure that the user has properly linked their subscription or assign them a Basic access level.",t.Resources.EditUserDialog_InvalidMsdnSubscription="The Visual Studio subscription associated with this user is no longer active. Please have the user sign-out and sign-in to revalidate the subscription or assign them a valid access level.",t.Resources.UserInviteDialog_MoreInformation="More information.",t.Resources.ProjectSelection_GroupOptionDropdownLabel1="Group Option for {0}",t.Resources.RoleType_Custom="Custom",t.Resources.GroupAssignmentIcon_HoverInfoLabel="Focus or hover for dialog regarding Group Assignment information",t.Resources.ProjectInheritence_CalloutLabel="Project inheritance information",t.Resources.ProjectInheritence_CalloutExplaination="This project membership is inherited from a group",t.Resources.EditUserDialog_ProjectsTabTitle="Projects",t.Resources.EditUserDialog_ExtensionsTabTitle="Extensions",t.Resources.EditUserDialog_GroupRulesTabTitle="Group Rules",t.Resources.EditGroupDialog_MembersTabTitle="Members",t.Resources.EditUserDialog_ManageUser="Manage user",t.Resources.ButtonText_Preview="Preview",t.Resources.GroupEdit_ChangeAccessLevels="Change access levels",t.Resources.EditGroupDialog_DowngradeWithExtensions="Downgrading access level to Stakeholder may cause some extensions to be removed.",t.Resources.EditGroupMembersDialog_CannotEditAadGroup="Members from an AAD group cannot be edited",t.Resources.LabelText_TestLicensingRuleApplicationWait="We are collecting details....",t.Resources.WarningMessageText_DowngradeAccessLevel_Plus2="{0}+ users will have access level changed to {1}.",t.Resources.WarningMessageText_DowngradeAccessLevel_Singular1="1 user will have access level changed to {0}.",t.Resources.WarningMessageText_DowngradeAccessLevel_Plural2="{0} users will have access level changed to {1}.",t.Resources.GroupEdit_GroupTooLarge="This group is too large to calculate all potential changes. There may be changes to users after editing. After processing is complete, a notification will be sent summarizing modifications.",t.Resources.WarningMessageText_DowngradeExtension_Plus2="{0}+ users will lose access to {1}.",t.Resources.WarningMessageText_DowngradeExtension_Singular1="1 user will lose access to {0}.",t.Resources.WarningMessageText_DowngradeExtension_Plural2="{0} users will lose access to {1}.",t.Resources.GroupEdit_NoPreviewChanges="After collecting details, there will be no visible changes to users after editing.",t.Resources.GroupEdit_ManageGroupRules="Manage group rules",t.Resources.ContextualMenuOptionManageExtensions="Manage extensions",t.Resources.ContextualMenuOptionManageProjects="Manage projects",t.Resources.DialogTitle_RemoveAadGroupRule1="Remove {0} group rule",t.Resources.DialogMessage_RemoveAadGroupRule1="Users in the group '{0}' will lose access to group resources unless they have been explicitly assigned to them or the resources have been made available to them through a group rule. The group will not be deleted.",t.Resources.DialogCheckbox_RemoveGroupMembership1="Remove {0} from all project level groups",t.Resources.GroupRules_RemovedRuleMessageBarMessage1="Removed group rule for {0}.",t.Resources.EditGroupMembers_IdentityPickerSearchByName="Search by name",t.Resources.AccessLevel_Invalid="Invalid",t.Resources.MemberList_CheckboxLabel="Select user in row and add them to current list of users to edit",t.Resources.MemberList_CheckboxAllLabel="Select all users in users list to edit",t.Resources.SpinnerLabel_WorkingOnIt="Working on it...",t.Resources.MemberList_ActionButtonLabel="Show actions for editing the selected users",t.Resources.MemberList_LoadNextPage="Load more users",t.Resources.DisplayNameWithAadDeleted1="{0} (Deleted from Azure AD)",t.Resources.GroupRules_IncompatibleState="Some extensions could not be assigned because users in the group have insufficient licenses.",t.Resources.GroupRules_UnableToApplyState="Group rule have assignment errors",t.Resources.HubColName="Name",t.Resources.HubColExtensions="Extensions",t.Resources.HubColAccessLevel="Access Level",t.Resources.HubColLastEvaluated="Last Evaluated",t.Resources.HubColLastAccessed="Last Accessed",t.Resources.HubColDateAdded="Date Added",t.Resources.HubColLicenseSource="License Source",t.Resources.EditUserDialog_ButtonTitle1="Edit {0}",t.Resources.ContextualMenuButtonText_Remove="Remove",t.Resources.SummaryHeader_Tooltip1="Filter list of users with {0}",t.Resources.WarningIcon_UninstalledExtensionMessage="This extension is paid for or has some assignments and is not installed on the organization. Users will not have access to given extension without installation.",t.Resources.HubSummary_TrialExtensionExpired1="Trial expired on {0}",t.Resources.HubSummary_Title="Summary",t.Resources.HubSummary_TotalUsers="Total Users",t.Resources.HubSummary_Users="Users",t.Resources.HubSummary_Extensions="Extensions",t.Resources.HubSummary_ChangeQuantity="Change quantity",t.Resources.HubSummary_Buy="Buy",t.Resources.HubSummary_NextMonthMissing="Users will lose this access level next month",t.Resources.HubSummary_NextMonthTotal="Next month total assignable",t.Resources.HubSummary_NextMonthTotalInfo="Showing information to verify that next month's billing cycle will keep user status's healthy",t.Resources.FilterLabel_Guest="Guest",t.Resources.FilterLabel_Member="Member",t.Resources.FilterPlaceholder_AadUserType="AAD User Type",t.Resources.CopyToClipBoard_Copy="Copy",t.Resources.CopyToClipBoard_Copied="Copied",t.Resources.GitHubSearchWarning_CalloutLabel="Warning information regarding GitHub search disabled",t.Resources.GitHubSearchWarning_HoverInfoLabel="Focus or hover for callout regarding GitHub search disabled",t.Resources.GitHubSearchWarning_TooltipContent="GitHub search is currently enabled only for GitHub users.",t.Resources.UsersSummary_LearnMore="Learn more",t.Resources.WarningMessage_GroupRulesAssignmentErrors="Group rules have assignment errors",t.Resources.WarningMessage_BilingIssues="Billing issues",t.Resources.UserInviteDialog_AadGuestAdminWarning="You are a Guest in the connected Azure AD and Guests may not be able to search users in the Azure AD. Please contact your Azure AD admin to make you a member of the connected Azure AD to enable searching for users.",t.Resources.WarningMessage_CannotAddProjectGroup="Cannot add a project group rule. All group rules must be an organization level group.",t.Resources.BillingCycle_OnDateWillHaveSingular3="On {0}, your organization will have {1} {2} access level.",t.Resources.BillingCycle_OnDateWillHaveMultiple3="On {0}, your organization will have {1} {2} access levels.",t.Resources.BillingCycle_NumberWillLoseAccessMultiple1="As is, {0} users will lose access to resources at the end of the month.",t.Resources.BillingCycle_NumberWillLoseAccessSingular1="As is, {0} user will lose access to resources at the end of the month.",t.Resources.ErrorTitle_ConfigurationError="We have trouble loading your user hub configuration",t.Resources.ErrorMessage_ConfigurationError1="You might experience issues working with user hub. Please check our {0}, and try again later. If this problem persists, please contact support.",t.Resources.AccessLevelAssignmentSourceDirect="Direct",t.Resources.AccessLevelAssignmentSourceGroupRule="Group Rule",t.Resources.UserTable_AriaLabel="User table",t.Resources.GroupTable_AriaLabel="Group table",t.ComponentsCommoncommon={},fe=t.GeneratedConstants={},(t.GeneratedConstants.ContributionIds||(t.GeneratedConstants.ContributionIds={})).UserHubDataProviderContributionId="ms.vss-aex-user-management-web.aex-user-hub-data-provider",(t.GeneratedConstants.DataProviderKeys||(t.GeneratedConstants.DataProviderKeys={})).GroupId="groupId",(tn=t.GeneratedConstants.DirectoryEntityType||(t.GeneratedConstants.DirectoryEntityType={})).User="User",tn.Group="Group",(en=t.GeneratedConstants.DirectoryName||(t.GeneratedConstants.DirectoryName={})).VisualStudioDirectory="vsd",en.AzureActiveDirectory="aad",en.MicrosoftAccount="msa",en.GitHub="ghb",(Xs=t.GeneratedConstants.ErrorCodes||(t.GeneratedConstants.ErrorCodes={})).General=5e3,Xs.IdentityNotFound=5001,Xs.InvalidIdentity=5002,Xs.InvalidProjectId=5003,Xs.RemoveUserFromAccountError=5004,Xs.AssignedLicenseFailed=5005,Xs.AssignedExtensionFailed=5006,Xs.UnassignExtensionFailed=5007,Xs.UnsupportedOperation=5008,Xs.RemoveIdentityFromSecurityGroupError=5009,Xs.GroupDoesNotExist=5010,Xs.MultipleErrors=5011,Xs.LicenseTypeConversionError=5012,Xs.ExportCSVFailed=5013,Xs.MemberNotInProject=5014,Xs.NotEnoughLicenses=5015,Xs.CannotDowngradeAccountAdmin=5016,Xs.InvalidLicenseType=5017,Xs.ExtensionUnassignable=5018,Xs.InvalidMemberEntitlement=5019,Xs.GroupAddJobFailed=5020,Xs.GroupRemoveOperationFailed=5021,Xs.GroupCreationFailed=5022,Xs.IdentityGetOrCreateError=5023,Xs.GroupGetOrCreateError=5024,Xs.InvalidGroupDisplayName=5025,Xs.InvalidGroupId=5026,Xs.GroupApplyAllOperationFailed=5028,Xs.GroupUpdateOperationFailed=5029,Xs.InvalidTeamId=5030,Xs.TeamsApiUnavailable=5031,Xs.AccessDenied=5032,Xs.InvalidEmail=5033,Xs.CannotChangeGroupAssignment=5034,Xs.NotEnoughExtensionLicenses=5035,Xs.SendInviteFailed=5036,Xs.BuildGroupEntitlementFailed=5037,Xs.BuildUserEntitlementFailed=5038,Xs.RemoveDirectAssignmentsForNewGroupMemebersFailed=5039,Xs.UserEntitlementNotFound=5040,Xs.NoMeterUsageReturned=5041,Xs.ExternalGuestAccessDenied=5101,Xs.GuestAadInviteGenericFailure=5102,Xs.GuestUserInviterError=5103,Xs.GuestUsersNotAllowedToPerfomAction=5104,Xs.InviteeHasSameDomain=5105,Xs.ValidRefreshTokenNotFound=5106,Xs.GuestUserBadRequest=5107,Xs.MemberAlreadyInProject=6001,Xs.SkippedAddInvalidGroup=6002,Xs.CannotCreateProjectLevelGroup=6003,(Zs=t.GeneratedConstants.ExceptionTypeKeys||(t.GeneratedConstants.ExceptionTypeKeys={})).UserManagementException="UserManagementException",Zs.MemberNotFoundException="UserNotFoundException",Zs.AccountAdminDowngradeLicenseException="AccountAdminDowngradeLicenseException",Zs.ChangeGroupAssignmentNotAllowedException="ChangeGroupAssignmentNotAllowedException",Zs.ExtensionUnassignableException="ExtensionUnassignableException",Zs.AssignLicenseNotAvailableException="AssignLicenseNotAvailableException",Zs.AssignExtensionsErrorException="AssignExtensionsErrorException",Zs.AssignExtensionLicenseNotAvailableException="AssignExtensionLicenseNotAvailableException",(Ys=t.GeneratedConstants.FeatureFlags||(t.GeneratedConstants.FeatureFlags={})).ShowMsaShouldBeAadBackedMessageBar="VisualStudio.UserManagement.ShowMsaShouldBeAadBackedMessageBar",Ys.DisableCheckForInstalledExtensions="VisualStudio.UserManagement.Web.DisableCheckForInstalledExtensions",Ys.HideLicenseAndExtensionCounters="VisualStudio.UserManagement.Web.UserHub.HideLicenseAndExtensionCounters",Ys.ReinstateAssets="VisualStudio.UserManagement.Web.UserHub.ReinstateAssets",Ys.EnableDefaultLicensing="VisualStudio.UserManagement.EnableDefaultLicensing",Ys.EnableBillingTabLinks="VisualStudio.UserManagement.EnableBillingTabLinks",Ys.ForwardFrameworkRequestsToLps="VisualStudio.Services.Licensing.ForwardFrameworkRequestsToLps",Ys.EnableDateAddedColumn="AzureDevOps.Services.UserManagement.EnableDateAddedColumn",(Qs=t.GeneratedConstants.FeatureManagementScopeConstants||(t.GeneratedConstants.FeatureManagementScopeConstants={})).User="me",Qs.Account="host",(Js=t.GeneratedConstants.IdentityConstants||(t.GeneratedConstants.IdentityConstants={})).MsaDomain="Windows Live ID",Js.GitHubDomain="github.com",(t.GeneratedConstants.LinkConstants||(t.GeneratedConstants.LinkConstants={})).PaidBasicLicenseId="ms.vss-vstsuser",($s=t.GeneratedConstants.OperationTarget||(t.GeneratedConstants.OperationTarget={})).AccessLevel="accessLevel",$s.ProjectEntitlements="projectEntitlements",$s.Extensions="extensions",$s.TeamRefs="teamRefs",$s.ReinstateAssets="reinstateAssets",(Ks=t.GeneratedConstants.OriginName||(t.GeneratedConstants.OriginName={})).AzureActiveDirectory="aad",Ks.MicrosoftAccount="msa",Ks.VisualStudioTeamServices="vsts",Ks.GitHubDirectory="ghb",(Ws=t.GeneratedConstants.PerformanceScenarioConstants||(t.GeneratedConstants.PerformanceScenarioConstants={})).UserManagementFeatureArea="UserManagement",Ws.AddUsersFeatureName="Userhub.AddUsers",Ws.AddUsersToProjectFeatureName="Userhub.AddUsersToProject",Ws.AddGroupFeatureName="Userhub.AddGroup",Ws.GetUsersFirstFeatureName="Userhub.GetUsersFirstBatch",Ws.GetAllUsersFeatureName="Userhub.GetAllUsers",Ws.GetUserExtendedFeatureName="Userhub.GetUserWithExtendedProperties",Ws.EditUserFeatureName="Userhub.EditUser",Ws.EditUsersFeatureName="Userhub.EditUsers",Ws.EditGroupFeatureName="Userhub.EditGroup",Ws.RemoveUserFeatureName="Userhub.RemoveUser",Ws.RemoveGroupFeatureName="Userhub.RemoveGroup",Ws.PageLoadInteractiveFeatureName="Userhub.PageLoadInteractive",Ws.PageLoadCompleteFeatureName="Userhub.PageLoadComplete",(qs=t.GeneratedConstants.ScriptModuleNames||(t.GeneratedConstants.ScriptModuleNames={})).UserManagementHub="UserManagement/Scripts/Components/Hub/UserManagement.Collection",qs.AddUsersDialog="UserManagement/Scripts/UserManagement/AddUsersDialog",(zs=t.GeneratedConstants.ServiceInstanceIds||(t.GeneratedConstants.ServiceInstanceIds={})).GalleryServiceInstanceId="00000029-0000-8888-8000-000000000000",zs.AexServiceInstanceId="00000041-0000-8888-8000-000000000000",(Vs=t.GeneratedConstants.SubjectKind||(t.GeneratedConstants.SubjectKind={})).Group="group",Vs.User="user",(Os=t.GeneratedConstants.SubjectType||(t.GeneratedConstants.SubjectType={})).AadUser="aad",Os.MsaUser="msa",Os.AadGroup="aadgp",Os.VstsGroup="vssgp",Os.BindPendingUser="bnd",(Hs=t.GeneratedConstants.UserEntitlementFilterNames||(t.GeneratedConstants.UserEntitlementFilterNames={})).LicenseId="licenseId",Hs.LicenseStatus="licenseStatus",Hs.AssignmentSource="assignmentSource",Hs.UserType="userType",Hs.Name="name",(Bs=t.GeneratedConstants.UserEntitlementPropertyNames||(t.GeneratedConstants.UserEntitlementPropertyNames={})).Projects="projects",Bs.GroupRules="grouprules",(js=t.GeneratedConstants.UserEntitlementSortColumns||(t.GeneratedConstants.UserEntitlementSortColumns={})).DisplayName="DisplayName",js.Name="name",js.DateAdded="dateAdded",js.DateCreated="dateCreated",js.LastAccessDate="LastAccessDate",js.LastAccessed="lastAccessed",(ws=t.GeneratedConstants.UserHubConstants||(t.GeneratedConstants.UserHubConstants={})).DefaultGetUsersPageSize=1e4,ws.DefaultGetUsersFirstPageSize=100,ws.DefaultGetUsersPageSizeServerSideSearch=500,ws.DefaultGetUsersFirstPageSizeServerSideSearch=100,ws.DefaultMaxIdentitiesToAdd=50,ws.BulkEditMaxBatchSize=20,ws.BulkEditMaxBatchWorker=10,ws.BulkMaxGetExtensionsMembersCount=50,ws.ResolveGroupsResultRetrievalDelayTime=2e3,ws.GroupMembersBatchSize=100,(ks=t.GeneratedConstants.UserManagementLinks||(t.GeneratedConstants.UserManagementLinks={})).AadGroupHelpLink="https://go.microsoft.com/fwlink/?linkid=835749",ks.AadGuestPermissionsHelpLink="https://go.microsoft.com/fwlink/?linkid=848469",ks.StakeholderInformation="https://www.visualstudio.com/en-us/docs/work/connect/work-as-a-stakeholder",ks.ExternalGuestAccessDeniedHelpLink="https://aka.ms/external-guest-access",ks.GenericFailureSupport="https://azure.microsoft.com/en-us/support/devops/",ks.GuestUserInviterErrorHelpLink="https://docs.microsoft.com/en-us/azure/active-directory/active-directory-b2b-troubleshooting",ks.InvitedSubscriberInformationLink="https://go.microsoft.com/fwlink/?LinkID=733421",ks.GuestUserInviteLearnMore="https://aka.ms/invite-outside-users",ks.AddTeamProjectMemberLink="https://go.microsoft.com/fwlink/?linkid=858235",ks.UsersWillLoseAccessLevelsLink="https://go.microsoft.com/fwlink/?linkid=860985",ks.UsersWillLostSignInUnlessAadBackedLink="https://go.microsoft.com/fwlink/?linkid=869519",ks.AccountChangeLink="https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/change-organization-ownership?view=azure-devops",ks.ReinstateAssetsHelpLink="https://go.microsoft.com/fwlink/?linkid=2007012",ks.DefaultAccessLevelLink="https://aka.ms/defaultaccesslevel",ks.BasicPlusTestPlansLearnMoreLink="https://aka.ms/testmanagerfaq",(Gs=t.GeneratedConstants.UserMetaType||(t.GeneratedConstants.UserMetaType={})).Member="member",Gs.Guest="guest",(_s=t.GeneratedConstants.UsersSummaryPropertyNames||(t.GeneratedConstants.UsersSummaryPropertyNames={})).Projects="projects",_s.Groups="groups",_s.Licenses="licenses",_s.AccessLevels="accesslevels",_s.DefaultAccessLevel="defaultAccessLevel",function(e){ye=t.ContextUserHubContext={};class u{constructor(e,t){this.telemetryService=e,this.telemetryArea=t}publishBuyMoreLinkClickEvent(e){const t={extensionTitle:e};this.telemetryService.publishEvent(this.telemetryArea,u.features.summaryFeature,t)}publishClickUserInvitationEvent(e,t){const s=e?e.length:0,n=e&&e.length>0?e[0]:void 0,r={AccessLevel:n?n.accessLevel.licenseDisplayName:void 0,Extensions:n?n.extensions:void 0,NumberExtensions:n&&n.extensions?n.extensions.length:0,NumberFailed:t,NumberProjectEntitlements:n&&n.projectEntitlements?n.projectEntitlements.length:0,NumberSucceeded:s-t,NumberUsers:s,UserType:n?n.user.origin:void 0,ProjectEntitlements:n?n.projectEntitlements:void 0};this.telemetryService.publishEvent(this.telemetryArea,u.features.accountInvitationFeature,r)}publishCloseInvitationEvent(e){const t={CloseInvitation:!0,type:e?u.constants.userType:u.constants.groupType};this.telemetryService.publishEvent(this.telemetryArea,e?u.features.accountInvitationFeature:u.features.accountGroupInvitationFeature,t)}publishClickResendInviteEvent(e,t){const s={invitedUserId:e,invitedUserIsAadGuest:t};this.telemetryService.publishEvent(this.telemetryArea,u.features.resendInvitationFeature,s)}publishResendInvitationsError(e,t){const s={invitedUserId:e,resendError:t};this.telemetryService.publishEvent(this.telemetryArea,u.features.resendInvitationFeature,s)}}t.ContextUserHubContext.UserHubPageContextTelemetries=u,u.features={accountInvitationFeature:"Account Invitation",accountGroupInvitationFeature:"Account Group Invitation",accountUserDetailsFeature:"Account User Details",accountGroupDetailsFeature:"Account Group Details",summaryFeature:"Summary",resendInvitationFeature:"Resend Invitation"},u.constants={userType:"user",groupType:"group"};class m extends s.AexPageContextService{constructor(e,t,s,n){super(e,t,s),this.perfRef=n,this.userListMaxInflight=10,this.getCreateProjectLink=(0,o.memoizeFunction)(()=>{try{const e=this.getPageData(),t=e&&e.hostPath;if(!t)return;const s="ms.vss-tfs-web.suite-me-page-route",n="_a",r="newProject";return(0,l.routeUrl)(this.pageContext,s,{[n]:r},t)}catch(e){this.telemetry.trackException(e,"e")}}),this.ciTelemetry=new u(this.getService("IVssTelemetryService"),t)}get isShowMsaShouldBeAadBackedMessageBar(){return this.isFeatureFlagEnabled(fe.FeatureFlags.ShowMsaShouldBeAadBackedMessageBar)}get contributionService(){return this.getService("IVssContributionService")}get pageService(){return this.getService("IVssPageService")}get isHideLicenseAndExtensionCountersEnabled(){return this.isFeatureFlagEnabled(fe.FeatureFlags.HideLicenseAndExtensionCounters)}get orgName(){const e=this.getPageData();return e&&e.hostName}get orgHostUri(){const e=this.getPageData();if(e&&e.hostPath)return new URL(e.hostPath,window.location.href).href}get browseExtensionsLink(){const e=this.galleryDeploymentUrl;return e&&e+"vsts"}get billingTabRoute(){return(0,l.routeUrl)(this.pageContext,"ms.vss-admin-web.collection-admin-hub-route",{adminPivot:"billing"})}get globalMessagesService(){return this.getService("IGlobalMessagesService")}get galleryDeploymentUrl(){try{return this.getServiceLocation(fe.ServiceInstanceIds.GalleryServiceInstanceId,1)}catch(e){this.telemetry.trackException(e)}}getImageUrl(e){return this.getAssetLocation(e)}assembleLicenseLink(e){const t=this.isFeatureFlagEnabled("VisualStudio.UserManagement.EnableBillingTabLinks");if(!t||"ms.feed"!==e&&"ms.vss-testmanager-web"!==e&&e!==fe.LinkConstants.PaidBasicLicenseId){if(t&&"berichthaus.tfstimetracker"===e.toLowerCase())return"Berichthaus.TfsTimetracker.OrganizationSettings#Upgrade";{const t=this.getPageData(),s=t&&t.hostId,n=this.galleryDeploymentUrl;return s&&n&&n+"items?itemName="+encodeURIComponent(e)+"&install=true&accountId="+s+"&referrer="+encodeURIComponent(window.location.href)+"&source=UserHub&wt.mc_id=UserHub"}}return this.billingTabRoute}shouldUseLicensingService(){return this.isFeatureFlagEnabled("VisualStudio.Services.Licensing.ForwardFrameworkRequestsToLps")}async isGroupIdValidForGroupRule(e){try{const t=await this.pageContext.getService("IVssContributionService").getDataAsync(m.groupRuleValidationDataProviderId,{[fe.DataProviderKeys.GroupId]:e});if(!0===t||!1===t)return t}catch(e){this.telemetry.trackException(e,"UserHubPageContextService.isGroupValidForGroupRule")}return!0}}t.ContextUserHubContext.UserHubPageContextService=m,m.noResultsAssetsId="ms.vss-aex-user-management/user-hub-content/content/NoResults.svg",m.noResultsMatchedAssetsId="ms.vss-aex-user-management/user-hub-content/content/NoResultsMatched.svg",m.serviceContextDataProviderId="ms.vss-aex-user-management.aex-user-management-service-context",m.groupRuleValidationDataProviderId="ms.vss-aex-user-management.group-rule-validation-data-provider";const d=i.createContext(void 0);function p(){return i.useContext(d)}t.ContextUserHubContext.UserHubContextProvider=function(e){const{pageContext:t}=(0,a.useComponentContext)(),[s]=(0,r.useContributionData)(t,void 0,m.serviceContextDataProviderId),o=i.useMemo(()=>new m(t,e.telemetryArea,e.telemetryFeature,e.perfRef),[t,e.telemetryArea,e.telemetryFeature,s,e.perfRef]);return void 0===s?i.createElement("div",{className:"absolute-fill flex flex-column flex-center justify-center"},i.createElement(c.Spinner,{size:"large"})):i.createElement(d.Provider,{value:o},i.createElement(n.GeneralErrorContextProvider,{telemetry:o.telemetry},i.createElement(b,null,e.children)))},t.ContextUserHubContext.useUserHubContext=p;class g{}g.dataProviderId="ms.vss-aex-user-management.aex-user-hub-data-provider";const C=i.createContext(void 0);function b(e){const t=p(),[s,n]=(0,r.useContributionData)(t.pageContext,t.telemetry,g.dataProviderId),o=i.useMemo(()=>({configurationError:n,isAdmin:!(!s||!s.isAdmin),isAadAccount:!(!s||!s.isAadAccount),isAadGuest:!(!s||!s.isGuest),isGitHubInviteEnabled:!(!s||!s.isGitHubInviteEnabled),isGitHubUser:!(!s||!s.isGitHubUser),isGitHubSearchEnabled:!(!s||!s.isGitHubSearchEnabled),isReadonly:!(!s||!s.isReadonly),shouldUseServerSideSearch:!(!s||!s.shouldUseServerSideSearch),shouldUseSearchApis:!(!s||!s.shouldUseSearchApis),useUpdatedSearchQuery:!(!s||!s.useUpdatedSearchQuery),getUsersPageSizeServerSideSearch:s?s.getUsersPageSizeServerSideSearch:fe.UserHubConstants.DefaultGetUsersPageSizeServerSideSearch,getUsersFirstPageSizeServerSideSearch:s?s.getUsersFirstPageSizeServerSideSearch:fe.UserHubConstants.DefaultGetUsersFirstPageSizeServerSideSearch,getUsersPageSize:s?s.getUsersPageSize:fe.UserHubConstants.DefaultGetUsersPageSize,getUsersFirstPageSize:s?s.getUsersFirstPageSize:fe.UserHubConstants.DefaultGetUsersFirstPageSize,bulkMaxBatchSize:s?s.bulkMaxBatchSize:fe.UserHubConstants.BulkEditMaxBatchSize,bulkMaxBatchWorker:s?s.bulkMaxBatchSize:fe.UserHubConstants.BulkEditMaxBatchWorker,groupMembersBatchSize:s?s.groupMembersBatchSize:100,maxIdentitiesToAdd:s?s.maxIdentitiesToAdd:fe.UserHubConstants.DefaultMaxIdentitiesToAdd}),[s,n]);return i.createElement(C.Provider,{value:o},e.children)}t.ContextUserHubContext.UserHubConfigurationContextProvider=b,t.ContextUserHubContext.useUserHubConfiguration=function(){return i.useContext(C)}}(),function(e){Se=t.ComponentsControlsuseTrackedAsyncCallback={},t.ComponentsControlsuseTrackedAsyncCallback.useTrackedAsyncCallback=function(e,t,s,n){return i.useCallback(async(...r)=>{let i,o={properties:{},measurements:{}};if(!e)return t(...r);try{return e.telemetry.startTrackEvent(s),i=await t(...r)}catch(t){throw e.telemetry.trackException(t),t}finally{n&&(o=n(o,i,...r)),e.telemetry.stopTrackEvent(s,o.properties,o.measurements)}},[e,t,s])}}(),function(e){Ee=t[e]={};t[e].MemberEntitlementManagementClientName="AexMemberEntitlementManagement.IMemberEntitlementManagementRestClient",t[e].getMemberEntitlementManagementClient=function(s,n){return s.getRestClient(t[e].MemberEntitlementManagementClientName,n)},u.RestClients.add(t[e].MemberEntitlementManagementClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async addGroupEntitlement(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/GroupEntitlements/{groupId}",queryParams:s,body:e})}async deleteGroupEntitlement(e,t,s){const n={ruleOption:t,removeGroupMembership:s};return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e},queryParams:n})}async getGroupEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e}})}async updateGroupEntitlement(e,t,s){const n={ruleOption:s};return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:t},customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:n,body:e})}async getGroupEntitlements(){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupDescriptor}"})}async addMemberEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/MemberEntitlements/{memberId}",body:e})}async deleteMemberEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlements(e,t,s,n){const r={top:e,skip:t,filter:s,select:n};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",queryParams:r})}async updateMemberEntitlement(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async updateMemberEntitlements(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async addMemberToGroup(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async getGroupMembers(e,t,s){const n={maxResults:t,pagingToken:s};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e},queryParams:n})}async removeMemberFromGroup(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async addUserEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.3",method:"POST",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",body:e})}async searchUserEntitlements(e,t,s,n){const r={continuationToken:e,select:t,$filter:s,$orderBy:n};return this.beginRequest({apiVersion:"5.1-preview.3",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",queryParams:r})}async updateUserEntitlements(e,t){const s={doNotSendInviteForNewUsers:t};return this.beginRequest({apiVersion:"5.1-preview.3",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:s,body:e})}async deleteUserEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.3",method:"DELETE",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async getUserEntitlement(e){return this.beginRequest({apiVersion:"5.1-preview.3",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async updateUserEntitlement(e,t){return this.beginRequest({apiVersion:"5.1-preview.3",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/UserEntitlementSummary",queryParams:t})}},options:{resourceAreaId:"68ddce18-2501-45f1-a17b-7931a9922690"}})}("RestClientMemberEntitlementManagement"),function(e){xe=t[e]={},t[e].UsersSummaryContext=i.createContext({refresh:()=>Promise.resolve(void 0)});class s{static async refresh(e,t){const n=(0,Ee.getMemberEntitlementManagementClient)(e.pageContext);let r;t&&(r=t.map(e=>s.keyToSelectMapping[e]).join(","));const i=await n.getUsersSummary(r),o={};if(t)for(const e of t)switch(e){case"groupOptions":o.groupOptions=i.groupOptions;break;case"licenses":o.licenses=i.licenses,o.availableAccessLevels=i.availableAccessLevels;break;case"projectRefs":o.projectRefs=i.projectRefs;break;case"defaultAccessLevel":o.defaultAccessLevel=i.defaultAccessLevel}else o.groupOptions=i.groupOptions,o.licenses=i.licenses,o.availableAccessLevels=i.availableAccessLevels,o.projectRefs=i.projectRefs,o.defaultAccessLevel=i.defaultAccessLevel;return o}}s.keyToSelectMapping={licenses:fe.UsersSummaryPropertyNames.Licenses+","+fe.UsersSummaryPropertyNames.AccessLevels,groupOptions:fe.UsersSummaryPropertyNames.Groups,projectRefs:fe.UsersSummaryPropertyNames.Projects,defaultAccessLevel:fe.UsersSummaryPropertyNames.DefaultAccessLevel},t[e].UsersSummaryContextProvider=function(n){const r=(0,ye.useUserHubContext)(),[o,a]=(0,d.useAsyncState)({projectRefs:void 0,availableAccessLevels:void 0,licenses:void 0,groupOptions:void 0,defaultAccessLevel:void 0}),l={projectRefs:o.projectRefs,availableAccessLevels:o.availableAccessLevels,groupOptions:o.groupOptions,licenses:o.licenses,defaultAccessLevel:o.defaultAccessLevel,refresh:async(...e)=>{let t;t=0===e.length?await s.refresh(r):await s.refresh(r,e),a(e=>Object.assign(Object.assign({},e),t))}};return i.useEffect(()=>{n.summarykeys?l.refresh(n.summarykeys):l.refresh()},[]),i.createElement(t[e].UsersSummaryContext.Provider,{value:l},n.children)},t[e].useProjectRefsMapping=function(){const s=i.useContext(t[e].UsersSummaryContext);return i.useMemo(()=>{const{projectRefs:e}=s;if(!e)return;const t={};for(const s of e)t[s.id]=s;return t},[s.projectRefs])},t[e].useGroupOptionNames=function(){const s=i.useContext(t[e].UsersSummaryContext);return i.useMemo(()=>{const e={4:he.RoleType_Custom};if(s.groupOptions)for(const t of s.groupOptions)e[t.group.groupType]=t.group.displayName;return e},[s.groupOptions])}}("ContextUsersSummaryContexts"),Ae=t.Constants={},t.Constants.L2ClassNames={userManagementHub:"user-management-hub",userSummary:"user-hub-summary",userList:"user-list",groupList:"group-rule-list",userSearch:"user-list-search",userPivotHeader:"user-pivot-item-header",groupPivotHeader:"group-pivot-item-header",dropdowns:{accessLevel:{callout:"access-level-dropdown-callout"},projectGroupType:{callout:"project-group-type-dropdown-callout",itemPrefix:"project-group-type-item-"},bulkManageUsers:{callout:"bulk-manage-users-dropdown-callout"}},callouts:{actionButton:"callout-action-button",dismissButton:"callout-dismiss-button",previewButton:"callout-preview-button"},commandItems:{exportUsers:"export-users-command",addUsers:"add-users-command",bulkManageUsers:"bulk-manage-users-command",addGroupRule:"add-group-rule-command",usersSummary:"users-summary-command",changeAccessLevel:"change-access-level-command",removeFromOrganization:"remove-from-organization-command",createNewAzureDevOpsGroup:"create-new-azure-devops-group-rule-command",manageMember:"manage-member-command",removeDirectAssignment:"remove-direct-assignment-command"},formItems:{userIdentityPicker:"user-identity-picker-form-item",groupIdentityPicker:"group-identity-picker-form-item",accessLevelsDropdown:"access-levels-dropdown-form-item",createNewAzureDevOpsGroupName:"create-new-azure-devops-group-name-form-item"},checkBoxes:{editMemberProject:"edit-member-project-checkbox"},lists:{usersTable:"users-table",groupsTable:"groups-table",memberProjects:"member-projects-list"},cards:{users:"users-card",groups:"groups-card"},menus:{editUser:"edit-user-menu",editGroup:"edit-group-menu"},memberTable:{accessLevel:"member-table-access-level",groupStatusPrefix:"member-table-group-status-"},tableColumnHeaders:{accessLevel:"table-header-access-level",displayName:"table-header-display-name",dateAdded:"table-header-date-added",licenseSource:"table-header-license-source",lastAccess:"table-header-last-access"},FilterItems:{accesslevels:"filterbar-accesslevels",usertypes:"filterbar-usertype",licenseSource:"filterbar-licenseSource",accesslevelPickList:"picklist-filterbar-accesslevels",usertypePickList:"picklist-filterbar-usertype",licenseSourcePickList:"picklist-filterbar-licenseSource"},ListHeaders:{displayName:"listHeader-displayName",accessLevel:"listHeader-access-level",lastAccessedDate:"listHeader-last-accessed-date"},ListRow:{baseRow:"member-list-row",displayName:"member-list-display-name",accessLevel:"member-list-accesslevel",dateAdded:"member-list-dateAdded",licenseSource:"member-list-licenseSource",licenseSourceText:"member-list-licenseSource-text",lastAccess:"member-list-lastAccessed",lastAccessText:"member-list-lastAccessed-text"},SummaryAreas:{accesslevel:"summary-access-level",accessLevelItem:"summary-access-level-item",accessLevelTotal:"summary-access-level-total"},panels:{addUsers:{root:"add-users-panel"},addGroupRule:{root:"add-group-rule-panel"},summary:{root:"users-sumamry-panel",accessLevels:"summary-access-levels",accessLevelItem:"summary-access-level-item",accessLevelTotal:"summary-access-level-total"},changeAccessLevel:{root:"change-access-level-panel"},bulkChangeAccessLevel:{root:"bulk-change-access-level-panel"},editGroupRule:{root:"edit-group-rule-panel"}},dialogs:{removeUser:{root:"remove-user-dialog"},removeGroup:{root:"remove-group-dialog"},removeDirectAssignment:{root:"remove-direct-assignment-dialog"}},Dialogs:{CancelButton:"dialog-cancel-button",AddUser:{SendInviteCheckbox:"add-user-dialog-send-invite-checkbox"},AddGroupRule:{DialogContainer:"add-group-dialog-container",AddGroupButton:"add-group-dialog-add-button",SelectFromExistingGroupButton:"add-group-dialog-select-exisiting-group"},RemoveGroup:{DialogContainer:"remove-group-dialog-container",RemoveGroupButton:"remove-group-dialog-remove-button"},EditUserSingle:{ChangeAccessLevelContainer:"change-user-accesslevel-dialog-container",ChangeAccessConfirmationButton:"change-user-accesslevel-change-button",EditUserDialogContainer:"edit-user-dialog-container",EditSaveButton:"edit-user-dialog-remove-button"},ManageGroupMembers:{DialogContainer:"manage-members-dialog-container",AddButton:"manage-members-add-button",AddMemberContainer:"manage-members-add-member-container",AddMemberTab:"manage-members-add-member-tab",RemoveButton:"manage-members-remove-button",RemoveMemberContainer:"manage-members-remove-member-container",RemoveMemberTab:"manage-members-remove-member-tab",MemberRow:"manage-members-row"},EditBulk:{ChangeAccessLevelContainer:"bulk-change-user-accesslevel-dialog-container",ChangeAccessConfirmationButton:"bulk-change-user-accesslevel-change-button",AddToProjectsContainer:"bulk-add-to-projects-dialog-container",AddToProjectsConfirmationButton:"bulk-add-to-projects-confirmation-button",RemoveFromProjectsContainer:"bulk-remove-from-projects-dialog-container",RemoveFromProjectsConfirmationButton:"bulk-remove-from-projects-confirmation-button",RemoveUserDialogContainer:"bulk-remove-user-dialog-container",RemoveUserConfirmationButton:"bulk-remove-user-dialog-remove-confirmation-button"}},EditItems:{accessLevelDropDown:"access-level-drop-down",accessLevelInfoIcon:"access-level-info-icon",accessLevelInfoContainer:"access-level-info-container",accessLevelGroupInheritenceContainer:"access-level-group-inherit-container",accessLevelGroupInheritenceGroup:"access-level-group-inherit-group",editProjectGroupDropDown:"project-group-drop-down",editProjectCheckBox:"edit-member-projects-checkbox",addToProjectsComboBox:"add-to-projects-combobox",bulkEditProjectsPickList:"bulk-edit-projects-pick-list",bulkEditProjectsPicker:"bulk-edit-projects-picker",groupPreviewMessageContainer:"edit-group-preview-message-container",groupPreviewMessage:"edit-group-preview-message"}},t.Constants.L2DataAttributeKeys={memberDescriptor:"data-member-descriptor",memberAccessLevel:"data-member-access-level",projectId:"data-project-id"},t.Constants.L2Keys={removeUser:"remove-user-button",changeAccessLevel:"change-access-level-button",manageProjects:"manage-projects",removeDirectAssignmentSingle:"remove-direct-assignment",reinstateAssetsSingle:"reinstate-assets",addToProjectsBulk:"add-to-projects",removeFromProjectsBulk:"remove-from-projects",exportUsers:"export-users",addGroupRule:"add-group-rule",removeGroupRule:"remove-group-rule",reEvaluateGroupRules:"reEvaluate-group-rules",manageGroupMembers:"manage-group-rule-members"},t.Constants.L2Constants={license:{basic:"Basic",vsSubscriber:"Visual Studio Subscriber",stakeholder:"Stakeholder"},projectGroups:{readers:"Project Readers",contributors:"Project Contributors",administrators:"Project Administrators"}},function(e){Ue=t.ModelsGroupOption={};t.ModelsGroupOption.GroupOptions=class{static getDefaultGroupType(e){return e&&e.length>=1?e.some(e=>2===e.group.groupType)?2:e[0].group.groupType:2}}}(),function(e){Te=t[e]={};class s{static getStyles(){return{addProjectsFormRoot:(0,b.getSpacingContainerClassName)("y",20),projectGroupTypeDropdown:(0,y.css)(C.SizeClassNames.width100,(0,b.getSpacingClassName)("margin","top",8))}}static getPermissionGroups(e,t){const s=[];if(e&&s.push(...e.map(e=>e.group)),t&&s.push({groupType:4,displayName:he.RoleType_Custom}),0!==s.length)return s}static permissionGroupEquals(e,t){return e.groupType===t}static getGroupType(e){return e.groupType}static projectRefEquals(e,t){return!!e.data&&e.data.id===t}static projectRefOnGetValue(e){return e.data.id}static teamRefEquals(e,t){return!!e.data&&e.data.id===t}static teamRefOnGetValue(e){return e.data.id}}function n(e){return Ae.L2ClassNames.dropdowns.projectGroupType.itemPrefix+e.toString()}function r(e){const t=i.useContext(xe.UsersSummaryContext),{groupOptions:r}=t,{hasCustom:o}=e,a=s.getStyles(),l=i.useMemo(()=>s.getPermissionGroups(r,!!o),[r,!!o]),[c,u]=(0,g.useSingleSelectedItem)(l,e.selectedGroupType,e.onChange,s.permissionGroupEquals,s.getGroupType),m=(0,g.useSelectionFactory)(()=>new S.DropdownSelection,c,u),d=i.useMemo(()=>{if(void 0!==l)return l.map(e=>({data:e,id:e.groupType.toString(),text:e.displayName,className:n(e.groupType)}))},[l]);return d?i.createElement(h.FormItem,{label:e.hideLabel?void 0:he.LabelText_ProjectSecurityGroups},i.createElement(v.Dropdown,{disabled:e.disabled,ariaLabel:e.projectName,className:a.projectGroupTypeDropdown,calloutContentClassName:Ae.L2ClassNames.dropdowns.projectGroupType.callout,selection:m,items:d})):null}function a(){const e=(0,ye.useUserHubContext)().getCreateProjectLink();return i.createElement(p.TemplateString,{template:he.UserInviteDialog_NoProjectsFound1},i.createElement(f.Link,{href:e,target:"_blank",rel:"noopener noreferrer"},he.UserInviteDialog_CreateAProject))}function l(e){const t=i.useContext(xe.UsersSummaryContext),{projectRefs:n}=t,r=i.useMemo(()=>n?n.map(e=>({id:e.id,text:e.name,data:e})):[{id:"_loading",type:4}],[n]),[o,l]=(0,g.useSelectedItems)(r,e.selected,e.onChange,s.projectRefEquals,s.projectRefOnGetValue),c=(0,g.useSelectionFactory)(()=>new S.DropdownMultiSelection,o,l),u=!!n&&0===n.length;return i.createElement("div",{className:e.className},i.createElement(v.Dropdown,{ariaLabel:he.TitleText_EditUserBulkDialog_AddToProjects,disabled:u,items:r,selection:c,loading:!n,noItemsText:he.UserInviteDialog_NoProjectsFound,actions:[{text:he.ButtonText_AddAll,onClick:()=>{c.select(0,r.length)}}]}),u&&i.createElement(a,null),e.children)}__decorate([o.memoize],s,"getStyles",null),t[e].useSelectedGroupType=function(){const e=i.useContext(xe.UsersSummaryContext);return i.useState(Ue.GroupOptions.getDefaultGroupType(e.groupOptions))},t[e].getProjectGroupTypeDropdownItemClassName=n,t[e].ProjectGroupTypeDropdown=r,t[e].ProjectsDropdown=l,t[e].AddToProjectsForm=function(e){const t=s.getStyles();return i.createElement(l,{selected:e.selected,onChange:e.onChange,className:t.addProjectsFormRoot},e.selected&&e.selected.length>0&&i.createElement(r,{onChange:e.onSelectedGroupTypeChange,selectedGroupType:e.selectedGroupType}))},t[e].TeamsDropdown=function(e){const{teams:t}=e,n=i.useMemo(()=>t?t.map(e=>({id:e.id,text:e.name,data:e})):[{id:"_loading",type:4}],[t]),[r,o]=(0,g.useSelectedItems)(n,e.selected,e.onChange,s.teamRefEquals,s.teamRefOnGetValue),a=(0,g.useSelectionFactory)(()=>new S.DropdownMultiSelection,r,o);return i.createElement(v.Dropdown,{items:n,selection:a,loading:!t,noItemsText:he.TextTeamPickerNoSuggestions,actions:[{text:he.ButtonText_AddAll,onClick:()=>{(0,E.announce)(he.ButtonAnnounce_AddAll),a.select(0,n.length)}}]})}}("ComponentsHubFormsProjectForms"),function(e){function s(){const e=(0,i.useContext)(xe.UsersSummaryContext),{availableAccessLevels:t}=e,s=(0,i.useMemo)(()=>t&&t[0],[t]),[n=s,r]=(0,i.useState)(void 0);return[n,r]}Re=t[e]={},t[e].useSelectedAccessLevel=s,t[e].useAddMemberFields=function(){const[e,t]=s(),[n,r]=(0,Te.useSelectedGroupType)(),[o,a]=(0,i.useState)(void 0);return{selectedAccessLevel:e,setSelectedAccessLevel:t,selectedGroupType:n,setSelectedGroupType:r,selectedProjectIds:o,setSelectedProjectIds:a}}}("ComponentsHubCalloutsAddMemberuseAddMemberFields"),function(e){Ie=t[e]={};class s{constructor(e){this.entityId=e}get displayName(){return this.entityId}}t[e].AddIdentity=s;class n{constructor(e){this.filter=e,this.entityType="custom",this.originDirectory="",this.addIdentityNames=e.split(";").map(e=>e.trim()).filter(e=>e)}get displayName(){return""}toAddIdentities(){return this.addIdentityNames.map(e=>new s(e))}get entityId(){return this.filter}}t[e].AddPendingIdentities=n;t[e].AddUserIdentityPickerProvider=class{constructor(e,t,r=!1){this.isSingleAdd=r,this.onFilterIdentities=(async(e,t)=>{const r=await this.baseProvider.onFilterIdentities(e,t);return 0===r.length&&""!==e?this.isSingleAdd?[new s(e.trim())]:[new n(e.trim())]:(r.forEach(e=>e.image=void 0),r)}),this.addIdentitiesToMRU=(async e=>{const t=e.filter(e=>!(e instanceof n||e instanceof s));return t.length>0&&this.baseProvider.addIdentitiesToMRU(t)}),this.baseProvider=new x.PeoplePickerProvider(e.pageContext,{identityTypes:["user"],operationScopes:t.isGitHubInviteEnabled?["source","ims","ghb"]:["source","ims"]})}onEmptyInputFocus(){return this.baseProvider.onEmptyInputFocus()}get onRequestConnectionInformation(){return this.baseProvider.onRequestConnectionInformation}get getEntityFromUniqueAttribute(){return this.baseProvider.getEntityFromUniqueAttribute}get removeIdentitiesFromMRU(){return this.baseProvider.removeIdentitiesFromMRU}}}("ModelsUserIdentityPickerProvider"),function(e){function s(e,t,s){return(0,i.useMemo)(()=>e&&new Ie.AddUserIdentityPickerProvider(e,t,s),[e,t,s])}Ne=t[e]={},t[e].useAddUserIdentityPickerProvider=s,t[e].useAddUserIdentityPicker=function(e,t){const n=s(e,t),[r,o]=(0,i.useState)([]);return n&&{pickerProvider:n,selectedIdentities:r,onChange:o}},t[e].hasValidIdentities=function(e,t){const s=t.length;return s>0&&s<=e.maxIdentitiesToAdd}}("ComponentsHubCalloutsAddMemberuseUserIdentityPicker"),function(e){Pe=t.ModelsAccessLevel={};class s{static equals(e,t){return e===t||!(!e||!t)&&s.getLicenseKey(e)===s.getLicenseKey(t)}static isInvalid(e){return 0!==e.status&&1!==e.status&&4!==e.status}static compareByPermission(e,t){return s.equals(e,t)?0:e?t?e.licensingSource!==t.licensingSource?2===e.licensingSource?1:2===t.licensingSource?-1:e.licensingSource>t.licensingSource?1:-1:1===e.licensingSource?5===e.accountLicenseType||0===e.accountLicenseType?-1:0:(t.licensingSource,0):1:-1}static hasValidMsdnSubscription(e){return 2===e.licensingSource&&1!==e.msdnLicenseType&&1===e.status}static hasInvitedMsdnSubscription(e){return this.matchesSourceAndType(e,2,1)&&4===e.status}static hasInvalidInvitedMsdnSubscription(e){return this.matchesSourceAndType(e,2,1)&&1===e.status}static hasInvalidMsdnSubscription(e){return 2===e.licensingSource&&1!==e.msdnLicenseType&&(2===e.status||6===e.status||5===e.status)}static isPossibleAccessLevelDowngrade(e,t){const n=s.accessLevelTuplesOrderedByUpgrade.findIndex(t=>s.equals(t,e)),r=s.accessLevelTuplesOrderedByUpgrade.findIndex(e=>s.equals(e,t));return r<0||n<0||n>r}static fromAccountUserLicense(e){const{source:t,license:s}=e;switch(t){case 1:return{licensingSource:1,status:1,accountLicenseType:s,msdnLicenseType:0};case 2:return{licensingSource:2,status:1,accountLicenseType:0,msdnLicenseType:s}}}static fromLicenseSummaryData(e){return{licensingSource:e.source,status:1,accountLicenseType:e.accountLicenseType,msdnLicenseType:e.msdnLicenseType}}static matchesSourceAndType(e,t,s){return e.licensingSource===t&&(1===t?e.accountLicenseType===s:2===t&&e.msdnLicenseType===s)}static mapToAvailableAccessLevel(e,t){if(e)for(const n of e)if(s.equals(n,t))return n}static getLicenseKey(e){const t=s.normalizeEnum(e.licensingSource),n=s.normalizeEnum(e.accountLicenseType),r=s.normalizeEnum(e.msdnLicenseType);switch(t){case 1:return`${t}-${n}`;case 2:return`${t}-${r}`;default:return t.toString()}}static getLicenseId(e){return s.getLicensingSourceString(e.licensingSource)+"-"+(1===e.licensingSource?s.getAccountLicenseTypeString(e.accountLicenseType):s.getMsdnLicenseTypeString(e.msdnLicenseType))}static normalizeEnum(e){return"number"!=typeof e?0:e}static getLicensingSourceString(e){switch(e){case 0:return"None";case 1:return"Account";case 2:return"Msdn";case 3:return"Profile";case 4:return"Auto";case 5:return"Trial"}}static getAccountLicenseTypeString(e){switch(e){case 0:return"None";case 1:return"EarlyAdopter";case 2:return"Express";case 3:return"Professional";case 4:return"Advanced";case 5:default:return"Stakeholder"}}static getMsdnLicenseTypeString(e){switch(e){case 0:return"None";case 2:return"Professional";case 3:return"Platforms";case 4:return"TestProfessional";case 5:return"Premium";case 6:return"Ultimate";case 7:return"Enterprise";case 1:default:return"Eligible"}}}t.ModelsAccessLevel.AccessLevels=s,s.accessLevelTuplesOrderedByUpgrade=[{licensingSource:1,status:1,accountLicenseType:5,msdnLicenseType:0},{licensingSource:1,accountLicenseType:2,status:1,msdnLicenseType:0},{licensingSource:2,status:1,accountLicenseType:0,msdnLicenseType:1}]}(),function(e){Me=t.ModelsMember={};class s{constructor(e){this.graphMember=e,this.graphMember=e,this.displayNameMatchString=(this.displayName+" "+this.principalName).toLocaleLowerCase()}static getAvatarUrl(e,t){const s=e.getPageData();if(s)return s.hostPath+"_api/_common/IdentityImage?id="+t}static isMemberAad(e){return e.origin===fe.DirectoryName.AzureActiveDirectory}get descriptor(){return this.graphMember.descriptor}getSortKey(e){switch(e){case"displayName":return this.displayName}}getAvatarUrl(e){return s.getAvatarUrl(e,this.id)}get key(){return this.id}get displayName(){return this.graphMember.displayName}get principalName(){return this.graphMember.principalName}get isAad(){return s.isMemberAad(this.graphMember)}get accessLevelDisplayName(){return 2===this.accessLevel.licensingSource?he.UserInviteDialog_AccessLevelBasic:this.accessLevel.licenseDisplayName}get accessLevelLicenseDisplayName(){if(2===this.accessLevel.licensingSource)return this.accessLevel.licenseDisplayName}get hasInvalidLicense(){return 1!==this.accessLevel.licensingSource&&2!==this.accessLevel.licensingSource}get hasLegacyLicense(){return!s.defaultAccountLicenseTypes.some(e=>this.accessLevel.accountLicenseType===e)}}t.ModelsMember.Member=s,s.memberSortComparisonFunction=((e,t,s,n)=>{switch(s){case"displayName":return n*e.getSortKey(s).localeCompare(t.getSortKey(s))}return 0}),s.defaultAccountLicenseTypes=[2,5,0]}(),function(e){Le=t.UtilsObjectUtils={},t.UtilsObjectUtils.updatePartialArray=function(e,t,s,n=!1){n&&(e=[...e]);const r=e.length;for(let t=r;t<s;++t)e.push(void 0);for(let n=0;n<t.length;++n,++s)r<=s?e.push(t[n]):e[s]=t[n];return e},t.UtilsObjectUtils.mergeObject=function(e,t){for(const s in t)e[s]=t[s]},t.UtilsObjectUtils.replaceItemsInArray=function(e,t,s){let n=!1;const r=e.map(e=>t(e)?(n=!0,s(e)):e);return n||r.push(s()),r},t.UtilsObjectUtils.isEmptyObject=function(e){for(const t in e)return!1;return!0},t.UtilsObjectUtils.objectHasTruthyValue=function(e){for(const t in e)if(e[t])return!0;return!1},t.UtilsObjectUtils.getMemoizedIncrementVersionFunction=function(){let e=0;return(0,o.memoizeFunction)((...t)=>++e)},t.UtilsObjectUtils.unionByKey=function(e,t,s){const n={};for(const t of e)n[s(t)]=!0;const r=[...e];for(const e of t){const t=s(e);n[t]||(n[t]=!0,r.push(e))}return r},t.UtilsObjectUtils.intersectionByKey=function(e,t,s){const n={};for(const t of e)n[s(t)]=!0;const r=[];for(const e of t)n[s(e)]&&r.push(e);return r},t.UtilsObjectUtils.updateItems=function(e,t,s,n=!0){const r={};for(const e of t)r[s(e)]=e;const i=e.map(e=>{const t=s(e);if(r.hasOwnProperty(t)){const e=r[t];return delete r[t],e}return e});if(n)for(const e in r)i.push(r[e]);return i},t.UtilsObjectUtils.deleteItemsByKey=function(e,t,s){const n={};for(const e of t)n[e]=!0;const r=[];for(const t of e)n[s(t)]||r.push(t);return r},t.UtilsObjectUtils.toKeyedObject=function(e,t){const s={};for(const n of e)s[t(n)]=n;return s},t.UtilsObjectUtils.toKeyMapping=function(e,t){const s={};for(const n of e)s[n]=t;return s},t.UtilsObjectUtils.toTupleArray=function(e,t){const s=[];for(let n=0;n<e.length;++n)s.push([e[n],t[n]]);return s}}(),function(e){De=t.UtilsPromiseUtils={};class s{}t.UtilsPromiseUtils.AsyncIteratorBase=s;class n extends s{constructor(e){super(),this.iterators=e}static async mapToContextPromise(e,t){const s=await e.next();return{index:t,iterator:e,result:s}}async next(){let e;for(this.activeContextPromises||(this.activeContextPromises={},this.iterators.map(n.mapToContextPromise).forEach((e,t)=>{this.activeContextPromises[t]=e}));;){const t=[];for(const e in this.activeContextPromises)t.push(this.activeContextPromises[e]);if(t.length<=0)return{done:!0,value:void 0};const s=await Promise.race(t),{result:r,index:i,iterator:o}=s;if(e=r.value,!r.done){this.activeContextPromises[i]=n.mapToContextPromise(o,i);break}delete this.activeContextPromises[i]}return{done:!1,value:e}}}t.UtilsPromiseUtils.RacedAsyncIterator=n;t.UtilsPromiseUtils.CancelableAsyncIterator=class extends s{constructor(e){super(),this.isPendingCanceled=!1,this.innerIterator=e}next(){return this.isPendingCanceled?new Promise(e=>{e({done:!0,value:void 0})}):this.innerIterator.next()}cancelPending(){this.isPendingCanceled=!0}}}(),function(e){Fe=t.UtilsBatchUtils={};class s extends De.AsyncIteratorBase{constructor(e,t){super(),this.onBatchHandler=e,this.batchesIterator=t}async next(){const e=this.batchesIterator.next(),{done:t,value:s}=e;return t?{done:t,value:s}:{done:t,value:{batchData:await this.onBatchHandler(s),metadata:s}}}}t.UtilsBatchUtils.BatchOrchestratorIterator=class extends De.AsyncIteratorBase{constructor(e,t){super(),this.batchMetadataIterator=e,this.result=[],this.maxInFlight=t;const n=[];for(let t=0;t<this.maxInFlight;++t)n.push(new s(e=>this.onBatchHandler(e),e));this.racedAsyncIterator=new De.RacedAsyncIterator(n)}async next(){const e=await this.racedAsyncIterator.next(),{value:t,done:s}=e;if(s)return{done:s,value:void 0};const{batchData:n,metadata:r}=t;return(0,Le.updatePartialArray)(this.result,n,r.beginIndex),{done:s,value:this.result}}}}(),function(e){_e=t.UtilsJsonBatchUtils={};class s{constructor(e,t){this.isCanceled=!1,this.innerIterator=s.getBatches(e,t)}static*getBatches(e,t){for(let s=0;s<e;s+=t){let n=s+t;n=n>e?e:n,yield{batchSize:n-s,beginIndex:s}}}next(){return this.isCanceled?{done:!0,value:void 0}:this.innerIterator.next()}cancel(){this.isCanceled=!0}}t.UtilsJsonBatchUtils.BatchMetadataIterator=s;t.UtilsJsonBatchUtils.JsonBatchRequestIterator=class extends Fe.BatchOrchestratorIterator{constructor(e,t=fe.UserHubConstants.BulkEditMaxBatchSize,n=fe.UserHubConstants.BulkEditMaxBatchWorker){super(new s(e.length,t),n),this.batch=e}cancelPending(){this.batchMetadataIterator.cancel()}async onBatchHandler(e){const{beginIndex:t,batchSize:s}=e,n=await this.sendClientRequest(this.batch.slice(t,t+s));return this.convertResponse(n)}}}(),function(e){function s(e,t,s,r){const i=t?"/"+t:"";switch(e){case 0:return r?{from:"",op:e,path:i+n(r),value:s}:{from:"",op:e,path:"",value:s};case 1:return r?{from:"",op:e,path:i+n(r),value:""}:{from:"",op:e,path:i,value:""};case 2:return{from:"",op:e,path:i+n(r),value:s};default:return}}function n(e){let t="";if(e)for(const s of e){const[e,n]=s;t+="/"+e,n&&(t+="/"+n)}return t}Ge=t[e]={};class r{constructor(){this.patchOperations=[],this.metadata=[],this.patchOperations=[]}build(){return[this.patchOperations,this.metadata]}get length(){return this.patchOperations.length}appendProjectOperation(e,t,n,r){const i=s(t,e&&e.id,{projectRef:{id:n},group:{groupType:r}},[[fe.OperationTarget.ProjectEntitlements,1===t?n:void 0]]);return i&&(this.patchOperations.push(i),this.metadata.push([0,e,t,n,r])),this}appendTeamOperation(e,t,n,r){const i=s(t,e&&e.id,{id:r},[[fe.OperationTarget.ProjectEntitlements,n],[fe.OperationTarget.TeamRefs,1===t?r:void 0]]);return i&&(this.patchOperations.push(i),this.metadata.push([1,e,t,n,r])),this}appendReplaceAccessLevel(e,t){const n=s(2,e&&e.id,{accountLicenseType:t.accountLicenseType,licensingSource:t.licensingSource},[[fe.OperationTarget.AccessLevel,void 0]]);return n&&(this.patchOperations.push(n),this.metadata.push([2,e,t])),this}appendAddUserEntitlementOperation(e){const t=s(0,void 0,e);return t&&(this.patchOperations.push(t),this.metadata.push([3,e])),this}appendRemoveUserEntitlementOperation(e){const t=s(1,e.id);return t&&(this.patchOperations.push(t),this.metadata.push([4,e])),this}appendReinstateAssets(){const e=s(2,void 0,{},[["reinstateAssets",void 0]]);return e&&(this.patchOperations.push(e),this.metadata.push([5])),this}}t[e].UserEntitlementsJsonPatchOperationsBuilder=r;class i extends r{replaceAccessLevel(e){return this.appendReplaceAccessLevel(void 0,e)}addProject(e,t){return this.appendProjectOperation(void 0,0,e,t)}replaceMembersGroupInProject(e,t){return this.appendProjectOperation(void 0,2,e,t),this}removeProject(e){return this.appendProjectOperation(void 0,1,e)}addToTeam(e,t){return this.appendTeamOperation(void 0,0,e,t)}removeFromTeam(e,t){return this.appendTeamOperation(void 0,1,e,t)}}t[e].SingleMemberEntitlementJsonDocumentBuilder=i;t[e].SingleUserEntitlementJsonDocumentBuilder=class extends i{reinstateAssets(){return this.appendReinstateAssets()}};t[e].BulkEditUserEntitlementJsonDocumentBuilder=class extends r{addUserToProject(e,t,s){return this.appendProjectOperation(e,0,t,s)}removeUserFromProject(e,t){return this.appendProjectOperation(e,1,t)}addToTeam(e,t,s){return this.appendTeamOperation(e,0,t,s)}removeFromTeam(e,t,s){return this.appendTeamOperation(e,1,t,s)}replaceUserAccessLevel(e,t){return this.appendReplaceAccessLevel(e,t)}addUserEntitlement(e){return this.appendAddUserEntitlementOperation(e)}removeUserEntitlement(e){return this.appendRemoveUserEntitlementOperation(e)}};class o extends _e.JsonBatchRequestIterator{constructor(e,t,s,n,r){super(t,n,r),this.client=e,this.doNotSendInviteForNewUsers=s,this.client=e}sendClientRequest(e){return this.client.updateUserEntitlements(e,this.doNotSendInviteForNewUsers)}convertResponse(e){return e.results}}class a extends _e.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,n,1),this.client=e,this.memberId=s,this.client=e,this.memberId=s}sendClientRequest(e){return this.client.updateUserEntitlement(e,this.memberId).then(e=>e)}convertResponse(e){return e.operationResults}}class l extends _e.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,n,1),this.client=e,this.memberId=s,this.client=e,this.memberId=s}sendClientRequest(e){return this.client.updateGroupEntitlement(e,this.memberId).then(e=>e)}convertResponse(e){return e.results}}function c(e,t,s,n,r){return new o(e,t,s,n,r)}function u(e,t,s,n){return new a(e,t,s,n)}function m(e,t,s,n){return new l(e,t,s,n)}async function d(e){let t=await e.next(),s=t.value;for(;!t.done;)s=t.value,t=await e.next();return s}t[e].createBulkBatchRequest=c,t[e].createUserBatchRequest=u,t[e].createGroupBatchRequest=m,t[e].processBulkUserActions=async function(e,t,s,n,r){const i=c((0,Ee.getMemberEntitlementManagementClient)(e.pageContext),s,r,t.bulkMaxBatchSize,t.bulkMaxBatchWorker),o=await d(i);return(0,Le.toTupleArray)(o,n)},t[e].processSingleUserActions=async function(e,t,s,n,r){const i=u((0,Ee.getMemberEntitlementManagementClient)(e.pageContext),s,r,t.bulkMaxBatchSize),o=await d(i);return(0,Le.toTupleArray)(o,n)},t[e].processSingleGroupActions=async function(e,t,s,n,r){const i=m((0,Ee.getMemberEntitlementManagementClient)(e.pageContext),s,r,t.bulkMaxBatchSize),o=await d(i);return(0,Le.toTupleArray)(o,n)}}("UtilsMemberEntitlementJsonPatchBuilder"),function(e){ke=t.ModelsGroup={};class s extends Me.Member{constructor(e,t){super(e.group),this.groupEntitlement=e,this.isPendingDeleteCompletion=t,this.groupEntitlement=e}static getDefaultGroupAvatarUrl(e){return(0,l.getAssetLocation)(e.pageContext,"ms.vss-aex-user-management/user-hub-content/content/ip-content-aad-group-default.png")}get id(){return this.groupEntitlement.id}get accessLevel(){return this.groupEntitlement.licenseRule}get extensions(){return this.groupEntitlement.extensionRules}get projectEntitlements(){return this.groupEntitlement.projectEntitlements}get status(){return this.groupEntitlement.status}getAvatarUrl(e){return this.groupEntitlement.group.origin===fe.OriginName.AzureActiveDirectory?s.getDefaultGroupAvatarUrl(e):super.getAvatarUrl(e)}get lastExecuted(){return this.groupEntitlement.lastExecuted}getSortKey(e){switch(e){case"lastExecutedDate":return this.lastExecuted.getTime()}return super.getSortKey(e)}}s.groupSortComparisonFunction=((e,t,s,n)=>{switch(s){case"lastExecutedDate":return n*(e.getSortKey(s)-t.getSortKey(s))}return Me.Member.memberSortComparisonFunction(e,t,s,n)}),__decorate([o.memoize],s,"getDefaultGroupAvatarUrl",null),t.ModelsGroup.Group=s}(),function(e){we=t.UtilsTableUtils={};class s{constructor(e,t,n){this.items=e,this.isFetchDone=t,this.onScheduleFetchNextBatch=n,this.getItem=(e=>{if(!(e>=this.length))return this.isFetchDone||e!==this.length-1?this.items[e]:(this.onScheduleFetchNextBatch&&this.onScheduleFetchNextBatch(),s.observableValueUndefined)})}get length(){return this.isFetchDone?this.value.length:this.value.length+1}get value(){return this.items}}t.UtilsTableUtils.AutoLoadingTableItemProvider=s,s.observableValueUndefined=new U.ObservableValue(void 0),t.UtilsTableUtils.useAutoLoadingTableProps=function(e,t,n){const r=i.useRef([void 0,!1]),o=i.useRef(!1),a=i.useMemo(()=>n&&(()=>{const[t]=r.current;e!==t&&(r.current=[e,!1],o.current&&(o.current=!1,r.current[1]=!0,n()))}),[n,e,r]),l=i.useMemo(()=>n&&(()=>{r.current[1]||(r.current[1]=!0,n())}),[n,r]),c=i.useMemo(()=>new s(e||[],t,a),[e,t,a]);return i.useEffect(()=>(o.current=!0,l&&l(),()=>{o.current=!1})),{itemProvider:c,behavior:i.useMemo(()=>({componentDidMount:l,componentDidUpdate:l}),[l]),isFetchDone:t,fetchedCount:c.value.length}},t.UtilsTableUtils.useColumnSorting=function(e,t){const s=(0,A.useMutableCallback)(e,t);return i.useMemo(()=>new T.ColumnSorting(s),[])}}(),function(e){je=t.ComponentsControlsFlexCenterBlock={};class s extends i.Component{static getStyles(){return{container:(0,y.css)(R.FlexClassNames.flexColumn,C.SizeClassNames.height100,C.SizeClassNames.width100,R.FlexClassNames.alignItemsCenter,R.FlexClassNames.justifyContentCenter),content:R.LayoutClassNames.overflowHidden}}render(){const e=s.getStyles();return i.createElement("div",{className:e.container},i.createElement("div",{className:e.content},this.props.children))}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsControlsFlexCenterBlock.FlexCenterBlock=s}(),function(e){Be=t[e]={};class s extends i.Component{static getStyles(){return{title:R.FontClassNames.fontSizeMm}}render(){const e=s.getStyles(),{groupsInheritedFrom:t,promiseFulfilled:n}=this.props;return i.createElement("div",{className:Ae.L2ClassNames.EditItems.accessLevelGroupInheritenceContainer},i.createElement("div",{className:e.title},he.GroupAssignmentIcon_CalloutTitle),n?!t||t.length<1?he.GroupAssignmentIcon_CalloutNoMatchesExplaination:t&&t.map(e=>i.createElement("div",{key:e.id,className:Ae.L2ClassNames.EditItems.accessLevelGroupInheritenceGroup},i.createElement("span",null,e.displayName," (",Me.Member.isMemberAad(e.groupEntitlement.group)?he.GroupAssignmentIcon_CalloutGroupTypeAad:he.GroupAssignmentIcon_CalloutGroupTypeVsts,")"))):i.createElement(je.FlexCenterBlock,null,i.createElement(c.Spinner,{size:"large"})))}}__decorate([o.memoize],s,"getStyles",null),t[e].GroupMembershipToolTipContent=s,t[e].GroupMembershipToolTip=function(e){return i.createElement(I.Icon,{tooltipProps:{renderContent:()=>i.createElement(s,Object.assign({},e)),showOnFocus:!0},className:e.className,iconName:"Info",ariaLabel:he.GroupAssignmentIcon_HoverInfoLabel})}}("ComponentsControlsTooltipGroupMembership"),function(e){He=t[e]={};class s{constructor(e,t,s){this.projectRef=e,this.memberProjectEntitlement=t,this.delta=s}get memberProjectEntitlementGroup(){return this.memberProjectEntitlement&&this.memberProjectEntitlement.group}}function n(){return i.createElement(I.Icon,{iconName:"Info",ariaLabel:he.ProjectInheritence_CalloutLabel,tooltipProps:{text:he.ProjectInheritence_CalloutExplaination}})}function r(e,t,s){return e?i.createElement(Be.GroupMembershipToolTip,{groupsInheritedFrom:s,promiseFulfilled:!0}):2===t?i.createElement(n,null):null}t[e].ProjectSelectionItem=s;class a{static getStyles(){return{checkboxLabel:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),projectsListItem:(0,y.css)((0,b.getSpacingClassName)("padding","y",8))}}static getInitialState(e,t){const{memberProjectEntitlement:s}=e;if(!s)return{checked:!1,groupType:void 0};const n=s.group.groupType;return{checked:!0,groupType:void 0===n?Ue.GroupOptions.getDefaultGroupType(t):n}}static mergeRenderState(e,t){return t?!0===t.checked?t:!1===t.checked?{checked:!1,groupType:void 0===t.groupType?e.groupType:t.groupType}:{checked:e.checked,groupType:t.groupType}:e}}function l(e){const{selectionItem:t,selectedGroupType:s,inheritsFromGroups:n,projectName:r,onGroupTypeChange:o}=e,{memberProjectEntitlement:a,memberProjectEntitlementGroup:l}=t;let c=!1;if(a){const{projectPermissionInherited:e}=a;if(2===e){const e=l&&(l.displayName?l.displayName:he.RoleType_Custom);return i.createElement("div",null,e)}l&&4===l.groupType&&(c=!0)}return i.createElement(Te.ProjectGroupTypeDropdown,{disabled:n,selectedGroupType:s,hasCustom:c,onChange:o,hideLabel:!0,projectName:r})}function c(e){const t=i.useContext(xe.UsersSummaryContext),{groupOptions:s}=t,{selectionItem:n,delta:o}=e,{projectRef:c,memberProjectEntitlement:u}=n,m=u&&e.groupAssignments&&e.groupAssignments.filter(e=>e.projectEntitlements.filter(e=>e.projectRef.id===c.id).length>0),d=n.memberProjectEntitlement&&2===n.memberProjectEntitlement.assignmentSource&&m&&m.length>0,p=a.getInitialState(n,s),g=a.mergeRenderState(p,o),b=a.getStyles();return i.createElement("div",Object.assign({className:(0,y.css)(C.SizeClassNames.width100,b.projectsListItem)},{[Ae.L2DataAttributeKeys.projectId]:c.id}),i.createElement(N.Checkbox,{className:(0,y.css)(Ae.L2ClassNames.checkBoxes.editMemberProject),disabled:u?2===u.projectPermissionInherited||d:void 0,checked:g.checked,label:i.createElement("div",{className:b.checkboxLabel},i.createElement("span",null,c.name),u&&r(!!d,u.projectPermissionInherited,m)),onChange:(t,n)=>{t.preventDefault(),n===p.checked?g.groupType===p.groupType?e.onChange(void 0):e.onChange({checked:void 0,groupType:g.groupType}):e.onChange({checked:n,groupType:g.groupType||Ue.GroupOptions.getDefaultGroupType(s)})}}),g.checked&&i.createElement("div",null,i.createElement(l,{selectionItem:n,inheritsFromGroups:d,selectedGroupType:g.groupType,projectName:c.name,onGroupTypeChange:t=>{p.checked?p.groupType!==t?e.onChange({checked:void 0,groupType:t}):e.onChange(void 0):e.onChange({checked:!0,groupType:t})}})))}__decorate([o.memoize],a,"getStyles",null),t[e].EditMemberProjectsForm=function(e){const t=(0,ye.useUserHubContext)(),n=i.useContext(xe.UsersSummaryContext),{projectRefs:r}=n,{memberProjectEntitlements:o,selectionDelta:a}=e,l=function(e,t,n){const r=i.useMemo(()=>{if(!e)return[];const r={};for(const e of t)r[e.projectRef.id]=e;return e.map(e=>new s(e,r[e.id],n[e.id]))},[e,t,n]);return i.useMemo(()=>new we.AutoLoadingTableItemProvider(r,!!e,void 0),[r,e])}(r,o,a),u=i.useCallback((t,s)=>{e.onChange(e=>Object.assign(Object.assign({},e),{[t]:s}))},[e.onChange]),m=i.useMemo(()=>l,[l,u]);if(r&&0===l.length){const e=t.getCreateProjectLink();return i.createElement(M.ZeroData,{imagePath:t.getImageUrl(ye.UserHubPageContextService.noResultsAssetsId),imageAltText:"",primaryText:he.UserInviteDialog_NoProjectsFound,actionText:e?he.UserInviteDialog_CreateAProject:void 0,actionHref:e})}return i.createElement(P.List,{className:(0,y.css)(C.SizeClassNames.width100,Ae.L2ClassNames.lists.memberProjects),itemProvider:m,renderRow:(t,s,n)=>{const r=s.projectRef.id;return i.createElement(P.ListItem,{key:t,index:t,details:n},i.createElement(c,{selectionItem:s,groupAssignments:e.groupAssignments,delta:s.delta,onChange:e=>{u(r,e)}}))}})}}("ComponentsHubCalloutsEditMemberProjectsForm"),function(e){function s(e,t,s){const n=new Ge.SingleMemberEntitlementJsonDocumentBuilder;var r,i;if(r=e.accessLevel,!(i=t)||Pe.AccessLevels.equals(r,i)&&!Pe.AccessLevels.isInvalid(r)||n.replaceAccessLevel(t),s)for(const e in s){const t=s[e];if(t)if(!0===t.checked){const s=t;n.addProject(e,s.groupType)}else if(!1===t.checked)n.removeProject(e);else{const s=t;n.replaceMembersGroupInProject(e,s.groupType)}}return n}Oe=t.ComponentsHubCalloutsEditMemberuseEditMemberInput={},t.ComponentsHubCalloutsEditMemberuseEditMemberInput.useEditMemberBuilder=function(e,t,n){return(0,i.useMemo)(()=>s(e,t,n),[e,t,n])}}(),function(e){Ve=t.ComponentsHubCalloutsEditMemberuseRefreshedMember={},t.ComponentsHubCalloutsEditMemberuseRefreshedMember.useRefreshedMember=function(e,t){const s=(0,i.useMemo)(()=>t&&t(e),[e]),[n]=(0,L.useResolvedPromise)(s);return n}}(),function(e){function s(){return i.createElement(f.Link,{href:fe.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer"},he.DialogErrorMessage_ServicePageLinkText)}ze=t.ComponentsControlsGenericErrors={},t.ComponentsControlsGenericErrors.GenericErrorSupportLink=s,t.ComponentsControlsGenericErrors.GenericErrorMessage=function(e){return e.scenario?i.createElement(p.TemplateString,{template:he.DialogErrorMessage_Template2},e.scenario,i.createElement(s,null)):i.createElement(p.TemplateString,{template:he.DialogErrorMessage_Generic1},i.createElement(s,null))}}(),function(e){qe=t[e]={},t[e].UserHubNotificationsContext=i.createContext({notifications:{},createNotification:()=>"",dismissNotification:()=>void 0,dismissAllNotifications:()=>void 0,setNotification:()=>void 0,clearActiveNotification:()=>void 0}),t[e].UserHubNotificationsContextProvider=function(s){const n=(0,ye.useUserHubContext)(),[r,o]=(0,d.useAsyncState)({}),[a,l]=(0,d.useAsyncState)(void 0),c=i.useRef({}),u=i.useRef(0),m=i.useCallback(e=>{o(t=>{if(r.hasOwnProperty(e)&&!c.current.hasOwnProperty(e)){const s=Object.assign({},t);return delete s[e],s}return t})},[o,r]),g=i.useCallback(()=>{o(e=>{const t=Object.assign({},e);for(const s in e)t.hasOwnProperty(s)&&!c.current.hasOwnProperty(s)&&delete t[s];return t})},[o,r]),C=n.globalMessagesService,b=i.useCallback((e,t,s={})=>{const n=c.current.hasOwnProperty(e);let r;if(t&&(r=n?Object.assign(Object.assign({},t),{isPersistent:!0}):Object.assign(Object.assign({},t),{lastUpdated:new Date}),s.addToast)){let n;switch(t.statusType){case"Success":n=he.BulkStatusDialogText_LabelSuccess;break;case"Warning":n=he.BulkStatusDialogText_LabelWarning;break;case"Failed":n=he.BulkStatusDialogText_LabelFailed}const r=n?i.createElement(p.TemplateString,{template:he.BulkStatusDialogText_ActionStatus2},n,t.title):t.title;C.addToast(Object.assign({message:r,callToAction:t.details?he.ButtonText_Details:void 0,onCallToActionClick:t.details?()=>{l(e)}:void 0,forceOverrideExisting:!0},s.addToast))}o(t=>Object.assign(Object.assign({},t),{[e]:r}))},[o]),v=i.useCallback(e=>{const t=(++u.current).toString();return e&&(c.current[t]=e),t},[]);return i.createElement(t[e].UserHubNotificationsContext.Provider,{value:{notifications:r,createNotification:v,dismissNotification:m,setNotification:b,dismissAllNotifications:g,activeNotificationId:a,clearActiveNotification:()=>{l(void 0)}}},s.children)},t[e].usePersistentUserHubNotification=function(s){const n=i.useContext(t[e].UserHubNotificationsContext),r=i.useMemo(()=>n.createNotification(s),[s]),{notifications:o}=n,a=o[r],l=i.useCallback(e=>{const t="function"==typeof e?e(a):e;t!==o[r]&&(t&&(t.isPersistent=!0),n.setNotification(r,t))},[r,o]);return[a,l]},t[e].useNotificationAsyncCallback=function(s,n){const r=i.useContext(t[e].UserHubNotificationsContext);return i.useCallback(async(...e)=>{const{onGetDisplayName:t,onGetErrorNotification:o,onGetDescription:a,onGetResultNotification:l}=n,c=t(...e),u=a&&a(...e),m=r.createNotification();r.setNotification(m,{statusType:"Running",title:c,description:u});try{const t=await s(...e),n=l?Object.assign({title:c},l(t,...e)):{statusType:"Success",title:c,description:u};return r.setNotification(m,n,{addToast:{duration:"Success"===n.statusType?5e3:1e4}}),t}catch(t){throw r.setNotification(m,o?Object.assign({title:c},o(t,...e)):{statusType:"Failed",title:c,description:i.createElement("div",null,i.createElement("div",null,u),i.createElement(ze.GenericErrorMessage,null))},{addToast:{duration:5e3}}),t}},[r,s,n])}}("ContextNotificationContexts"),function(e){We=t.ModelsUser={};class s extends Me.Member{constructor(e){super(e.user),this.userEntitlement=e,this._groupAssignments=[],this._groupAssignments=e.groupAssignments?e.groupAssignments.map(e=>new ke.Group(e,!1)):[]}get directoryAlias(){return this.graphMember.directoryAlias?this.graphMember.directoryAlias:this.isGitHubUser?this.isBindPending?this.computeGitHubHandleFromPrincipalName():`(${this.principalName})`:void 0}get displayName(){return this.graphMember.displayName}get principalName(){return this.graphMember.mailAddress||this.graphMember.principalName}get id(){return this.userEntitlement.id}get accessLevel(){return this.userEntitlement.accessLevel}get dateAdded(){return this.userEntitlement.dateCreated}get lastAccessedDate(){return this.userEntitlement.lastAccessedDate}get projectEntitlements(){return this.userEntitlement.projectEntitlements}get groupAssignments(){return this._groupAssignments}get isAADGuest(){return this.graphMember.subjectKind===fe.SubjectKind.User&&this.graphMember.metaType===fe.UserMetaType.Guest}get isGitHubUser(){return this.graphMember.origin===fe.OriginName.GitHubDirectory}get isAADDeleted(){return this.graphMember.isDeletedInOrigin}getAvatarUrl(e){if(this.isGitHubUser&&this.isBindPending){if(this.computeGitHubHandleFromPrincipalName())return`https://avatars.githubusercontent.com/u/${this.graphMember.originId}?v=4`}return Me.Member.getAvatarUrl(e,this.id)}get isBindPending(){return(0,D.caseInsensitiveContains)(this.graphMember.descriptor,fe.SubjectType.BindPendingUser)}getSortKey(e){switch(e){case"dateAdded":return this.dateAdded.getTime();case"lastAccessDate":return this.lastAccessedDate.getTime()}return super.getSortKey(e)}computeGitHubHandleFromPrincipalName(){return this.graphMember.principalName.split("@")[0]}}t.ModelsUser.User=s,s.userSortComparisonFunction=((e,t,s,n)=>{switch(s){case"dateAdded":case"lastAccessDate":return n*(e.getSortKey(s)-t.getSortKey(s))}return Me.Member.memberSortComparisonFunction(e,t,s,n)})}(),function(e){Ke=t[e]={};t[e].InvitationClientName="AexInvitation.IInvitationRestClient",t[e].getInvitationClient=function(s,n){return s.getRestClient(t[e].InvitationClientName,n)},u.RestClients.add(t[e].InvitationClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async sendInvitation(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/Invitations/{userId}",routeValues:{userId:t},body:e})}async sendInvitations(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Invitations/{userId}",body:e})}},options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientInvitation"),function(e){$e=t.ComponentsHubCalloutsResendUserInvitation={},t.ComponentsHubCalloutsResendUserInvitation.useResendUserInvitation=function(){const e=(0,ye.useUserHubContext)(),t=i.useCallback(t=>{const s=e.getRestClient(Ke.InvitationClientName);return e.ciTelemetry.publishClickResendInviteEvent(t.id,t.isAADGuest),s.sendInvitation({},t.userEntitlement.id)},[e]);return(0,qe.useNotificationAsyncCallback)(t,{onGetDisplayName:()=>he.ResendInviteSingle_ActionDisplayName,onGetErrorNotification:t=>{const s=new F.HandledError(t);return s&&"InvalidInviterPermissionsException"===s.typeKey?{statusType:"Failed",title:he.ResendInviteSingle_ActionDisplayName,description:he.ResendInvite_NoAadAdminPermissions}:(e.telemetry.trackException(t,"ResendUserInvitation"),{statusType:"Failed",title:he.ResendInviteSingle_ActionDisplayName,description:s?s.message:he.ResendInviteSingle_ActionDisplayNameFailure})}})}}(),function(e){Je=t.ComponentsHubNotificationsNotificationUtils={};class s{static summarizeNotifications(e){const t=[],n=[];let r="Info",i=0;for(const s in e){const o=e[s];if(o)switch(o.isPersistent?t.push(s):n.push(s),o.statusType){case"Running":++i;break;case"Failed":r=this.getHigherSeverity(r,"Error");break;case"Warning":r=this.getHigherSeverity(r,"Warning")}}return t.sort(),n.sort((t,n)=>s.compareNotification(t,n,e[t],e[n])),{persistentNotificationsIds:t,sortedMessageIds:n,runningTaskCount:i,severity:r}}static getHigherSeverity(e,t){return"Error"===e||"Error"===t?"Error":"Warning"===e||"Warning"===t?"Warning":"Info"}static compareNotification(e,t,s,n){return void 0===s.lastUpdated||void 0===n.lastUpdated?e<t?-1:e>t?1:0:n.lastUpdated.getTime()-s.lastUpdated.getTime()}}t.ComponentsHubNotificationsNotificationUtils.NotificationUtils=s}(),function(e){Qe=t.UtilsPatchResponseUtils={};const s={[fe.ErrorCodes.AssignedExtensionFailed]:!0,[fe.ErrorCodes.MemberAlreadyInProject]:!0,[fe.ErrorCodes.SkippedAddInvalidGroup]:!0,[fe.ErrorCodes.NotEnoughExtensionLicenses]:!0,[fe.ErrorCodes.BuildUserEntitlementFailed]:!0,[fe.ErrorCodes.BuildGroupEntitlementFailed]:!0};t.UtilsPatchResponseUtils.PatchResponseUtils=class{static hasFailedOperation(e){return e.some(e=>void 0!==e&&!e.isSuccess)}static containsErrors(e){return e.some(e=>!s[e.key])}static getStatus(e,t){if(t)return 0;if(!e)return 3;if(e.isSuccess)return 2;if(e.errors)for(const t of e.errors)if(!s[t.key])return 0;return 1}}}(),function(e){Ye=t.ComponentsHubNotificationsPatchResponseNotifications={};class s{constructor(e,t){this.results=e,this.handledError=t,this.summarized=s.summarizeItems(e,t);let n=3,r=!1;for(const[e]of this.summarized)e<n&&(n=e),3===e&&(r=!0);let i="Success";switch(n){case 0:i="Failed";break;case 1:i="Warning";break;case 3:i="Canceled";break;default:r&&(i="Warning")}this.statusType=i}static summarizeItems(e,t){const s=[[0,[]],[1,[]],[2,[]],[3,[]]];return e.forEach(e=>{const[n]=e,r=Qe.PatchResponseUtils.getStatus(n,t),[,i]=s[r];i.push(e)}),s.filter(e=>e[1].length>0)}}t.ComponentsHubNotificationsPatchResponseNotifications.PatchResponseStatusNotification=s}(),function(e){t.ComponentsHubUserHubPageCommon={};t.ComponentsHubUserHubPageCommon.UserHubPageCommon=class{static getSingleSelectedMember(e,t){if(!e)return;const s=t.value[0];return s?e[s.beginIndex]:void 0}static getMultiSelectedMember(e,t){if(!e)return;const s=[];for(const n of t.value)for(let t=n.beginIndex;t<=n.endIndex;++t)s.push(e[t]);return s}}}(),t.ContextCommandContext={},function(e){Ze=t[e]={};class s{static createFilterPropertyString(e,t){if(t&&0!==t.length)return e+" eq '"+t.join(",")+"'"}static matchMap(e,t){for(const s in e)if(e[s]&&!t[s])return!1;for(const s in t)if(t[s]&&!e[s])return!1;return!0}}class n{constructor(e){this.filterState=e,this.AssignmentSourceEnumToString={2:"GroupRule",0:"None",1:"Unknown"},this.filterItems=n.getFilterItems(e)}static getFilterItems(e){switch(e){case 1:case 2:return[e];case 0:return[1,2]}return[]}get isActive(){return void 0!==this.filterState&&0!==this.filterState}matches(e){const t=e.accessLevel.assignmentSource;switch(this.filterState){case 1:return 0===t||1===t;case 2:return 2===t}return!0}get searchFilterClause(){if(!this.isActive)return;const e=`${fe.UserEntitlementFilterNames.AssignmentSource} eq`;let t="";switch(this.filterState){case 1:t=`(${e} '${this.AssignmentSourceEnumToString[0]}' or ${e} '${this.AssignmentSourceEnumToString[1]}')`;break;case 2:t=`${e} '${this.AssignmentSourceEnumToString[2]}'`;break;default:return}return t}get filterClause(){}clear(){return void 0!==this.filterState?new n(void 0):this}withFilter(e){let t;for(const s of e)switch(s){case 1:case 2:void 0===t?t=s:t!==s&&(t=0)}return t===this.filterState?this:new n(t)}}t[e].LicenseSourceFilter=n;class r{constructor(e){this.filterState=e,this.filterItems=r.getFilterItems(e)}static getFilterItems(e){switch(e){case 1:case 2:return[e];case 0:return[1,2]}return[]}get isActive(){return void 0!==this.filterState&&0!==this.filterState}matches(e){const{userEntitlement:t}=e;if(!t)return!0;const{metaType:s}=t.user;switch(this.filterState){case 1:return s===fe.UserMetaType.Guest;case 2:return s!==fe.UserMetaType.Guest}return!0}get searchFilterClause(){if(!this.isActive)return;let e=`${fe.UserEntitlementFilterNames.UserType} eq `;switch(this.filterState){case 1:e+=`'${fe.UserMetaType.Guest}'`;break;case 2:e+=`'${fe.UserMetaType.Member}'`;break;default:return}return e}get filterClause(){if(this.isActive)switch(this.filterState){case 1:return s.createFilterPropertyString(fe.UserEntitlementFilterNames.UserType,[fe.UserMetaType.Guest]);case 2:return s.createFilterPropertyString(fe.UserEntitlementFilterNames.UserType,[fe.UserMetaType.Member])}}clear(){return void 0!==this.filterState?new r(void 0):this}withFilter(e){let t;for(const s of e)switch(s){case 1:case 2:void 0===t?t=s:t!==s&&(t=0)}return t===this.filterState?this:new r(t)}}t[e].UserTypeGuestFilter=r;class i{constructor(e){this.filter=i.getFilterValue(e)}static getFilterValue(e){return e&&e.trim()||void 0}get isActive(){return!!this.filter}matches(e){return!!this.filter&&e.displayNameMatchString.indexOf(this.filter.toLocaleLowerCase())>-1}get searchFilterClause(){const e=this.filter&&this.filter.replace("'","''");if(e)return`${fe.UserEntitlementFilterNames.Name} eq '${e}'`}get filterClause(){const e=this.filter&&this.filter.replace("'","\\'");return s.createFilterPropertyString(fe.UserEntitlementFilterNames.Name,e?[e]:void 0)}clear(){return this.isActive?new i:this}withFilter(e){const t=i.getFilterValue(e);return t!==this.filter?new i(t):this}}t[e].MemberNameFilter=i;class o{constructor(e,t,s){this.disabled=s,this.genericAccessLevel=Pe.AccessLevels.fromLicenseSummaryData(e),this.key=o.getKey(this.genericAccessLevel,s),this.displayName=t+(this.disabled?` (${he.AccessLevel_Invalid})`:""),this.licenseId=Pe.AccessLevels.getLicenseId(this.genericAccessLevel)}static getKey(e,t){return Pe.AccessLevels.getLicenseKey(e)+(t?"!":"")}filterValueEquals(e,t){const s=Pe.AccessLevels.fromLicenseSummaryData(e);return Pe.AccessLevels.equals(s,this.genericAccessLevel)&&t===this.disabled}}t[e].MemberAccessLevelFilterItem=o;class a{constructor(e,t){this.availableFilterItems=e,this.filteredKeys=t;const s=[];for(const e in this.filteredKeys)if(this.filteredKeys[e]){const t=this.availableFilterItems[e];t&&s.push(t)}this.filterItems=s}static getMemberAccessLevelKey(e){const t=Pe.AccessLevels.getLicenseKey(e.accessLevel),{status:s}=e.accessLevel;return 1===s||4===s||5===s?t:t+"!"}get isActive(){return(0,Le.objectHasTruthyValue)(this.filteredKeys)}matches(e){return!!this.filteredKeys[a.getMemberAccessLevelKey(e)]}get searchFilterClause(){let e=[];for(const t of this.filteredMemberAccessLevelItem){let s=`${fe.UserEntitlementFilterNames.LicenseId} eq '${t.licenseId}'`;t.disabled&&(s=`(${s} and ${fe.UserEntitlementFilterNames.LicenseStatus} eq 'Disabled')`),e=[...e,s]}return e.length>1?`(${e.join(" or ")})`:e[0]}get filterClause(){if(this.isActive)return s.createFilterPropertyString(fe.UserEntitlementFilterNames.LicenseId,this.filteredMemberAccessLevelItem.map(e=>e.licenseId))}get filteredMemberAccessLevelItem(){const e=[];for(const t in this.filteredKeys)if(this.filteredKeys[t]){const s=this.availableFilterItems[t];s&&e.push(s)}return e}clear(){return this.isActive?new a(this.availableFilterItems,{}):this}withFilter(e){for(const t of e){const e=t.key;this.availableFilterItems[e]||(this.availableFilterItems[e]=t)}const t={};for(const s of e)t[s.key]=!0;return s.matchMap(t,this.filteredKeys)?this:new a(this.availableFilterItems,t)}}function l(e){return e.filter(e=>!!e).map(e=>e).join(" and ")}function c(e){switch(e){case 1:return"Descending";case 0:default:return"Ascending"}}t[e].MemberAccessLevelsFilter=a,t[e].createSearchFilterString=function(e,t,s,n){return l([t.searchFilterClause,s&&s.searchFilterClause,e.searchFilterClause,n&&n.searchFilterClause])},t[e].createFilterString=function(e,t,s){return l([t.filterClause,s&&s.filterClause,e.filterClause])},t[e].getSortOrderString=c,t[e].createSortString=function(e,t){return function(e){switch(e){case"dateAdded":return fe.UserEntitlementSortColumns.DateCreated;case"lastAccessDate":return fe.UserEntitlementSortColumns.LastAccessed;case"displayName":default:return fe.UserEntitlementSortColumns.Name}}(e)+" "+c(t)}}("ModelsUserManagementFilters"),function(e){Xe=t.ContextMembersContext={},t.ContextMembersContext.membersContextFilterStateIsActive=function(e){return e.nameFilter.isActive||e.accessLevelsFilter.isActive||!!e.userTypeGuestFilter&&e.userTypeGuestFilter.isActive||!!e.licenseSourceFilter&&e.licenseSourceFilter.isActive},t.ContextMembersContext.useRefreshableMembersFetcherAndStore=function(e,t){const[[s,n],r]=(0,k.useAsyncDependentState)(()=>[e(),new G.CollectionDataStore(e=>e.id)],t);return[s,n,i.useCallback(()=>{r([e(),new G.CollectionDataStore(e=>e.id)])},[e,r])]},t.ContextMembersContext.useMembersFetcher=function(e,t){const{value:s,isDone:n,fetchNext:r,upsert:i,deleteItems:o}=(0,_.useContinuationTokenCollectionDataIterator)(e,t);return{value:s,upsert:i,deleteItems:o,isDone:n,fetchNext:r}},t.ContextMembersContext.useMembersFilter=function(e){const[t,n]=i.useState(e);return{filterState:t,setAccessLevelsFilter:i.useCallback(e=>{n(t=>new s(t).withAccessLevelFilter(e).build())},[n]),setUserTypesFilter:i.useCallback(e=>{n(t=>new s(t).withUserTypeFilter(e).build())},[n]),setLicenseSourcesFilter:i.useCallback(e=>{n(t=>new s(t).withLicenseSourceFilter(e).build())},[n]),setNameFilter:i.useCallback(e=>{n(t=>new s(t).withNameFilter(e).build())},[n])}};class s{constructor(e){this.filterState=e,this.nextFilterState=Object.assign({},e)}static getAvailableAccessLevelFilters(e,t){const s=[];return e.forEach(e=>{t?(e.assigned>=0&&s.push(new Ze.MemberAccessLevelFilterItem(e,e.licenseName,!1)),e.disabled>0&&s.push(new Ze.MemberAccessLevelFilterItem(e,e.licenseName,!0))):(e.assigned>=0||e.disabled>0)&&s.push(new Ze.MemberAccessLevelFilterItem(e,e.licenseName,!1))}),s}withAccessLevelFilter(e,t=!1){const s=this.nextFilterState.accessLevelsFilter.withFilter(e);return this.nextFilterState.accessLevelsFilter=s,t&&(this.nextFilterState.nameFilter=this.nextFilterState.nameFilter.clear(),this.nextFilterState.userTypeGuestFilter&&(this.nextFilterState.userTypeGuestFilter=this.nextFilterState.userTypeGuestFilter.clear()),this.nextFilterState.licenseSourceFilter&&(this.nextFilterState.licenseSourceFilter=this.nextFilterState.licenseSourceFilter.clear())),this}withNameFilter(e,t=!1){const s=this.nextFilterState.nameFilter.withFilter(e);return this.nextFilterState.nameFilter=s,t&&(this.nextFilterState.accessLevelsFilter=this.nextFilterState.accessLevelsFilter.clear(),this.nextFilterState.userTypeGuestFilter&&(this.nextFilterState.userTypeGuestFilter=this.nextFilterState.userTypeGuestFilter.clear())),this}withUserTypeFilter(e){const t=this.nextFilterState.userTypeGuestFilter&&this.nextFilterState.userTypeGuestFilter.withFilter(e);return this.nextFilterState.userTypeGuestFilter=t,this}withLicenseSourceFilter(e){const t=this.nextFilterState.licenseSourceFilter&&this.nextFilterState.licenseSourceFilter.withFilter(e);return this.nextFilterState.licenseSourceFilter=t,this}build(){return this.nextFilterState.accessLevelsFilter===this.filterState.accessLevelsFilter&&this.nextFilterState.nameFilter===this.filterState.nameFilter&&this.nextFilterState.userTypeGuestFilter===this.filterState.userTypeGuestFilter&&this.nextFilterState.licenseSourceFilter===this.filterState.licenseSourceFilter?this.filterState:this.nextFilterState}}t.ContextMembersContext.MemberFilterStateBuilder=s}(),function(e){et=t.ContextMembersContextClient={};class s{static getAllMembers(e,t){const s=[];for(const n of e){const e=t[n.id];e?s.push(e):!1===e||s.push(n)}return s}static filterAndSort(e,t,s,n,r){let i=t?n(e,t):e;return i=s&&i?r(i,s):i}static getFilteredMembers(e,t){if(!t)return e;let s=e;const{nameFilter:n,accessLevelsFilter:r}=t;return n.isActive&&(s=s.filter(e=>!e||n.matches(e))),r.isActive&&(s=s.filter(e=>!e||r.matches(e))),s}static getSortedMembers(e,t,s){const{sortByKey:n,sortOrder:r}=t,i=[...e];return i.sort((e,t)=>void 0===e?-1:void 0===t?1:s(e,t,n,0===r?1:-1)),i}}t.ContextMembersContextClient.MembersClientContextProviderUtils=s,t.ContextMembersContextClient.useMembersClientContextProvider=function(e,t,n,r,o){const{filterState:a,setAccessLevelsFilter:l,setNameFilter:c,setUserTypesFilter:u,setLicenseSourcesFilter:m}=(0,Xe.useMembersFilter)(n),[d,p]=i.useState({sortByKey:"displayName",sortOrder:0}),[g,C]=(0,k.useAsyncDependentState)(void 0,[e]),{isDone:b,fetchNext:v,value:h,upsert:f,deleteItems:y}=(0,Xe.useMembersFetcher)(e,t),S=(0,ye.useUserHubContext)(),E=i.useCallback(e=>{S.telemetry.trackException(e,"useMembersClientContextProvider.fetchAllMembers"),C(e)},[S.telemetry]);(0,_.useContinuationTokenCollectionDataIteratorAutoLoadingEffect)(b||!!g,v,E);const x=i.useMemo(()=>s.filterAndSort(h,a,d,r,o),[r,o,h,a,d]),A=i.useContext(xe.UsersSummaryContext);return{isDone:b,upsert:f,deleteItems:y,availableAccessLevelFilters:i.useMemo(()=>A.licenses&&Xe.MemberFilterStateBuilder.getAvailableAccessLevelFilters(A.licenses,!0),[A.licenses]),allMembers:h,filterState:a,sortState:d,displayMembers:x,setAccessLevelsFilter:l,setLicenseSourcesFilter:m,setNameFilter:c,setUserTypesFilter:u,setSort:p,fetchError:g}}}(),function(e){tt=t[e]={};class s{static async fetchGroupsList(e){const t=e.getRestClient(Ee.MemberEntitlementManagementClientName);return(await t.getGroupEntitlements()).map(e=>new ke.Group(e))}static sortGroupsList(e,t){return et.MembersClientContextProviderUtils.getSortedMembers(e,t,ke.Group.groupSortComparisonFunction)}}t[e].GroupsContext=i.createContext(void 0);class n{constructor(e){this.client=(0,Ee.getMemberEntitlementManagementClient)(e.pageContext)}async next(){return{done:!0,value:[(await this.client.getGroupEntitlements()).map(e=>new ke.Group(e))]}}}t[e].GroupsContextProvider=function(r){const o=(0,ye.useUserHubContext)(),[a,l,c]=(0,Xe.useRefreshableMembersFetcherAndStore)(()=>new n(o),[o]),u=(0,et.useMembersClientContextProvider)(a,l,{nameFilter:new Ze.MemberNameFilter,accessLevelsFilter:new Ze.MemberAccessLevelsFilter({},{})},et.MembersClientContextProviderUtils.getFilteredMembers,s.sortGroupsList),{isDone:m,upsert:d,deleteItems:p}=u,g=i.useCallback(async e=>{const t=o.getRestClient(Ee.MemberEntitlementManagementClientName),s=await t.getGroupEntitlement(e),n=new ke.Group(s);return d([n]),n},[d,o]),C={availableAccessLevelFilters:u.availableAccessLevelFilters,allMembers:u.allMembers,refreshMembersList:c,displayMembers:u.displayMembers,fetchError:u.fetchError,filterState:u.filterState,sortState:u.sortState,setAccessLevelsFilter:u.setAccessLevelsFilter,setNameFilter:u.setNameFilter,setUserTypesFilter:u.setUserTypesFilter,setLicenseSourcesFilter:u.setLicenseSourcesFilter,setSort:u.setSort,isFetchDone:m,refreshGroup:g,upsert:d,deleteMembers:p};return i.createElement(t[e].GroupsContext.Provider,{value:C},r.children)}}("ContextGroupsContext"),function(e){st=t[e]={};t[e].MEMInternalClientName="AexMEMInternal.IMEMInternalRestClient",t[e].getMEMInternalClient=function(s,n){return s.getRestClient(t[e].MEMInternalClientName,n)},u.RestClients.add(t[e].MEMInternalClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async exportUsersToCSV(){return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"text/csv",routeTemplate:"_apis/MEMInternal/Export"})}async getUserEntitlements(e,t){const s={select:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/GetMemberEntitlementsBatch",queryParams:s,body:e})}async reApplyAllGroupEntitlementsToUsers(e){const t={ruleOption:e};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MEMInternal/GroupEntitlementUserApplication",queryParams:t})}async removeExplicitAssignments(e,t,s){const n={select:t,ruleOption:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MEMInternal/RemoveExplicitAssignment",queryParams:n,body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MEMInternal/UserManagementSummary",queryParams:t})}},options:{resourceAreaId:"6d1800d2-db34-4956-88b4-fad14617d011",serviceInstanceType:"00000041-0000-8888-8000-000000000000"}})}("RestClientMEMInternal"),function(e){nt=t[e]={};t[e].MemberEntitlementManagementClientName="AexMemberEntitlementManagementLegacy.IMemberEntitlementManagementRestClient",t[e].getMemberEntitlementManagementClient=function(s,n){return s.getRestClient(t[e].MemberEntitlementManagementClientName,n)},u.RestClients.add(t[e].MemberEntitlementManagementClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async addGroupEntitlement(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/GroupEntitlements/{groupId}",queryParams:s,body:e})}async deleteGroupEntitlement(e,t,s){const n={ruleOption:t,removeGroupMembership:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e},queryParams:n})}async getGroupEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e}})}async updateGroupEntitlement(e,t,s){const n={ruleOption:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:t},customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:n,body:e})}async getGroupEntitlements(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupDescriptor}"})}async addMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MemberEntitlements/{memberId}",body:e})}async deleteMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlements(e,t,s,n){const r={top:e,skip:t,filter:s,select:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",queryParams:r})}async updateMemberEntitlement(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async updateMemberEntitlements(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async addMemberToGroup(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async getGroupMembers(e,t,s){const n={maxResults:t,pagingToken:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e},queryParams:n})}async removeMemberFromGroup(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async addUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",body:e})}async getUserEntitlements(e,t,s,n){const r={top:e,skip:t,filter:s,sortOption:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",queryParams:r})}async updateUserEntitlements(e,t){const s={doNotSendInviteForNewUsers:t};return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:s,body:e})}async deleteUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async getUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async updateUserEntitlement(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/UserEntitlementSummary",queryParams:t})}},options:{resourceAreaId:"68ddce18-2501-45f1-a17b-7931a9922690"}})}("RestClientLegacyMemberEntitlementManagement"),function(e){rt=t[e]={};class s{static getUsers(e){return e.filter(e=>e&&!Qe.PatchResponseUtils.containsErrors(e.errors)).map(e=>new We.User(e.result))}static async refreshUsers(e,t,s,n){const r=e.getRestClient(st.MEMInternalClientName);let i=0;const o=t.bulkMaxBatchSize;let a=[];for(;i<s.length;){const e=s.slice(i,i+o);a=a.concat(r.getUserEntitlements(e,n&&n.join(","))),i+=o}const l=await Promise.all(a),c=[];return l.forEach(e=>{e.forEach(e=>{c.push(new We.User(e))})}),c}static exportUsers(e){const t=e.getServiceLocation("00000041-0000-8888-8000-000000000000",4);window.open(t+"/_apis/MEMInternal/Export?api-version=3.1-preview")}static async removeDirectAssignments(e,t,s){const n=e.getRestClient(st.MEMInternalClientName);return(await n.removeExplicitAssignments(t,fe.UserEntitlementPropertyNames.GroupRules,s)).map(e=>new We.User(e))}static toUsers(e){return e.filter(e=>!!e).map(e=>new We.User(e))}static getInitialFilterState(){return{nameFilter:new Ze.MemberNameFilter,accessLevelsFilter:new Ze.MemberAccessLevelsFilter({},{}),userTypeGuestFilter:new Ze.UserTypeGuestFilter(void 0),licenseSourceFilter:new Ze.LicenseSourceFilter(void 0)}}static addUsersToCollection(e,t,s,n){const r=new Ge.BulkEditUserEntitlementJsonDocumentBuilder;for(const e of s)r.addUserEntitlement(e);const[i,o]=r.build();return(0,Ge.processBulkUserActions)(e,t,i,o,n)}}t[e].UsersContextUtils=s;t[e].UsersFetcher=class{constructor(e,t,s,n){if(this.pageContextService=e,this.getUsersPageCounter=0,this.total=0,this.client=(0,Ee.getMemberEntitlementManagementClient)(e.pageContext),this.firstPageSize=t.getUsersFirstPageSize,this.pageSize=t.getUsersPageSize,s){const{nameFilter:e,accessLevelsFilter:n,userTypeGuestFilter:r,licenseSourceFilter:i}=s;this.filterString=t.useUpdatedSearchQuery&&t.shouldUseSearchApis?(0,Ze.createSearchFilterString)(e,n,r,i):(0,Ze.createFilterString)(e,n,r)}n&&(this.sortString=(0,Ze.createSortString)(n.sortByKey,n.sortOrder))}async next(e){const t=!e&&0===this.total;t?this.pageContextService.telemetry.startTrackEvent(fe.PerformanceScenarioConstants.GetUsersFirstFeatureName):this.pageContextService.telemetry.startTrackEvent(fe.PerformanceScenarioConstants.GetAllUsersFeatureName);const n=await this.client.searchUserEntitlements(e,void 0,this.filterString,this.sortString);t?this.pageContextService.telemetry.stopTrackEvent(fe.PerformanceScenarioConstants.GetUsersFirstFeatureName,{},{"First Page Size":this.firstPageSize}):this.pageContextService.telemetry.stopTrackEvent(fe.PerformanceScenarioConstants.GetAllUsersFeatureName,{ConinuationToken:e||""},{"Page Size":this.pageSize,["Page "+ ++this.getUsersPageCounter]:window.performance.now()});const{members:r,continuationToken:i,totalCount:o}=n;return this.total+=r.length,i?{done:!1,value:[s.toUsers(r),i,[o]]}:{done:!0,value:[s.toUsers(r)]}}};t[e].LegacyUsersFetcher=class{constructor(e,t,s,n){if(this.pageContextService=e,this.getUsersPageCounter=0,this.client=(0,nt.getMemberEntitlementManagementClient)(e.pageContext),this.firstPageSize=t.shouldUseServerSideSearch?t.getUsersFirstPageSizeServerSideSearch:t.getUsersFirstPageSize,this.pageSize=t.shouldUseServerSideSearch?t.getUsersPageSizeServerSideSearch:t.getUsersPageSize,s){const{nameFilter:e,accessLevelsFilter:n,userTypeGuestFilter:r,licenseSourceFilter:i}=s;this.filterString=t.useUpdatedSearchQuery&&t.shouldUseSearchApis?(0,Ze.createSearchFilterString)(e,n,r,i):(0,Ze.createFilterString)(e,n,r)}n&&(this.sortString=(0,Ze.createSortString)(n.sortByKey,n.sortOrder))}async next(e=0){const t=0===e?this.firstPageSize:this.pageSize;let n;0===e?(this.pageContextService.telemetry.startTrackEvent(fe.PerformanceScenarioConstants.GetUsersFirstFeatureName),n=await this.client.getUserEntitlements(t,e,this.filterString,this.sortString),this.pageContextService.telemetry.stopTrackEvent(fe.PerformanceScenarioConstants.GetUsersFirstFeatureName,{},{"First Page Size":this.firstPageSize})):(this.pageContextService.telemetry.startTrackEvent(fe.PerformanceScenarioConstants.GetAllUsersFeatureName),n=await this.client.getUserEntitlements(t,e,this.filterString,this.sortString),this.pageContextService.telemetry.stopTrackEvent(fe.PerformanceScenarioConstants.GetAllUsersFeatureName,{},{"Page Size":this.pageSize,["Page "+ ++this.getUsersPageCounter]:window.performance.now()}));const{members:r,totalCount:i}=n;return r.length<t?{done:!0,value:[s.toUsers(r)]}:{done:!1,value:[s.toUsers(r),e+t,[i]]}}},t[e].UsersContext=i.createContext({availableAccessLevelFilters:[],filterState:{nameFilter:new Ze.MemberNameFilter,accessLevelsFilter:new Ze.MemberAccessLevelsFilter({},{}),userTypeGuestFilter:new Ze.UserTypeGuestFilter},sortState:{sortByKey:"displayName",sortOrder:0},displayMembers:[],allMembers:[],isFetchDone:!1,refreshMembersList:()=>void 0,setAccessLevelsFilter:()=>void 0,setNameFilter:()=>void 0,setUserTypesFilter:()=>void 0,setLicenseSourcesFilter:()=>void 0,setSort:()=>void 0,upsert:()=>void 0,deleteMembers:()=>void 0,exportUsers:()=>void 0,refreshUsers:()=>Promise.resolve([])}),t[e].useUsersContextApiActions=function(){const n=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),o=i.useContext(t[e].UsersContext),a=i.useContext(xe.UsersSummaryContext);return{addUsersToCollection:i.useCallback(async(e,t)=>{const i=await s.addUsersToCollection(n,r,e,t),l=i.filter(([e])=>e&&!Qe.PatchResponseUtils.containsErrors(e.errors)).map(([e])=>new We.User(e.result));return l.length>0&&(o.upsert(l),a.refresh("licenses")),i},[n,r,o.upsert,a.refresh]),removeUsers:i.useCallback(async e=>{const t=new Ge.BulkEditUserEntitlementJsonDocumentBuilder;for(const s of e)t.removeUserEntitlement(s);const[s,i]=t.build(),l=await(0,Ge.processBulkUserActions)(n,r,s,i),c=l.filter(([e])=>e&&e.isSuccess).map(([e])=>e.userId);return c.length>0&&(o.deleteMembers(c),a.refresh("licenses")),l},[n,r,a.refresh,o.deleteMembers]),bulkChangeAccessLevel:i.useCallback(async(e,t)=>{const s=new Ge.BulkEditUserEntitlementJsonDocumentBuilder;for(const n of e)s.replaceUserAccessLevel(n,t);const[i,l]=s.build(),c=await(0,Ge.processBulkUserActions)(n,r,i,l),u=e.map(e=>e.id);return o.refreshUsers(u),a.refresh("licenses"),c},[n,r,o.refreshUsers,a.refresh]),addToProjects:i.useCallback(async(e,t,s)=>{const i=new Ge.BulkEditUserEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)i.addUserToProject(n,e,s);const[o,a]=i.build();return await(0,Ge.processBulkUserActions)(n,r,o,a)},[n,r]),removeFromProjects:i.useCallback(async(e,t)=>{const s=new Ge.BulkEditUserEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)s.removeUserFromProject(n,e);const[i,o]=s.build();return await(0,Ge.processBulkUserActions)(n,r,i,o)},[n,r]),removeDirectAssignments:i.useCallback(async(e,t)=>{const s=(0,st.getMEMInternalClient)(n.pageContext),r=(await s.removeExplicitAssignments(e,fe.UserEntitlementPropertyNames.GroupRules,t)).map(e=>new We.User(e));return 0===t&&r.length>0&&o.upsert(r),r},[o.upsert,n.pageContext]),updateUser:i.useCallback(async(e,t,s)=>{const i=e.id,l=await(0,Ge.processSingleUserActions)(n,r,t,s,i);return o.refreshUsers([e.id]),a.refresh("licenses"),l},[n,r,o.refreshUsers,a.refresh]),reinstateAssets:i.useCallback(async e=>{const t=new Ge.SingleUserEntitlementJsonDocumentBuilder;t.reinstateAssets();const[s,i]=t.build(),a=e.id,l=await(0,Ge.processSingleUserActions)(n,r,s,i,a);return o.refreshUsers([e.id]),l},[n,r,o.refreshUsers])}}}("ContextUsersContext"),function(e){it=t.ContextuseGroupsContextApiActions={},t.ContextuseGroupsContextApiActions.useGroupsContextApiActions=function(){const e=(0,ye.useUserHubContext)(),t=(0,ye.useUserHubConfiguration)(),s=i.useContext(rt.UsersContext),n=i.useContext(xe.UsersSummaryContext),r=i.useContext(tt.GroupsContext);return{addGroupRule:i.useCallback(async t=>{const i=(0,Ee.getMemberEntitlementManagementClient)(e.pageContext),o=await i.addGroupEntitlement(t),a=o.results&&o.results[0],l=a.result;if(a.isSuccess&&l){if(r){const e=new ke.Group(l);r.upsert([e])}l.members&&l.members.length>0&&(s.refreshUsers(l.members.map(e=>e.id)),n.refresh("licenses"))}return[[a,[3,t]]]},[e.pageContext,s.refreshUsers,n.refresh,r&&r.upsert]),updateGroupRule:i.useCallback(async(s,n,i)=>{const o=s.id,a=await(0,Ge.processSingleGroupActions)(e,t,n,i,o);return r&&r.refreshGroup(o),a},[e,t,r&&r.refreshGroup]),deleteGroupRule:i.useCallback(async(t,s)=>{const n=e.getRestClient(Ee.MemberEntitlementManagementClientName),i=(await n.deleteGroupEntitlement(t.id,0,s)).results[0];return i.isSuccess&&r&&r.upsert([new ke.Group(t.groupEntitlement,!0)]),i},[e,r&&r.upsert])}}}(),t.GeneratedInterfaces={},function(e){ot=t.ModelsGroupIdentityPickerProvider={};t.ModelsGroupIdentityPickerProvider.GroupIdentityPickerProvider=class extends x.PeoplePickerProvider{constructor(e){super(e,{identityTypes:["group"]})}}}(),function(e){at=t.ModelsLicensingRuleApplicationStatus={},t.ModelsLicensingRuleApplicationStatus.isOperationStatusCompleted=function(e){switch(e){case 3:case 5:case 4:case 0:return!0;default:return!1}}}(),function(e){lt=t.ModelsProjectEntitlement={};t.ModelsProjectEntitlement.ProjectEntitlements=class{static toProjectEntitlements(e,t){return e&&e.map(e=>({group:void 0===t?void 0:{groupType:t},projectRef:{id:e}}))}}}(),function(e){ct=t.ModelsUserEntitlement={};t.ModelsUserEntitlement.UserEntitlements=class{static buildUserEntitlements(e,t,s,n,r){const i=[];if(e)for(const t of e)switch(t.originDirectory){case fe.DirectoryName.VisualStudioDirectory:case fe.DirectoryName.AzureActiveDirectory:case fe.DirectoryName.GitHub:const e={displayName:t.displayName,origin:t.originDirectory,originId:t.originId,principalName:t.signInAddress,subjectKind:fe.SubjectKind.User};i.push({accessLevel:s,extensions:n&&n.map(e=>({id:e.extensionId,name:e.extensionName})),id:t.localId||void 0,projectEntitlements:r,user:e})}if(t)for(const e of t){const t={principalName:e,subjectKind:fe.SubjectKind.User};i.push({accessLevel:s,extensions:n&&n.map(e=>({id:e.extensionId,name:e.extensionName})),projectEntitlements:r,user:t})}return i}static buildUserEntitlementsFromIdentities(e,t,s){return e.map(e=>{if(e instanceof Ie.AddIdentity){const n={principalName:e.entityId,subjectKind:fe.SubjectKind.User};return{accessLevel:t,projectEntitlements:s,user:n}}{const n={displayName:e.displayName,origin:e.originDirectory,originId:e.originId,principalName:e.signInAddress,subjectKind:fe.SubjectKind.User};return{accessLevel:t,id:e.localId||void 0,projectEntitlements:s,user:n}}})}}}(),function(e){ut=t[e]={};t[e].AzCommClientName="AexAzComm.IAzCommRestClient",t[e].getAzCommClient=function(s,n){return s.getRestClient(t[e].AzCommClientName,n)},u.RestClients.add(t[e].AzCommClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async setupDataImport(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"{organizationId}/_apis/AzComm/AzCommDataImport",routeValues:{organizationId:e}})}async getAzureSubscriptionDetails(e,t,s){const n={organizationId:t,tenantId:s};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/AzureSubscription/{subscriptionId}",routeValues:{subscriptionId:e},queryParams:n})}async getAzureSubscriptionsForUser(e){const t={payload:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/AzureSubscription/{subscriptionId}",queryParams:t})}async getBillingInfo(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:e}})}async removeBilling(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:e}})}async setupBilling(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:t},body:e})}async updateBillingMode(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:t},body:e})}async getDefaultLicenseType(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/DefaultLicenseType",routeValues:{organizationId:e}})}async updateDefaultLicenseType(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"{organizationId}/_apis/AzComm/DefaultLicenseType",routeValues:{organizationId:t},body:e})}async getAllMeterResources(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/MeterResource",routeValues:{organizationId:e}})}async updateMeterResource(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{organizationId}/_apis/AzComm/MeterResource",routeValues:{organizationId:t},body:e})}async getMeterUsage(e){const t={payload:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/MeterUsage",queryParams:t})}async reportUsage(e,t){const s={organizationId:t};return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/AzComm/MeterUsage",queryParams:s,body:e})}async getAllMeterUsages(e){return this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"{organizationId}/_apis/AzComm/MeterUsage2/{meterId}",routeValues:{organizationId:e}})}async getSubscriptionInformation(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/Subscription/{subscriptionId}",routeValues:{subscriptionId:e}})}async getAllSubscriptionMeterResources(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{subscriptionId}/_apis/AzComm/SubscriptionMeterResource",routeValues:{subscriptionId:e}})}async updateSubscriptionMeterResource(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{subscriptionId}/_apis/AzComm/SubscriptionMeterResource",routeValues:{subscriptionId:t},body:e})}},options:{resourceAreaId:"ed1325fd-71e8-4623-89f3-485951654312"}})}("RestClientAzComm"),function(e){mt=t[e]={};t[e].CoreClientName="AexUserHubCore.ICoreRestClient",t[e].getCoreClient=function(s,n){return s.getRestClient(t[e].CoreClientName,n)},u.RestClients.add(t[e].CoreClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async createConnectedService(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:t},body:e})}async getConnectedServiceDetails(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e,name:t}})}async getConnectedServices(e,t){const s={kind:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e},queryParams:s})}async createIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async deleteIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t}})}async getIdentityMru(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:e}})}async updateIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async getTeamMembersWithExtendedProperties(e,t,s,n){const r={$top:s,$skip:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{teamId}/members",routeValues:{projectId:e,teamId:t},queryParams:r})}async getProcessById(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/process/processes/{*processId}",routeValues:{processId:e}})}async getProcesses(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/process/processes/{*processId}"})}async getProjectCollection(e){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",routeValues:{collectionId:e}})}async getProjectCollections(e,t){const s={$top:e,$skip:t};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",queryParams:s})}async getProjectHistoryEntries(e){const t={minRevision:e};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectHistory",queryParams:t})}async getProject(e,t,s){const n={includeCapabilities:t,includeHistory:s};return this.beginRequest({apiVersion:"5.0-preview.4",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e},queryParams:n})}async getProjects(e,t,s,n,r){const i={stateFilter:e,$top:t,$skip:s,continuationToken:n,getDefaultTeamImageUrl:r};return this.beginRequest({apiVersion:"5.0-preview.4",routeTemplate:"_apis/projects/{*projectId}",queryParams:i,returnRawResponse:!0}).then(async e=>{const t=await e.text().then(w.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t})}async queueCreateProject(e){return this.beginRequest({apiVersion:"5.0-preview.4",method:"POST",routeTemplate:"_apis/projects/{*projectId}",body:e})}async queueDeleteProject(e){return this.beginRequest({apiVersion:"5.0-preview.4",method:"DELETE",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e}})}async updateProject(e,t){return this.beginRequest({apiVersion:"5.0-preview.4",method:"PATCH",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:t},body:e})}async getProjectProperties(e,t){const s={keys:t&&t.join(",")};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},queryParams:s})}async setProjectProperties(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async createOrUpdateProxy(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PUT",routeTemplate:"_apis/proxies",body:e})}async deleteProxy(e,t){const s={proxyUrl:e,site:t};return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/proxies",queryParams:s})}async getProxies(e){const t={proxyUrl:e};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/proxies",queryParams:t})}async createTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t},body:e})}async deleteTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})}async getTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})}async getTeams(e,t,s,n){const r={$mine:t,$top:s,$skip:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e},queryParams:r})}async updateTeam(e,t,s){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t,teamId:s},body:e})}async getAllTeams(e,t,s){const n={$mine:e,$top:t,$skip:s};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/teams",queryParams:n})}},options:{resourceAreaId:"79134c72-4a58-4b42-976c-04e7115f32bf",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientCore"),function(e){dt=t[e]={};t[e].LicensingRuleClientName="AexLicensingRule.ILicensingRuleRestClient",t[e].getLicensingRuleClient=function(s,n){return s.getRestClient(t[e].LicensingRuleClientName,n)},u.RestClients.add(t[e].LicensingRuleClientName,{factory:class extends m.RestClientBase{constructor(e){super(e)}async addGroupLicensingRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s,body:e})}async deleteGroupLicenseRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:s})}async getGroupLicensingRule(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",routeValues:{subjectDescriptor:e}})}async getGroupLicensingRules(e,t){const s={top:e,skip:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s})}async updateGroupLicensingRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s,body:e})}async applyGroupLicensingRulesToAllUsers(e){const t={ruleOption:e};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesApplication/",queryParams:t})}async getApplicationStatus(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesApplicationStatus/{operationId}",routeValues:{operationId:e}})}async retrieveFile(e){const t={fileId:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesEvaluationLog",queryParams:t})}async lookupGroupLicensingRules(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesLookup/",body:e})}async applyGroupLicensingRulesToUser(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesUserApplication/{userId}",routeValues:{userId:e}})}async removeDirectAssignment(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesUserApplication/{userId}",routeValues:{userId:e}})}}})}("RestClientLicensingRule"),function(e){pt=t.UtilsDateUtils={},t.UtilsDateUtils.toLocaleDateString=function(e,t){return!e||e.getTime()<0?t:e.toLocaleDateString()}}(),function(e){gt=t.UtilsFocusUtils={},t.UtilsFocusUtils.useSaveFocusElement=function(){const e=i.useRef(null);return[i.useCallback(t=>{t&&(e.current=t)},[e]),()=>{try{e.current&&e.current.focus()}catch(e){}}]}}(),function(e){function s(e){return`access-level-dropdown-item-${Pe.AccessLevels.getLicenseKey(e)}`}Ct=t[e]={},t[e].getAccessLevelDropdownItemClassName=s;class n{static selectionItemEquals(e,t){return Pe.AccessLevels.equals(e.data,t)}static selectionOnGetValue(e){return e.data}}t[e].AccessLevelDropdown=function(e){const t=i.useContext(xe.UsersSummaryContext),r=e.availableAccessLevels||t.availableAccessLevels,o=i.useMemo(()=>r?r.map(e=>({id:Pe.AccessLevels.getLicenseKey(e),text:e.licenseDisplayName,data:e,className:s(e)})):[{id:"_loading",type:4}],[r]),{selectedAccessLevel:a,onChange:l}=e,c=i.useCallback(e=>{void 0!==e&&l(e)},[l]),[u,m]=(0,g.useSingleSelectedItem)(o,a,c,n.selectionItemEquals,n.selectionOnGetValue),d=(0,g.useSelectionFactory)(()=>new S.DropdownSelection,u,m);return i.createElement(h.FormItem,{className:Ae.L2ClassNames.formItems.accessLevelsDropdown,label:e.label},i.createElement(v.Dropdown,{className:"access-level-dropdown",calloutContentClassName:Ae.L2ClassNames.dropdowns.accessLevel.callout,items:o,loading:void 0===r,disabled:e.disabled||0===o.length,selection:d}))}}("ComponentsControlsAccessLevelDropdown"),function(e){bt=t.ComponentsControlsFlexDividerCell={};class s extends i.Component{static getStyle(){return(0,y.css)(R.FlexClassNames.alignSelfStretch,B.CssClassNames.border.top.style.solid,B.CssClassNames.border.top.width1,(0,j.getColorClassName)("neutral",8,"border-top-color"))}render(){return i.createElement("div",{className:s.getStyle()})}}__decorate([o.memoize],s,"getStyle",null),t.ComponentsControlsFlexDividerCell.FlexDividerCell=s}(),function(e){vt=t[e]={};class s{static getStyles(){return{labelContainer:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),statusMessage:(0,b.getSpacingContainerClassName)("y",8),tooltipContainer:R.FlexClassNames.alignSelfCenter}}}__decorate([o.memoize],s,"getStyles",null),t[e].AccessLevelDropdownWithGroupAssignmentsInternal=s,t[e].AccessLevelDropdownWithGroupAssignments=function(e){const{groupAssignments:t,selectedAccessLevel:n,disabled:r}=e,o=!!n&&1!==n.status&&!!n.statusMessage,a=!!n&&2===n.assignmentSource,l=a&&t&&t.length>0&&n?t.filter(e=>Pe.AccessLevels.compareByPermission(n,e.accessLevel)>=0):void 0,c=o||a,u=a&&(e.memberPromiseFulfilled?l&&l.length>0&&n&&5!==n.accountLicenseType:n&&5!==n.accountLicenseType&&1!==n.msdnLicenseType),m=s.getStyles(),d=c?i.createElement("div",{className:m.labelContainer},i.createElement("div",null,e.label),(o&&n||a)&&i.createElement("div",{className:m.tooltipContainer},i.createElement(I.Icon,{className:(0,y.css)(Ae.L2ClassNames.EditItems.accessLevelInfoIcon),iconName:n&&o&&2!==n.licensingSource&&1!==n.msdnLicenseType?"Warning":"Info",ariaLabel:he.AccessLevelIcon_HoverInfoLabel,tabIndex:0,tooltipProps:{renderContent:()=>i.createElement("div",{className:Ae.L2ClassNames.EditItems.accessLevelInfoContainer},o&&n&&i.createElement("div",{className:m.statusMessage},i.createElement("div",null,he.AccessLevelInfo_StatusMessageTitle),i.createElement("div",null,n.statusMessage)),o&&n&&a&&i.createElement(bt.FlexDividerCell,null),a&&i.createElement(Be.GroupMembershipToolTipContent,{promiseFulfilled:e.memberPromiseFulfilled,groupsInheritedFrom:l}))}}))):e.label;return i.createElement(Ct.AccessLevelDropdown,Object.assign({},e,{label:d,disabled:r||u}))}}("ComponentsControlsAccessLevelDropdownGroupAssignments"),function(e){function s(e){const{isPrimary:t=!0,className:s}=e,n=__rest(e,["isPrimary","className"]);return i.createElement(H.Button,Object.assign({},n,{className:(0,y.css)(s,Ae.L2ClassNames.callouts.actionButton),primary:t}))}ht=t.ComponentsControlsCommonCallout={},t.ComponentsControlsCommonCallout.CommonPanelFooter=function(e){return e.onDismiss||e.actionButtonProps?i.createElement(V.PanelFooter,null,i.createElement(O.ButtonGroup,{className:"bolt-panel-footer-buttons flex-grow"},e.onDismiss&&i.createElement(H.Button,{className:Ae.L2ClassNames.callouts.dismissButton,text:he.HubButtonTextCancel,onClick:e.onDismiss}),e.actionButtonProps&&i.createElement(s,Object.assign({},e.actionButtonProps)))):null}}(),function(e){ft=t.ComponentsControlsCommonDialog={},t.ComponentsControlsCommonDialog.CommonDialog=function(e){const{className:t,onDismiss:s,title:n}=e,r=i.useMemo(()=>e.id||(0,z.getId)("dialog"),[e.id]),o=n?`${r}-title`:void 0;return i.createElement(q.CustomDialog,{ariaLabelledBy:o,className:(0,y.css)("bolt-dialog",t),id:r,onDismiss:s,contentSize:e.contentSize},i.createElement(V.PanelHeader,{onDismiss:s,closeButtonSize:0,showCloseButton:!0,showSeparator:!1,titleProps:{text:n,size:2,id:o}}),i.createElement(W.SurfaceContext.Consumer,null,t=>i.createElement("div",{className:(0,y.css)("bolt-dialog-content flex-column flex-grow","bolt-dialog-content-bottom-padding",t.horizontalClassName)},e.children)),i.createElement(ht.CommonPanelFooter,{onDismiss:e.onDismiss,actionButtonProps:e.actionButtonProps}))}}(),function(e){yt=t.ComponentsControlsCommonPanel={},t.ComponentsControlsCommonPanel.CommonPanel=function(e){const{backButtonProps:t,description:s,onDismiss:n,title:r}=e,o=i.useMemo(()=>e.id||(0,z.getId)("panel"),[e.id]),a=r?`${o}-title`:void 0;return i.createElement(V.CustomPanel,{className:e.className,ariaLabelledBy:a,onDismiss:n,id:o,defaultActiveElement:e.defaultActiveElement},i.createElement(V.PanelHeader,{backButtonProps:t,description:s,onDismiss:n,titleProps:{id:a,text:r}}),i.createElement(V.PanelContent,null,i.createElement("div",{className:(0,y.css)(C.SizeClassNames.width100,R.FlexClassNames.flexColumn,e.contentClassName)},e.children)),i.createElement(ht.CommonPanelFooter,{onDismiss:e.hideDismissButton?void 0:e.onDismiss,actionButtonProps:e.actionButtonProps}))}}(),function(e){St=t[e]={},t[e].identityPickerDropdownClass="identity-picker-dropdown",t[e].identityPickerDropdownInputSelector=".identity-picker-dropdown input",t[e].UserIdentityPicker=function(e){const t=(0,K.useVersionKey)(e.pickerProvider),s=i.useCallback(t=>{let s;s=t instanceof Ie.AddPendingIdentities?(0,Le.unionByKey)(e.selectedIdentities,t.toAddIdentities(),e=>e.entityId):(0,Le.unionByKey)(e.selectedIdentities,[t],e=>e.entityId),e.onChange(s)},[e.selectedIdentities,e.onChange]);return i.createElement($.IdentityPicker,{placeholderText:e.placeholderText,pickerProvider:e.pickerProvider,onBlur:e=>{(e=e&&e.trim())&&s(new Ie.AddPendingIdentities(e))},onIdentityAdded:s,onIdentitiesRemoved:t=>{const s={};for(const e of t)s[e.entityId]=!0;const n=e.selectedIdentities.filter(e=>!s[e.entityId]);e.onChange(n)},onIdentityRemoved:t=>{const s=e.selectedIdentities.filter(e=>e.entityId!==t.entityId);e.onChange(s)},selectedIdentities:e.selectedIdentities,renderCustomIdentitySuggestion:e=>e instanceof Ie.AddPendingIdentities?i.createElement("div",{className:"bolt-picker-suggesteditem-text flex-row flex-grow flex-center text-ellipsis"},i.createElement("div",{className:(0,y.css)("bolt-picker-persona-name flex-column flex-grow",(0,b.getSpacingContainerClassName)("y",4))},i.createElement("div",null,he.IdentityPickerText_AddUsers),i.createElement(Q.PillGroup,{className:"flex-row",overflow:1},e.addIdentityNames.map((e,t)=>i.createElement(J.Pill,{key:t,variant:1,size:0},e))))):i.createElement(i.Fragment,null),key:t})},t[e].IdentityPickerDropdown=function(e){const t=(0,K.useVersionKey)(e.pickerProvider);return i.createElement($.IdentityPickerDropdown,Object.assign({},e,{key:t}))}}("ComponentsControlsIdentityPickers"),function(e){function s(e,t){switch(e){case fe.ErrorCodes.RemoveUserFromAccountError:return i.createElement("div",null,t,he.PunctuationPeriod,he.PunctuationSuffix,i.createElement(f.Link,{href:fe.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer",tabIndex:0},he.UserDialog_LearnMore),he.PunctuationPeriod,he.PunctuationSuffix);case fe.ErrorCodes.BuildGroupEntitlementFailed:return i.createElement("div",null,he.GroupRules_BuildGroupEntitlementFailed);case fe.ErrorCodes.AccessDenied:return i.createElement("div",null,he.ProjectInviteDialog_FailedToAddNoPermissions,he.PunctuationSuffix,i.createElement(f.Link,{href:fe.UserManagementLinks.AddTeamProjectMemberLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore));case fe.ErrorCodes.ExternalGuestAccessDenied:return i.createElement("div",null,t,he.PunctuationSuffix,i.createElement(f.Link,{href:fe.UserManagementLinks.ExternalGuestAccessDeniedHelpLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore));case fe.ErrorCodes.GuestUserInviterError:return i.createElement("div",null,t,he.PunctuationSuffix,i.createElement(f.Link,{href:fe.UserManagementLinks.GuestUserInviterErrorHelpLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore));case fe.ErrorCodes.GuestAadInviteGenericFailure:return i.createElement(p.TemplateString,{template:he.GuestInviteError_GuestAadInviteGenericFailure1},i.createElement(f.Link,{href:fe.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_ContactSupport));case fe.ErrorCodes.ValidRefreshTokenNotFound:return i.createElement("div",null,"Resources.UserInviteDialog_ValidRefreshTokenNotFound")}return i.createElement("div",{dangerouslySetInnerHTML:{__html:t}})}function n(e){const{onRender:t=s}=e;return t(e.errorKey,e.errorValue,s)}Et=t[e]={},t[e].defaultRender=s,t[e].OperationError=n,t[e].OperationErrors=function(e){return i.createElement("div",{className:e.className},e.errors.map((t,s)=>i.createElement(n,{key:s,errorKey:t.key,errorValue:t.value,onRender:e.onRender})))}}("ComponentsControlsNotifications"),function(e){xt=t.ComponentsControlsPersona={};class s extends i.PureComponent{static getStyles(e){let t="aex-user-hub-persona-size-32";switch(e){case"large":t="aex-user-hub-persona-size-48"}return{root:(0,y.css)(R.FontClassNames.fontSizeM,R.FontClassNames.fontWeightNormal,j.ColorClassNames.primaryText,R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter),imageArea:(0,y.css)(B.CssClassNames.flex.none,R.TextClassNames.alignCenter,t),details:(0,y.css)((0,b.getSpacingClassName)("padding","left",16),(0,b.getSpacingClassName)("padding","right",20),B.CssClassNames.flex.auto,R.FlexClassNames.flexColumn,B.CssClassNames.jusitfyContent.spaceAround,R.FlexClassNames.alignItemsStretch,R.LayoutClassNames.overflowHidden),primaryText:(0,y.css)(R.TextClassNames.ellipsis,R.FontClassNames.fontSizeM,j.ColorClassNames.primaryText),secondaryText:(0,y.css)(R.TextClassNames.ellipsis,R.FontClassNames.fontSizeDefault,j.ColorClassNames.secondaryText)}}render(){const{member:e,onRenderImage:t,size:n="medium",pageContext:r,defaultToMemberTextField:o=!0,defaultToMemberSecondaryTextField:a=!0}=this.props,{text:l=(o?e.displayName:void 0),secondaryText:c=(a?e.principalName:void 0)}=this.props,u=s.getStyles(n);return i.createElement("div",Object.assign({className:(0,y.css)(u.root,this.props.className)},{[Ae.L2DataAttributeKeys.memberDescriptor]:e.descriptor}),i.createElement("div",{className:(0,y.css)(u.imageArea,this.props.imageContainerClassName)},t?t():i.createElement(Z.VssPersona,{suppressPersonaCard:!0,imageUrl:e.getAvatarUrl(r),showInitialsOnImageError:!0,size:n})),i.createElement("div",{className:u.details},l&&i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:u.primaryText},l)),c&&i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:u.secondaryText},c))))}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsControlsPersona.MemberPersona=s;class n extends i.PureComponent{static getStyles(){return{githubIcon:(0,b.getSpacingClassName)("margin","right",4),baseIconContainer:(0,y.css)(B.CssClassNames.border.radius50,R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,R.FlexClassNames.justifyContentCenter),aadDeletedIconContainer:j.BackgroundColorClassNames.statusErrorBackground,aadGuestIconContainer:j.BackgroundColorClassNames.communicationBackground}}render(){const e=n.getStyles(),{member:t}=this.props;if(t.isGitHubUser){const n=Object.assign(Object.assign({},this.props),{defaultToMemberTextField:!1,defaultToMemberSecondaryTextField:!1});return t.isBindPending?n.text=i.createElement(i.Fragment,null,i.createElement(I.Icon,{className:e.githubIcon,iconName:"GitHubLogo"}),t.directoryAlias||t.displayName):(n.text=t.displayName,n.secondaryText=t.directoryAlias&&i.createElement(i.Fragment,null,i.createElement(I.Icon,{className:e.githubIcon,iconName:"GitHubLogo"}),t.directoryAlias)),i.createElement(s,Object.assign({},n))}return t.isAADDeleted&&this.props.pageContext.isFeatureFlagEnabled(fe.FeatureFlags.ReinstateAssets)?i.createElement(s,Object.assign({},this.props,{imageContainerClassName:(0,y.css)(e.baseIconContainer,e.aadDeletedIconContainer),onRenderImage:()=>i.createElement(I.Icon,{className:(0,y.css)(R.FontClassNames.fontSizeL,j.ColorClassNames.statusErrorForeground),iconName:"Warning"}),text:(0,D.format)(he.DisplayNameWithAadDeleted1,t.displayName)})):t.isAADGuest?i.createElement(s,Object.assign({},this.props,{imageContainerClassName:(0,y.css)(e.baseIconContainer,e.aadGuestIconContainer),onRenderImage:()=>i.createElement(I.Icon,{className:(0,y.css)(R.FontClassNames.fontSizeL,j.ColorClassNames.textOnCommunicationBackground),iconName:"Contact"})})):i.createElement(s,Object.assign({},this.props))}}__decorate([o.memoize],n,"getStyles",null),t.ComponentsControlsPersona.UserPersona=n}(),function(e){At=t.ComponentsControlsStatusMessageCard={};class s{static getMessageCardInfo(e){let t="Info";switch(e){case"Failed":t="Error";break;case"Warning":t="Warning"}return{severity:t,iconProps:{render:t=>i.createElement(ee.Status,Object.assign({},ee.Statuses[e],{className:(0,y.css)(t,(0,b.getSpacingClassName)("margin","all",8)),size:"16"}))}}}}t.ComponentsControlsStatusMessageCard.StatusMessageCard=function(e){const t=i.useMemo(()=>s.getMessageCardInfo(e.statusType),[e.statusType]),{severity:n=t.severity,iconProps:r=t.iconProps}=e;return i.createElement(X.MessageCard,Object.assign({},e,{severity:n,iconProps:r}),e.children)}}(),function(e){Ut=t.ComponentsControlsTableCells={},t.ComponentsControlsTableCells.OneLineSimpleTableCell=function(e){return i.createElement(T.SimpleTableCell,{columnIndex:e.columnIndex,tableColumn:e.tableColumn},i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:(0,y.css)(R.TextClassNames.ellipsis,e.contentClassName)},e.children)))}}(),function(e){Tt=t.ComponentsControlsTextFieldWithCopy={};class s{static getStyles(){return{content:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter),textContainer:R.FlexClassNames.flexGrow}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsControlsTextFieldWithCopy.TextFieldWithCopy=function(e){const[t,n]=i.useState(void 0),r=s.getStyles(),{text:o}=e,a=i.useMemo(()=>({text:t===o?he.CopyToClipBoard_Copied:he.CopyToClipBoard_Copy,anchorOrigin:{horizontal:"center",vertical:"end"},tooltipOrigin:{horizontal:"center",vertical:"start"}}),[o,t]);return i.createElement("div",{className:r.content},i.createElement(se.TextField,{containerClassName:r.textContainer,value:o,readOnly:!0}),i.createElement(te.ClipboardButton,{getContent:()=>e.text,onCopy:()=>{n(e.text)},tooltipProps:a}))}}(),function(e){Rt=t[e]={};class s extends De.AsyncIteratorBase{constructor(e,t,s){super(),this.client=e,this.operationId=t,this.intervalInMs=s,this.client=e,this.operationId=t,this.intervalInMs=s}async next(){if(this.latestValue){if((0,at.isOperationStatusCompleted)(this.latestValue.status))return{done:!0,value:void 0};const e=Math.floor(Math.random()*this.intervalInMs/2);await(0,ne.wait)(this.intervalInMs+e)}return this.latestValue=await this.client.getApplicationStatus(this.operationId),{done:!1,value:this.latestValue}}get value(){return this.latestValue}get initialApplicationStatusPromise(){return this._initialApplicationStatusPromise||(this._initialApplicationStatusPromise=(async()=>this.latestValue?this.latestValue:(await this.next(),this.latestValue))()),this._initialApplicationStatusPromise}get pollUntilCompletePromise(){return this._pollUntilCompletePromise||(this._pollUntilCompletePromise=(async()=>{const e=await this.initialApplicationStatusPromise;if((0,at.isOperationStatusCompleted)(e.status))return e;let t=await this.next();for(;!t.done;)t=await this.next();return this.latestValue})()),this._pollUntilCompletePromise}}function n(e){const t=e&&e.value,[,s]=i.useState(0);let n=!(!e||void 0!==t&&(0,at.isOperationStatusCompleted)(t.status));return i.useEffect(()=>(e&&n&&(void 0===t?(async()=>{await e.initialApplicationStatusPromise,n&&s(e=>e+1)})():(async()=>{await e.pollUntilCompletePromise,n&&s(e=>e+1),n=!1})()),()=>{n=!1})),[t,n]}t[e].LicensingRulesContext=i.createContext({allRulesPoller:void 0,rulePollers:{},startPollLicensingRule:()=>void 0}),t[e].LicensingRulesContextProvider=function(n){const r=(0,ye.useUserHubContext)(),o=i.useContext(tt.GroupsContext),a=i.useContext(rt.UsersContext),l=i.useContext(xe.UsersSummaryContext),c=r.shouldUseLicensingService()?"00000043-0000-8888-8000-000000000000":"951917ac-a960-4999-8464-e3f0aa25b381",u=i.useMemo(()=>(0,dt.getLicensingRuleClient)(r.pageContext,{serviceInstanceType:c}),[r.pageContext]),[m,p]=(0,d.useAsyncState)(void 0),[g,C]=(0,d.useAsyncState)({}),b=i.useCallback((e,t,n)=>{const r=new s(u,e,3e3);return(async()=>{if(await r.pollUntilCompletePromise,t){const t=r.value;t&&0===t.option&&4===t.status&&(t.licenses&&t.licenses.filter(e=>e.assigned>0).length>0&&(a.refreshMembersList(),l.refresh("licenses")),o&&(e&&!n?o.refreshGroup(e):o.refreshMembersList()))}})(),e?C(t=>Object.assign(Object.assign({},t),{[e]:r})):p(r),r},[u,a,o,l]),v=i.useMemo(()=>({allRulesPoller:m,rulePollers:g,startPollLicensingRule:b}),[m,g,b]);return i.createElement(t[e].LicensingRulesContext.Provider,{value:v},n.children)},t[e].useAllLicensingRulesApplicaitonStatus=function(){const s=i.useContext(t[e].LicensingRulesContext),[r,o]=n(s.allRulesPoller);return[r,o,i.useCallback(e=>s.startPollLicensingRule(void 0,e),[s.startPollLicensingRule])]},t[e].useLicensingRuleApplicationStatus=function(s){const r=i.useContext(t[e].LicensingRulesContext),o=i.useCallback(e=>r.startPollLicensingRule(s,e),[s,r.startPollLicensingRule]),[a,l]=n(r.rulePollers[s]);return[a,l,o]}}("ContextLicensingRulesContext"),function(e){It=t.UtilsIdentityUtils={};class s{static getStyles(){return{githubWarning:(0,b.getSpacingContainerClassName)("y",4)}}static checkHasValidUsers(e,t,n,r,i,o){n=n||[],r=r||[],i=i&&i.trim();const a={userCount:n.length+r.length+(i?1:0)};return t.isAadAccount&&(a.warningMessageOfAadGuestUsers=s.checkForAADGuestWarning(r,i,o)),t.isGitHubInviteEnabled&&(a.warningMessageOfGitHubUsers=s.checkForGitHubWarning(n,e.orgHostUri)),a}static getWarning(e,t,n){const r={userCount:n.length};return t.isAadAccount&&(t.isAadGuest?r.warningMessageforAadGuestAdmin=s.getAadGuestAdminWarning():r.warningMessageOfAadGuestUsers=s.getAADGuestWarning(n)),t.isGitHubInviteEnabled&&(r.warningMessageOfGitHubUsers=s.checkForGitHubWarning(n.filter(e=>!(e instanceof Ie.AddIdentity)),e.orgHostUri)),r}static getAddUserDisplayWarning(e,t){return t.userCount>e.maxIdentitiesToAdd?i.createElement(p.TemplateString,{template:he.UserInviteDialog_MaxUsersToAdd1},e.maxIdentitiesToAdd):t.warningMessageforAadGuestAdmin?t.warningMessageforAadGuestAdmin:t.warningMessageOfAadGuestUsers?t.warningMessageOfAadGuestUsers:t.warningMessageOfGitHubUsers?t.warningMessageOfGitHubUsers:void 0}static checkForAADGuestWarning(e,t,n){const r=s.getNewUnresolvedUsers(t,n,e);if(r.length>0)return i.createElement("span",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserToAadWarning1},r.join(he.ListItemSeparator)),i.createElement(f.Link,{href:fe.UserManagementLinks.GuestUserInviteLearnMore,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserDialog_LearnMore_AriaLabel},he.UserDialog_LearnMore))}static getAADGuestWarning(e){const t=e.filter(e=>e instanceof Ie.AddIdentity).map(e=>e.entityId);if(t.length>0)return i.createElement("span",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserToAadWarning1},t.join(he.ListItemSeparator)),i.createElement(f.Link,{href:fe.UserManagementLinks.GuestUserInviteLearnMore,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserDialog_LearnMore_AriaLabel},he.UserDialog_LearnMore))}static checkForGitHubWarning(e,t){if(e&&e.length>0){const n=s.getStyles(),r=e.filter(e=>e.originDirectory===fe.DirectoryName.GitHub);if(r.length>0)return i.createElement("div",{className:n.githubWarning},i.createElement("div",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserFromGitHubWarning1},r.map(e=>e.signInAddress).join(he.ListItemSeparator))),t&&i.createElement(Tt.TextFieldWithCopy,{text:t}))}}static getAadGuestAdminWarning(){return i.createElement("span",{role:"alert"},he.UserInviteDialog_AadGuestAdminWarning,i.createElement(f.Link,{href:fe.UserManagementLinks.AadGuestPermissionsHelpLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore))}static isValidEmailAddress(e){return s.VALID_EMAIL_ADDRESS_PATTERN.test(e)}static getNewUnresolvedUsers(e,t,n){if(!t)return[];const r=s.isValidEmailAddress(e||"")?e:"";let i=n.filter(e=>s.isValidEmailAddress(e));const o=i.indexOf(r);return-1!==o&&i.splice(o,1),i.length>0||r&&t.length<=0?(r&&t.length<=0&&(i=i.concat(r)),i):[]}}s.VALID_EMAIL_ADDRESS_PATTERN=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,__decorate([o.memoize],s,"getStyles",null),__decorate([o.memoize],s,"getWarning",null),t.UtilsIdentityUtils.UserValidationUtils=s}(),function(e){Nt=t[e]={};class s{static getStyles(){return{summaryCellContent:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8))}}static getTreeItemProvider(e){const t=e.map(([e,t])=>({data:{isSummary:!0,status:e,summaryCount:t.length,resultItem:void 0},childItems:t.map(e=>({data:{isSummary:!1,status:void 0,summaryCount:void 0,resultItem:e}})),expanded:0===e||1===e}));return new ie.TreeItemProvider(t)}static renderNameCell(e,t,n,r){const{data:o}=r.underlyingItem,{isSummary:a}=o;let l;if(a)l=s.renderSummaryCellContent(o);else{const[,e]=o.resultItem,[t]=e;switch(t){case 3:const s=e[1];l=i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:R.TextClassNames.ellipsis},s.user.principalName));break;default:const n=e[1];l=n&&i.createElement("div",null,n.displayName)}}return i.createElement(re.ExpandableTreeCell,{className:(0,y.css)(B.CssClassNames.whiteSpace.normal),key:t,columnIndex:t,treeItem:r,contentClassName:n.className,colspan:a?2:void 0,treeColumn:n},l)}static renderSimpleCell(e,t,s){return i.createElement(T.SimpleTableCell,{key:t,columnIndex:t,tableColumn:s,contentClassName:s.className},i.createElement("div",null,e))}static renderMessageCell(e,t,n,r){const{data:o}=r.underlyingItem,{isSummary:a}=o;if(a)return i.createElement(i.Fragment,{key:t});const l=o,{resultItem:c}=l,[u]=c;return s.renderSimpleCell(u&&u.errors&&i.createElement(Et.OperationErrors,{className:B.CssClassNames.whiteSpace.normal,errors:u.errors,onRender:e&&((t,s)=>e(c,t,s))}),t,n)}static getDefaultWidthes(e){switch(e){case 2:return[-50,-50];case 3:return[-30,-30,-40]}}static renderSummaryCellContent(e){const t=s.getStyles();let n=he.BulkStatusDialogText_LabelSuccess,r="Success";switch(e.status){case 3:n=he.BulkStatusDialogText_LabelCanceled,r="Canceled";break;case 0:n=he.BulkStatusDialogText_LabelFailed,r="Failed";break;case 1:n=he.BulkStatusDialogText_LabelWarning,r="Warning"}return i.createElement("div",{className:t.summaryCellContent},i.createElement(ee.Status,Object.assign({},ee.Statuses[r],{size:"16"})),i.createElement("div",null,n),i.createElement(J.Pill,{size:0},e.summaryCount))}}function n(e){const[t,n]=i.useState(s.getDefaultWidthes(e.centerColumn?3:2));i.useEffect(()=>{e.centerColumn&&2===t.length?n(s.getDefaultWidthes(3)):e.centerColumn||3!==t.length||n(s.getDefaultWidthes(2))});const r=i.useCallback((e,t,s)=>{n(e=>{const n=[...e];return n[t]=s,n})},[]),o=i.useMemo(()=>s.getTreeItemProvider(e.groupedItems),[e.groupedItems]),a=(0,K.useVersionKey)(o),l=i.useCallback((t,n,r,i)=>s.renderMessageCell(e.onRenderError,n,r,i),[e.onRenderError]),c=i.useMemo(()=>[{id:"name",renderCell:s.renderNameCell,name:he.BulkStatusDialogColumnName_User,width:t[0],onSize:r},...e.centerColumn?[Object.assign(Object.assign({},e.centerColumn),{width:t[1],onSize:r})]:[],{id:"message",renderCell:l,name:he.BulkStatusDialogColumnName_Message,width:t[e.centerColumn?2:1],onSize:r}],[t,r,e.centerColumn]);return i.createElement(re.Tree,{onToggle:(e,t)=>{o.toggle(t.underlyingItem)},showLines:!0,columns:c,itemProvider:o,key:a})}__decorate([o.memoize],s,"getStyles",null),t[e].BulkStatusTree=n,t[e].BulkProjectStatusTree=function(e){const t=(0,xe.useProjectRefsMapping)(),r={id:"project",renderCell:i.useCallback((e,n,r,o)=>{const{data:a}=o.underlyingItem,{isSummary:l}=a;if(l)return i.createElement(i.Fragment,{key:n});const[,c]=a.resultItem,[,,,u]=c,m=t&&t[u]&&t[u].name;return s.renderSimpleCell(m,n,r)},[]),name:he.BulkStatusDialogColumnName_Project,width:-100};return i.createElement(n,{centerColumn:r,groupedItems:e.groupedItems})}}("ComponentsHubNotificationsBulkStatusTree"),function(e){Pt=t[e]={};class s extends Ye.PatchResponseStatusNotification{constructor(e,t=Nt.BulkStatusTree){super(e),this.details=i.createElement(t,{groupedItems:this.summarized})}}t[e].BulkStatusResultNotification=s;t[e].SingleMemberStatusResultNotification=class extends Ye.PatchResponseStatusNotification{constructor(e,t){super(e,t),this.description=i.createElement(i.Fragment,null,t&&t.message&&i.createElement("div",null,t.message),e.map(([e],t)=>void 0===e||e.isSuccess?null:i.createElement(Et.OperationErrors,{key:t,errors:e.errors,className:(0,b.getSpacingClassName)("margin","left",8)})))}},t[e].useBulkUserApiNotificationCallback=function(e,t,n){const r=i.useMemo(()=>({onGetDisplayName:t,onGetResultNotification:(e,...t)=>new s(e,n)}),[t]);return(0,qe.useNotificationAsyncCallback)(e,r)}}("ComponentsHubNotificationsMemberOperationStatusNotifications"),function(e){function s(e){const t=(0,ye.useUserHubConfiguration)(),s=n.getStyles(),r=i.createElement(i.Fragment,null,he.LabelText_WithUsers,!t.isGitHubUser&&t.isGitHubSearchEnabled&&i.createElement(I.Icon,{tooltipProps:{renderContent:()=>i.createElement("span",null,he.GitHubSearchWarning_TooltipContent)},iconName:"Warning",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement("div",{className:s.innerFormGroupSpacing},i.createElement("div",{className:s.spacingContainer12},i.createElement(h.FormItem,{className:Ae.L2ClassNames.formItems.createNewAzureDevOpsGroupName,label:he.LabelText_VstsGroupName},i.createElement(se.TextField,{autoFocus:!0,required:!0,value:e.groupName,onChange:(t,s)=>{e.onGroupNameChange(s)}})),e.onSelectFromExistingGroups&&i.createElement(H.Button,{className:Ae.L2ClassNames.Dialogs.AddGroupRule.SelectFromExistingGroupButton,onClick:e.onSelectFromExistingGroups,text:he.ButtonText_SelectFromSingleExistingGroup})),i.createElement("div",null,i.createElement(h.FormItem,{label:r,className:Ae.L2ClassNames.formItems.userIdentityPicker},i.createElement(St.UserIdentityPicker,{pickerProvider:e.userIdentityPicker.pickerProvider,selectedIdentities:e.userIdentityPicker.selectedIdentities,onChange:e.userIdentityPicker.onChange}))))}Mt=t.ComponentsHubCalloutsAddMemberAddGroupPanel={};class n{static getStyles(){return{innerFormGroupSpacing:(0,b.getSpacingContainerClassName)("y",8),spacingContainer4:(0,b.getSpacingContainerClassName)("y",4),spacingContainer12:(0,b.getSpacingContainerClassName)("y",12),labelContainer:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter),content:(0,b.getSpacingContainerClassName)("y",16)}}static buildGroupEntitlementFromInput(e,t,s,r,i){const o=n.buildCreateGroupFromInput(e,t);if(!o)return;const[a,l,c]=o;return{extensionRules:[],group:a,id:l,licenseRule:s,members:c,projectEntitlements:r&&lt.ProjectEntitlements.toProjectEntitlements(r,i)}}static buildCreateGroupFromInput(e,t){if(e.isCreatingGroup){const{createGroupName:s}=e,n=t&&ct.UserEntitlements.buildUserEntitlementsFromIdentities(t);return[{displayName:s?s.trim():void 0,origin:fe.OriginName.VisualStudioTeamServices,subjectKind:fe.SubjectKind.Group},void 0,n]}{const{selectedGroupIdentity:t}=e;if(!t)return;return[{displayName:t.displayName,origin:t.originDirectory,originId:t.originId,subjectKind:fe.SubjectKind.Group},t.localId,void 0]}}}n.addToProjectsItemKey="projects-form",__decorate([o.memoize],n,"getStyles",null),t.ComponentsHubCalloutsAddMemberAddGroupPanel.AddGroupPanel=function(e){const t=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),{isAdmin:o}=(0,ye.useUserHubConfiguration)(),a=i.useContext(tt.GroupsContext),l=i.useMemo(()=>new ot.GroupIdentityPickerProvider(t.pageContext),[t.pageContext]),c=(0,Ne.useAddUserIdentityPicker)(t,r),[u,m]=i.useState({isCreatingGroup:!1,selectedGroupIdentity:void 0,createGroupName:void 0}),d=i.useContext(Rt.LicensingRulesContext),{selectedAccessLevel:g,setSelectedAccessLevel:C,selectedGroupType:b,setSelectedGroupType:v,selectedProjectIds:f,setSelectedProjectIds:y}=(0,Re.useAddMemberFields)(),S=i.useMemo(()=>{const e=c&&c.selectedIdentities;if(e)return It.UserValidationUtils.getWarning(t,r,e).warningMessageOfAadGuestUsers},[c&&c.selectedIdentities,t,r]),E=i.useMemo(()=>{if(!u.isCreatingGroup&&u.selectedGroupIdentity)return t.isGroupIdValidForGroupRule(u.selectedGroupIdentity.originId)},[u.isCreatingGroup,u.selectedGroupIdentity,t]),[x]=(0,L.useResolvedPromise)(E),A=i.useMemo(()=>{if(!1===x)return!0;if(u.isCreatingGroup){const{createGroupName:e}=u;return!e||0===e.trim().length}return!u.selectedGroupIdentity},[u,x]),U=i.createElement(p.TemplateString,{template:he.Notification_AddGroupRule_Action1},u.isCreatingGroup?u.createGroupName:u.selectedGroupIdentity&&u.selectedGroupIdentity.displayName),{addGroupRule:T}=(0,it.useGroupsContextApiActions)(),R=(0,Se.useTrackedAsyncCallback)(t,(0,qe.useNotificationAsyncCallback)(T,{onGetDisplayName:()=>U,onGetResultNotification:e=>new Pt.SingleMemberStatusResultNotification(e),onGetErrorNotification:(e,t)=>new Pt.SingleMemberStatusResultNotification([[void 0,[3,t]]],new F.HandledError(e))}),fe.PerformanceScenarioConstants.AddGroupFeatureName);if(!a||!t||!c)return null;const I=n.getStyles();return i.createElement(yt.CommonPanel,{className:Ae.L2ClassNames.panels.addGroupRule.root,contentClassName:I.content,onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!1),e.onDismiss()},title:he.CommandButtonText_AddSingleGroupRule,defaultActiveElement:St.identityPickerDropdownInputSelector,actionButtonProps:{disabled:A,text:he.UserInviteDialog_AddButton,onClick:async()=>{const t=g&&n.buildGroupEntitlementFromInput(u,c.selectedIdentities,g,f,b);if(t){e.onDismiss();try{const[[e]]=await R(t);e&&e.result&&d.startPollLicensingRule(e.result.id,!0)}catch(e){}}}}},u.isCreatingGroup?i.createElement(s,{groupName:u.createGroupName,onGroupNameChange:e=>{m(t=>Object.assign(Object.assign({},t),{createGroupName:e}))},userIdentityPicker:c,onSelectFromExistingGroups:o?()=>{m(e=>Object.assign(Object.assign({},e),{isCreatingGroup:!1}))}:void 0}):i.createElement("div",{className:I.spacingContainer12},i.createElement(h.FormItem,{label:he.IdentityPickerLabelText_Group,className:Ae.L2ClassNames.formItems.groupIdentityPicker},i.createElement(St.IdentityPickerDropdown,{className:St.identityPickerDropdownClass,pickerProvider:l,onChange:e=>{m(t=>Object.assign(Object.assign({},t),{selectedGroupIdentity:e}))},value:u.selectedGroupIdentity,placeholder:he.UserInviteDialog_IdentityPickerGroupPlaceholder})),o&&i.createElement(H.Button,{text:he.ButtonText_CreateNewVstsGroup,iconProps:{iconName:"Add"},className:Ae.L2ClassNames.commandItems.createNewAzureDevOpsGroup,onClick:()=>{m(e=>Object.assign(Object.assign({},e),{isCreatingGroup:!0}))}})),i.createElement(Ct.AccessLevelDropdown,{label:he.UserInviteDialog_AccessLevel,onChange:C,selectedAccessLevel:g}),i.createElement(h.FormItem,{label:he.DialogColProjectName},i.createElement(Te.AddToProjectsForm,{selectedGroupType:b,selected:f,onSelectedGroupTypeChange:v,onChange:y})),S&&i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,S)),!1===x&&i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,he.WarningMessage_CannotAddProjectGroup)))}}(),function(e){Lt=t.ComponentsHubCalloutsAddMemberAddUsersToCollection={};class s{static buildUserEntitlementsFromInput(e,t,s,n){const r=s&&lt.ProjectEntitlements.toProjectEntitlements(s,n);return ct.UserEntitlements.buildUserEntitlementsFromIdentities(e,t,r)}static getStyles(){return{content:(0,b.getSpacingContainerClassName)("y",16),projectsLabelContainer:R.FlexClassNames.flexColumn}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsAddMemberAddUsersToCollection.AddUsersToCollectionPanel=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=(0,Ne.useAddUserIdentityPicker)(t,n),o=i.useContext(xe.UsersSummaryContext),a=r&&r.selectedIdentities,{selectedAccessLevel:l,setSelectedAccessLevel:c,selectedGroupType:u,setSelectedGroupType:m,selectedProjectIds:d,setSelectedProjectIds:g}=(0,Re.useAddMemberFields)(),[C,b]=i.useState(!0),{addUsersToCollection:v}=(0,rt.useUsersContextApiActions)(),f=(0,Pt.useBulkUserApiNotificationCallback)(async(e,s)=>{const n=await v(e,s);let r=0;for(const[e]of n)e&&e.errors&&Qe.PatchResponseUtils.containsErrors(e.errors)&&++r;return r>0&&t&&t.ciTelemetry.publishClickUserInvitationEvent(n.map(e=>e[1][1]),r),n},e=>{const t=e.length;return i.createElement(p.TemplateString,{template:he.Notification_AddUsers_Action2},t,t<2?he.Text_User_Singular:he.Text_User_Plural)}),y=(0,Se.useTrackedAsyncCallback)(t,f,fe.PerformanceScenarioConstants.AddUsersFeatureName,(e,t)=>(e.measurements=Object.assign(Object.assign({},e.measurements),{Projects:d?d.length:0,Users:t?t.length:0}),e));if(!t||!r)return null;const S=s.getStyles(),E=It.UserValidationUtils.getAddUserDisplayWarning(n,It.UserValidationUtils.getWarning(t,n,r.selectedIdentities)),x=(0,Ne.hasValidIdentities)(n,r.selectedIdentities),A=i.createElement(i.Fragment,null,he.UserInviteDialog_Users,!n.isGitHubUser&&n.isGitHubSearchEnabled&&i.createElement(I.Icon,{tooltipProps:{text:he.GitHubSearchWarning_TooltipContent},iconName:"Warning",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement(yt.CommonPanel,{title:he.UserInviteDialog_DialogTitle,className:Ae.L2ClassNames.panels.addUsers.root,onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!0),e.onDismiss()},actionButtonProps:{disabled:!x||!l,text:he.UserInviteDialog_AddButton,onClick:()=>{if(!a||!l)return;const t=s.buildUserEntitlementsFromInput(a,l,d,u);t&&t.length>0&&(e.onDismiss(),y(t,!C))}},contentClassName:S.content,defaultActiveElement:`${Ae.L2ClassNames.formItems.userIdentityPicker} input`},i.createElement(h.FormItem,{label:A,className:Ae.L2ClassNames.formItems.userIdentityPicker},i.createElement(St.UserIdentityPicker,{pickerProvider:r.pickerProvider,onChange:r.onChange,selectedIdentities:r.selectedIdentities,placeholderText:he.UserInviteDialog_Users})),i.createElement(Ct.AccessLevelDropdown,{disabled:!o.availableAccessLevels,label:he.UserInviteDialog_AccessLevel,onChange:c,selectedAccessLevel:l}),i.createElement("div",{className:s.getStyles().projectsLabelContainer},i.createElement("label",{className:"bolt-formitem-label body-m"},he.TitleText_EditUserBulkDialog_AddToProjects),i.createElement(Te.AddToProjectsForm,{selected:d,selectedGroupType:u,onChange:g,onSelectedGroupTypeChange:m})),i.createElement("div",null,i.createElement(N.Checkbox,{className:Ae.L2ClassNames.Dialogs.AddUser.SendInviteCheckbox,ariaLabel:he.UserInviteDialog_SendEmailAriaLabel,label:he.UserInviteDialog_SendEmails,checked:C,onChange:()=>{b(e=>!e)}})),E&&i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,E)))}}(),t.ComponentsHubCalloutsBulkStatus={},t.ComponentsHubCalloutsBulkStatusMember={},function(e){Dt=t.ComponentsHubCalloutsAddMemberAddUsersToProject={};class s{static getDefaultSelectedTeams(e,t){const s=e&&e.defaultTeam&&e.defaultTeam.id,n=s&&t?t.find(e=>e.id===s):void 0;return n&&[n]}static async getProjectAndTeamsPromise(e,t){const s=e.getRestClient(mt.CoreClientName);try{return await Promise.all([s.getProject(t),s.getTeams(t,void 0,500)])}catch(t){return e.telemetry.trackException(t,"AddUsersToProject.getProjectAndTeams"),[void 0,void 0]}}static createActionDisplayName(e,t,s){const n=s>1?i.createElement(p.TemplateString,{template:he.TextTeamsPlural1},s.toLocaleString()):he.TextTeamSingular;let r="";return t>0&&(r=t>1?i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_AccessLevelAssignedPlural1},t.toLocaleString()):he.ProjectInviteDialog_AccessLevelAssignedSingular),e+t>1?i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_UsersAddedPlural3},t+e,n,r):i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_UserAddSingular2},n,r)}static getStyles(){return{content:(0,b.getSpacingContainerClassName)("y",16),addToProjectsLabel:(0,y.css)(R.FontClassNames.fontSizeL,(0,b.getSpacingClassName)("padding","top",12)),defaultLicenseLink:(0,b.getSpacingClassName)("margin","left",4)}}static getUnlicensedInfo(e){const t=e.filter(e=>!e.localId),n=i.useContext(xe.UsersSummaryContext),{defaultAccessLevel:r}=n;let o=he.ProjectInviteDialog_UserNotInAccountWarning1_Fallback;if(r&&(o=r.licenseDisplayName),t.length>0)return s.buildInfoMessageForNotLicensedUsers(t.map(e=>e.displayName),o)}static buildInput(e,t,s){const n=s&&s.map(e=>({id:e})),r=[],o=new Ge.BulkEditUserEntitlementJsonDocumentBuilder,a={projectRef:{id:t},teamRefs:n,assignmentSource:void 0,group:void 0,isProjectPermissionInherited:void 0,projectPermissionInherited:void 0};let l=0,c=0;e.forEach(e=>{e.localId?++l:++c;const s=e instanceof Ie.AddIdentity?{displayName:e.entityId,principalName:e.entityId,subjectKind:fe.SubjectKind.User}:{displayName:e.displayName,origin:e.originDirectory,originId:e.originId?e.originId:void 0,principalName:e.signInAddress,subjectKind:fe.SubjectKind.User},u={id:e.localId?e.localId:void 0,projectEntitlements:[a],user:s},m=new We.User(u),d=e.localId;n&&d?n.forEach(s=>{o.addToTeam({displayName:e.displayName,id:d,accessLevelDisplayName:""},t,s.id),r.push({operationDisplayName:i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_AddToTeam1},s.name),user:m})}):(o.addUserEntitlement(u),r.push({operationDisplayName:he.ProjectInviteDialog_AssignLicenseAndTeams,user:new We.User(u)}))});const[u,m]=o.build();if(u.length>0)return{jsonPatchDocument:u,metadata:m,existingUsersCount:l,newUsersCount:c,teamsCount:n?n.length:0}}static buildInfoMessageForNotLicensedUsers(e,t){return i.createElement(i.Fragment,null,i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_UserNotInAccountWarning1},e.filter(Boolean).join(he.ListItemSeparator),t),i.createElement(f.Link,{href:fe.UserManagementLinks.DefaultAccessLevelLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore))}}__decorate([o.memoize],s,"getProjectAndTeamsPromise",null),__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsAddMemberAddUsersToProject.AddUsersToProjectPanel=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=(0,Ne.useAddUserIdentityPicker)(t,n),[o]=(0,L.useResolvedPromise)(e.teamId?void 0:s.getProjectAndTeamsPromise(t,e.projectId)),a=i.useCallback(async s=>{const r=await(0,Ge.processBulkUserActions)(t,n,s.jsonPatchDocument,s.metadata,!1);return e.onUsersAdded(),r},[t,n,e.onUsersAdded]),{projectOrTeamDisplayName:l}=e,c=(0,Pt.useBulkUserApiNotificationCallback)(a,e=>s.createActionDisplayName(e.existingUsersCount,e.newUsersCount,e.teamsCount));let u,m;o&&([u,m]=o);const d=i.useMemo(()=>{const e=s.getDefaultSelectedTeams(u,m);return e&&e.map(e=>e.id)},[u,m]),[p=d,g]=i.useState(void 0);if(!t||!r)return null;const{selectedIdentities:C}=r,b=(0,Ne.hasValidIdentities)(n,C),v=s.getStyles(),f=It.UserValidationUtils.getAddUserDisplayWarning(n,It.UserValidationUtils.getWarning(t,n,C)),y=s.getUnlicensedInfo(C);return i.createElement(yt.CommonPanel,{actionButtonProps:{disabled:!b,text:he.UserInviteDialog_AddButton,onClick:()=>{const t=s.buildInput(C,e.projectId,e.teamId?[e.teamId]:p);t&&(c(t),e.onDismiss())}},title:(0,D.format)(he.ProjectInviteDialog_AddUsersTitleTemplate1,l),description:(0,D.format)(he.ProjectInviteDialog_AddUsersSubTitle1,l),onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!0),e.onDismiss()},contentClassName:v.content},i.createElement(h.FormItem,{label:he.UserInviteDialog_Users},i.createElement(St.UserIdentityPicker,{pickerProvider:r.pickerProvider,onChange:r.onChange,selectedIdentities:r.selectedIdentities,placeholderText:he.UserInviteDialog_IdentityPickerPlaceholder})),m&&!e.teamId&&i.createElement(h.FormItem,{label:he.ProjectInviteDialog_AddToTeams},i.createElement(Te.TeamsDropdown,{teams:m,onChange:g,selected:p})),f&&i.createElement(X.MessageCard,{severity:"Info"},f),y&&i.createElement(X.MessageCard,{severity:"Info"},y))}}(),function(e){Ft=t[e]={},t[e].GroupCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,group:t.group}}}s.initialState={operation:void 0,group:void 0},t[e].GroupCommandContextProvider=function(n){const[r,o]=i.useReducer(s.reduce,s.initialState),[a,l]=(0,gt.useSaveFocusElement)(),c=i.useCallback((e,t)=>{o({operation:e,group:t})},[o]),u=i.useCallback(e=>{o({operation:e,group:void 0})},[o]),m={operation:r.operation,group:r.group,onOpenModifyGroupCallout:c,onOpenIndependentCallout:u,saveFocusElement:a,onClose:()=>{o({operation:void 0,group:void 0}),l()}};return i.createElement(t[e].GroupCommandContext.Provider,{value:m},n.children)},t[e].groupCommandItems={add:{id:"add",text:he.CommandButtonText_AddSingleGroupRule,className:Ae.L2ClassNames.commandItems.addGroupRule},reEvaluateAllRules:{id:"reEvaluateAllRules",text:he.GroupCommandBar_ReevaluateRules},fixAssignmentErrors:{id:"fixAssignmentErrors",text:he.GroupResolve_FixAssignmentIssues},manageGroup:{id:"manageGroup",text:he.ContextualMenuButtonText_ManageGroupRule,className:Ae.L2ClassNames.commandItems.manageMember},manageMembers:{id:"manageMembers",text:he.ContextualMenuOptionManageMembers},remove:{id:"remove",className:Ae.L2ClassNames.commandItems.removeFromOrganization,text:he.ContextualMenuButtonText_Remove}}}("ContextCommandContextGroup"),function(e){function s(e,t){switch(t){case 0:const s=e[0];return s?i.createElement(J.Pill,{size:0,excludeTabStop:!0},i.createElement(p.TemplateString,{template:he.Notification_ChangeMember_Description_ChangeAccessLevel1},s.licenseDisplayName)):null}const s=e[t];if(0===s)return null;let n,r;switch(t){case 1:n=he.Notification_ChangeMember_Description_Summary_AddToProject2;break;case 2:n=he.Notification_ChangeMember_Description_Summary_RemoveFromProject2;break;case 3:n=he.Notification_ChangeMember_Description_Summary_ChangeProjectPermissions2;break;default:throw new Error("Unknown operationType: "+t)}if(s<2)switch(t){case 1:case 2:case 3:r=he.Text_Project_Singular;break;default:throw new Error("Unknown operationType: "+t)}else switch(t){case 1:case 2:case 3:r=he.Text_Project_Plural;break;default:throw new Error("Unknown operationType: "+t)}return i.createElement(J.Pill,{size:0,excludeTabStop:!0},i.createElement(p.TemplateString,{template:n},s,r))}function n(e){const t=(0,xe.useProjectRefsMapping)();return t&&t[e.projectId]?i.createElement(p.TemplateString,{template:e.template1},t[e.projectId].name):null}function r(e){const t=(0,xe.useProjectRefsMapping)(),s=(0,xe.useGroupOptionNames)();return t&&t[e.projectId]&&s[e.groupType]?i.createElement(p.TemplateString,{template:e.template2},t[e.projectId].name,s[e.groupType]):null}function o(e){const{results:t}=e;return i.createElement(i.Fragment,null,e.description,t.map(([e,t],s)=>{if(void 0===e||e.isSuccess)return null;const o=function(e){const[t]=e;switch(t){case 2:const[,,s]=e;return i.createElement("div",null,i.createElement(p.TemplateString,{template:he.Notification_ChangeMember_Description_ChangeAccessLevel1},s.licenseDisplayName));case 0:const[,,o,a,l]=e;switch(o){case 0:return i.createElement("div",null,i.createElement(r,{template2:he.Notification_ChangeMember_Description_AddToProject2,projectId:a,groupType:l}));case 2:return i.createElement("div",null,i.createElement(r,{template2:he.Notification_ChangeMember_Description_ChangeProjectPermissions2,projectId:a,groupType:l}));case 1:return i.createElement("div",null,i.createElement(n,{template1:he.Notification_ChangeMember_Description_RemoveFromProject1,projectId:a}))}}return null}(t);return i.createElement("div",{key:s,className:(0,b.getSpacingClassName)("margin","left",8)},o,i.createElement(Et.OperationErrors,{errors:e.errors,className:(0,b.getSpacingClassName)("margin","left",8)}))}))}_t=t[e]={},t[e].EditMemberNotificationDescription=function(e){const t=i.useMemo(()=>(function(e){const t=[void 0,0,0,0];for(const s of e){const[e,,n]=s;switch(e){case 2:t[0]=n;break;case 0:0===n?++t[1]:1===n?++t[2]:2===n&&++t[3]}}return t})(e.metadata),[e.metadata]);return i.createElement(Q.PillGroup,null,s(t,0),s(t,1),s(t,2),s(t,3))},t[e].EditMemberNotificationResultDescription=o;t[e].EditMemberStatusResultNotification=class extends Ye.PatchResponseStatusNotification{constructor(e,t){super(e),this.description=i.createElement(o,{results:e,description:t})}}}("ComponentsHubCalloutsEditMemberEditMemberNotifications"),function(e){Gt=t.ComponentsHubCalloutsEditMemberAccessLevelForm={},t.ComponentsHubCalloutsEditMemberAccessLevelForm.EditMemberAccessLevelForm=function(e){const{memberAccessLevelDisplayName:t}=e;if(t)return i.createElement(h.FormItem,{label:he.HubColAccessLevel},t);const{validAccessLevels:s,selectedAccessLevel:n=e.member.accessLevel,groupAssignments:r}=e;return i.createElement(vt.AccessLevelDropdownWithGroupAssignments,{memberPromiseFulfilled:e.memberPromiseFulfilled,label:he.UserInviteDialog_AccessLevel,availableAccessLevels:s,selectedAccessLevel:n,onChange:e.onChange,groupAssignments:r})}}(),function(e){kt=t.ComponentsHubCalloutsEditMemberMemberPersona={},t.ComponentsHubCalloutsEditMemberMemberPersona.EditMemberPersona=function(e){const t=(0,ye.useUserHubContext)(),{member:s}=e;return i.createElement(xt.MemberPersona,{pageContext:t,size:"large",member:s,secondaryText:e.isGroup?s.isAad?he.GroupAssignmentIcon_CalloutGroupTypeAad:he.GroupAssignmentIcon_CalloutGroupTypeVsts:s.principalName})}}(),function(e){wt=t[e]={};class s extends i.Component{static getValidAccessLevelMessageCardContent(e,t){if(t&&e&&e.length<2)return he.EditUserDialog_AccessLevelUnchangable}static getStyles(){return{accessLevelDropdown:(0,y.css)(B.CssClassNames.flex.auto),formUpper:(0,y.css)(R.FlexClassNames.flexRow,(0,b.getSpacingContainerClassName)("x",20)),formExtraInfo:B.CssClassNames.flex.auto,panelContent:(0,b.getSpacingContainerClassName)("y",20)}}static getValidAccessLevelOptions(e,t){const{accessLevel:s}=e;let n=[];return(t||[]).forEach(e=>{Pe.AccessLevels.equals(e,s)?n=n.concat(s):2===s.licensingSource&&2===e.licensingSource||(n=n.concat(e))}),n.filter(e=>Pe.AccessLevels.equals(e,s)).length<1&&(n=[s].concat(n)),n}static getMemberAccessLevelDisplayName(e,t){if(e.accessLevel&&t.length<2){const t=e.accessLevelLicenseDisplayName?"("+e.accessLevelLicenseDisplayName+")":"";return e.accessLevelDisplayName+" "+t}}}__decorate([o.memoize],s,"getStyles",null),t[e].EditMemberAccessLevelPanel=function(e){const{isAccessLevelOnly:t,member:n,extraInfo:r,memberPromiseFulfilled:o,selectedAccessLevel:a,groupAssignments:l}=e,c=i.useContext(xe.UsersSummaryContext),u=i.useMemo(()=>s.getValidAccessLevelOptions(n,c.availableAccessLevels),[c.availableAccessLevels,n]),m=i.useMemo(()=>s.getMemberAccessLevelDisplayName(n,u),[n,u]),d=i.useMemo(()=>s.getValidAccessLevelMessageCardContent(u,!!t),[u,t]),p=s.getStyles();return i.createElement(yt.CommonPanel,{className:(0,y.css)(e.className,Ae.L2ClassNames.panels.changeAccessLevel.root),title:e.title,onDismiss:e.onDismiss,size:t?1:2,actionButtonProps:e.actionButtonProps,contentClassName:p.panelContent,defaultActiveElement:".access-level-dropdown input"},i.createElement(kt.EditMemberPersona,{member:n,isGroup:e.isGroup}),i.createElement("div",{className:p.formUpper},i.createElement("div",{className:p.accessLevelDropdown},i.createElement(Gt.EditMemberAccessLevelForm,{memberPromiseFulfilled:!!o,member:n,selectedAccessLevel:a,groupAssignments:l,validAccessLevels:u,memberAccessLevelDisplayName:m,onChange:e.onSelectedAccessLevelChanged})),r&&i.createElement("div",{className:p.formExtraInfo},r)),e.children,d&&i.createElement("div",null,i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,d))))}}("ComponentsHubCalloutsEditMemberEditMemberPanelAccessLevel"),function(e){jt=t.ComponentsHubCalloutsEditMemberEditMemberPanelTabGroup={};class s{static getStyles(){return{content:(0,y.css)((0,b.getSpacingContainerClassName)("y",20)),noTabBarTitle:(0,y.css)(R.TextClassNames.ellipsis,R.FontClassNames.fontSizeMm)}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsEditMemberEditMemberPanelTabGroup.EditMemberPanelTabGroup=function(e){const{tabs:t,renderAdditionalContent:n,defaultTabId:r}=e;if(0===t.length)return null;const o=s.getStyles();if(1===t.length&&!n){const e=t[0];return i.createElement(i.Fragment,null,i.createElement("span",{className:o.noTabBarTitle,id:e.id||"singleTab"},e.name),e.content)}const a=i.useMemo(()=>{const t={};return e.tabs.forEach(e=>{t[e.id]=e}),t},e.tabs),[l,c]=i.useState(r||t[0].id);return i.createElement(i.Fragment,null,i.createElement(oe.TabBar,{onSelectedTabChanged:e=>{c(e)},selectedTabId:l,renderAdditionalContent:n},...t.map(e=>i.createElement(oe.Tab,{name:e.name,id:e.id,key:e.id}))),i.createElement("div",{className:o.content},a[l]?a[l].content:void 0))}}(),function(e){function s(e){const{member:t,memberPromiseFulfilled:s,initialTab:n}=e;return s?e.isGroupRuleInFlight?i.createElement(c.Spinner,{className:(0,y.css)(R.FlexClassNames.flexRow,(0,b.getSpacingContainerClassName)("x",12)),size:"large",label:he.LabelText_TestLicensingRuleApplicationWait}):i.createElement(jt.EditMemberPanelTabGroup,{tabs:[{id:"projects",name:he.EditUserDialog_ProjectsTabTitle,content:i.createElement(He.EditMemberProjectsForm,{memberProjectEntitlements:t.projectEntitlements,groupAssignments:e.groupAssignments,onChange:e.onProjectSelectionChange,selectionDelta:e.projectSelectionDelta})},...e.additionalTabs||[]],defaultTabId:n}):i.createElement(c.Spinner,{size:"large"})}Bt=t.ComponentsHubCalloutsEditMemberEditMemberPanel={},t.ComponentsHubCalloutsEditMemberEditMemberPanel.EditMemberPanel=function(e){return i.createElement(wt.EditMemberAccessLevelPanel,{actionButtonProps:e.actionButtonProps,className:e.className,member:e.member,onDismiss:e.onDismiss,isGroup:e.isGroup,memberPromiseFulfilled:e.memberPromiseFulfilled,onSelectedAccessLevelChanged:e.onSelectedAccessLevelChanged,selectedAccessLevel:e.selectedAccessLevel,groupAssignments:e.groupAssignments,title:e.title,extraInfo:e.extraInfo},i.createElement(s,Object.assign({},e)),e.children)}}(),function(e){function s(e,t,s){const[,,n]=(0,Rt.useLicensingRuleApplicationStatus)(t.id),r=i.useCallback(async()=>{return await s(),n().pollUntilCompletePromise},[s,n]),[o,a]=(0,ae.useAsyncAction)(r);return o?{previewResult:o}:e?{preview:a}:{}}Ht=t[e]={},t[e].PreviewDowngradeLicenseMessageCard=function(e){const t=i.useContext(xe.UsersSummaryContext),{group:s,applicationStatus:n}=e,r=[];return 4===n.status&&e.hasDowngrade&&(n.licenses.forEach(e=>{const o=Pe.AccessLevels.fromAccountUserLicense(e.accountUserLicense);if(o&&Pe.AccessLevels.isPossibleAccessLevelDowngrade(s.accessLevel,o)){const s=o&&Pe.AccessLevels.mapToAvailableAccessLevel(t.availableAccessLevels,o),a=s?s.licenseDisplayName:e.license.toString();n.isTruncated?r.push(i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Plus2},e.assigned,a)):r.push(e.assigned<=1?i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Singular1},a):i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Plural2},e.assigned,a))}}),r.length<1&&n.isTruncated?r.push(he.GroupEdit_GroupTooLarge):r.length<1&&r.push(he.GroupEdit_NoPreviewChanges)),0===r.length?null:i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,r.map((e,t)=>i.createElement("div",{key:t},e))))},t[e].TestApplyGroupRuleInflightStatusMessageCard=function(){return i.createElement(At.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,he.LabelText_TestLicensingRuleApplicationWait))},t[e].useEditOrRemoveGroup=s,t[e].useEditGroup=function(e,t,n){const r=(0,ye.useUserHubContext)(),o=Pe.AccessLevels.isPossibleAccessLevelDowngrade(e.accessLevel,t),[a]=n.build(),l=i.useCallback(()=>r.getRestClient(Ee.MemberEntitlementManagementClientName).updateGroupEntitlement(a,e.groupEntitlement.id,1),[e,t,r,a]),c=s(o,e,l);return Object.assign(Object.assign({},c),{hasDowngrade:o})}}("ComponentsHubCalloutsEditMemberuseEditGroup"),function(e){Ot=t.ComponentsHubCalloutsEditMemberEditGroupPanel={},t.ComponentsHubCalloutsEditMemberEditGroupPanel.EditGroupPanel=function(e){let{member:t}=e;const s=(0,ye.useUserHubContext)(),n=i.useContext(tt.GroupsContext),[r,o]=i.useState(t.accessLevel),[a,l]=i.useState({}),c=(0,Oe.useEditMemberBuilder)(t,r,a),{preview:u,previewResult:m,hasDowngrade:d}=(0,Ht.useEditGroup)(t,r,c),g=i.useContext(Rt.LicensingRulesContext),C=(0,Ve.useRefreshedMember)(t.id,n&&n.refreshGroup);t=C||t;const v=!!C,{updateGroupRule:h}=(0,it.useGroupsContextApiActions)(),f=(0,qe.useNotificationAsyncCallback)(h,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeGroup_Action1},t.displayName),onGetDescription:(e,t,s)=>i.createElement(_t.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new _t.EditMemberStatusResultNotification(e,i.createElement(_t.EditMemberNotificationDescription,{metadata:n}))}),y=(0,Se.useTrackedAsyncCallback)(s,f,fe.PerformanceScenarioConstants.EditGroupFeatureName,(e,t,s,n)=>(e.measurements["operation Count"]=n.length,e)),S=m&&0===m.state;return n?i.createElement(Bt.EditMemberPanel,{onDismiss:e.onDismiss,member:t,memberPromiseFulfilled:v,className:Ae.L2ClassNames.panels.editGroupRule.root,actionButtonProps:{disabled:0===c.length||m&&0===m.state,text:u?he.ButtonText_Preview:he.ButtonText_SaveChanges,onClick:u||(()=>{e.onDismiss();const[s,n]=c.build();(async()=>{await y(t,s,n),g.startPollLicensingRule(t.id,!0)})()}),className:u?Ae.L2ClassNames.callouts.previewButton:void 0,isPrimary:!m||0!==m.state},isGroup:!0,selectedAccessLevel:r,title:he.ContextualMenuButtonText_ManageGroupRule,projectSelectionDelta:a,onSelectedAccessLevelChanged:o,onProjectSelectionChange:l,isGroupRuleInFlight:S},i.createElement("div",{className:(0,b.getSpacingClassName)("margin","bottom",8),style:{marginTop:"auto"}},m&&m.value&&i.createElement(Ht.PreviewDowngradeLicenseMessageCard,{applicationStatus:m.value,group:t,hasDowngrade:d}))):null}}(),function(e){Vt=t[e]={};class s{static getStyles(){return{root:(0,y.css)("aex-user-hub-edit-group-membership-bar"),actionContainer:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",4)),label:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),footer:R.FlexClassNames.justifyContentFlexEnd}}}__decorate([o.memoize],s,"getStyles",null),t[e].EditGroupMembershipBar=function(e){const t=s.getStyles(),n=(0,ye.useUserHubConfiguration)(),{actionButtonText:r,selectedIdentity:o}=e,a=i.createElement("div",{className:t.label},he.BulkStatusDialogColumnName_User,!n.isGitHubUser&&n.isGitHubSearchEnabled&&i.createElement(I.Icon,{tooltipProps:{text:he.GitHubSearchWarning_TooltipContent},iconName:"Info",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement(W.Surface,{background:1},i.createElement(le.CustomCard,{className:(0,y.css)(t.root,e.className)},i.createElement(le.CardContent,null,i.createElement("div",{className:C.SizeClassNames.width100},i.createElement(h.FormItem,{label:a},i.createElement(St.IdentityPickerDropdown,{pickerProvider:e.identityPickerProvider,value:o,onChange:e.onSelectedIdentityChange})))),i.createElement(le.CardFooter,{className:t.footer},i.createElement(H.Button,{onClick:e.onActionButtonClick,disabled:!o||e.isActionInProgress,primary:!0,className:e.actionButtonClassName},i.createElement("div",{className:t.actionContainer},e.isActionInProgress&&i.createElement(c.Spinner,{size:"small"}),i.createElement("span",null,r))))))}}("ComponentsHubCalloutsEditMemberEditGroupFormEditMembershipBar"),function(e){zt=t.ComponentsHubCalloutsEditMemberEditGroupFormAddMembers={};class s{static async addMember(e,t,n,r,i){let o=i.localId;if(!o){const e=s.buildUserEntitlements(n,i);if(!e)return;const[[r]]=await t.addUsersToCollection([e],!0);if(!r||!r.isSuccess)return r;o=r.userId}const a=e.getRestClient(Ee.MemberEntitlementManagementClientName);await a.addMemberToGroup(r.id,o),await t.removeDirectAssignments([o],0)}static buildUserEntitlements(e,t){const s=e?e.filter(e=>5===e.accountLicenseType):void 0,n=s&&s.length>0?s[0]:e&&e.length>0?e[0]:{accountLicenseType:5,licensingSource:1,msdnLicenseType:0},[r]=ct.UserEntitlements.buildUserEntitlementsFromIdentities([t],n);return r}}t.ComponentsHubCalloutsEditMemberEditGroupFormAddMembers.EditGroupAddMembers=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=i.useContext(xe.UsersSummaryContext),o=(0,rt.useUsersContextApiActions)(),a=(0,Ne.useAddUserIdentityPickerProvider)(t,n,!0),[l,c]=i.useState(void 0),[u,m]=(0,ae.useAsyncAction)(async()=>{const n=r.availableAccessLevels;l&&n&&(await s.addMember(t,o,n,e.group,l),r.refresh("licenses"),e.onAddComplete())}),d=l&&It.UserValidationUtils.getWarning(t,n,[l]);if(!a)return null;const p=u&&u.error&&new F.HandledError(u.error);return i.createElement("div",{className:(0,b.getSpacingContainerClassName)("y",8)},i.createElement(Vt.EditGroupMembershipBar,{className:Ae.L2ClassNames.Dialogs.ManageGroupMembers.AddMemberContainer,actionButtonText:he.UserInviteDialog_AddButton,identityPickerProvider:a,selectedIdentity:l,onSelectedIdentityChange:c,onActionButtonClick:m,isActionInProgress:!!u&&0===u.state}),d&&d.warningMessageOfAadGuestUsers&&i.createElement(X.MessageCard,{severity:"Warning"},d.warningMessageOfAadGuestUsers),p&&i.createElement(X.MessageCard,{severity:"Error"},p.isUserError?p.message:i.createElement(ze.GenericErrorMessage,null)))}}(),function(e){qt=t[e]={},t[e].EditGroupRemoveMembers=function(e){const t=(0,ye.useUserHubContext)(),s=i.useRef(new x.PeoplePickerProvider(t.pageContext,{operationScopes:["ims"],identityTypes:["user"]})),[n,r]=i.useState(void 0),[o,a]=(0,ae.useAsyncAction)(async()=>{if(n){const{group:s}=e,r=n.localId;if(!r)return;const i=t.getRestClient(Ee.MemberEntitlementManagementClientName);await i.removeMemberFromGroup(s.id,r),e.onRemoveComplete()}});if(!s)return null;const l=o&&o.error&&new F.HandledError(o.error);return i.createElement("div",{className:(0,b.getSpacingContainerClassName)("y",8)},i.createElement(Vt.EditGroupMembershipBar,{className:Ae.L2ClassNames.Dialogs.ManageGroupMembers.RemoveMemberContainer,actionButtonClassName:Ae.L2ClassNames.Dialogs.ManageGroupMembers.RemoveButton,actionButtonText:he.HubButtonTextRemove,identityPickerProvider:s.current,selectedIdentity:n,onSelectedIdentityChange:r,onActionButtonClick:a,isActionInProgress:!!o&&0===o.state}),l&&i.createElement(X.MessageCard,{severity:"Error"},l.isUserError?l.message:i.createElement(ze.GenericErrorMessage,null)))}}("ComponentsHubCalloutsEditMemberEditGroupFormRemoveMembers"),function(e){Wt=t.ComponentsHubCalloutsEditMemberGroupMembersTable={};class s{static getStyles(){return{persona:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),personaName:B.CssClassNames.flex.auto,zeroDataImage:(0,b.getSpacingClassName)("margin","all",40)}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsEditMemberGroupMembersTable.GroupMembersTable=function(e){const{group:t}=e,n=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),[[o,a],l]=(0,d.useAsyncState)([[],!1]),c=!a&&!1!==a,u=s.getStyles(),m=n.getRestClient(Ee.MemberEntitlementManagementClientName),p=i.useCallback(async()=>{const e=await m.getGroupMembers(t.id,r.groupMembersBatchSize,!1===a?void 0:a);l(([t])=>[t.concat(e.members),e.continuationToken])},[l,m,t.id,a,r.groupMembersBatchSize]),{itemProvider:g,behavior:C}=(0,we.useAutoLoadingTableProps)(o,c,c?void 0:p),b=i.useMemo(()=>[{readonly:!0,id:"name",width:-50,name:he.HubColName,renderCell:(e,t,s,r)=>i.createElement(T.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("div",{className:u.persona},i.createElement(Z.VssPersona,{size:"small",imageUrl:Me.Member.getAvatarUrl(n,r.id)}),i.createElement("span",{className:u.personaName},r.user.displayName)))},{id:"email",width:-50,name:he.HubColEmail,renderCell:(e,t,s,n)=>i.createElement(T.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.user.principalName)}],[n,u]);return 0!==o.length||a||!1===a?i.createElement(T.Table,{itemProvider:g,behaviors:[C],columns:b}):i.createElement(M.ZeroData,{className:u.zeroDataImage,imagePath:n.getImageUrl(ye.UserHubPageContextService.noResultsAssetsId),imageAltText:"",primaryText:he.NoResults_NoDirectMembersFound})}}(),function(e){Kt=t[e]={},t[e].EditGroupManageMembersPanel=function(e){const{group:t}=e,[s,n]=i.useState("addMember"),[r,o]=i.useState(0);return i.createElement(V.Panel,{size:2,onDismiss:e.onDismiss,titleProps:{text:he.EditGroupMembers_DialogTitle},contentClassName:Ae.L2ClassNames.Dialogs.ManageGroupMembers.DialogContainer},i.createElement("div",{className:(0,y.css)(C.SizeClassNames.width100)},i.createElement(kt.EditMemberPersona,{isGroup:!0,member:t}),t.isAad?i.createElement(X.MessageCard,{className:(0,b.getSpacingClassName)("margin","top",32),severity:"Warning"},he.EditGroupMembersDialog_CannotEditAadGroup):i.createElement("div",{className:(0,y.css)(C.SizeClassNames.width100,(0,b.getSpacingContainerClassName)("y",8))},i.createElement(oe.TabBar,{selectedTabId:s,onSelectedTabChanged:n},i.createElement(oe.Tab,{name:he.EditGroupMembers_IdentityPickerAddMembersLabel,id:"addMember"}),i.createElement(oe.Tab,{name:he.EditGroupMembers_IdentityPickerRemoveMembersLabel,id:"removeMember"})),"addMember"===s&&i.createElement(zt.EditGroupAddMembers,{group:t,onAddComplete:()=>{o(e=>e+1)}}),"removeMember"===s&&i.createElement(qt.EditGroupRemoveMembers,{group:t,onRemoveComplete:()=>{o(e=>e+1)}}),i.createElement(Wt.GroupMembersTable,{group:t,key:t.id+"-"+r}))))}}("ComponentsHubCalloutsEditMemberEditGroupPanelManageMembers"),function(e){$t=t.ComponentsHubCalloutsReEvaluateRulesDialog={},t.ComponentsHubCalloutsReEvaluateRulesDialog.ReEvaluateRulesDialog=function(e){const t=(0,ye.useUserHubContext)(),[,,s]=(0,Rt.useAllLicensingRulesApplicaitonStatus)(),n=i.useCallback(async()=>{e.onDismiss();const n=(0,st.getMEMInternalClient)(t.pageContext);await n.reApplyAllGroupEntitlementsToUsers(0),s(!0)},[t.pageContext]);return i.createElement(ft.CommonDialog,{title:he.TitleText_ReEvaluateRulesDialog_ReEvaluateRules,onDismiss:e.onDismiss,actionButtonProps:{text:he.ButtonText_ReEvaluate,onClick:n}},he.ReEvaluateRulesDialog_Description)}}(),function(e){Jt=t[e]={};t[e].RemoveMemberDialogUtils=class{static getMemberTitle(e){const{displayName:t,principalName:s}=e;return s&&t!==s?t?t+" ("+s+")":s:t}};class s extends i.Component{static getStyles(){return{title:R.FontClassNames.fontSizeL,content:(0,b.getSpacingContainerClassName)("y",20)}}render(){const e=s.getStyles(),{memberTitleForPrompt:t,pageContext:n}=this.props;return i.createElement("div",{className:e.content},i.createElement("div",{className:e.title},i.createElement(p.TemplateString,{template:he.UserRemoveDialog_RemoveUserPrompt2},t,n.orgName)),this.props.children)}}__decorate([o.memoize],s,"getStyles",null),t[e].RemoveMemberDialogContent=s}("ComponentsHubCalloutsRemoveMemberRemoveMemberDialog"),function(e){Qt=t.ComponentsHubCalloutsRemoveMemberRemoveGroupDialog={},t.ComponentsHubCalloutsRemoveMemberRemoveGroupDialog.RemoveGroupDialog=function(e){const t=(0,ye.useUserHubContext)(),s=i.useContext(xe.UsersSummaryContext),n=i.useContext(tt.GroupsContext),r=i.useContext(qe.UserHubNotificationsContext),o=i.useContext(rt.UsersContext),a=i.useContext(Rt.LicensingRulesContext),[l,c]=i.useState(!1),{member:u}=e,m=i.useCallback(()=>t.getRestClient(Ee.MemberEntitlementManagementClientName).deleteGroupEntitlement(u.groupEntitlement.id,1),[t,u]),d=(0,Ht.useEditOrRemoveGroup)(!0,u,m),{preview:g,previewResult:C}=d,b=C&&0===C.state,v=(0,it.useGroupsContextApiActions)(),h=(0,Se.useTrackedAsyncCallback)(t,async()=>{if(e.onDismiss(),!n)return;const t=r.createNotification(),c=i.createElement(p.TemplateString,{template:he.Notification_RemoveGroup_Action1},u.displayName);r.setNotification(t,{title:c,statusType:"Running"});const m=await v.deleteGroupRule(u,l);if(m.isSuccess){const e=a.startPollLicensingRule(u.id,!0,!0);await e.pollUntilCompletePromise,r.setNotification(t,{title:c,statusType:"Success"}),o.refreshMembersList(),s.refresh("licenses")}else r.setNotification(t,{title:c,statusType:"Failed",description:i.createElement(Et.OperationErrors,{errors:m.errors})})},fe.PerformanceScenarioConstants.RemoveGroupFeatureName);return n?i.createElement(ft.CommonDialog,{onDismiss:e.onDismiss,className:Ae.L2ClassNames.dialogs.removeGroup.root,title:(0,D.format)(he.DialogTitle_RemoveAadGroupRule1,u.displayName),actionButtonProps:{text:g?he.ButtonText_Preview:he.HubButtonTextRemove,onClick:g||h,disabled:b,className:g?Ae.L2ClassNames.callouts.previewButton:void 0}},i.createElement(Jt.RemoveMemberDialogContent,{pageContext:t,memberTitleForPrompt:Jt.RemoveMemberDialogUtils.getMemberTitle(u)},i.createElement("div",null,i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,i.createElement(p.TemplateString,{template:he.DialogMessage_RemoveAadGroupRule1},u.displayName)))),i.createElement("div",null,i.createElement(N.Checkbox,{checked:l,label:(0,D.format)(he.DialogCheckbox_RemoveGroupMembership1,u.displayName),onChange:(e,t)=>{c(t)}})),C&&0===C.state&&i.createElement(Ht.TestApplyGroupRuleInflightStatusMessageCard,null),C&&C.value&&i.createElement(Ht.PreviewDowngradeLicenseMessageCard,{applicationStatus:C.value,group:u,hasDowngrade:!0}))):null}}(),function(e){Yt=t[e]={},t[e].LicenseBuyLink=function(e){const t=(0,ye.useUserHubContext)();return i.createElement(f.Link,{href:t.assembleLicenseLink(e.marketplaceId),target:"_blank",rel:"noopener noreferrer"},he.UserBuyLink)},t[e].LicenseMissingCountMessage=function(e){const t=e.numLicensesNeeded-e.extensionSummary.available;return i.createElement(p.TemplateString,{template:e.isTruncated?he.Text_LicensesMissingCountPlus1:he.Text_LicensesMissingCount1},t<0?0:t.toLocaleString(),";")},t[e].RefreshLicensesButton=function(){const e=function(){const e=i.useContext(xe.UsersSummaryContext);return i.useMemo(()=>({iconProps:{iconName:"Refresh"},onClick:()=>{e.refresh("licenses")},text:he.ButtonText_Refresh,tooltipProps:{text:he.RefreshIcon_ExtensionRefreshDescription}}),[e.refresh])}();return i.createElement(H.Button,Object.assign({},e))}}("ComponentsHubFormsExtensionForms"),function(e){Zt=t.ComponentsHubCalloutsResolveGroupsDialog={};class s{static hasApplicationDiff(e){return e.licenses&&e.licenses.length>0}static getStyles(){return{content:(0,b.getSpacingContainerClassName)("y",16)}}static applicationStatusHasErrorsInRules(e){return 0===e.option&&e.licenses&&e.licenses.some(e=>e.failed>0||e.insufficientResources>0)}static convertFailedApplicationStatusToPerformingApplicationStatus(e){if(4!==e.status)return e;return{licenses:e.licenses.map(e=>({accountUserLicense:e.accountUserLicense,assigned:e.insufficientResources+e.failed,failed:0,insufficientResources:0,license:e.license})),option:e.option,status:e.status}}static extractLicenseFromLicenseSummaryListUsingLicenseSourceAndType(e,t,s,n){return e.find(e=>!(e.source!==t||null!=s&&e.accountLicenseType!==s||null!=n&&e.msdnLicenseType!==n))}static getResolveSummaryItems(e,t){const n=[],r=[],{isTruncated:i}=e;if(t&&e.licenses)for(const o of e.licenses){const e=Pe.AccessLevels.fromAccountUserLicense(o.accountUserLicense);if(!e)break;const{licensingSource:a,accountLicenseType:l=0,msdnLicenseType:c=0}=e,u=s.extractLicenseFromLicenseSummaryListUsingLicenseSourceAndType(t,a,l,c);if(u){if(o.assigned>u.available){const e=1===o.accountUserLicense.source&&2===o.accountUserLicense.license?fe.LinkConstants.PaidBasicLicenseId:o.accountUserLicense.source+"-"+o.accountUserLicense.license;n.push({isValid:!1,name:u.licenseName,needed:o.assigned,summary:u,summaryLinkId:e,isTruncated:i})}else r.push({isValid:!0,name:u.licenseName,needed:o.assigned,summary:u,isTruncated:i})}}return n.concat(r)}static getResolveTableColumns(){return[{id:"status",renderCell:(e,t,s,n)=>i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement(ee.Status,Object.assign({},n.isValid?ee.Statuses.Success:ee.Statuses.Failed,{size:"12"}))),width:40},{id:"name",renderCell:(e,t,s,n)=>i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("span",null,n.name)),width:-40},{id:"missing-count",renderCell:(e,t,s,n)=>i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.needed>0&&i.createElement(Yt.LicenseMissingCountMessage,{extensionSummary:n.summary,numLicensesNeeded:n.needed,isTruncated:n.isTruncated})),width:-30},{id:"buy-more",renderCell:(e,t,s,n)=>i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.summaryLinkId&&i.createElement(Yt.LicenseBuyLink,{marketplaceId:n.summaryLinkId})),width:-30}]}}function n(e){const t=i.useContext(xe.UsersSummaryContext);let{applicationStatus:n}=e;s.applicationStatusHasErrorsInRules(n)&&(n=s.convertFailedApplicationStatusToPerformingApplicationStatus(n));const{isTruncated:r}=n,o=i.useMemo(()=>new ce.ArrayItemProvider(s.getResolveSummaryItems(n,t.licenses)),[n,t.licenses]),a=i.useMemo(()=>s.getResolveTableColumns(),[]);return e.hasApplicationDiff?i.createElement("div",null,i.createElement(Yt.RefreshLicensesButton,null),i.createElement(T.Table,{showHeader:!1,itemProvider:o,columns:a})):i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,r?he.GroupResolve_GroupTooLarge:he.GroupResolve_NothingToFix))}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsResolveGroupsDialog.ResolveGroupsDialog=function(e){const t=(0,ye.useUserHubContext)(),[r,o,a]=(0,Rt.useAllLicensingRulesApplicaitonStatus)(),l=void 0!==r&&1!==r.option,c=!!r&&(0,at.isOperationStatusCompleted)(r.status),u=i.useRef(o);i.useEffect(()=>{u.current||(o?u.current=!0:void 0===r?a():(0,at.isOperationStatusCompleted)(r.status)&&(u.current=!0,(async()=>{const e=(0,st.getMEMInternalClient)(t.pageContext);await e.reApplyAllGroupEntitlementsToUsers(1),a()})()))});const m=i.useCallback(async()=>{e.onDismiss();const s=(0,st.getMEMInternalClient)(t.pageContext);await s.reApplyAllGroupEntitlementsToUsers(),a(!0)},[t.pageContext]),d=u.current,p=s.getStyles();let g,C=!1,b=!1;return d&&r&&(l||c)?l&&!c?(g=i.createElement(At.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,he.GroupResolve_RunningApplyJob)),C=!0):(b=s.hasApplicationDiff(r),g=i.createElement(n,{applicationStatus:r,hasApplicationDiff:b})):g=i.createElement(At.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,i.createElement("div",{className:j.ColorClassNames.secondaryText},he.GroupResolve_OneMoment),i.createElement("div",{className:R.FontClassNames.fontWeightSemiBold},he.GroupResolve_CalculatingMissingResources))),i.createElement(ft.CommonDialog,{actionButtonProps:{disabled:C,text:b?he.GroupResolve_FixErrors:he.ButtonText_ResoveAllGroupRules,onClick:m,isPrimary:b},contentSize:2,onDismiss:e.onDismiss,title:he.GroupResolve_FixAssignmentIssues},i.createElement("div",{className:p.content},g))}}(),function(e){Xt=t.ComponentsHubCalloutsCalloutsGroup={},t.ComponentsHubCalloutsCalloutsGroup.GroupCallouts=function(){const e=i.useContext(Ft.GroupCommandContext);if(!e)return null;const{onClose:t,group:s,operation:n}=e;switch(n){case"add":return i.createElement(Mt.AddGroupPanel,{onDismiss:t});case"reEvaluateAllRules":return i.createElement($t.ReEvaluateRulesDialog,{onDismiss:t});case"fixAssignmentErrors":return i.createElement(Zt.ResolveGroupsDialog,{onDismiss:t})}if(!s)return null;switch(n){case"manageGroup":return i.createElement(Ot.EditGroupPanel,{onDismiss:t,member:s});case"manageMembers":return i.createElement(Kt.EditGroupManageMembersPanel,{onDismiss:t,group:s});case"remove":return i.createElement(Qt.RemoveGroupDialog,{onDismiss:t,member:s})}return null}}(),function(e){es=t[e]={},t[e].BulkUserCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,users:t.users,flowId:e.flowId+1}}}s.initialState={operation:void 0,flowId:0,users:void 0},t[e].BulkUserCommandContextProvider=function(n){const[r,o]=i.useReducer(s.reduce,s.initialState),a=i.useCallback((e,t)=>{o({operation:e,users:t})},[o]),l={operation:r.operation,flowId:r.flowId,onOpenBulkModifyUserCallout:a,users:r.users,onClose:()=>{o({operation:void 0,users:void 0})}};return i.createElement(t[e].BulkUserCommandContext.Provider,{value:l},n.children)},t[e].userBulkCommandItems={changeAccessLevel:{id:"changeAccessLevel",text:he.ContextualMenuButtonText_ChangeAccessLevel,className:Ae.L2ClassNames.commandItems.changeAccessLevel},addToProjects:{id:"addToProjects",text:he.TitleText_EditUserBulkDialog_AddToProjects},removeFromProjects:{id:"removeFromProjects",text:he.TitleText_EditUserBulkDialog_RemoveFromProjects},remove:{id:"remove",text:he.EditUserBulkDialog_RemoveFromAccount},removeDirectAssignment:{id:"removeDirectAssignment",text:he.ContextualMenuOptionRemoveDirectAssignment}}}("ContextCommandContextUserBulk"),function(e){ts=t.ComponentsHubCalloutsEditUserBulkCommon={},t.ComponentsHubCalloutsEditUserBulkCommon.BulkEditUserPanelDescription=function(e){return i.createElement(p.TemplateString,{template:he.TextNumberOfUsersSelected},e.usersCount)}}(),function(e){ss=t.ComponentsHubCalloutsEditUserBulkAddToProjectsPanel={},t.ComponentsHubCalloutsEditUserBulkAddToProjectsPanel.BulkEditUserAddToProjectsPanel=function(e){const{users:t}=e,[s,n]=(0,Te.useSelectedGroupType)(),[r,o]=i.useState([]),a=r.length,l=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_AddToProjects3},t.length,a,a<2?he.Text_Project_Singular:he.Text_Project_Plural),{addToProjects:c}=(0,rt.useUsersContextApiActions)(),u=(0,Pt.useBulkUserApiNotificationCallback)(c,()=>l,Nt.BulkProjectStatusTree);return i.createElement(yt.CommonPanel,{actionButtonProps:{disabled:0===a,text:he.UserInviteDialog_AddButton,className:Ae.L2ClassNames.Dialogs.EditBulk.AddToProjectsConfirmationButton,onClick:()=>{r&&r.length>0&&(e.onDismiss(),u(t,r,s))}},title:he.TitleText_EditUserBulkDialog_AddToProjects,description:i.createElement(ts.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,b.getSpacingContainerClassName)("y",20)},i.createElement(Te.AddToProjectsForm,{selectedGroupType:s,selected:r,onSelectedGroupTypeChange:n,onChange:o}))}}(),function(e){ns=t[e]={},t[e].BulkEditUserChangeAccessLevelPanel=function(e){const{users:t}=e,[s,n]=i.useState(t[0].accessLevel),r=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_ChangeAccessLevel2},s.licenseDisplayName,t.length),{bulkChangeAccessLevel:o}=(0,rt.useUsersContextApiActions)(),a=(0,Pt.useBulkUserApiNotificationCallback)(o,()=>r);return i.createElement(yt.CommonPanel,{className:Ae.L2ClassNames.panels.bulkChangeAccessLevel.root,actionButtonProps:{text:he.ButtonText_SaveChanges,onClick:async()=>{e.onDismiss(),a(t,s)}},title:he.TitleText_EditUserBulkDialog_ChangeAccessLevels,description:i.createElement(ts.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,b.getSpacingContainerClassName)("y",20)},i.createElement(Ct.AccessLevelDropdown,{selectedAccessLevel:s,onChange:n,label:he.FormText_UserEditDialogBulk_ChangeAccessLevel}))}}("ComponentsHubCalloutsEditUserBulkChangeAccessLevelPanel"),function(e){function s(e){return i.createElement(Jt.RemoveMemberDialogContent,{pageContext:e.pageContext,memberTitleForPrompt:e.memberTitleForWarning},i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,e.isAad?i.createElement(i.Fragment,null,i.createElement(p.TemplateString,{template:he.UserRemoveDialog_AADWarning1},e.memberTitleForWarning)," ",i.createElement(f.Link,{href:fe.UserManagementLinks.AadGroupHelpLink,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserRemoveDialog_AADWarningLink_AriaLabel},he.UserDialog_LearnMore)):he.UserRemoveDialog_GenericWarning)))}rs=t[e]={},t[e].RemoveUserDialogContent=s,t[e].RemoveUserDialog=function(e){const t=(0,ye.useUserHubContext)(),{user:n}=e,r=Jt.RemoveMemberDialogUtils.getMemberTitle(n),{removeUsers:o}=(0,rt.useUsersContextApiActions)(),a=i.createElement(p.TemplateString,{template:he.Notification_RemoveUser_Action1},n.displayName),l=(0,Se.useTrackedAsyncCallback)(t,(0,qe.useNotificationAsyncCallback)(async()=>(e.onDismiss(),o([n])),{onGetDisplayName:()=>a,onGetResultNotification:e=>new Pt.SingleMemberStatusResultNotification(e)}),fe.PerformanceScenarioConstants.RemoveUserFeatureName);return i.createElement(ft.CommonDialog,{onDismiss:e.onDismiss,title:he.UserRemoveDialog_DialogTitleSingular,className:Ae.L2ClassNames.dialogs.removeUser.root,actionButtonProps:{text:he.HubButtonTextRemove,onClick:l}},i.createElement(s,{pageContext:t,isAad:e.user.isAad,memberTitleForPrompt:r,memberTitleForWarning:r}))}}("ComponentsHubCalloutsRemoveMemberRemoveUserDialog"),function(e){is=t[e]={},t[e].BulkEditUserRemoveFromAccountDialog=function(e){const t=(0,ye.useUserHubContext)(),{users:s}=e,n=i.useMemo(()=>s.some(e=>e.isAad),[s]),r=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_RemoveUsers1},s.length),{removeUsers:o}=(0,rt.useUsersContextApiActions)(),a=(0,Pt.useBulkUserApiNotificationCallback)(o,()=>r);return i.createElement(ft.CommonDialog,{actionButtonProps:{className:Ae.L2ClassNames.Dialogs.EditBulk.RemoveUserConfirmationButton,text:he.HubButtonTextRemove,onClick:()=>{e.onDismiss(),a(s)}},title:he.TitleText_EditUserBulkDialog_RemoveFromOrganization,description:i.createElement(ts.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss},i.createElement(rs.RemoveUserDialogContent,{pageContext:t,isAad:n,memberTitleForPrompt:he.UserRemoveDialog_TheseUsers,memberTitleForWarning:he.UserRemoveDialog_SomeUsers}))}}("ComponentsHubCalloutsEditUserBulkRemoveFromAccountDialog"),function(e){os=t[e]={},t[e].BulkEditUserRemoveFromProjectsPanel=function(e){const{users:t}=e,[s,n]=i.useState([]),r=s.length,o=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_RemoveFromProjects3},t.length,r,r<2?he.Text_Project_Singular:he.Text_Project_Plural),{removeFromProjects:a}=(0,rt.useUsersContextApiActions)(),l=(0,Pt.useBulkUserApiNotificationCallback)(a,()=>o,Nt.BulkProjectStatusTree);return i.createElement(yt.CommonPanel,{actionButtonProps:{disabled:0===r,text:he.HubButtonTextRemove,className:Ae.L2ClassNames.Dialogs.EditBulk.RemoveFromProjectsConfirmationButton,onClick:()=>{e.onDismiss(),s&&s.length>0&&l(t,s)}},title:he.TitleText_EditUserBulkDialog_RemoveFromProjects,description:i.createElement(ts.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,b.getSpacingContainerClassName)("y",20)},i.createElement(Te.ProjectsDropdown,{selected:s,onChange:n}))}}("ComponentsHubCalloutsEditUserBulkRemoveFromProjectsPanel"),function(e){function s(e){const[t,s]=i.useMemo(()=>{const t=[],s=[];for(const n of e.users){const r=e.previewResult[n.userEntitlement.id];if(!r)continue;const i=r&&!Pe.AccessLevels.equals(n.accessLevel,r.accessLevel);i?t.push([n,r,i]):s.push(n)}return[t,s]},[e.users,e.previewResult]);return i.createElement(i.Fragment,null,t.length>0&&i.createElement(X.MessageCard,{severity:"Warning"},t.map(([e,t,s],n)=>i.createElement("div",{key:n},s&&i.createElement("div",null,i.createElement(p.TemplateString,{template:he.WarningMessageText_AccessLevelChange2},e.displayName,t.accessLevel.licenseDisplayName))))),s.length>0&&i.createElement(X.MessageCard,{severity:"Info"},s.map((e,t)=>i.createElement("div",{key:t},i.createElement(p.TemplateString,{template:he.RemoveDirectAssignmentDialog_NoChanges1},e.displayName)))))}as=t[e]={},t[e].RemoveDirectAssignmentsDialog=function(e){const{users:t}=e,n=i.useContext(xe.UsersSummaryContext),r=(0,rt.useUsersContextApiActions)(),[o,a]=(0,d.useAsyncState)(void 0);i.useEffect(()=>{(async()=>{const e=await r.removeDirectAssignments(t.map(e=>e.id),1),s={};e&&e.forEach(e=>{s[e.id]=e}),a(s)})()},[]);const l=i.createElement(p.TemplateString,{template:he.Notification_RemoveDirectAssignments_Action2},t.length,t.length<2?he.Text_User_Singular:he.Text_User_Plural),c=(0,qe.useNotificationAsyncCallback)(async()=>{e.onDismiss(),await r.removeDirectAssignments(t.map(e=>e.userEntitlement.id),0),n.refresh("licenses")},{onGetDisplayName:()=>l});return i.createElement(ft.CommonDialog,{onDismiss:e.onDismiss,actionButtonProps:{text:he.HubButtonTextRemove,onClick:c},className:Ae.L2ClassNames.dialogs.removeDirectAssignment.root,title:he.ContextualMenuOptionRemoveDirectAssignment},i.createElement("div",null,i.createElement("div",{className:(0,b.getSpacingClassName)("margin","bottom",16)},o?i.createElement(s,{users:t,previewResult:o}):i.createElement(X.MessageCard,{iconProps:{render:e=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{className:(0,y.css)(e,(0,b.getSpacingClassName)("margin","all",8)),size:"16"}))}},he.SpinnerLabelText_RemoveDirectAssignmentsPreview)),i.createElement("div",{className:R.FontClassNames.fontSizeL},he.ReEvaluateRulesDialog_RunningJobExplaination)))}}("ComponentsHubCalloutsRemoveMemberRemoveDirectAssignmentsDialog"),function(e){ls=t.ComponentsHubCalloutsCalloutsUserBulk={},t.ComponentsHubCalloutsCalloutsUserBulk.BulkUserCallouts=function(){const e=i.useContext(es.BulkUserCommandContext),{onClose:t,operation:s,users:n,flowId:r}=e;if(!n)return null;switch(s){case"changeAccessLevel":return i.createElement(ns.BulkEditUserChangeAccessLevelPanel,{users:n,onDismiss:t});case"addToProjects":return i.createElement(ss.BulkEditUserAddToProjectsPanel,{users:n,onDismiss:t});case"removeFromProjects":return i.createElement(os.BulkEditUserRemoveFromProjectsPanel,{users:n,onDismiss:t});case"remove":return i.createElement(is.BulkEditUserRemoveFromAccountDialog,{users:n,onDismiss:t});case"removeDirectAssignment":return i.createElement(as.RemoveDirectAssignmentsDialog,{key:r,users:n,onDismiss:t})}return null}}(),function(e){cs=t[e]={},t[e].UserCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,user:t.user}}}s.initialState={operation:void 0,user:void 0},t[e].UserCommandContextProvider=function(n){const[r,o]=i.useReducer(s.reduce,s.initialState),[a,l]=(0,gt.useSaveFocusElement)(),c=(0,ye.useUserHubContext)(),u=i.useContext(qe.UserHubNotificationsContext),m=i.useCallback((e,t)=>{o({operation:e,user:t})},[o]),d=i.useCallback(e=>{o({operation:e,user:void 0})},[o]),p=(0,$e.useResendUserInvitation)(),g=i.useCallback((e,t)=>{switch(e){case"resendInvite":p(t)}},[c,u]),C={operation:r.operation,user:r.user,onOpenModifyUserCallout:m,onOpenIndependentCallout:d,saveFocusElement:a,onUserOperation:g,onClose:()=>{o({operation:void 0,user:void 0}),l()}};return i.createElement(t[e].UserCommandContext.Provider,{value:C},n.children)},t[e].userCommandItems={add:{id:"add",text:he.ButtonText_Invite},export:{id:"export",text:he.ContextualMenuOptionExportCSV},changeAccessLevel:{id:"changeAccessLevel",text:he.ContextualMenuButtonText_ChangeAccessLevel,className:Ae.L2ClassNames.commandItems.changeAccessLevel},manageUser:{id:"manageUser",text:he.ContextualMenuButtonText_ManageUser,className:Ae.L2ClassNames.commandItems.manageMember},resendInvite:{id:"resendInvite",text:he.ContextualMenuOptionResendInvite},reinstateAssets:{id:"reinstateAssets",text:he.ContextualMenuOptionReinstateAssets},remove:{id:"remove",text:he.EditUserBulkDialog_RemoveFromAccount,className:Ae.L2ClassNames.commandItems.removeFromOrganization},removeDirectAssignment:{id:"removeDirectAssignment",text:he.ContextualMenuOptionRemoveDirectAssignment,className:Ae.L2ClassNames.commandItems.removeDirectAssignment}}}("ContextCommandContextUser"),function(e){function s(e,t){return i.createElement(h.FormItem,{label:he.HubColLastAccessed},(0,pt.toLocaleDateString)(e.lastAccessedDate,he.TextLastAccessedDateNever))}function n(e,t){if(2===e.licensingSource&&Pe.AccessLevels.equals(t,e)){if(Pe.AccessLevels.hasValidMsdnSubscription(e))return;if(Pe.AccessLevels.hasInvitedMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_PendingSubscriber," ",i.createElement(f.Link,{href:fe.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank"},he.UserInviteDialog_MoreInformation)),"Info"];if(Pe.AccessLevels.hasInvalidInvitedMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_InvalidSubscriber," ",i.createElement(f.Link,{href:fe.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank"},he.UserInviteDialog_MoreInformation)),"Error"];if(Pe.AccessLevels.hasInvalidMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_InvalidMsdnSubscription," ",i.createElement(f.Link,{href:fe.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank"},he.UserInviteDialog_MoreInformation)),"Error"]}}function r(e){const[t,s]=i.useState(e.accessLevel),r=i.useMemo(()=>n(e.accessLevel,t),[e.accessLevel,t]);return[t,s,r]}us=t[e]={},t[e].renderLastAccessed=s,t[e].getUserMsdnAccessLevelMessageBarContentAndType=n,t[e].useUserSelectAccessLevel=r,t[e].EditUserAccessLevelPanel=function(e){i.useMemo(()=>(0,z.getId)("last-accessed"),[]);const t=(0,ye.useUserHubContext)();let{member:n}=e;const[o,a,l]=r(n),c=(0,Oe.useEditMemberBuilder)(n,o),u=i.useContext(rt.UsersContext),m=(0,Ve.useRefreshedMember)(n.id,2===n.accessLevel.assignmentSource?async e=>{const[t]=await u.refreshUsers([e],[fe.UserEntitlementPropertyNames.GroupRules]);return t}:void 0);n=m||n;const d=!!m,{updateUser:g}=(0,rt.useUsersContextApiActions)(),C=(0,qe.useNotificationAsyncCallback)(g,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},n.displayName),onGetDescription:(e,t,s)=>i.createElement(_t.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new _t.EditMemberStatusResultNotification(e,i.createElement(_t.EditMemberNotificationDescription,{metadata:n}))}),b=(0,Se.useTrackedAsyncCallback)(t,C,fe.PerformanceScenarioConstants.EditUserFeatureName,(e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e));return i.createElement(wt.EditMemberAccessLevelPanel,{actionButtonProps:{disabled:0===c.length,className:Ae.L2ClassNames.Dialogs.EditUserSingle.ChangeAccessConfirmationButton,onClick:()=>{const[t,s]=c.build();t.length>0&&(e.onDismiss(),b(n,t,s))},text:he.ButtonText_SaveChanges},className:Ae.L2ClassNames.Dialogs.EditUserSingle.ChangeAccessLevelContainer,member:n,isGroup:!1,onDismiss:e.onDismiss,memberPromiseFulfilled:d,extraInfo:s(e.member),isAccessLevelOnly:!0,groupAssignments:n.groupAssignments,selectedAccessLevel:o,onSelectedAccessLevelChanged:a,title:he.ContextualMenuButtonText_ChangeAccessLevel},l&&i.createElement(X.MessageCard,{severity:l[1]},l[0]))}}("ComponentsHubCalloutsEditMemberEditUserPanelAccessLevel"),function(e){function s(e){const{hasFilter:t,displayMembers:s}=e,n=(0,ye.useUserHubContext)();if(s){const{noResultsText:s,noResultsMatchFilterText:r}=e;return i.createElement("div",{className:(0,y.css)(B.CssClassNames.flex.auto),role:"alert"},i.createElement(M.ZeroData,{className:(0,y.css)(B.CssClassNames.flex.auto,(0,b.getSpacingClassName)("margin","all",40)),imagePath:n.getImageUrl(t?ye.UserHubPageContextService.noResultsMatchedAssetsId:ye.UserHubPageContextService.noResultsAssetsId),primaryText:t?r:s,imageAltText:""}))}return i.createElement("div",{className:B.CssClassNames.flex.auto},i.createElement(c.Spinner,{size:"large",label:he.SpinnerLabel_WorkingOnIt}))}ms=t.ComponentsHubMemberListMemberTable={},t.ComponentsHubMemberListMemberTable.MemberTable=function(e){const{columns:t,columnSorting:n}=e,{perfRef:r}=(0,ye.useUserHubContext)(),{itemProvider:o,behavior:a,fetchedCount:l,isFetchDone:c}=(u={displayMembers:e.displayMembers,fetchNextBatch:e.fetchNextBatch,isFetchDone:e.isFetchDone},(0,we.useAutoLoadingTableProps)(u.displayMembers,u.isFetchDone,u.fetchNextBatch));var u;i.useEffect(()=>{(c||l>0)&&r.current.markInteractive()},[c,l]);const m=n?i.useMemo(()=>[n,a],[n,a]):void 0;return 0===o.length?i.createElement(s,Object.assign({},e)):i.createElement("div",{className:R.LayoutClassNames.overflowXAuto},i.createElement(T.Table,{itemProvider:o,className:e.className,selection:e.selection,columns:t,behaviors:m,ariaLabel:e.ariaLabel}))}}(),function(e){ds=t[e]={};class s{static getStyles(){return{accessLevelDisplay:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8))}}}__decorate([o.memoize],s,"getStyles",null);class n{constructor(e){this.onSize=((e,t,s,n)=>{n.id===this.id&&(this.width.value=s)}),this.width=new U.ObservableValue(e)}}t[e].MemberResizableColumn=n;t[e].MemberPersonaColumn=class extends n{constructor(e,t,s){super(e),this.onRenderPersona=s,this.id="persona",this.headerClassName=Ae.L2ClassNames.tableColumnHeaders.displayName,this.className=Ae.L2ClassNames.ListRow.displayName,this.minWidth=288,this.name=he.HubColName,this.renderCell=((e,t,s,n)=>i.createElement(T.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},this.onRenderPersona(n))),this.sortProps={sortOrder:t}}};t[e].MemberAccessLevelColumn=class extends n{constructor(e,t){super(e),this.hideStatusIcon=t,this.id="access-level",this.headerClassName=Ae.L2ClassNames.tableColumnHeaders.accessLevel,this.className=Ae.L2ClassNames.memberTable.accessLevel,this.minWidth=216,this.name=he.HubColAccessLevel,this.renderCell=((e,t,n,r)=>{const o=s.getStyles(),{accessLevel:a}=r,l=this.hideStatusIcon&&!!a.statusMessage,c={[Ae.L2DataAttributeKeys.memberAccessLevel]:Pe.AccessLevels.getLicenseKey(a)};return i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:n,contentClassName:o.accessLevelDisplay,key:t},i.createElement("div",Object.assign({},c),a.licenseDisplayName),l&&i.createElement(I.Icon,{iconName:4===a.status?"Info":"Warning",title:a.statusMessage}))})}}}("ComponentsHubMemberListMemberTableColumns"),function(e){ps=t.ComponentsHubCalloutsEditMemberGroupEntitlementsForm={},t.ComponentsHubCalloutsEditMemberGroupEntitlementsForm.EditMemberGroupEntitlementsForm=function(e){const t=(0,ye.useUserHubContext)(),{groupAssignments:s}=e,n=i.useMemo(()=>[new ds.MemberPersonaColumn(-50,void 0,e=>i.createElement(xt.MemberPersona,{member:e,pageContext:t,defaultToMemberSecondaryTextField:!1})),new ds.MemberAccessLevelColumn(-50,!0)].map(e=>Object.assign(Object.assign({},e),{minWidth:10})),[]);return i.createElement(ms.MemberTable,{displayMembers:s||[],isFetchDone:!0,noResultsText:he.NoResults_NoGroupRulesFound,hasFilter:!1,columns:n})}}(),function(e){gs=t.ComponentsHubCalloutsEditMemberEditUserPanel={},t.ComponentsHubCalloutsEditMemberEditUserPanel.EditUserPanel=function(e){const t=(0,ye.useUserHubContext)();let{member:s}=e;const n=i.useContext(rt.UsersContext),r=(0,Ve.useRefreshedMember)(s.id,async e=>{const[t]=await n.refreshUsers([e],[fe.UserEntitlementPropertyNames.Projects,fe.UserEntitlementPropertyNames.GroupRules]);return t});s=r||s;const o=!!r,[a,l,c]=(0,us.useUserSelectAccessLevel)(s),u=i.useMemo(()=>(0,z.getId)("last-accessed"),[]),[m,d]=i.useState({}),g=(0,Oe.useEditMemberBuilder)(s,a,m),{updateUser:C}=(0,rt.useUsersContextApiActions)(),b=(0,qe.useNotificationAsyncCallback)(C,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},s.displayName),onGetDescription:(e,t,s)=>i.createElement(_t.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new _t.EditMemberStatusResultNotification(e,i.createElement(_t.EditMemberNotificationDescription,{metadata:n}))}),v=(0,Se.useTrackedAsyncCallback)(t,b,fe.PerformanceScenarioConstants.EditUserFeatureName,(e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e));return i.createElement(Bt.EditMemberPanel,{onDismiss:e.onDismiss,member:s,memberPromiseFulfilled:o,className:Ae.L2ClassNames.Dialogs.EditUserSingle.EditUserDialogContainer,actionButtonProps:{disabled:0===g.length,className:Ae.L2ClassNames.Dialogs.EditUserSingle.EditSaveButton,text:he.ButtonText_SaveChanges,onClick:()=>{const[t,n]=g.build();t.length>0&&(e.onDismiss(),v(s,t,n))}},additionalTabs:2===s.accessLevel.assignmentSource||s.groupAssignments&&s.groupAssignments.length>0?[{id:"GroupRules",name:he.EditUserDialog_GroupRulesTabTitle,content:i.createElement(ps.EditMemberGroupEntitlementsForm,{groupAssignments:s.groupAssignments})}]:void 0,initialTab:e.initialTab,isGroup:!1,selectedAccessLevel:a,groupAssignments:s.groupAssignments,extraInfo:(0,us.renderLastAccessed)(s,u),title:he.EditUserDialog_ManageUser,projectSelectionDelta:m,onSelectedAccessLevelChanged:l,onProjectSelectionChange:d},c&&i.createElement(X.MessageCard,{severity:c[1]},c[0]))}}(),function(e){Cs=t.ComponentsHubCalloutsEditMemberReinstateAssetsDialog={};class s{static getStyles(){return{contentRoot:(0,b.getSpacingContainerClassName)("y",20)}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubCalloutsEditMemberReinstateAssetsDialog.ReinstateAssetsDialog=function(e){const{user:t}=e,n=i.createElement(p.TemplateString,{template:he.Notification_ReinstateAssets_Action1},t.displayName),{reinstateAssets:r}=(0,rt.useUsersContextApiActions)(),o=(0,qe.useNotificationAsyncCallback)(r,{onGetDisplayName:()=>n,onGetResultNotification:e=>new Pt.SingleMemberStatusResultNotification(e)}),a=s.getStyles(),l=t.principalName?t.principalName:t.displayName;return i.createElement(ft.CommonDialog,{actionButtonProps:{text:he.HubButtonTextReinstate,onClick:()=>{e.onDismiss(),o(t)}},onDismiss:e.onDismiss,title:he.ReinstateAssetsDialog_DialogTitleSingular},i.createElement("div",{className:a.contentRoot},i.createElement("div",{className:R.FontClassNames.fontSizeL},i.createElement(p.TemplateString,{template:he.ReinstateAssetsDialog_ReinstateAssetsPrompt1},l)),i.createElement(X.MessageCard,{iconProps:{iconName:"Warning"}},i.createElement("div",null,he.ReinstateAssetsDialog_LoseAssetsWarning," ",i.createElement(f.Link,{href:fe.UserManagementLinks.ReinstateAssetsHelpLink,target:"_blank",rel:"noopener noreferrer"},he.UserDialog_LearnMore)))))}}(),function(e){bs=t.ComponentsHubCalloutsCalloutsUser={},t.ComponentsHubCalloutsCalloutsUser.UserCallouts=function(){const e=i.useContext(cs.UserCommandContext),{onClose:t,user:s,operation:n}=e;switch(e.operation){case"add":return i.createElement(Lt.AddUsersToCollectionPanel,{onDismiss:t})}if(!s)return null;switch(n){case"changeAccessLevel":return i.createElement(us.EditUserAccessLevelPanel,{member:s,onDismiss:t});case"manageUser":return i.createElement(gs.EditUserPanel,{onDismiss:t,member:s});case"removeDirectAssignment":return i.createElement(as.RemoveDirectAssignmentsDialog,{onDismiss:t,users:[s],key:s.id});case"reinstateAssets":return i.createElement(Cs.ReinstateAssetsDialog,{user:s,onDismiss:t});case"remove":return i.createElement(rs.RemoveUserDialog,{onDismiss:t,user:s})}return null}}(),function(e){vs=t.ComponentsHubMemberListGroupTable={};class s extends ds.MemberResizableColumn{constructor(e,t){super(e),this.id="lastExecuted",this.headerClassName=Ae.L2ClassNames.ListHeaders.lastAccessedDate,this.className=Ae.L2ClassNames.ListRow.lastAccess,this.minWidth=144,this.name=he.HubColLastEvaluated,this.renderCell=((e,t,s,n)=>{const{lastExecuted:r}=n;return i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},r?i.createElement("time",{dateTime:r.toISOString()},r.toLocaleDateString()," ",r.toLocaleTimeString()):i.createElement("div",{className:Ae.L2ClassNames.ListRow.lastAccessText}))}),this.sortProps={sortOrder:t}}}function n(e){return Ae.L2ClassNames.memberTable.groupStatusPrefix+e}t.ComponentsHubMemberListGroupTable.getGroupStatusClassName=n;class r{constructor(){this.id="status",this.width=40,this.renderCell=((e,t,s,r)=>{let o=null;switch(r.status){case 0:o=i.createElement(I.Icon,{render:()=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{size:"16"})),tooltipProps:{text:he.GroupResolve_Running}});break;case 5:o=i.createElement(I.Icon,{iconName:"Info",title:he.GroupRules_IncompatibleState});break;case 10:o=i.createElement(I.Icon,{iconName:"Info",title:he.GroupRules_UnableToApplyState,"data-groupStatus":""})}return r.isPendingDeleteCompletion&&(o=i.createElement(I.Icon,{render:()=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{size:"16"})),tooltipProps:{text:he.GroupResolve_Deleting}})),i.createElement(T.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t,className:n(r.status)},o)})}}t.ComponentsHubMemberListGroupTable.GroupTable=function(e){const t=(0,ye.useUserHubContext)(),n=function(){const e=i.useContext(Ft.GroupCommandContext);return i.useCallback(t=>({id:"edit-group-menu",className:Ae.L2ClassNames.menus.editGroup,items:e?[Object.assign(Object.assign({},Ft.groupCommandItems.manageGroup),{onActivate:()=>e.onOpenModifyGroupCallout("manageGroup",t)}),Object.assign(Object.assign({},Ft.groupCommandItems.manageMembers),{disabled:!!t.isAad,onActivate:()=>e.onOpenModifyGroupCallout("manageMembers",t)}),{id:"divider1",itemType:1},Object.assign(Object.assign({},Ft.groupCommandItems.remove),{onActivate:()=>e.onOpenModifyGroupCallout("remove",t)})]:[]}),[e])}(),o=i.useContext(Ft.GroupCommandContext),{groupsContext:a}=e,[l,c]=function(e,t,n,o){const[a,l,c]=i.useMemo(()=>{const e={},t={},s=[];return s.push(0,1),e[s.length-1]="displayName",t[s.length-1]=-7/12*100,s.push(2,3),t[s.length-2]=-25,t[s.length-1]=-2/12*100,e[s.length-1]="lastExecutedDate",s.push(4),[s,t,e]},[o]),u=n&&n.sortState;return[i.useMemo(()=>a.map((n,a)=>{switch(n){case 0:return new r;case 1:return new ds.MemberPersonaColumn(l[a],u&&"displayName"===u.sortByKey?u.sortOrder:void 0,t=>i.createElement(xt.MemberPersona,{member:t,pageContext:e,defaultToMemberSecondaryTextField:!1}));case 2:return new ds.MemberAccessLevelColumn(l[a],!0);case 3:return new s(l[a],u&&"lastExecutedDate"===u.sortByKey?u.sortOrder:void 0);case 4:return new T.ColumnMore(o,void 0,(e,s)=>{t&&t.saveFocusElement(document.activeElement)})}}),[a,l,o,e,u]),c]}(t,o,a,n),u=(0,we.useColumnSorting)((e,t)=>{const s=c[e];s&&a.setSort({sortByKey:s,sortOrder:t})},[a.setSort,c]);return i.createElement(ms.MemberTable,{className:e.className,ariaLabel:he.GroupTable_AriaLabel,displayMembers:a.displayMembers,fetchNextBatch:a.fetchNextBatch,isFetchDone:a.isFetchDone,noResultsText:he.NoResults_NoGroupRulesFound,noResultsMatchFilterText:he.NoResults_NoGroupRulesMatchFilter,hasFilter:e.hasFilter,columns:l,columnSorting:u})}}(),function(e){hs=t[e]={};class s{static getStyles(){return{root:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",16),R.FontClassNames.fontSizeM),pillLabel:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",4)),pillContent:R.TextClassNames.alignCenter}}}__decorate([o.memoize],s,"getStyles",null),t[e].tableCardClassName="bolt-table-card",t[e].MembersTableCardTitle=function(e){const t=s.getStyles();return i.createElement("div",{className:t.root,"aria-live":"polite"},void 0!==e.totalCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Total),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.totalCount)),void 0!==e.estimatedFilterCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Filtered),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.estimatedFilterCount+(0===e.estimatedFilterCount||!e.hasExactFilterCountEstimate&&void 0!==e.hasExactFilterCountEstimate?"+":""))),void 0!==e.selectedCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Selected),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.selectedCount)))}}("ComponentsHubMemberListMembersTableCard"),function(e){fs=t.ComponentsHubMemberListGroupTableCard={};class s{static getCommandBarItems(e,t){return e.isAdmin?[Object.assign(Object.assign({},Ft.groupCommandItems.add),{isPrimary:!0,important:!0,onActivate:()=>{t("add")}}),Object.assign(Object.assign({},Ft.groupCommandItems.reEvaluateAllRules),{important:!0,onActivate:()=>{t("reEvaluateAllRules")}})]:[]}}t.ComponentsHubMemberListGroupTableCard.GroupTableCard=function(){const e=(0,ye.useUserHubConfiguration)(),t=i.useContext(tt.GroupsContext),n=i.useContext(Ft.GroupCommandContext),r=i.useMemo(()=>t&&n&&s.getCommandBarItems(e,n.onOpenIndependentCallout),[e,n&&n.onOpenIndependentCallout]);if(!t)return null;const o=(0,Xe.membersContextFilterStateIsActive)(t.filterState);return i.createElement(i.Fragment,null,i.createElement(le.Card,{titleProps:{text:i.createElement(hs.MembersTableCardTitle,{totalCount:t.isFetchDone?t.allMembers.length:void 0,estimatedFilterCount:o&&t.isFetchDone?t.displayMembers.length:void 0})},headerCommandBarItems:r,className:(0,y.css)(hs.tableCardClassName,Ae.L2ClassNames.cards.groups)},i.createElement(vs.GroupTable,{hasFilter:o,groupsContext:t})))}}(),function(e){ys=t[e]={};class s extends ds.MemberResizableColumn{constructor(e,t){super(e),this.id="lastExecuted",this.headerClassName=Ae.L2ClassNames.tableColumnHeaders.lastAccess,this.className=Ae.L2ClassNames.ListRow.lastAccess,this.minWidth=144,this.name=he.HubColLastAccessed,this.renderCell=((e,t,s,n)=>{const r=(0,pt.toLocaleDateString)(n.lastAccessedDate,he.TextLastAccessedDateNever);return i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},r===he.TextLastAccessedDateNever?i.createElement("div",{className:Ae.L2ClassNames.ListRow.lastAccessText},r):i.createElement("time",{dateTime:n.lastAccessedDate.toISOString()},r))}),this.sortProps={sortOrder:t}}}class n extends ds.MemberResizableColumn{constructor(e,t){super(e),this.id="dateAdded",this.headerClassName=Ae.L2ClassNames.tableColumnHeaders.dateAdded,this.className=Ae.L2ClassNames.ListRow.dateAdded,this.minWidth=144,this.name=he.HubColDateAdded,this.renderCell=((e,t,s,n)=>{const r=n.dateAdded.toLocaleDateString();return i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("time",{dateTime:n.dateAdded.toISOString()},r))}),this.sortProps={sortOrder:t}}}t[e].UserDateAddedColumn=n;class r extends ds.MemberResizableColumn{constructor(e){super(e),this.id="licenseSource",this.headerClassName=Ae.L2ClassNames.tableColumnHeaders.licenseSource,this.className=Ae.L2ClassNames.ListRow.licenseSource,this.minWidth=144,this.name=he.HubColLicenseSource,this.renderCell=((e,t,s,n)=>{let r="";switch(n.accessLevel.assignmentSource){case 2:r=he.AccessLevelAssignmentSourceGroupRule;break;case 0:case 1:default:r=he.AccessLevelAssignmentSourceDirect}return i.createElement(Ut.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("div",{className:Ae.L2ClassNames.ListRow.licenseSourceText},r))})}}t[e].UserLicenseSourceColumn=r,t[e].UserTable=function(e){const t=(0,ye.useUserHubContext)(),o=function(){const e=(0,ye.useUserHubContext)(),t=(0,ye.useUserHubConfiguration)(),s=i.useContext(cs.UserCommandContext),n=i.useContext(tt.GroupsContext),r=i.useCallback(t=>({id:"edit-user-menu",className:Ae.L2ClassNames.menus.editUser,items:[Object.assign(Object.assign({},cs.userCommandItems.changeAccessLevel),{onActivate:()=>s.onOpenModifyUserCallout("changeAccessLevel",t)}),Object.assign(Object.assign({},cs.userCommandItems.manageUser),{onActivate:()=>s.onOpenModifyUserCallout("manageUser",t)}),{id:"divider-1",itemType:1},Object.assign(Object.assign({},cs.userCommandItems.resendInvite),{onActivate:()=>s.onUserOperation("resendInvite",t)}),{id:"divider-2",itemType:1},...n?[Object.assign(Object.assign({},cs.userCommandItems.removeDirectAssignment),{onActivate:()=>s.onOpenModifyUserCallout("removeDirectAssignment",t)})]:[],Object.assign(Object.assign({},cs.userCommandItems.remove),{onActivate:()=>s.onOpenModifyUserCallout("remove",t)}),...e.isFeatureFlagEnabled(fe.FeatureFlags.ReinstateAssets)&&t.isAADDeleted?[Object.assign(Object.assign({},cs.userCommandItems.reinstateAssets),{onActivate:()=>s.onOpenModifyUserCallout("reinstateAssets",t)})]:[]]}),[s,e,n]);if(t.isAdmin)return r}(),a=i.useContext(rt.UsersContext),l=i.useContext(tt.GroupsContext),c=i.useContext(cs.UserCommandContext),[u,m]=function(e,t,o,a,l){const{sortState:c}=t,u=!!a&&a.allMembers.length>0,m=!!l,d=i.useMemo(()=>new T.ColumnSelect,[]),[p,g,C]=i.useMemo(()=>{const e={},t={},s=[];return m&&s.push(0),s.push(1),e[s.length-1]="displayName",t[s.length-1]=u?-4/12*100:-50,s.push(2),t[s.length-1]=-2/12*100,u&&(s.push(5),t[s.length-1]=-2/12*100),s.push(3,4),t[s.length-2]=-2/12*100,e[s.length-2]="dateAdded",t[s.length-1]=-2/12*100,e[s.length-1]="lastAccessDate",m&&s.push(6),[s,t,e]},[m,u]);return[i.useMemo(()=>p.map((t,a)=>{switch(t){case 0:return d;case 1:return new ds.MemberPersonaColumn(g[a],"displayName"===c.sortByKey?c.sortOrder:void 0,t=>i.createElement(xt.UserPersona,{member:t,pageContext:e}));case 2:return new ds.MemberAccessLevelColumn(g[a],!0);case 5:return new r(g[a]);case 3:return new n(g[a],"dateAdded"===c.sortByKey?c.sortOrder:void 0);case 4:return new s(g[a],"lastAccessDate"===c.sortByKey?c.sortOrder:void 0);case 6:return new T.ColumnMore(l,void 0,(e,t)=>{o.saveFocusElement(document.activeElement)})}}),[p,g,l,e,c]),C]}(t,a,c,l,o),d=(0,we.useColumnSorting)((e,t)=>{const s=m[e];s&&a.setSort({sortByKey:s,sortOrder:t})},[a.setSort,m]);return i.createElement(ms.MemberTable,{className:Ae.L2ClassNames.lists.usersTable,ariaLabel:he.UserTable_AriaLabel,displayMembers:a.displayMembers,fetchNextBatch:a.fetchNextBatch,isFetchDone:a.isFetchDone,noResultsText:he.NoResults_NoUsersMatchFilter,noResultsMatchFilterText:he.NoResults_NoUsersMatchFilter,hasFilter:e.hasFilter,columns:u,selection:e.selection,columnSorting:d})}}("ComponentsHubMemberListUserTable"),function(e){Ss=t[e]={},t[e].BillingContext=i.createContext({});class s{}s.TokenProvierNameAzCommDeploymentProfile="AzCommDeploymentProfile",t[e].BillingContextProvider=function(n){const r=(0,ye.useUserHubContext)(),o=i.useMemo(async()=>{const e=r.getService("IAuthenticationService").getNamedTokenProvider(s.TokenProvierNameAzCommDeploymentProfile),t=r.getRestClient(ut.AzCommClientName,{hostType:1,authTokenProvider:e}),n=r.getPageData(),i=n&&n.hostId;return(await t.getBillingInfo(i)).isAssignmentBillingEnabled},[r]),[a]=(0,L.useResolvedPromise)(o,void 0,e=>{r.telemetry.trackException(e,"AzCommBillingContextProvider")}),l=i.useMemo(()=>({isAssignmentBilling:a}),[a]);return i.createElement(t[e].BillingContext.Provider,{value:l},n.children)}}("ContextBillingContext"),function(e){Es=t[e]={};class s{static getAssignedSum(e){return e.length>0?e.reduce((e,t)=>e+t.assigned+t.disabled,0):0}}t[e].UserSummaryPanelUtils=s;class n{static getStyles(){return{content:(0,y.css)(C.SizeClassNames.width100,R.FlexClassNames.flexColumn,(0,b.getSpacingContainerClassName)("y",20)),sectionTitle:(0,y.css)(R.TypographyClassNames.titleS,(0,b.getSpacingContainerClassName)("x",8),R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingClassName)("margin","bottom",16)),statusTreeCellContent:(0,y.css)(R.TextClassNames.ellipsis,B.CssClassNames.flex.auto,R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),extensionsTitleRow:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,B.CssClassNames.jusitfyContent.spaceBetween,(0,b.getSpacingClassName)("margin","bottom",16))}}static getLicensesInfoItemProvider(e,t,s){const r=[];if(e&&void 0!==t)for(const i of e){const e=s?void 0:n.getLicenseChildItems(i,t);r.push({childItems:e,expanded:!e&&void 0,data:{label:i.licenseName,count:i.assigned,labelSuffixIcon:!e&&i.disabled>0?{iconName:"Warning",title:he.HubSummary_InvalidAccessLevelDropdownInformation}:void 0,summaryData:i}})}else r.push({data:void 0});return new ie.TreeItemProvider(r)}static hasBuyLink(e,t){return e.isAdmin&&(2===t||4===t)}static getLicenseChildItems(e,t){const s=[];let n=e.total-e.includedQuantity;if(t&&(n=e.assigned-e.includedQuantity),e.disabled>0&&s.push({data:{label:he.AccessLevel_Invalid,count:e.disabled,labelSuffixIcon:{iconName:"Warning"}}}),e.isPurchasable&&(e.includedQuantity>0?s.push({data:{label:he.HubSummary_Free,count:e.includedQuantity}},{data:{label:he.HubSummary_Paid,count:n}}):4!==e.accountLicenseType&&s.push({data:{label:he.HubSummary_Total,count:e.total}})),(e.isPurchasable||e.disabled>0)&&s.push({data:{label:he.HubSummary_Assigned,count:e.assigned}}),e.isPurchasable&&!t&&4!==e.accountLicenseType){if(s.push({data:{label:he.HubSummary_Available,count:e.available<0?0:e.available}}),0!==e.accountLicenseType&&void 0!==e.totalAfterNextBillingDate&&null!==e.totalAfterNextBillingDate&&e.total!==e.totalAfterNextBillingDate){const t=e.assigned-e.totalAfterNextBillingDate;t>0?s.push({data:{label:he.HubSummary_NextMonthMissing,count:t,labelSuffixIcon:{iconName:"Warning"}}}):s.push({data:{label:he.HubSummary_NextMonthTotal,count:e.totalAfterNextBillingDate,labelSuffixIcon:{iconName:"Info",title:he.HubSummary_NextMonthTotalInfo}}})}}return s.length>0?s:void 0}}function r(e){const t=n.getStyles(),{data:s,childItems:r}=e.treeItem.underlyingItem;if(!s)return i.createElement(i.Fragment,null);const o=r&&e.onGetLinks&&s.summaryData&&e.onGetLinks(s.summaryData);return i.createElement(re.ExpandableTreeCell,{columnIndex:e.columnIndex,treeItem:e.treeItem,className:Ae.L2ClassNames.panels.summary.accessLevelItem},i.createElement("div",{className:t.statusTreeCellContent},i.createElement("div",{className:t.statusTreeCellContent},i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:(0,y.css)(R.TextClassNames.ellipsis,B.CssClassNames.flexShrink1)},s.label)),s.labelSuffixIcon&&i.createElement(I.Icon,Object.assign({},s.labelSuffixIcon))),o&&o.length>0&&i.createElement("div",null,i.createElement(p.TemplateJoinedString,{delimiter:" | "},...o.map(([e,t],s)=>i.createElement(f.Link,Object.assign({key:s,target:"_blank",rel:"noopener noreferrer"},e,{onClick:t=>{t.stopPropagation(),e.onClick&&e.onClick(t)}}),t)))),void 0!==s.count&&i.createElement(J.Pill,{tabIndex:-1},s.count>=0?s.count.toLocaleString():0)))}__decorate([o.memoize],n,"getStyles",null);class a{constructor(){this.id="licenses",this.width=-100,this.renderCell=((e,t,s,n)=>i.createElement(r,{key:t,columnIndex:t,treeItem:n,onGetLinks:this.onGetLinks})),this.onGetLinks=(e=>{const t=[];return 4===e.accountLicenseType&&t.push([{href:fe.UserManagementLinks.BasicPlusTestPlansLearnMoreLink},he.UsersSummary_LearnMore]),t})}}function l(){const e=n.getStyles(),t=i.useContext(Ss.BillingContext),{isAssignmentBilling:r}=t,o=i.useContext(xe.UsersSummaryContext),{licenses:l}=o,c=i.useContext(rt.UsersContext),u=l&&s.getAssignedSum(l),m=(0,ye.useUserHubContext)(),d=(0,ye.useUserHubConfiguration)(),p=m.isFeatureFlagEnabled(fe.FeatureFlags.HideLicenseAndExtensionCounters),g=i.useMemo(()=>n.getLicensesInfoItemProvider(l,r,p),[l,r,p]),C=i.useMemo(()=>[new a],[m,d]);return i.createElement("div",{className:Ae.L2ClassNames.panels.summary.accessLevels},i.createElement("div",{className:e.sectionTitle},i.createElement("div",null,he.HubSummary_TotalUsers),void 0!==u&&i.createElement(J.Pill,{tabIndex:-1,excludeFocusZone:!0,className:Ae.L2ClassNames.panels.summary.accessLevelTotal},u)),i.createElement(re.Tree,{showHeader:!1,showLines:!1,columns:C,itemProvider:g,onToggle:(e,t)=>{g.toggle(t.underlyingItem)},onSelect:(e,t)=>{const s=t.data.underlyingItem.data;if(s&&s.summaryData){const e=new Ze.MemberAccessLevelFilterItem(s.summaryData,s.summaryData.licenseName,!1);c.setAccessLevelsFilter([e])}}}))}t[e].UsersSummaryPanel=function(e){const t=n.getStyles();return i.createElement(V.Panel,{titleProps:{text:he.HubSummary_Title},onDismiss:e.onDismiss,className:Ae.L2ClassNames.panels.summary.root},i.createElement("div",{className:t.content},i.createElement(l,null)))}}("ComponentsHubSummaryUsersSummaryPanel"),function(e){xs=t.ComponentsHubMemberListUserTableCard={};class s{static getCommandBarItems(e,t,s,n,r,i){const{onOpenIndependentCallout:o}=s,a=e&&t&&t.length>1?[Object.assign(Object.assign({},es.userBulkCommandItems.changeAccessLevel),{onActivate:()=>{r("changeAccessLevel",t)}}),{id:"divider-1",itemType:1},Object.assign(Object.assign({},es.userBulkCommandItems.addToProjects),{onActivate:()=>{r("addToProjects",t)}}),Object.assign(Object.assign({},es.userBulkCommandItems.removeFromProjects),{onActivate:()=>{r("removeFromProjects",t)}}),{id:"divider-2",itemType:1},...n?[Object.assign(Object.assign({},es.userBulkCommandItems.removeDirectAssignment),{onActivate:()=>{r("removeDirectAssignment",t)}})]:[],Object.assign(Object.assign({},es.userBulkCommandItems.remove),{onActivate:()=>{r("remove",t)}})]:void 0,l=a&&t?[{id:"manage",text:(0,D.format)(he.ButtonText_ManageCount1,t.length),className:Ae.L2ClassNames.commandItems.bulkManageUsers,iconProps:{iconName:"Edit"},important:!0,subMenuProps:{id:"manage-menu",className:Ae.L2ClassNames.dropdowns.bulkManageUsers.callout,items:a}}]:[];return[...a?[]:[{id:"summary",text:he.ButtonText_Summary,className:Ae.L2ClassNames.commandItems.usersSummary,onActivate:()=>{i(!0)}}],...!a&&e?[Object.assign(Object.assign({},cs.userCommandItems.add),{className:Ae.L2ClassNames.commandItems.addUsers,isPrimary:!0,important:!0,onActivate:()=>{o("add")}})]:[],...l]}static userEquals(e,t){return!!e&&!!t&&e.id===t.id}}t.ComponentsHubMemberListUserTableCard.UserTableCard=function(){const e=i.useContext(rt.UsersContext),t=(0,ye.useUserHubConfiguration)(),n=i.useContext(tt.GroupsContext),r=i.useContext(cs.UserCommandContext),o=i.useContext(es.BulkUserCommandContext),[a,l]=i.useState([]),[c,u,m]=(0,g.useSelectedItems)(e.displayMembers,a,l,s.userEquals,g.onGetSelfValue),d=(0,g.useSelectionFactory)(()=>new P.ListSelection(!0),c,u),p=i.useContext(xe.UsersSummaryContext),[C,b]=i.useState(!1),{isAdmin:v}=t,h=i.useMemo(()=>s.getCommandBarItems(v,m,r,n,o.onOpenBulkModifyUserCallout,b),[v,r,n,e.displayMembers,o.onOpenBulkModifyUserCallout,b,m]),f=p.licenses&&p.licenses.length>0?p.licenses.reduce((e,t)=>e+t.assigned+t.disabled,0):void 0,S=(0,Xe.membersContextFilterStateIsActive)(e.filterState),E=m&&m.length;return i.createElement(i.Fragment,null,i.createElement(le.Card,{headerCommandBarItems:h,className:(0,y.css)(hs.tableCardClassName,Ae.L2ClassNames.cards.users),titleProps:{text:i.createElement(hs.MembersTableCardTitle,{totalCount:f,estimatedFilterCount:S?e.displayMembers.length:void 0,hasExactFilterCountEstimate:e.isFetchDone,selectedCount:0===E?void 0:E})}},i.createElement(ys.UserTable,{selection:d,hasFilter:S})),C&&i.createElement(Es.UsersSummaryPanel,{onDismiss:()=>{b(!1)}}))}}(),function(e){As=t[e]={},t[e].useReEvaluateRulesNotification=function(){const e=i.useContext(tt.GroupsContext),t=e&&e.allMembers&&e.allMembers.some(e=>e&&10===e.status),s=i.useContext(Ft.GroupCommandContext),[n,r]=(0,qe.usePersistentUserHubNotification)("re-evaluate-rules"),[,o]=(0,Rt.useAllLicensingRulesApplicaitonStatus)(),a=n&&n.data;i.useEffect(()=>{o?1!==a&&r({statusType:"Running",title:he.GroupResolve_Running,data:1}):t&&s?0!==a&&r({statusType:"Warning",title:he.WarningMessage_GroupRulesAssignmentErrors,description:he.GroupResolve_UsersMissingLicenses,buttons:s&&[{text:he.GroupResolve_FixAssignmentIssues,onClick:()=>{s.onOpenIndependentCallout("fixAssignmentErrors")}}],data:0}):void 0!==a&&r(void 0)},[t,s,o,a])}}("ComponentsHubNotificationsuseReEvaluateRulesNotification"),function(e){Us=t[e]={};class s{static getStyles(){return{listRoot:C.SizeClassNames.width100,listItemRoot:(0,y.css)(C.SizeClassNames.width100,(0,b.getSpacingClassName)("padding","y",8),(0,b.getSpacingClassName)("padding","x",4),(0,b.getSpacingContainerClassName)("y",8)),listItemTitle:(0,y.css)(R.FlexClassNames.flexRow,R.FlexClassNames.alignItemsCenter,(0,b.getSpacingContainerClassName)("x",8)),listItemTitleText:(0,y.css)(B.CssClassNames.whiteSpace.normal,B.CssClassNames.flex.auto,j.ColorClassNames.primaryText,R.FontClassNames.fontWeightSemiBold),listItemTitleTimestamp:(0,y.css)(j.ColorClassNames.secondaryText),listItemContent:(0,y.css)(B.CssClassNames.flex.auto,R.FlexClassNames.flexColumn,R.FlexClassNames.alignItemsFlexStart,B.CssClassNames.whiteSpace.normal),pillStatusIcon:(0,b.getSpacingClassName)("margin","x",8)}}static getStatusType(e){switch(e){case"Canceling":return"Waiting";default:return e}}}function n(e){const{onDismiss:t,notification:n}=e,r=s.getStyles(),[o,a]=i.useState(!1),l=i.useMemo(()=>{const e=[];return n.details&&e.push({text:o?he.ButtonText_LessDetails:he.ButtonText_MoreDetails,iconProps:{iconName:o?"ChevronUp":"ChevronDown"},ariaExpanded:o,onClick:e=>{e.preventDefault(),e.stopPropagation(),a(e=>!e)}}),n.buttons&&e.push(...n.buttons),e},[!n.details,o,a,n.buttons]);return i.createElement("div",{className:r.listItemRoot},i.createElement("div",{className:r.listItemTitle},i.createElement(ee.Status,Object.assign({},ee.Statuses[s.getStatusType(n.statusType)],{size:"16"})),i.createElement("div",{className:r.listItemTitleText},n.title),n.lastUpdated&&i.createElement("div",{className:r.listItemTitleTimestamp},i.createElement(ue.Ago,{date:n.lastUpdated})),t&&i.createElement(H.Button,{subtle:!0,iconProps:{iconName:"Clear"},ariaLabel:he.ButtonText_Dismiss,tooltipProps:{text:he.ButtonText_Dismiss},onClick:s=>{s.preventDefault(),s.stopPropagation(),t(),(()=>{const t=e.id&&document.getElementById(e.id);t&&t.focus()})()}})),i.createElement("div",{className:r.listItemContent},n.description&&i.createElement("div",null,n.description)),l&&i.createElement(O.ButtonGroup,null,l.map((e,t)=>i.createElement(H.Button,Object.assign({},e,{key:t})))),o&&n.details&&i.createElement("div",null,n.details))}function r(e){const t=i.useMemo(()=>new ce.ArrayItemProvider(e.sortedIdAndNotifications),[e.sortedIdAndNotifications]),r=(0,K.useVersionKey)(t),o=s.getStyles(),a=i.useRef(null),{onDismiss:l}=e,c=i.useMemo(()=>(0,z.getId)("list-of-notifications"),[]),u=i.useCallback((e,t,s)=>{const[r,o]=t;return i.createElement(P.ListItem,{key:r,index:e,details:s},i.createElement(n,{notification:o,notificationId:r,id:c,onDismiss:l&&(()=>l(r))}))},[l]);return i.createElement("div",{id:c,tabIndex:-1},i.createElement(P.ScrollableList,{itemProvider:t,key:r,className:o.listRoot,renderRow:u,ref:a}))}function a(e){const{activeNotificationId:t}=e;let s;return void 0!==t&&(s=e.notifications[t]),i.useEffect(()=>{void 0!==t&&(e.notifications[t]||e.clearActiveNotification())}),s?t:void 0}function l(e){const t=i.useContext(qe.UserHubNotificationsContext),{persistentIds:s,messageIds:n,notifications:o}=e,[l,c]=i.useState(()=>0===s.length?"messages":"persistent"),u=i.useMemo(()=>{return("persistent"===l?s:n).map(e=>[e,o[e]])},[s,n,l,o]),m=a(t);return i.useEffect(()=>{void 0!==m&&(s.indexOf(m)>0?c("persistent"):c("messages"))}),i.createElement(V.Panel,{onDismiss:e.onDismiss,titleProps:{text:he.TitleText_Notifications},description:he.DescriptionText_NotificationsPanel,size:2},i.createElement("div",null,i.createElement(oe.TabBar,{selectedTabId:l,onSelectedTabChanged:c,renderAdditionalContent:"persistent"===l?void 0:()=>i.createElement(H.Button,{text:he.ButtonText_DismissAll,onClick:e.dismissAllNotifications})},s.length>0&&i.createElement(oe.Tab,{name:he.TitleText_Issues,id:"persistent",badgeCount:s.length}),i.createElement(oe.Tab,{name:he.TitleText_Messages,id:"messages",badgeCount:n.length})),i.createElement(r,{sortedIdAndNotifications:u,onDismiss:"persistent"===l?void 0:e.dismissNotification})))}function c(e){const{notifications:t}=e,[s,n]=i.useState(!1),r=i.useMemo(()=>(0,Le.objectHasTruthyValue)(t),[t]),o=a(e);return i.useEffect(()=>{r?void 0!==o&&(e.clearActiveNotification(),n(!0)):n(!1)}),[s,n,r]}__decorate([o.memoize],s,"getStyles",null),t[e].useActiveNotificationId=a,t[e].UserHubNotificationsPanel=l,t[e].useShowUserHubNotificationsPanel=c,t[e].UserHubNotificationsSummaryCard=function(e){const t=i.useContext(qe.UserHubNotificationsContext),[n,r,o]=c(t),{notifications:a,dismissAllNotifications:u}=t,{persistentNotificationsIds:m,sortedMessageIds:d,runningTaskCount:g,severity:C}=i.useMemo(()=>Je.NotificationUtils.summarizeNotifications(a),[a]),b=i.useMemo(()=>[{text:he.ButtonText_ViewAll,onClick:()=>{r(!0)}},...d.length>0?[{text:he.ButtonText_DismissAll,onClick:u}]:[]],[r,m.length>0,u]);if(!o)return null;const v=d.length-g,h=s.getStyles();return i.createElement("div",{className:e.className},i.createElement(X.MessageCard,{severity:C,buttonProps:b},i.createElement("div",null,i.createElement(Q.PillGroup,null,m.length>0&&i.createElement(J.Pill,null,i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},m.length,m.length>1?he.Text_Issue_Plural:he.Text_Issue_Singular)),v>0&&i.createElement(J.Pill,null,i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},v,v>1?he.Text_Message_Plural:he.Text_Message_Singular)),g>0&&i.createElement(J.Pill,{iconProps:{render:()=>i.createElement(ee.Status,Object.assign({className:h.pillStatusIcon},ee.Statuses.Running,{size:"16"}))}},i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},g,g>1?he.Text_RunningTask_Plural:he.Text_RunningTask_Singular)))),n&&i.createElement(l,{notifications:a,persistentIds:m,messageIds:d,onDismiss:()=>{r(!1)},dismissAllNotifications:u,dismissNotification:t.dismissNotification})))}}("ComponentsHubNotificationsUserHubNotificationsCard"),function(e){Ts=t[e]={},t[e].useSummaryPendingTotalChangesNotification=function(){const e=i.useContext(xe.UsersSummaryContext),[t,s]=(0,qe.usePersistentUserHubNotification)("purchase-licenses"),{licenses:n}=e,r=i.useMemo(()=>{const e=n&&n.filter(e=>e.isPurchasable&&0!==e.accountLicenseType&&e.totalAfterNextBillingDate&&e.totalAfterNextBillingDate<e.total);if(e&&e.length>0){const t=[],s=e[0],n=s.totalAfterNextBillingDate<s.assigned;if(n){const e=s.nextBillingDate?s.nextBillingDate.toLocaleDateString():void 0;t.push(i.createElement(p.TemplateString,{template:s.totalAfterNextBillingDate<2?he.BillingCycle_OnDateWillHaveSingular3:he.BillingCycle_OnDateWillHaveMultiple3},e?i.createElement("time",{dateTime:e},e):"",s.totalAfterNextBillingDate,s.licenseName));const n=s.assigned-s.totalAfterNextBillingDate;n>0&&t.push(i.createElement(p.TemplateString,{template:n<=1?he.BillingCycle_NumberWillLoseAccessSingular1:he.BillingCycle_NumberWillLoseAccessMultiple1},n))}return[t.length>0?t:void 0,n]}return[void 0,!1]},[n]),[o,a]=r;i.useEffect(()=>{!o||t&&t.data===r?o||s(void 0):s(()=>({statusType:a?"Warning":"Information",title:he.WarningMessage_BilingIssues,description:i.createElement("div",null,i.createElement(p.TemplateJoinedString,{delimiter:he.PunctuationSuffix},...o.map((e,t)=>i.createElement(i.Fragment,{key:t},e)))," ",i.createElement(f.Link,{target:"_blank",rel:"noopener noreferrer",href:fe.UserManagementLinks.UsersWillLoseAccessLevelsLink},he.UsersSummary_LearnMore)),data:r}))})}}("ComponentsHubNotificationsuseSummaryPendingTotalChangesNotification"),function(e){Rs=t[e]={},t[e].useUserHubConfigurationErrorNotification=function(){const e=(0,ye.useUserHubConfiguration)(),[,t]=(0,qe.usePersistentUserHubNotification)("config-error");i.useEffect(()=>{e.configurationError&&t(()=>({statusType:"Failed",title:he.ErrorTitle_ConfigurationError,description:i.createElement(p.TemplateString,{template:he.ErrorMessage_ConfigurationError1},i.createElement(ze.GenericErrorSupportLink,null))}))},[e.configurationError])}}("ComponentsHubNotificationsuseUserHubConfigurationErrorNotification"),function(e){Is=t.ComponentsHubUserHubPageFilterBar={};class s{static getAccessLevelFilters(e){return e.map(e=>({id:e.key,text:e.displayName,data:e}))}static getUserTypeFilters(){return s.availableUserTypeFilterStates.map(e=>{switch(e){case 1:return{id:fe.UserMetaType.Guest,text:he.FilterLabel_Guest,data:1};case 2:default:return{id:"member",text:he.FilterLabel_Member,data:2}}})}static getLicenseSourceFilters(){return s.availableLicenseSourceFilterStates.map(e=>{switch(e){case 1:return{id:"1",text:he.AccessLevelAssignmentSourceDirect,data:1};case 2:default:return{id:"2",text:he.AccessLevelAssignmentSourceGroupRule,data:2}}})}static updateFilter(e,t){if(!t)return;const s={name:{value:t.filter}};e.setState(s,!0)}}s.availableUserTypeFilterStates=[1,2],s.availableLicenseSourceFilterStates=[1,2],t.ComponentsHubUserHubPageFilterBar.UserHubPageFilterBar=function(e){const t=(0,ye.useUserHubConfiguration)(),n=i.useMemo(()=>new pe.Filter,[]),r=i.useRef(void 0),o=i.useMemo(()=>e.availableAccessLevelFilters?e.availableAccessLevelFilters.map(e=>({id:e.key,text:e.displayName,data:e})):[{id:"_loading",type:4}],[e.availableAccessLevelFilters]),a=e.filterState&&e.filterState.accessLevelsFilter,[l,c]=(0,g.useSelectedItems)(o,a&&a.filterItems,e.onSetAccessLevelsFilter,i.useCallback((e,t)=>!!e.data&&e.data.key===t.key,[]),i.useCallback(e=>e.data,[])),u=(0,g.useSelectionFactory)(()=>new S.DropdownMultiSelection,l,c),m=i.useMemo(()=>s.getUserTypeFilters(),[!(!e.filterState||!e.filterState.userTypeGuestFilter)]),d=e.filterState&&e.filterState.userTypeGuestFilter,[p,C]=(0,g.useSelectedItems)(m,d&&d.filterItems,e.onSetUserTypesFilter,i.useCallback((e,t)=>e.data===t,[]),i.useCallback(e=>e.data,[])),b=(0,g.useSelectionFactory)(()=>new S.DropdownMultiSelection,p,C),h=i.useMemo(()=>s.getLicenseSourceFilters(),[!(!e.filterState||!e.filterState.licenseSourceFilter)]),f=e.filterState&&e.filterState.licenseSourceFilter,[y,E]=(0,g.useSelectedItems)(h,f&&f.filterItems,e.onSetLicenseSourceFilter,i.useCallback((e,t)=>e.data===t,[]),i.useCallback(e=>e.data,[])),x=(0,g.useSelectionFactory)(()=>new S.DropdownMultiSelection,y,E),A=e.filterState&&e.filterState.nameFilter;return r.current!==e.filterState&&(s.updateFilter(n,A),r.current=e.filterState),i.useEffect(()=>{const t=()=>{const{onSetNameFilter:t,filterState:s}=e;if(!s)return;const r=n.getState(),{name:i}=r;t(i?i.value:void 0)};return n.subscribe(t),()=>{n.unsubscribe(t)}},[n]),i.createElement(me.FilterBar,{filter:n},i.createElement(de.KeywordFilterBarItem,{filterItemKey:"name",placeholder:e.isGroupRules?he.FilterBar_FilterRules:he.FilterBar_FilterUsers,inputClassName:Ae.L2ClassNames.userSearch,throttleWait:300}),i.createElement(v.DropdownFilterBarItem,{containerClassName:Ae.L2ClassNames.FilterItems.accesslevelPickList,className:Ae.L2ClassNames.FilterItems.accesslevels,filterItemKey:"accessLevel",items:o,selection:u,placeholder:he.HubColAccessLevel}),m&&!e.isGroupRules&&t.isAadAccount&&i.createElement(v.DropdownFilterBarItem,{containerClassName:Ae.L2ClassNames.FilterItems.usertypePickList,className:Ae.L2ClassNames.FilterItems.usertypes,filterItemKey:"userType",items:m,selection:b,placeholder:he.FilterPlaceholder_AadUserType}),h&&!e.isGroupRules&&t.useUpdatedSearchQuery&&e.hasGroupRules&&i.createElement(v.DropdownFilterBarItem,{containerClassName:Ae.L2ClassNames.FilterItems.licenseSourcePickList,className:Ae.L2ClassNames.FilterItems.licenseSource,filterItemKey:"licenseSource",items:h,selection:x,placeholder:he.HubColLicenseSource}))}}(),function(e){Ns=t.ComponentsHubTabsGroupsTab={},t.ComponentsHubTabsGroupsTab.GroupsTab=function(){const e=i.useContext(tt.GroupsContext);return e?i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(Is.UserHubPageFilterBar,{availableAccessLevelFilters:e.availableAccessLevelFilters,filterState:e.filterState,isGroupRules:!0,onSetAccessLevelsFilter:e.setAccessLevelsFilter,onSetNameFilter:e.setNameFilter,onSetUserTypesFilter:e.setUserTypesFilter,onSetLicenseSourceFilter:e.setLicenseSourcesFilter})),i.createElement("div",null,i.createElement(fs.GroupTableCard,null))):null}}(),function(e){Ps=t.ComponentsHubTabsUsersTab={},t.ComponentsHubTabsUsersTab.UsersTab=function(){const e=i.useContext(rt.UsersContext),t=i.useContext(tt.GroupsContext);return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(Is.UserHubPageFilterBar,{availableAccessLevelFilters:e.availableAccessLevelFilters,filterState:e.filterState,onSetAccessLevelsFilter:e.setAccessLevelsFilter,onSetNameFilter:e.setNameFilter,onSetUserTypesFilter:e.setUserTypesFilter,onSetLicenseSourceFilter:e.setLicenseSourcesFilter,hasGroupRules:t&&t.displayMembers&&t.displayMembers.length>0})),i.createElement("div",null,i.createElement(cs.UserCommandContextProvider,null,i.createElement(es.BulkUserCommandContextProvider,null,i.createElement(xs.UserTableCard,null),i.createElement(bs.UserCallouts,null),i.createElement(ls.BulkUserCallouts,null)))))}}(),function(e){Ms=t.ContextUsersContextClient={};class s{static getFilteredUsers(e,t){e=et.MembersClientContextProviderUtils.getFilteredMembers(e,t);const{userTypeGuestFilter:s,licenseSourceFilter:n}=t;return e&&n&&n.isActive&&(e=e.filter(e=>!e||n.matches(e))),e&&s&&s.isActive&&(e=e.filter(e=>!e||s.matches(e))),e}static sortUsersList(e,t){return et.MembersClientContextProviderUtils.getSortedMembers(e,t,We.User.userSortComparisonFunction)}}t.ContextUsersContextClient.UsersClientContextProvider=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),[r,o,a]=(0,Xe.useRefreshableMembersFetcherAndStore)(()=>n.shouldUseSearchApis?new rt.UsersFetcher(t,n):new rt.LegacyUsersFetcher(t,n),[t,n]),l=(0,et.useMembersClientContextProvider)(r,o,rt.UsersContextUtils.getInitialFilterState(),s.getFilteredUsers,s.sortUsersList),{upsert:c}=l,u=i.useCallback(async(e,s)=>{const r=await rt.UsersContextUtils.refreshUsers(t,n,e,s);return r.length>0&&c(r),r},[c,t]),m={availableAccessLevelFilters:l.availableAccessLevelFilters,allMembers:l.allMembers,refreshMembersList:a,displayMembers:l.displayMembers,fetchError:l.fetchError,filterState:l.filterState,sortState:l.sortState,setAccessLevelsFilter:l.setAccessLevelsFilter,setNameFilter:l.setNameFilter,setUserTypesFilter:l.setUserTypesFilter,setLicenseSourcesFilter:l.setLicenseSourcesFilter,setSort:l.setSort,isFetchDone:l.isDone,refreshUsers:u,upsert:c,deleteMembers:l.deleteItems,exportUsers:()=>rt.UsersContextUtils.exportUsers(t)};return i.createElement(rt.UsersContext.Provider,{value:m},e.children)}}(),function(e){Ls=t.ContextUsersContextServer={},t.ContextUsersContextServer.UsersServerContextProvider=function(e){const t=(0,ye.useUserHubContext)(),s=(0,ye.useUserHubConfiguration)(),{filterState:n,setAccessLevelsFilter:r,setNameFilter:o,setUserTypesFilter:a,setLicenseSourcesFilter:l}=(0,Xe.useMembersFilter)(rt.UsersContextUtils.getInitialFilterState()),[c,u]=i.useState({sortByKey:"displayName",sortOrder:0}),[m,d,p]=(0,Xe.useRefreshableMembersFetcherAndStore)(()=>s.shouldUseSearchApis?new rt.UsersFetcher(t,s,n,c):new rt.LegacyUsersFetcher(t,s,n,c),[t,n,c,s.shouldUseSearchApis]),g=(0,Xe.useMembersFetcher)(m,d),{deleteItems:C,isDone:b,fetchNext:v,value:h}=g,[f,y]=(0,ae.useAsyncAction)(async()=>{try{await v()}catch(e){throw t.telemetry.trackException(e,"UsersServerContextProvider.fetchNextBatch"),e}}),S=i.useCallback(async(e,n)=>{const r=await rt.UsersContextUtils.refreshUsers(t,s,e,n);return r.length>0&&p(),r},[t,p]),E=i.useContext(xe.UsersSummaryContext),x={availableAccessLevelFilters:i.useMemo(()=>E.licenses&&Xe.MemberFilterStateBuilder.getAvailableAccessLevelFilters(E.licenses,s.useUpdatedSearchQuery),[E.licenses]),allMembers:h,displayMembers:h,fetchError:f&&f.error,filterState:n,sortState:c,refreshMembersList:p,refreshUsers:S,fetchNextBatch:b?void 0:y,isFetchDone:b,exportUsers:()=>rt.UsersContextUtils.exportUsers(t),setAccessLevelsFilter:r,setNameFilter:o,setUserTypesFilter:a,setLicenseSourcesFilter:l,setSort:u,upsert:p,deleteMembers:s.shouldUseSearchApis?C:p};return i.createElement(rt.UsersContext.Provider,{value:x},e.children)}}(),function(e){Ds=t.ComponentsHubUserHubPage={};class s{static getStyles(){return{content:(0,y.css)((0,b.getSpacingClassName)("padding","x",20),(0,b.getSpacingClassName)("padding","bottom",20),(0,b.getSpacingContainerClassName)("y",20)),tabContent:(0,y.css)((0,b.getSpacingContainerClassName)("y",20)),notificationMessageCard:(0,y.css)((0,b.getSpacingClassName)("padding","x",20),(0,b.getSpacingClassName)("padding","top",20))}}}__decorate([o.memoize],s,"getStyles",null),t.ComponentsHubUserHubPage.UserHubPage=function(){const[e,t]=i.useState("all-users"),n=i.useContext(tt.GroupsContext),r=i.useContext(rt.UsersContext),o=s.getStyles(),{isAdmin:a}=(0,ye.useUserHubConfiguration)();(0,As.useReEvaluateRulesNotification)(),(0,Ts.useSummaryPendingTotalChangesNotification)(),(0,Rs.useUserHubConfigurationErrorNotification)();const l=(0,ye.useUserHubContext)();return i.useEffect(()=>{l.perfRef.current.markRenderComplete()},[]),i.createElement(W.Surface,{background:1},i.createElement(be.Page,{className:(0,y.css)(B.CssClassNames.flex.auto,Ae.L2ClassNames.userManagementHub)},i.createElement(Us.UserHubNotificationsSummaryCard,{className:o.notificationMessageCard}),i.createElement(ge.Header,{title:he.HubSummary_Users,titleSize:1}),i.createElement("div",{className:o.content},i.createElement(oe.TabBar,{onSelectedTabChanged:e=>{t(e)},selectedTabId:e,renderAdditionalContent:a?()=>{const e=[{id:"export",iconProps:{iconName:"Download"},text:he.ContextualMenuOptionExportCSV,onActivate:()=>r.exportUsers()}];return i.createElement(Ce.HeaderCommandBar,{items:e})}:void 0},i.createElement(oe.Tab,{name:he.TabLabel_AllUsers,id:"all-users"}),n&&i.createElement(oe.Tab,{name:he.TabLabel_Groups,id:"group-rules"})),i.createElement("div",{className:o.tabContent},"all-users"===e&&i.createElement(Ps.UsersTab,null),"group-rules"===e&&i.createElement(Ns.GroupsTab,null),i.createElement(Xt.GroupCallouts,null)))))}}(),function(e){Fs=t.ComponentsHubUserHub={};class s{}s.emptyTabProviderContext={selectedId:void 0,tabs:[],commandBarItems:[],renderContent:void 0,renderFilterBar:void 0},t.ComponentsHubUserHub.UserHub=function(){const e=(0,ye.useUserHubConfiguration)(),t=e.shouldUseServerSideSearch?Ls.UsersServerContextProvider:Ms.UsersClientContextProvider;return i.createElement(oe.TabProviderContext.Provider,{value:s.emptyTabProviderContext},i.createElement(qe.UserHubNotificationsContextProvider,null,i.createElement(xe.UsersSummaryContextProvider,null,i.createElement(t,null,i.createElement(Ss.BillingContextProvider,null,e.isAdmin?i.createElement(tt.GroupsContextProvider,null,i.createElement(Rt.LicensingRulesContextProvider,null,i.createElement(Ft.GroupCommandContextProvider,null,i.createElement(Ds.UserHubPage,null)))):i.createElement(Ds.UserHubPage,null))))))}}(),function(e){t.EntryPointsInviteUserContextProvider={};class s{}function n(){const e=i.useContext(qe.UserHubNotificationsContext),[t,s]=(0,Us.useShowUserHubNotificationsPanel)(e),{sortedMessageIds:n}=i.useMemo(()=>Je.NotificationUtils.summarizeNotifications(e.notifications),[e.notifications]);return t?i.createElement(Us.UserHubNotificationsPanel,{persistentIds:[],notifications:e.notifications,messageIds:n,onDismiss:()=>s(!1),dismissAllNotifications:e.dismissAllNotifications,dismissNotification:e.dismissNotification}):null}function r(e){const[t,s]=i.useState(!1),{pageContext:r}=(0,a.useComponentContext)(),o=i.useRef(new ve.PerfUtil(r,"ms.vss-aex-user-management.user-hub.invite-user-context."));return i.createElement(ye.UserHubContextProvider,{telemetryArea:"Microsoft.VisualStudio.Services.UserManagement",telemetryFeature:"UserHub",perfRef:o},i.createElement(qe.UserHubNotificationsContextProvider,null,i.createElement(xe.UsersSummaryContextProvider,{summarykeys:"defaultAccessLevel"},i.createElement(Ss.BillingContextProvider,null,t&&i.createElement(Dt.AddUsersToProjectPanel,{projectOrTeamDisplayName:e.projectOrTeamDisplayName,projectId:e.projectId,teamId:e.teamId,onDismiss:()=>{s(!1)},onUsersAdded:e.onUsersAdded}),i.createElement(n,null)))),i.createElement(e.context.Provider,{value:{onFlowStart:()=>{s(!0)}}},e.children))}s.componentType="inviteUserContextProvider",t.EntryPointsInviteUserContextProvider.InviteUserContextProvider=r,a.VssComponent.register(s.componentType,r)}(),function(e){function s(e){const{pageContext:t}=(0,a.useComponentContext)(),s=i.useRef(new ve.PerfUtil(t,"ms.vss-aex-user-management.user-hub.management-hub."));return s.current.markRenderStart(),i.createElement(ye.UserHubContextProvider,{telemetryArea:e.telemetryArea||"Unknown",telemetryFeature:e.telemetryFeature||"Unknown",perfRef:s},i.createElement(Fs.UserHub,null))}t.EntryPointsManagementHub={},t.EntryPointsManagementHub.ManagementHub=s,a.VssComponent.register("ms.vss-aex-user-management.user-hub.management-hub",s)}()},["Resources","Components/Common/common","Generated/Constants","Context/UserHubContext","Components/Controls/useTrackedAsyncCallback","RestClient/MemberEntitlementManagement","Context/UsersSummaryContexts","Constants","Models/GroupOption","Components/Hub/Forms/ProjectForms","Components/Hub/Callouts/AddMember/useAddMemberFields","Models/UserIdentityPickerProvider","Components/Hub/Callouts/AddMember/useUserIdentityPicker","Models/AccessLevel","Models/Member","Utils/ObjectUtils","Utils/PromiseUtils","Utils/BatchUtils","Utils/JsonBatchUtils","Utils/MemberEntitlementJsonPatchBuilder","Models/Group","Utils/TableUtils","Components/Controls/FlexCenterBlock","Components/Controls/Tooltip.GroupMembership","Components/Hub/Callouts/EditMember/ProjectsForm","Components/Hub/Callouts/EditMember/useEditMemberInput","Components/Hub/Callouts/EditMember/useRefreshedMember","Components/Controls/GenericErrors","Context/NotificationContexts","Models/User","RestClient/Invitation","Components/Hub/Callouts/ResendUserInvitation","Components/Hub/Notifications/NotificationUtils","Utils/PatchResponseUtils","Components/Hub/Notifications/PatchResponseNotifications","Components/Hub/UserHubPage.Common","Context/CommandContext","Models/UserManagementFilters","Context/MembersContext","Context/MembersContext.Client","Context/GroupsContext","RestClient/MEMInternal","RestClientLegacy/MemberEntitlementManagement","Context/UsersContext","Context/useGroupsContextApiActions","Generated/Interfaces","Models/GroupIdentityPickerProvider","Models/LicensingRule.ApplicationStatus","Models/ProjectEntitlement","Models/UserEntitlement","RestClient/AzComm","RestClient/Core","RestClient/LicensingRule","Utils/DateUtils","Utils/FocusUtils","Components/Controls/AccessLevelDropdown","Components/Controls/FlexDividerCell","Components/Controls/AccessLevelDropdown.GroupAssignments","Components/Controls/CommonCallout","Components/Controls/CommonDialog","Components/Controls/CommonPanel","Components/Controls/IdentityPickers","Components/Controls/Notifications","Components/Controls/Persona","Components/Controls/StatusMessageCard","Components/Controls/TableCells","Components/Controls/TextFieldWithCopy","Context/LicensingRulesContext","Utils/IdentityUtils","Components/Hub/Notifications/BulkStatusTree","Components/Hub/Notifications/MemberOperationStatusNotifications","Components/Hub/Callouts/AddMember/AddGroupPanel","Components/Hub/Callouts/AddMember/AddUsersToCollection","Components/Hub/Callouts/BulkStatus","Components/Hub/Callouts/BulkStatus.Member","Components/Hub/Callouts/AddMember/AddUsersToProject","Context/CommandContext.Group","Components/Hub/Callouts/EditMember/EditMemberNotifications","Components/Hub/Callouts/EditMember/AccessLevelForm","Components/Hub/Callouts/EditMember/MemberPersona","Components/Hub/Callouts/EditMember/EditMemberPanel.AccessLevel","Components/Hub/Callouts/EditMember/EditMemberPanelTabGroup","Components/Hub/Callouts/EditMember/EditMemberPanel","Components/Hub/Callouts/EditMember/useEditGroup","Components/Hub/Callouts/EditMember/EditGroupPanel","Components/Hub/Callouts/EditMember/EditGroupForm.EditMembershipBar","Components/Hub/Callouts/EditMember/EditGroupForm.AddMembers","Components/Hub/Callouts/EditMember/EditGroupForm.RemoveMembers","Components/Hub/Callouts/EditMember/GroupMembersTable","Components/Hub/Callouts/EditMember/EditGroupPanel.ManageMembers","Components/Hub/Callouts/ReEvaluateRulesDialog","Components/Hub/Callouts/RemoveMember/RemoveMemberDialog","Components/Hub/Callouts/RemoveMember/RemoveGroupDialog","Components/Hub/Forms/ExtensionForms","Components/Hub/Callouts/ResolveGroupsDialog","Components/Hub/Callouts/Callouts.Group","Context/CommandContext.User.Bulk","Components/Hub/Callouts/EditUserBulk/Common","Components/Hub/Callouts/EditUserBulk/AddToProjectsPanel","Components/Hub/Callouts/EditUserBulk/ChangeAccessLevelPanel","Components/Hub/Callouts/RemoveMember/RemoveUserDialog","Components/Hub/Callouts/EditUserBulk/RemoveFromAccountDialog","Components/Hub/Callouts/EditUserBulk/RemoveFromProjectsPanel","Components/Hub/Callouts/RemoveMember/RemoveDirectAssignmentsDialog","Components/Hub/Callouts/Callouts.User.Bulk","Context/CommandContext.User","Components/Hub/Callouts/EditMember/EditUserPanel.AccessLevel","Components/Hub/MemberList/MemberTable","Components/Hub/MemberList/MemberTable.Columns","Components/Hub/Callouts/EditMember/GroupEntitlementsForm","Components/Hub/Callouts/EditMember/EditUserPanel","Components/Hub/Callouts/EditMember/ReinstateAssetsDialog","Components/Hub/Callouts/Callouts.User","Components/Hub/MemberList/GroupTable","Components/Hub/MemberList/MembersTableCard","Components/Hub/MemberList/GroupTableCard","Components/Hub/MemberList/UserTable","Context/BillingContext","Components/Hub/Summary/UsersSummaryPanel","Components/Hub/MemberList/UserTableCard","Components/Hub/Notifications/useReEvaluateRulesNotification","Components/Hub/Notifications/UserHubNotificationsCard","Components/Hub/Notifications/useSummaryPendingTotalChangesNotification","Components/Hub/Notifications/useUserHubConfigurationErrorNotification","Components/Hub/UserHubPage.FilterBar","Components/Hub/Tabs/GroupsTab","Components/Hub/Tabs/UsersTab","Context/UsersContext.Client","Context/UsersContext.Server","Components/Hub/UserHubPage","Components/Hub/UserHub","EntryPoints/InviteUserContextProvider","EntryPoints/ManagementHub"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-aex-user-management.user-hub-content"}}));