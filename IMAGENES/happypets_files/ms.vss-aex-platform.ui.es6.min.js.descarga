"use strict";define("Aex/Platform/UI",["require","exports","Aex/Platform/Telemetry/AexTelemetry","Aex/Platform/Telemetry/Constants","VSS/Core/Util/Memoize","VSS/Platform/Location","Aex/Platform/Utils/useAsyncAction","react","Aex/Platform/Utils/useDependentState","Aex/Platform/Utils/useMemoizedResultCallback","Aex/Platform/Utils/useAsyncState","VSSUI/Utilities/Selection"],function(e,t,o,r,n,i,s,a,l,c,u,f){var d,g;!function(e){t.ContextsAexPageContextService={};t.ContextsAexPageContextService.AexPageContextService=class{constructor(e,t,s,a){this.pageContext=e,this.getCurrentRoute=(0,n.memoizeFunction)(()=>this.pageContext.getService("IVssNavigationService").getCurrentRoute()),this.getPageData=(0,n.memoizeFunction)(()=>this.pageContext.getService("IVssPageService").getData()),this.getPageUserData=(0,n.memoizeFunction)(()=>{const e=this.getPageData();if(e)return e.user}),this.getService=(0,n.memoizeFunction)(e=>this.pageContext.getService(e)),this.getRestClient=(0,n.memoizeFunction)((e,t)=>this.pageContext.getRestClient(e,t)),this.getNamedAuthenticationTokenProvider=(0,n.memoizeFunction)(e=>this.pageContext.getService("IAuthenticationService").getNamedTokenProvider(e)),this.isFeatureEnabled=(0,n.memoizeFunction)((e,t)=>{if(!t)try{const t=localStorage.getItem(e);if("true"===t)return!0;if("false"===t)return!1}catch(e){}return this.pageContext.getService("IVssFeatureService").isFeatureEnabled(e)}),this.isFeatureFlagEnabled=(0,n.memoizeFunction)(e=>this.pageContext.getService("IVssFeatureService").isFeatureFlagEnabled(e)),this.getAssetLocation=(0,n.memoizeFunction)(e=>(0,i.getAssetLocation)(this.pageContext,e)),this.getServiceLocation=(0,n.memoizeFunction)((e,t)=>(0,i.getServiceLocation)(this.pageContext,e,t)),this.getRestClientOptions=(0,n.memoizeFunction)((e,t,o)=>({hostType:t,rootPath:o,authTokenProvider:e})),this.getCrossServiceRestClientOptions=this.getRestClientOptions;const l=e.getService(r.ServiceName.IAexTelemetryService);let c;if(a){c=[];for(const e of a){const t=this.isFeatureEnabled(e),o=this.isFeatureEnabled(e,!0);if(t===o&&t)c.push(e);else if(t!==o){const o=e+"!"+(t?"+":"-");c.push(o)}}}this.telemetry=new o.AexTelemetry(l,t,s,c)}getCrossServiceRestClient(e,t,o,r){return this.getRestClient(e,this.getCrossServiceRestClientOptions(t,o,r))}}}(),function(e){t.ContextsFormWorkflow={},t.ContextsFormWorkflow.useAsyncFormWorkflow=function(e,t,o){const r=a.useCallback(async(r,n)=>{let i=t(r,n);if(void 0!==i){if(o){const e=await o(i,n);if(!e)return;i=e}return e(i,n)}},[e,t,o]);return(0,s.useAsyncAction)(r)}}(),function(e){t.UtilCollectionDataStore={};t.UtilCollectionDataStore.CollectionDataStore=class{constructor(e,t=[]){this.getKey=e,this.initialValue=t,this.dataLog=[],this.reconciledValue=t}get value(){return this.reconcile()}clear(){this.dataLog.length=0,this.reconciledValue=this.initialValue}upsert(e){this.dataLog.push([0,e])}deleteItems(e){this.dataLog.push([1,e])}reconcile(){if(0===this.dataLog.length)return this.reconciledValue;let e=0;const t={};for(;this.dataLog.length>0;){const o=this.dataLog.shift();if(!o)break;const[r,n]=o;if(0===r){const o=n;for(const r of o)t[this.getKey(r)]=[0,[r,e++]]}else if(1===r){const e=n;for(const o of e)t[o]=[1,void 0]}}const o=[];for(const e of this.reconciledValue){const r=this.getKey(e),n=t[r];if(n){const[e,i]=n;0===e&&o.push(i[0]),delete t[r]}else o.push(e)}const r=[];for(const e in t)if(t[e]){const[o,n]=t[e];0===o&&r.push(n)}return r.sort((e,t)=>e[1]-t[1]),o.push(...r.map(e=>e[0])),this.reconciledValue=o,this.reconciledValue}}}(),function(e){t[e]={};const o=new class{next(){return Promise.resolve({done:!0,value:void 0})}};function r(e,t){const[o,r]=(0,l.useAsyncDependentState)(void 0,[e]),[n,i]=(0,l.useAsyncDependentState)(t.value,[t]),s=(0,a.useCallback)(e=>{t.upsert(e),i(t.value)},[t,i]),u=(0,a.useCallback)(e=>{t.deleteItems(e),i(t.value)},[t,i]);let f,d=!1;o&&(o.done?d=!0:f=o.value[2]);const g=(0,a.useCallback)(async t=>{const o=await e.next(t);r(o),o.value&&s(o.value[0])},[e,r,s]),m=o&&(o.done?void 0:o.value[1]),h=(0,c.useMemoizedResultCallback)(()=>g(m),[g,m]);return{value:n,upsert:s,deleteItems:u,isDone:d,fetchNext:h,extraYield:f}}t[e].useContinuationTokenCollectionDataIterator=r,t[e].useNullableContinuationTokenCollectionDataIterator=function(e,t){const n=r(e||o,t);return e?n:{isDone:!0,fetchNext:()=>Promise.resolve(void 0),extraYield:void 0,value:[],upsert:()=>void 0,deleteItems:()=>void 0}},t[e].useContinuationTokenCollectionDataIteratorAutoLoadingEffect=function(e,t,o){(0,a.useEffect)(()=>{e||t().catch(e=>{if(!o)throw e;o(e)})},[e,t])}}("HooksuseCollectionDataIterator"),function(e){t.HooksuseContributionData={},t.HooksuseContributionData.useContributionData=function(e,t,o){const r=(0,a.useMemo)(()=>e.getService("IVssContributionService"),[e]),[n,i]=(0,u.useAsyncState)(()=>r.getData(o)),[s,l]=(0,u.useAsyncState)(void 0),c=void 0!==n,f=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{c||f.current||(f.current=!0,(async()=>{try{const r=await e.getService("IVssContributionService").getDataAsync(o);if(void 0===r)throw new Error(`Fetched undefined contribution data for data provider: ${o}`);i(r)}catch(e){if(!t)throw e;t.trackException(e),l(e)}})())},[c,f.current]),[n,s]}}(),function(e){t.HooksuseMutableCallback={},t.HooksuseMutableCallback.useMutableCallback=function(e,t){const o=(0,a.useCallback)(e,t),r=(0,a.useRef)(o);return r.current=o,(0,a.useCallback)((...e)=>r.current(...e),[])}}(),function(e){function o(e,t,o,r=[]){return(0,a.useEffect)(()=>{(0,f.compareSelectionRanges)(e.value,t).length>0&&(e.clear(),e.value=t),(0,f.compareSelectionRanges)(e.unselectableRanges,r).length>0&&(e.unselectableRanges=r);const n=()=>{o(e.value)};return e.subscribe(n),()=>{e.unsubscribe(n)}}),e}function r(e,t,o){const r=[];if(!t||!e)return r;let n;return e.forEach((e,i)=>{for(const s of t)if(o(e,s)){!n||i-n.endIndex>1?(n&&r.push(n),n={beginIndex:i,endIndex:i}):n.endIndex=i;break}}),n&&r.push(n),r}function n(e,t,o){return(0,a.useMemo)(()=>r(e,t,o),[e,t,o])}function i(e,t,o){if(!e)return;const r=[];for(const n of t)for(let t=n.beginIndex;t<=n.endIndex;++t){const n=o(e[t]);void 0!==n&&r.push(n)}return r}function s(e,t,o,r,s){const l=n(e,t,r),c=(0,a.useCallback)(t=>{const r=i(e,t,s);void 0!==r&&o(r)},[e,o,s]),u=(0,a.useMemo)(()=>i(e,l,s),[e,t,l,s]);return[l,c,u]}t.HooksuseSelection={},t.HooksuseSelection.useSelection=o,t.HooksuseSelection.useSelectionFactory=function(e,t,r,n=[]){return o((0,a.useMemo)(()=>e(),[]),t,r,n)},t.HooksuseSelection.getSelectionRanges=r,t.HooksuseSelection.useSelectionRanges=n,t.HooksuseSelection.onGetSelfValue=function(e){return e},t.HooksuseSelection.useSelectedItems=s,t.HooksuseSelection.useSingleSelectedItem=function(e,t,o,r,n){const i=(0,a.useMemo)(()=>{if(void 0!==t)return[t]},[t]),l=(0,a.useCallback)(e=>{o(e[0])},[o]),[c,u]=s(e,i,l,r,n);return[c,u]}}(),function(e){d=t.UtilExceptions={},t.UtilExceptions.getTypeKey=function(e){const t=e;if(t.serverError)return t.serverError.typeKey},t.UtilExceptions.getErrorStatus=function(e){const t=e;if("number"==typeof t.status)return t.status},t.UtilExceptions.getCustomProperties=function(e){const t=e;if(t.serverError)return t.serverError.customProperties}}(),function(e){t.ModelsHandledError={};t.ModelsHandledError.HandledError=class{constructor(e,t,o=!1){this.isUserError=t,this.showErrorMessage=o,this.error="string"==typeof e?new Error(e):e,void 0===t&&"string"!=typeof e&&(this.statusCode=(0,d.getErrorStatus)(e),this.typeKey=(0,d.getTypeKey)(e),void 0!==this.statusCode&&this.statusCode>=400&&this.statusCode<500&&(this.isUserError=!0,this.showErrorMessage=!0))}get message(){return this.error.message}getCustomProperties(){return(0,d.getCustomProperties)(this.error)}}}(),g=t.StylingCommon={},t.StylingCommon.prefix="aex-",function(e){t.StylingColorClassNames={},t.StylingColorClassNames.BackgroundColorClassNames={default:"background-color-default",communicationBackground:"background-color-communication-background",neutral2:"background-color-neutral-2",statusInfoBackground:"background-color-status-info-background",statusErrorBackground:"background-color-status-error-background"},t.StylingColorClassNames.ColorClassNames={primaryText:g.prefix+"color-primary-text",secondaryText:g.prefix+"color-secondary-text",textOnCommunicationBackground:"color-text-on-communication-background",communicationForeground:"color-communication-foreground",white:"color-white",statusErrorForeground:"color-status-error-foreground"},t.StylingColorClassNames.getColorClassName=function(e,t,o="color"){return`${g.prefix}${o}-${e}-${t}`}}(),t.StylingCoreClassNames={},t.StylingCoreClassNames.FontClassNames={fontWeightNormal:"fontWeightNormal",fontWeightSemiBold:"fontWeightSemiBold",fontWeightHeavy:"fontWeightHeavy",fontSizeS:"fontSizeS",fontSizeDefault:"fontSize",fontSizeM:"fontSizeM",fontSizeMm:"fontSizeMM",fontSizeL:"fontSizeL",fontSizeLl:"fontSizeLL",fontSizeXl:"fontSizeXL",fontSizeXxl:"fontSizeXXL"},t.StylingCoreClassNames.TypographyClassNames={titleS:"title-s"},t.StylingCoreClassNames.FlexClassNames={flexRow:"flex-row",flexColumn:"flex-column",flexGrow:"flex-grow",alignItemsBaseline:"flex-baseline",alignItemsCenter:"flex-center",alignItemsFlexStart:"flex-start",alignItemsFlexEnd:"flex-end",alignItemsStretch:"flex-stretch",alignSelfCenter:"flex-self-center",alignSelfStretch:"flex-self-stretch",justifyContentCenter:"justify-center",justifyContentFlexEnd:"justify-end"},t.StylingCoreClassNames.TextClassNames={ellipsis:"text-ellipsis",alignCenter:"text-center",alignRight:"text-right"},t.StylingCoreClassNames.LayoutClassNames={overflowAuto:"scroll-auto",overflowHidden:"scroll-hidden",overflowYAuto:"v-scroll-auto",overflowXAuto:"h-scroll-auto"},t.StylingCssClassNames={},t.StylingCssClassNames.CssClassNames={background:{position:{leftBottom:g.prefix+"background-position-left-bottom"},repeat:{noRepeat:g.prefix+"background-repeat-no-repeat"}},border:{top:{style:{solid:g.prefix+"border-top-style-solid"},width1:g.prefix+"border-top-width-1"},radius50:g.prefix+"border-radius-50"},display:{inlineFlex:g.prefix+"display-inline-flex"},flex:{auto:g.prefix+"flex-auto",none:g.prefix+"flex-none"},flexShrink1:g.prefix+"flex-shrink-1",jusitfyContent:{spaceAround:g.prefix+"justify-content-space-around",spaceBetween:g.prefix+"justify-content-space-between"},whiteSpace:{normal:g.prefix+"white-space-normal"}},t.StylingSizing={},t.StylingSizing.SizeClassNames={width100:g.prefix+"width-100",width50:g.prefix+"width-50",height100:g.prefix+"height-100"},function(e){t.StylingSpacing={},t.StylingSpacing.getSpacingContainerClassName=function(e,t){return`${g.prefix}spacing-container-${e}-${t}`},t.StylingSpacing.getSpacingClassName=function(e,t,o){const r="all"===t?"":"-"+t;return`${g.prefix}${e}${r}-${o}`}}(),function(e){t.UtilPerfUtil={};class o{constructor(e,t){this.eventPrefix=t,this.isRenderCompleteMarked=!1,this.isInteractiveMarked=!1,this.perfService=e.getService("IVssPerformanceService")}markRenderStart(){if(!this.renderScenario){const e=this.eventPrefix+o.renderScenario;this.renderScenario=this.perfService.startScenario(e,!0)}return this.renderScenario}markRenderComplete(){if(!this.isRenderCompleteMarked){const e=this.eventPrefix+o.renderScenario;this.perfService.addSplitTiming(o.renderCompleteTiming,e),this.isRenderCompleteMarked=!0}}markInteractive(){this.renderScenario&&!this.isInteractiveMarked&&(this.renderScenario.complete(),this.isInteractiveMarked=!0)}}t.UtilPerfUtil.PerfUtil=o,o.renderScenario="render",o.renderCompleteTiming="renderComplete"}(),function(e){t.UtilUrl={},t.UtilUrl.urlSearchParamsGet=function(e,t){const o=e.find(e=>e.name===t);return o&&o.value||null},t.UtilUrl.urlSearchParamsAppend=function(e,t,o){e.push({name:t,value:o})}}(),function(e){t.ComponentsTemplateString={};t.ComponentsTemplateString.TemplateString=class extends a.Component{constructor(){super(...arguments),this.parseTemplate=(0,n.memoizeFunction)(e=>{const t=e.split(/{\d+}/m),o=e.match(/{\d+}/gm),r=[];for(let e=0;e<t.length-1;++e){const n=t[e];if(r.push({isPlaceholder:!1,stringPart:n}),o&&o[e]){const t=o[e].match(/\d+/);if(t){const e=parseInt(t[0],void 0);r.push({isPlaceholder:!0,placeholderId:e})}}}return r.push({isPlaceholder:!1,stringPart:t[t.length-1]}),r})}render(){const e=a.Children.toArray(this.props.children),t=this.parseTemplate(this.props.template).map(t=>t.isPlaceholder?e[t.placeholderId]:t.stringPart);return a.createElement(a.Fragment,null,...t)}},t.ComponentsTemplateString.TemplateJoinedString=function(e){const t=a.useMemo(()=>a.Children.toArray(e.children),[e.children]);let o=!1;return a.createElement(a.Fragment,null,t.map((t,r)=>{if(null!=t&&!1!==t)return o?a.createElement(a.Fragment,{key:r},e.delimiter,t):(o=!0,a.createElement(a.Fragment,{key:r},t))}))}}(),function(e){t[e]={},t[e].GeneralErrorContext=a.createContext({error:void 0,setError:()=>void 0});t[e].GeneralErrorContextProvider=class extends a.Component{constructor(e){super(e),this.getMemoizedValue=(0,n.memoizeFunction)(e=>({error:e,setError:this.setError})),this.setError=(e=>{"function"==typeof e?this.setState(t=>({error:e(t.error)})):this.setState({error:e})}),this.state={error:void 0}}componentDidCatch(e,t){this.props.telemetry.trackException(e,"GeneralErrorContextProvider",{componentStack:t.componentStack}),this.setError([e,t])}render(){return a.createElement(t[e].GeneralErrorContext.Provider,{value:this.getMemoizedValue(this.state.error)},this.props.children)}},t[e].useGeneralError=function(){return a.useContext(t[e].GeneralErrorContext).error}}("ContextsGeneralErrorContext")},["Contexts/AexPageContextService","Contexts/FormWorkflow","Util/CollectionDataStore","Hooks/useCollectionDataIterator","Hooks/useContributionData","Hooks/useMutableCallback","Hooks/useSelection","Util/Exceptions","Models/HandledError","Styling/Common","Styling/ColorClassNames","Styling/CoreClassNames","Styling/CssClassNames","Styling/Sizing","Styling/Spacing","Util/PerfUtil","Util/Url","Components/TemplateString","Contexts/GeneralErrorContext"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-aex-platform.ui"}}));