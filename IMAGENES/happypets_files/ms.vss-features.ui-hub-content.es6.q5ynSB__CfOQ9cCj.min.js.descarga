"use strict";define("VSSUI",["require","exports","react","OfficeFabric/Callout","OfficeFabric/Button","OfficeFabric/FocusZone","OfficeFabric/Link","OfficeFabric/ResizeGroup","OfficeFabric/Utilities","VSS/Core/Util/Object","VSS/Core/Observable","OfficeFabric/ContextualMenu","OfficeFabric/Icon","OfficeFabric/Slider","OfficeFabric/Toggle","OfficeFabric/CommandBar","OfficeFabric/Dropdown","OfficeFabric/Fabric","VSS/Platform/Layout"],function(e,t,i,s,o,r,n,a,c,l,d,m,p,h,u,b,v,P,g){var _,I,B,f,k,C,y,w,S,x,O,E,A,V,L,T;!function(e){_=t.ComponentsVssBreadcrumbVssBreadcrumb={};const d=4;class m extends c.BaseComponent{constructor(e){super(e),this._onPositioned=(()=>{this._pickList.focus()}),this._onDismiss=(()=>{this.closeDropdown()}),this.state={calloutIsVisible:!1,itemPicker:e.item.itemPicker,events:this._events,updateDelegate:()=>this.forceUpdate()}}render(){const{getPinElement:e,item:o,width:r,minWidth:n,maxWidth:a,maxHeight:c,pickListClassName:l}=this.props;if(this.state.calloutIsVisible){const d=o.itemPicker;return i.createElement(s.Callout,{isBeakVisible:!1,target:e(),onPositioned:this._onPositioned,onDismiss:this._onDismiss},i.createElement(t.PickList.PickList,{className:(0,t.Util.css)("picker-dropdown",l),ref:e=>this._pickList=e,getActions:()=>d.actions,getListItem:d.getListItem,groups:d.groups,pivots:d.pivots,indicators:d.dropdownIndicators,initiallySelectedItems:d.selectedItem?[d.selectedItem]:void 0,isSearchable:d.isSearchable,items:d.getItems(),searchResultsLoadingText:d.searchResultsLoadingText,noItemsText:d.noItemsText,itemAriaDescription:d.itemAriaDescription,searchNoResultsText:d.searchNoResultsText,searchResultsGroupName:d.searchResultsGroupName,searchTextPlaceholder:d.searchTextPlaceholder,shouldVirtualize:e=>(e||[]).length>50,width:r,minWidth:n,maxWidth:a,maxHeight:c,onFocusLost:this._onDismiss,onSearch:d.onSearch,onSelectionChanged:o.onSelectionChanged,onRenderItemText:d.onRenderItemText,onSelectedPivotChanged:d.onSelectedPivotChanged}))}return null}componentDidMount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&(this.props.item.itemPicker,this._events.on(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}componentWillUnmount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate)}componentWillReceiveProps(e){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this.props.item.itemPicker!==e.item.itemPicker&&(this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate),this._events.on(e.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}openDropdown(){this.props.onPickListOpened&&this.props.onPickListOpened(),this.setState({calloutIsVisible:!0})}closeDropdown(){this.setState({calloutIsVisible:!1}),this.props.onPickListClosed&&this.props.onPickListClosed()}toggleDropdown(){this.state.calloutIsVisible?this.closeDropdown():this.openDropdown()}}class p extends i.Component{constructor(e){super(e),this._pinElements={},this._linkElements={},this._breadcrumbElements={},this._focusedLinkIndex=-1,this._onItemClick=(e=>{this.setState({pickerItemKey:e.key},()=>{this.pickList&&this.pickList.toggleDropdown()})}),this.onRenderItem=((e,s)=>{const{presentationStyles:o,shouldUseFocusZone:r}=this.props,{pickerItemKey:a}=this.state,c=Object.assign({},e);delete c.onClick,delete c.href;const d=this._getIcon(e.leftIconProps),m=s(c),p=m.props&&m.props.className;let h=1&o?"vss-Breadcrumb--itemText-small":"vss-Breadcrumb--itemText vss-HubBreadcrumb--itemText";h=(0,t.Util.css)(h,"ellipsis-text",!!(2&o)&&"vss-Breadcrumb--light");const u=Object.assign(Object.assign({},m.props),{className:(0,t.Util.css)(p,h),style:m.props.style?Object.assign({},m.props.style):{}});this.props.maxItemWidth&&(u.style.maxWidth=this.props.maxItemWidth);const b=i.cloneElement(m,u),v=r?0:-2,P=(0,l.getId)("vss-breadcrumb-item-described-by");if(e.isHeaderPickerItem&&e.itemPicker){const s=!e.nonInteractive&&!!(8&o);let c;return e.nonInteractive||(c=this._onItemClick.bind(this,e)),i.createElement("div",{ref:t=>{t&&(this._pinElements[e.key]=t,this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!c&&"no-click",!!(16&o)&&"vss-Breadcrumb--item-min-height")},i.createElement(n.Link,{key:"BreadcrumbItem$"+e.key,componentRef:t=>{t&&(this._linkElements[e.key]=t)},onClick:c,href:e.href,"aria-haspopup":!0,"aria-expanded":this.state.pickerIsOpen,"aria-label":e.ariaLabel,"aria-describedby":(0,t.Util.getSafeId)(P),tabIndex:v,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer vss-HubBreadcrumb--itemContainer"},d,i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:e.text},b),s&&this._getBreadcrumbIcon(e)),i.createElement("div",{id:(0,t.Util.getSafeId)(P),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription)),a&&a===e.key&&this._renderPickerDropdown(e),this._getIndicators(e))}return e.onClick||e.href?i.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&o)&&"vss-Breadcrumb--item-min-height")},i.createElement(n.Link,{componentRef:t=>{t&&(this._linkElements[e.key]=t)},key:"BreadcrumbItem$"+e.key,onClick:e.onClick,href:e.href,"aria-label":e.ariaLabel,"aria-describedby":(0,t.Util.getSafeId)(P),tabIndex:v,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer"},d,b),i.createElement("div",{id:(0,t.Util.getSafeId)(P),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription))):i.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&o)&&"vss-Breadcrumb--item-min-height"),"aria-label":e.ariaLabel},d,b)}),this._onLinkFocus=(e=>{this._focusedLinkIndex<0&&(this._focusedLinkIndex=(0,c.findIndex)(this.state.linkItems,t=>t.key===e))}),this._getCustomDivider=(e=>{const s=e.item,{presentationStyles:o}=this.props;return void 0===o||8&o?i.createElement("div",{key:"BreadcrumbItemDivider$"+s.key,className:"vss-Breadcrumb--divider-container",ref:e=>{e&&(this._pinElements[s.key]=e,this._breadcrumbElements["BreadcrumbItemDivider$"+s.key]=e)}},this._getDividerButtonOrIcon(s)):i.createElement("div",{ref:e=>{e&&(this._breadcrumbElements["BreadcrumbItemDivider$"+s.key]=e)},key:"BreadcrumbItemDivider$"+s.key,className:(0,t.Util.css)("vss-Breadcrumb--divider vss-HubBreadcrumb--divider",!!(4&o)&&"vss-Breadcrumb--divider-extra-padding",!!(2&o)&&"vss-Breadcrumb--divider-light")},this._getBreadcrumbIcon(s))}),this._onKeyDown=(e=>{const{linkItems:t}=this.state;37===e.which&&this._focusedLinkIndex>0&&(this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1),this._linkElements[t[--this._focusedLinkIndex].key].focus(),e.preventDefault()),39===e.which&&this._focusedLinkIndex>=0&&(this._focusedLinkIndex<t.length-1?(this._linkElements[t[++this._focusedLinkIndex].key].focus(),e.preventDefault()):this._focusedLinkIndex===t.length-1&&this._isExtraContentSelectable()&&this.props.onExtraContentSelectionChanged?(this.props.onExtraContentSelectionChanged(!0),this._focusedLinkIndex++,e.preventDefault()):this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1)),40===e.which&&this._focusedLinkIndex>=0&&!this.props.extraContentSelected&&this._onItemClick(t[this._focusedLinkIndex])}),this._onBlur=(()=>{this.state.pickerIsOpen||this.props.extraContentSelected||(this._focusedLinkIndex=-1)}),this._dataDidRender=(e=>{const{dataDidRender:t}=this.props;if(t){let i=0;Object.keys(this._breadcrumbElements).map((e,t)=>{i+=this._breadcrumbElements[e].clientWidth}),t(e,i)}});const s=p._arrangeItems(e.items);this.state={pickerIsOpen:!1,pickerItemKey:null,displayedItems:s,linkItems:p._getLinkItems(s)}}static getDerivedStateFromProps(e,t){const i=p._arrangeItems(e.items);return Object.assign(Object.assign({},t),{displayedItems:i,linkItems:p._getLinkItems(i)})}componentDidUpdate(e){!e.extraContentSelected&&this.props.extraContentSelected?this._focusedLinkIndex=this.state.linkItems.length:e.extraContentSelected&&!this.props.extraContentSelected&&this._focusedLinkIndex===this.state.linkItems.length&&(this._focusedLinkIndex=-1)}static _getLinkItems(e){return e.filter(e=>e.isHeaderPickerItem&&e.itemPicker||e.href||e.onClick)}_getIcon(e){return e?i.createElement(t.VssIcon.VssIcon,Object.assign({},e,{className:(0,t.Util.css)("vss-Breadcrumb--item-leftIcon vss-HubBreadcrumb--item-leftIcon",e.className)})):null}_renderPickerDropdown(e){const{pickListClassName:t,pickListWidth:s,pickListMinWidth:o,pickListMaxWidth:r,pickListMaxHeight:n}=this.props,a=e.pickerWidth||s||o||this._pinElements[e.key]&&this._pinElements[e.key].clientWidth,c=!r,l=e.pickListClassName||t;return i.createElement(m,{ref:e=>{this.pickList=e},item:e,getPinElement:()=>this._pinElements[e.key],width:c&&a,minWidth:!c&&a,maxWidth:r,maxHeight:n,pickListClassName:l,onPickListClosed:()=>this.setState({pickerIsOpen:!1}),onPickListOpened:()=>this.setState({pickerIsOpen:!0})})}_getBreadcrumbIcon(e){const{pickerItemKey:s}=this.state,{dividerType:o}=this.props;return 1===o?i.createElement("div",{className:"vss-Breadcrumb--forward-slash"},"/"):i.createElement(t.VssIcon.VssIcon,{iconName:e.isHeaderPickerItem||e.key===s&&this.state.pickerIsOpen?"ChevronDown":"ChevronRight",iconType:0,key:"RightIcon$"+e.key,className:(0,t.Util.css)("vss-Breadcrumb--item-dropdown vss-HubBreadcrumb--item-dropdown",e.isHeaderPickerItem&&"vss-Breadcrumb--item-dropdown-with-picker vss-HubBreadcrumb--item-dropdown-with-picker")})}_getDividerButtonOrIcon(e){const{pickerItemKey:s}=this.state,o=this._getBreadcrumbIcon(e);return e.itemPicker?i.createElement(n.Link,{onClick:this._onItemClick.bind(this,e),"aria-expanded":this.state.pickerIsOpen,"aria-label":e.itemPicker.ariaLabel,className:(0,t.Util.css)("vss-Breadcrumb--divider vss-Breadcrumb--divider-link")},o,s&&s===e.key&&e.itemPicker&&this._renderPickerDropdown(e)):o}_getIndicators(e){const s=e.isHeaderPickerItem&&e.itemPicker;return s&&s.selectedItem&&s.selectedItemIndicators&&s.selectedItemIndicators.length?i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:s.selectedItemIndicators.map(e=>e.getItemIndicator(s.selectedItem))}):null}static _arrangeItems(e){const t={};e.forEach(e=>{(!t[e.key]||(t[e.key].priority||0)<=(e.priority||0))&&(t[e.key]=e)});const i=[];return Object.keys(t).forEach(e=>{i.push(t[e])}),i.some(e=>e.rank>=0)&&i.sort((e,t)=>{return(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE)}),i}_isExtraContentSelectable(){const e=document.getElementById((0,t.Util.getSafeIdSelector)("breadcrumb-extra-content"));return!!e&&!!e.querySelector('[tabindex="-2"]')}render(){const{ariaLabel:e,className:s,maxDisplayedItems:o=d,onReduceData:r,overflowIndex:n,shouldUseFocusZone:a,extraContent:c}=this.props;return i.createElement("div",{className:(0,t.Util.css)("vss-Breadcrumb--container vss-HubBreadcrumb--container",s),onKeyDown:a?void 0:this._onKeyDown,onBlur:a?void 0:this._onBlur},i.createElement(b,{onReduceData:r||(e=>void 0),dataDidRender:this._dataDidRender,items:this.state.displayedItems,className:(0,t.Util.css)("vss-Breadcrumb vss-HubBreadcrumb"),onRenderItem:this.onRenderItem,ariaLabel:e||t.VSSResourcesVSSUI.BreadcrumbAriaLabel,maxDisplayedItems:o,overflowIndex:n,dividerAs:this._getCustomDivider,shouldUseFocusZone:a,extraContent:c}))}}t.ComponentsVssBreadcrumbVssBreadcrumb.VssBreadcrumb=p,p.defaultProps={items:[]};const h="overflow",u=()=>null;class b extends i.Component{constructor(e){super(e),this._focusZone=(0,c.createRef)(),this._onRenderBreadcrumb=(e=>{const{ariaLabel:s,dividerAs:n=t.Icon.Icon,onRenderItem:a=this._onRenderItem,overflowAriaLabel:c,overflowIndex:l,className:d,shouldUseFocusZone:m,extraContent:p}=e.props,{renderedOverflowItems:b,renderedItems:v}=e,P=b.map((e,t)=>({name:e.text,key:e.key,onClick:e.onClick?this._onBreadcrumbClicked.bind(this,e):null,href:e.href})),g=v.length-1,_=b&&0!==b.length,I=v.map((e,t)=>i.createElement("li",{className:"internal-breadcrumb--listItem",key:e.key||String(t)},a(e,this._onRenderItem),(t!==g||_&&t===l-1)&&i.createElement(n,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:e})));_&&I.splice(l,0,i.createElement("li",{className:"internal-breadcrumb--overflow",key:h},i.createElement(o.IconButton,{className:"internal-breadcrumb--overflowButton",iconProps:{iconName:"More"},role:"button","aria-haspopup":"true",ariaLabel:c,onRenderMenuIcon:u,menuProps:{items:P,directionalHint:4}}),l!==g+1&&i.createElement(n,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:b[b.length-1]}))),p&&I.push(i.createElement("li",{key:"breadcrumb-extra-content",id:(0,t.Util.getSafeId)("breadcrumb-extra-content")},p));let B=i.createElement("ol",{className:"internal-breadcrumb--list"},I);return m&&(B=i.createElement(r.FocusZone,{componentRef:this._focusZone,direction:r.FocusZoneDirection.horizontal},B)),i.createElement("div",{className:d,role:"navigation","aria-label":s},B)}),this._onRenderItem=(e=>i.createElement("span",{className:"internal-breadcrumb--item"},e.text)),this._onBreadcrumbClicked=((e,t)=>{e.onClick&&e.onClick(t,e)}),b._validateProps(e),this.state={}}render(){const{onReduceData:e,dataDidRender:t,overflowIndex:s,maxDisplayedItems:o,items:r}=this.props,n=[...r],c=n.splice(s,n.length-o),l={props:this.props,renderedItems:n,renderedOverflowItems:c};return i.createElement(a.ResizeGroup,{onRenderData:this._onRenderBreadcrumb,onReduceData:e,dataDidRender:t,data:l,className:"vss-Breadcrumb--resizeGroup"})}static getDerivedStateFromProps(e,t){return b._validateProps(e),t}static _validateProps(e){const{maxDisplayedItems:t,overflowIndex:i,items:s}=e;if(i<0||t>1&&i>t-1||s.length>0&&i>s.length-1)throw new Error("Breadcrumb: overflowIndex out of range")}}b.defaultProps={items:[],maxDisplayedItems:999,overflowIndex:0}}(),function(e){I=t.ComponentsHubHeaderHubTitle={};t.ComponentsHubHeaderHubTitle.HubTitle=class extends c.BaseComponent{constructor(e){super(e)}getIcon(){if(this.props.iconProps){const e=Object.assign(Object.assign({},this.props.iconProps),{className:(0,t.Util.css)(this.props.iconProps.className,"vss-HubTitle-titleIcon")});return i.createElement(t.VssIcon.VssIcon,Object.assign({},e))}return null}getTitleText(){return i.createElement("div",{className:"vss-HubTitle--titleText"},this.props.titleText)}render(){const e=(0,t.Util.css)("vss-HubTitle");return i.createElement("h1",{className:e,onClick:this.props.onClick},this.getIcon(),this.getTitleText())}}}(),function(e){B=t.ComponentsHubHeaderHubHeader={};const s="340px";t.ComponentsHubHeaderHubHeader.HubHeader=class extends c.BaseComponent{constructor(e){super(e),this.dataDidRender=((e,t)=>{const{breadcrumbProps:i,breadcrumbDataDidRender:s}=this.props,{canBreadcrumbShrink:o}=this.state;if(i&&i.onReduceData){const t=i.onReduceData(e);void 0===t&&o?this.setState({canBreadcrumbShrink:!1}):void 0===t||o||this.setState({canBreadcrumbShrink:!0})}s&&s(e,t)}),this.onSelectionChanged=(e=>{const{headerItemPicker:t}=this.state;let i=!1;return t&&t.onSelectedItemChanged&&(i=!0===t.onSelectedItemChanged(e.selectedItems&&e.selectedItems.length>0?e.selectedItems[0]:null),this._hubBreadcrumb&&this._hubBreadcrumb.pickList&&this._hubBreadcrumb.pickList.closeDropdown()),i}),this.onHeaderPickerChanged=(e=>{this.setState({headerItemPicker:e})}),this.state={headerItemPicker:d.ObservableLike.getValue(this.props.headerItemPicker),canBreadcrumbShrink:!0}}componentWillMount(){d.ObservableLike.subscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillUnmount(){d.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillReceiveProps(e){this.props.headerItemPicker!==e.headerItemPicker&&(this.setState({headerItemPicker:d.ObservableLike.getValue(e.headerItemPicker)}),d.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged),d.ObservableLike.subscribe(e.headerItemPicker,this.onHeaderPickerChanged))}getTitle(){return this.props.breadcrumbItems&&this.props.breadcrumbItems.length>0||this.props.headerItemPicker?this.getBreadcrumb():this.props.title?i.createElement(I.HubTitle,{titleText:this.props.title,iconProps:this.props.iconProps}):(console.log("Must use title or breadcrumb items + headerItemPicker"),null)}getBreadcrumb(){let e=this.props.breadcrumbItems?[...this.props.breadcrumbItems]:[];const{maxBreadcrumbItemWidth:t,collapseBreadcrumb:o,iconProps:r,pickListClassName:n,pickListMinWidth:a,pickListMaxWidth:c,pickListMaxHeight:l,title:d,hubBreadcrumbAriaLabel:m,breadcrumbProps:p}=this.props,{headerItemPicker:h}=this.state;if(h&&h.getListItem){const t=h.selectedItem&&h.getListItem(h.selectedItem),i=h.selectedItem&&h.getTitleTextForItem?h.getTitleTextForItem(h.selectedItem):t&&t.name,s={key:"title-item",text:d||i,leftIconProps:r,onSelectionChanged:this.onSelectionChanged,itemPicker:h,ariaLabel:h.ariaLabel,isHeaderPickerItem:!0};e.push(s)}else if(d){const t={key:"title-item",text:d,leftIconProps:r};e.push(t)}return o&&(e=e.slice(e.length-1),p&&(p.overflowIndex=0)),i.createElement(_.VssBreadcrumb,Object.assign({},p,{dataDidRender:this.dataDidRender,ref:e=>{this._hubBreadcrumb=e},items:e,maxItemWidth:"string"==typeof t?t:s,pickListClassName:n,pickListMinWidth:a,pickListMaxWidth:c,pickListMaxHeight:l,ariaLabel:m,shouldUseFocusZone:!0,presentationStyles:24}))}render(){return i.createElement("div",{className:(0,t.Util.css)("vss-HubHeader",!this.state.canBreadcrumbShrink&&"vss-HubHeader-no-shrink")},this.getTitle(),this.props.children)}}}(),function(e){f=t.ComponentsHubHeaderHubTextTile={};t.ComponentsHubHeaderHubTextTile.HubTextTile=class extends c.BaseComponent{render(){const{text:e,secondaryText:s}=this.props,o=(0,t.Util.css)("vss-HubTextTile vss-HubTile");return i.createElement("div",{className:o},i.createElement(t.Dynamic.DynamicText,{text:e,className:(0,t.Util.css)("vss-HubTextTile--primaryText",!this.props.secondaryText&&"vss-HubTextTile--primaryTextOnly")}),i.createElement(t.Dynamic.DynamicText,{text:s,className:"vss-HubTextTile--secondaryText"}))}}}(),function(e){k=t.ComponentsHubHeaderHubTileRegion={};t.ComponentsHubHeaderHubTileRegion.HubTileRegion=class extends c.BaseComponent{render(){const e=(0,t.Util.css)("vss-HubTileRegion"),s=i.Children.toArray(this.props.children),o=i.Children.map(s||[],(e,t)=>{const s=e.props,o=s&&s.className,r=Object.assign(Object.assign({},s),{className:o?o+" vss-HubTile":"vss-HubTile"});return i.cloneElement(e,r)});return i.createElement("div",{className:e},o)}}}(),C=t.ComponentsHubHeaderindex={},__exportStar(B,t.ComponentsHubHeaderindex),__exportStar(f,t.ComponentsHubHeaderindex),__exportStar(k,t.ComponentsHubHeaderindex),y=t.HubHeader={},__exportStar(C,t.HubHeader),function(e){w=t.ComponentsPivotBarPivotBarItem={};t.ComponentsPivotBarPivotBarItem.PivotBarItem=class extends c.BaseComponent{render(){return i.createElement("div",Object.assign({},(0,c.getNativeProps)(this.props,c.divProperties),{className:(0,t.Util.css)("vss-PivotBarItem",this.props.className)}),this.props.children)}}}(),function(e){S=t.ComponentsPivotBarPivotBarAction={};const s="vss-PivotBar--commandBar-item";var o,n;function a(e,i,o,r){let a=[];for(let t of e||[]){const e=n.getInstance(i,t.actionType||0);a=a.concat(e.getVisualization(t,o,r))}return a.forEach(e=>{e.className=(0,t.Util.css)(e.className,s)}),a}function l(e,t,i,s,o){e?e.setViewOption(t,i):"function"==typeof o.onClick&&o.onClick(s,o)}!function(e){e[e.Bar=0]="Bar",e[e.Overflow=1]="Overflow"}(o||(o={})),t.ComponentsPivotBarPivotBarAction.mapActionsToItems=function(e,t,i){return a(e,o.Bar,t,i)},t.ComponentsPivotBarPivotBarAction.mapItemToActions=function e(t){const i=t.iconProps.iconType,s=i===p.IconType.default||i===p.IconType.Default?0:3,o={key:t.key,name:t.name,href:t.href,title:t.title,iconProps:Object.assign(Object.assign({},t.iconProps),{iconType:s}),onClick:t.onClick,disabled:t.disabled,important:t.important,target:t.target,separator:t.itemType===m.ContextualMenuItemType.Divider};return t.items&&(o.children=t.items.map(e)),o},function(e){const t={};function i(e,t){return`${e}:${t}`}e.register=function(e,s,o){const r=i(e,s);t[r]=o},e.getInstance=function(e,s){const o=i(e,s);let r=t[o];if(!r)throw new Error(`No visualization found for area ${e} and action type ${s}`);return new r}}(n||(n={}));class d{getVisualization(e,i){const s={key:e.key,name:e.name||"",ariaLabel:e.ariaLabel,className:e.actionProps&&e.actionProps.className,title:e.title,onClick:e.onClick,href:e.href,disabled:e.disabled,target:e.target,itemType:e.separator?m.ContextualMenuItemType.Divider:m.ContextualMenuItemType.Normal};if(e.iconProps){const i=Object.assign({},e.iconProps);i.className=(0,t.Util.css)(i.className,"vss-PivotBar--commandBar-icon"),s.iconProps=t.VssIcon.VssIcon.getIconProps(i)}const r=e.actionProps;return r&&r.showChevron&&(s.subMenuProps={items:[]}),Array.isArray(e.children)&&(s.subMenuProps={className:"vss-PivotBar--commandBar-overflow",items:a(e.children,o.Overflow,i)}),[s]}}n.register(o.Bar,0,d),n.register(o.Overflow,0,d);class b{getVisualization(e,t){return[]}getActionProps(e){return e.actionProps||(e.actionProps={on:!1}),e.actionProps}isOn(e,t){return!!t&&!0===t.getViewOption(e)}}n.register(o.Bar,1,class extends b{getVisualization(e,s,o){const r=this.getActionProps(e),n=this.isOn(e.key,s),a=n?t.VSSResourcesVSSUI.PivotBarViewActionOnText:t.VSSResourcesVSSUI.PivotBarViewActionOffText;let c;!1!==r.showText&&(c=a);let d=n?r.onAriaLabel:r.offAriaLabel,m=e.title;void 0===d&&(d=void 0!==m?m:a),void 0===m&&(m=void 0!==d?d:a);let p=n?r.onIconProps:r.offIconProps;return p||(p=e.iconProps),[{key:e.key,onRender:(a,h,u,b)=>{const v=i.createElement(t.Button.Button,{subtle:!0,className:(0,t.Util.css)("vss-PivotBar--commandBar-toggle","pivotBar-toggle-button",r.className),text:c,ariaSetSize:b,ariaPosInSet:u,ariaChecked:n,disabled:e.disabled,iconProps:t.VssIcon.VssIcon.getIconProps(p,"vss-PivotBar--commandBar-icon"),onClick:t=>{l(s,a.key,!this.isOn(a.key,s),t,e),o&&o()},ariaLabel:d,role:"switch",tooltipProps:m?{showOnFocus:!0,text:m}:void 0});return m?i.createElement(t.TooltipEx.Tooltip,{text:m},i.createElement("span",{className:"vss-PivotBar-commandBar-toggle-host"},v)):v}}]}});n.register(o.Overflow,1,class extends b{getVisualization(e,s){const o=this.getActionProps(e);let r=[];const n=o.onText||t.VSSResourcesVSSUI.PivotBarViewActionOnText,a=o.offText||t.VSSResourcesVSSUI.PivotBarViewActionOffText,c=o.onAriaLabel||(e.ariaLabel?e.ariaLabel:null),d=o.offAriaLabel||(e.ariaLabel?e.ariaLabel:null),p={key:e.key,onRender:r=>{const m=i.createElement(u.Toggle,{key:`${e.key}-toggle`,className:(0,t.Util.css)("vss-PivotBar--commandBar-toggle",o.className),styles:{root:{paddingLeft:8,marginTop:4},container:{alignItems:"center"},pill:{fontSize:"15px"}},checked:this.isOn(e.key,s),disabled:e.disabled,onText:n,offText:a,onAriaLabel:c,offAriaLabel:d,onChanged:t=>{l(s,r.key,t,null,e)}});return e.title?i.createElement(t.Tooltip.TooltipHost,{content:e.title,key:`${e.key}-toggle-tooltip`},m):m}};return e.name?r.push({key:e.key,sectionProps:{items:[p],title:e.name,key:`${e.key}-section`},itemType:m.ContextualMenuItemType.Section}):r.push(p),r}});class v{getVisualization(e,t){return[]}getActionProps(e){if(!e.actionProps)throw new Error(`Options must be specified for the choice group ${e.key}`);return e.actionProps}getSelectedOption(e,t,i){const s=(i?i.getViewOption(e):null)||t.defaultSelectedKey;return t.options.filter(e=>e.key===s)[0]||t.options[0]}}class P extends c.BaseComponent{constructor(e){super(e),this._onCycleClick=(e=>{this._changeOption(e,this._getNextOptionIndex(this.props.options))}),this._onOptionClick=((e,t)=>{e.stopPropagation(),this._changeOption(e,(0,c.findIndex)(this.props.options,e=>e.key===t.key))}),this._onDropClick=(e=>{this.setState({showDropdown:!0,dropTarget:e.currentTarget})}),this._onDismiss=(e=>{this.setState({showDropdown:!1})}),this.state={showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(this.props.options,this.props.defaultSelectedKey)}}componentWillReceiveProps(e){this.setState({showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(e.options,e.defaultSelectedKey)})}render(){const{dropButtonClassName:e,ariaLabel:s,dropButtonAriaLabel:o,options:r}=this.props,{selectedOptionIndex:n,showDropdown:a,dropTarget:c}=this.state,l=r[n];return i.createElement("div",{className:"vss-ChoiceGroupButton"},i.createElement(t.Button.Button,{subtle:!0,ariaLabel:s||o||t.VSSResourcesVSSUI.PivotBarMoreOptionsAriaLabel,"aria-expanded":a,"aria-haspopup":!0,className:(0,t.Util.css)("vss-ChoiceGroupButton--drop",e),text:l.text,onClick:this._onDropClick},(0,t.Icon.Icon)({iconName:"ChevronDown",className:"pivotBar-choice-group-icon"})),a?i.createElement(m.ContextualMenu,{shouldFocusOnMount:!0,isBeakVisible:!1,target:c,onDismiss:this._onDismiss,directionalHint:6,items:r.map(e=>({key:e.key,name:e.text,ariaLabel:e.ariaLabel,isChecked:e===l,canCheck:!0,onClick:this._onOptionClick}))}):null)}_getSelectedOptionIndex(e,t=null){const i=t?(0,c.findIndex)(e,e=>e.key===t):-1;return Math.max(i,0)}_getNextOptionIndex(e){let t=this.state.selectedOptionIndex+1;return t===e.length&&(t=0),t}_changeOption(e,t){const{onChange:i,options:s}=this.props;this.setState({selectedOptionIndex:t}),i&&i(e,s[t])}}n.register(o.Bar,2,class extends v{getVisualization(e,s){const o=this.getActionProps(e),r=this.getSelectedOption(e.key,o,s);return[{key:e.key,className:(0,t.Util.css)("vss-PivotBar--commandBar-barChoiceGroup",o.className),onRender:(t,n,a,c)=>i.createElement(P,{ariaLabel:t.ariaLabel,"aria-setsize":c,"aria-posinset":a,dropButtonAriaLabel:o.dropButtonAriaLabel,defaultSelectedKey:r.key,options:o.options,dropButtonClassName:"vss-PivotBar--commandBar-barChoiceDrop",onChange:(t,i)=>{l(s,e.key,i.key,t,e)}})}]}});n.register(o.Overflow,2,class extends v{getVisualization(e,t){const i=this.getActionProps(e),s=this.getSelectedOption(e.key,i,t);let o=[];e.name&&o.push({key:`${e.key}-header`,name:e.name,itemType:m.ContextualMenuItemType.Header});for(let r of i.options)o.push({key:r.key,name:r.text,ariaLabel:r.ariaLabel,isChecked:r===s,canCheck:!0,title:r.title,onClick:(i,s)=>{l(t,e.key,s.key,i,e),t&&i&&i.preventDefault()}});return o}});class g{getActionProps(e){const t=e.actionProps;if(!t||!t.text)throw new Error(`Text must be specified through actionProps for ${e.key}`);return t}getVisualization(e,s){const o=this.getActionProps(e);return[{key:e.key,className:"vss-PivotBar--commandBar-text",onRender:s=>{const r=i.createElement(t.Dynamic.DynamicText,{className:o.className,key:`${e.key}-text`,text:o.text});return e.title?i.createElement(t.TooltipEx.Tooltip,{text:e.title,key:`${e.key}-tooltip`},i.createElement("span",null,r)):r}}]}}n.register(o.Bar,3,g),n.register(o.Overflow,3,g);class _ extends c.BaseComponent{constructor(){super(...arguments),this._onOuterKeyDown=(e=>{13===e.which&&this._innerFocus&&(this._innerFocus.focus(),e.preventDefault(),e.stopPropagation())}),this._onInnerKeyDown=(e=>{27===e.which&&this._outerFocus&&(this._outerFocus.focus(),e.preventDefault(),e.stopPropagation())})}render(){return i.createElement(t.TooltipEx.Tooltip,{text:this.props.title},i.createElement("div",{ref:e=>this._outerFocus=e,onKeyDown:this._onOuterKeyDown,"data-is-focusable":!0,className:"vss-PivotBarSlider"},i.createElement(r.FocusZone,{componentRef:e=>this._innerFocus=e,onKeyDown:this._onInnerKeyDown,direction:r.FocusZoneDirection.horizontal},i.createElement(h.Slider,Object.assign({},this.props)))))}}class I{getActionProps(e){return e.actionProps||(e.actionProps={}),e.actionProps}getValue(e,t){return t&&t.getViewOption(e)||0}get useLabel(){return!0}getVisualization(e,s){const o=this.getActionProps(e),r=this.getValue(e.key,s);return[{key:e.key,className:"vss-PivotBar--commandBar-barSlider",onRender:(n,a,c,d)=>i.createElement(_,{key:`${e.key}-slider`,className:(0,t.Util.css)("vss-PivotBar--commandBar-slider",o.className),label:this.useLabel?e.name:void 0,value:r,min:o.minValue,max:o.maxValue,step:o.step,ariaLabel:e.ariaLabel,"aria-setsize":d,"aria-posinset":c,title:e.title,showValue:!1,disabled:e.disabled,onChange:t=>{l(s,e.key,t,null,e)}})}]}}n.register(o.Bar,4,class extends I{});n.register(o.Overflow,4,class extends I{get useLabel(){return!1}getVisualization(e,t){const i=super.getVisualization(e,t);return e.name&&i.unshift({key:`${e.key}-header`,name:e.name,itemType:m.ContextualMenuItemType.Header}),i}})}(),function(e){x=t.ComponentsPivotBarPivotCommandBar={};t.ComponentsPivotBarPivotCommandBar.PivotCommandBar=class extends c.BaseComponent{constructor(e){super(e),this._onCommandsChanged=(()=>{this.setState({commands:this._getCommands(this.props)})}),this._onViewActionsChanged=(()=>{this.setState({viewActions:this._getViewActions(this.props)})}),this._forceUpdate=(()=>{this.forceUpdate()}),this.state={commands:this._getCommands(this.props),viewActions:this._getViewActions(this.props)}}componentWillReceiveProps(e){let i=!1;(0,t.Util.arrayEquals)(this.props.commands,e.commands)||(this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(e.commands,this._onCommandsChanged),i=!0),(0,t.Util.arrayEquals)(this.props.viewActions,e.viewActions)||(this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged),this._subscribeItems(e.viewActions,this._onViewActionsChanged),i=!0),this.props.showFilterAction===e.showFilterAction&&this.props.filterBar===e.filterBar||(i=!0),i&&this.setState({commands:this._getCommands(e),viewActions:this._getViewActions(e)})}componentDidMount(){this._subscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(this.props.viewActions,this._onViewActionsChanged)}componentWillUnmount(){this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged)}render(){const{className:e,viewOptions:s,filterBar:o,hasAppliedFilter:r,showFilterAction:n,onShowFilterBarClicked:a,showFilterBarViewOptionKey:c,prependSeparator:l,role:d,ariaLabel:m,commandsMenuBarAriaLabel:p,inlineFilterAriaLabel:h}=this.props,{commands:u,viewActions:v}=this.state;let P=[],g=[];if(u&&u.length){const e=u.filter(e=>e.important),t=u.filter(e=>!e.important);P=(0,S.mapActionsToItems)(e,s,this._forceUpdate),g=(0,S.mapActionsToItems)(t,s,this._forceUpdate)}const _=[];if(v&&v.length){_.push(...v.filter(e=>e.important&&1===e.viewActionRenderArea));const e=v.filter(e=>!e.important);e.length&&_.push({key:"viewOptions",title:t.VSSResourcesVSSUI.PivotBarViewOptionsText,ariaLabel:t.VSSResourcesVSSUI.PivotBarViewOptionsText,actionProps:{className:"vss-PivotBar--viewOptionsMenu"},important:!0,actionType:0,iconProps:{iconName:"Equalizer"},children:e}),_.push(...v.filter(e=>e.important&&1!==e.viewActionRenderArea&&2!==e.viewActionRenderArea))}n&&!o&&_.push({key:c,important:!0,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextHide,offAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextShow,onIconProps:{iconName:r?"FilterSolid":"Filter"},offIconProps:{iconName:r?"FilterSolid":"Filter"}},onClick:a}),v&&v.length&&_.push(...v.filter(e=>e.important&&2===e.viewActionRenderArea));const I=(0,S.mapActionsToItems)(_,s,this._forceUpdate);return o&&I.unshift({className:"vss-PivotBar--inlineFilterBar",key:"filterBar",ariaLabel:h,onRender:()=>o}),P.length||g.length||I.length?i.createElement("div",{className:"vss-PivotBar--right",role:d,"aria-label":m},!(!l||!P.length&&!g.length)&&i.createElement("div",{className:"vss-PivotBar--separator"}),i.createElement(b.CommandBar,{componentRef:e=>{this._commandBar=e},className:(0,t.Util.css)(e),items:P,overflowItems:g,farItems:I,elipisisAriaLabel:t.VSSResourcesVSSUI.PivotBarMoreCommandsAriaLabel,ariaLabel:p})):null}focus(){this._commandBar&&this._commandBar.focus()}_subscribeItems(e,t){(e||[]).forEach(e=>e.subscribe(t))}_unsubscribeItems(e,t){(e||[]).forEach(e=>e.unsubscribe(t))}_getCommands(e){const t=[],i=e.commands||[];for(const e of i)t.push(...e.value);return t}_getViewActions(e){const t=[],i=e.viewActions||[];for(const e of i)t.push(...e.value);return t}}}(),function(e){O=t[e]={};const s=340;t[e].MAX_PIVOT_WAIT=1e3;class o extends c.BaseComponent{constructor(e){super(e),this._subscribedToPivotObservables=!1,this._pivotSelected=!1,this._pivotItemsRendered={},this._pivotHeader=(0,c.createRef)(),this._onFilterBarDismissClicked=(()=>{const{showFilterBarViewOptionKey:e,viewOptions:t}=this.props;t&&e&&this.props.viewOptions.setViewOption(e,!1),this._commandBar&&this._commandBar.focus(),this.setState({showFilterBar:!1})}),this._onDropDownSelected=(e=>{const t=e.key;this._updateSelectedItem(t,null)}),this._renderPivotItem=((e,s)=>{const o=e.itemKey,r=this.state.selectedPivot===o;return i.createElement(t.Dynamic.DynamicLink,{url:e.url,className:(0,t.Util.css)("vss-PivotBar--itemLink",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:o},i.createElement(t.Button.Button,{id:e.id,className:(0,t.Util.css)("vss-PivotBar--button",r?"selected":""),onClick:this._onPivotClick.bind(this,o),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:r,ariaPosInSet:s+1,ariaSetSize:this.state.items.length},this._renderPivotItemContent(e)))}),this._onShowFilterBarClicked=(()=>{this.setState({showFilterBar:!this.state.showFilterBar})}),this._onFilterApplied=(()=>{const e=this.props.filter.hasChangesToReset();e!==this.state.hasAppliedFilter&&this.setState({hasAppliedFilter:e})}),this._onContributedPivotsChanged=(()=>{if(this.setState({items:this._getPivotBarItems(this.props)}),this._pivotSelected){if(this.state.selectedPivot&&!this.getSelectedPivot()){let e;this.props.initialSelectedPivot&&this._getPivotBarItemByItemKey(this.props.initialSelectedPivot)?e=this.props.initialSelectedPivot:this.state.items&&this.state.items.length>0&&(e=this.state.items[0].itemKey),e&&this.selectPivot(e)}}else this.setState(this._buildInitialPivotState())}),this._onViewOptionChanged=(e=>{const{showFilterBarViewOptionKey:t}=this.props,{viewActions:i}=this.state;let s=!1;if(t in e&&(this._focusFilterBar=!0,s=!0),!s){const t=[];i&&i.forEach(e=>t.push(...e.value));for(const i in e)if((0,c.findIndex)(t,e=>e.key===i)>=0){s=!0;break}}s&&this.forceUpdate()}),this._makeIPivotBarItemFromContribution=((e,t)=>({contributedItem:e,id:this._makeContributedPivotBarItemId(e,t),itemKey:e.itemKey||e.id,groupKey:e.groupKey,name:e.text,order:e.order,ariaLabel:e.ariaLabel,onRenderFilterBar:e.renderFilterBar,commandProviders:e.commandProviders,viewActionProviders:e.viewActionProviders,badgeCount:e.badgeCount,url:e.url,hidden:e.hidden,onBeforePivotChange:e.onBeforePivotChange})),this._getPivotBarItemId=(e=>e.contributedItem?e.contributedItem.id:e.itemKey||e.id),this._id=(0,l.getId)("PivotBar"),this._setupPivotObservables(this.props),this._actionsManager=new n,this._disposables.push(this._actionsManager),this.state={items:this._getPivotBarItems(this.props)},this.state=Object.assign({hasAppliedFilter:!!this.props.filter&&this.props.filter.hasChangesToReset(),items:this.state.items},this._buildInitialPivotState())}focus(e){if(this._commandBar)switch(e){case 0:this._commandBar.focus()}}selectPivot(e){return!!this._getPivotBarItemByItemKey(e)&&(this._updateSelectedItem(e,null),!0)}getSelectedPivot(){return this._getPivotBarItemByItemKey(this.state.selectedPivot)}componentWillReceiveProps(e){(0,t.Util.arrayEquals)(this.props.pivotProviders,e.pivotProviders)||this._setupPivotObservables(e);const i=this._getPivotBarItems(e);this.setState((e,t)=>Object.assign({items:i},this._buildInitialPivotState(t,i,!0)))}componentDidMount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.on(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.subscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._updateHeaderTopIfNeeded(),this._subscribeToPivotObservables()}componentDidUpdate(){this._updateHeaderTopIfNeeded(),this.props.onRenderComplete&&this.props.onRenderComplete()}componentWillUnmount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.off(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.unsubscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._contributedPivotWait&&(clearTimeout(this._contributedPivotWait),this._contributedPivotWait=null),this._unsubscribeFromPivotObservables()}render(){let{className:e,filter:s,showPivots:o,showFilterBarViewOptionKey:r,filterBarClassName:n,pivotRenderingModeOptions:a,isCommandBarSticky:c,isPivotBarContentScrollable:l,pivotBarSize:d="compact",canBreadcrumbShrink:m,maxBreadcrumbWidth:p,pivotBarHeaderClassName:h}=this.props,{showFilterBar:u,headerTop:b}=this.state;const v=i.Children.toArray(this.props.children)||[],P=v.filter(e=>"object"!=typeof e||e.type!==w.PivotBarItem&&e.type!==t.FilterBar.FilterBar&&e.type!==y.HubTileRegion);let g=null;const _=this._getHubTileRegionIndex(v);_>-1&&(g=v[_]);let I=null,B=_>-1;void 0===o?o=this.state.items&&this.state.items.length>1:B=B&&o,o&&(I=this._renderPivotItems(a)),this._singleLineMode=!o&&!B;const f=this._singleLineMode?"vss-PivotBar--bar-one-line":"vss-PivotBar--bar-two-line";let k;this.props.viewOptions&&r&&(u=this.props.viewOptions.getViewOption(r));const C=this._getFilterBarSettings(v),S=C&&C.showInline,x=!1===this.props.isPivotBarContentScrollable&&!!c;C&&(u||C.showInline)&&(k=C.filterBarElement,k=i.cloneElement(k,{className:(0,t.Util.css)(k.props.className,n),filter:k.props.filter||s,onDismissClicked:this._onFilterBarDismissClicked,onMounted:e=>{!S&&this._focusFilterBar&&e.focus()}}),x&&(k=i.createElement("div",{className:"vss-PivotBar--filter-sticky"},k)));const O=!(!I&&!this._singleLineMode),E=x?"sticky":"";let A={};return this._singleLineMode&&p&&(A={maxWidth:`${p}px`}),a&&2===a.mode?i.createElement("div",{className:(0,t.Util.css)("vss-PivotBar",e)},i.createElement("div",{className:(0,t.Util.css)(h,"vss-PivotBar--header vertical")},P,B&&g),i.createElement("div",{className:"vss-PivotBar--pivotsContainer vertical"},I,i.createElement("div",{className:"vss-PivotBar--barAndContentContainer"},i.createElement("div",{className:(0,t.Util.css)("vss-PivotBar--bar",d)},this._renderCommandBar(S?k:null,!!C,!1),S?null:k),this._renderContent()))):i.createElement("div",{className:(0,t.Util.css)("vss-PivotBar",e)},i.createElement("div",{className:(0,t.Util.css)(f,E,!u&&"bottom-border"),style:{top:this._singleLineMode?0:b}},i.createElement("div",{className:(0,t.Util.css)(h,"vss-PivotBar--header",m&&this._singleLineMode&&"can-shrink"),ref:this._pivotHeader,style:A},P,B&&g),i.createElement("div",{className:(0,t.Util.css)("vss-PivotBar--bar",d)},I,this._renderCommandBar(S?k:null,!!C,O))),S?null:k,this._renderContent())}_updateHeaderTopIfNeeded(){!1===this.props.isPivotBarContentScrollable&&this.props.isCommandBarSticky&&void 0===this.state.headerTop&&!this._singleLineMode&&this.setState({headerTop:`-${this._pivotHeader.current.clientHeight}px`})}_renderPivotItems(e){return e&&1===e.mode?this._renderDropdown(e.props):e&&2===e.mode?this._renderVerticalTabs():this._renderHorizontalTabs()}_renderDropdown(e){const s=[];if(this.state.items.length>0){let e=this.state.items[0].groupKey;for(const t of this.state.items){const{name:i,itemKey:o,groupKey:r}=t;e!==r&&(s.push({key:`${r}-separator`,text:"-",itemType:v.DropdownMenuItemType.Divider}),e=r),s.push({key:o,text:i})}}return i.createElement(v.Dropdown,{ariaLabel:t.VSSResourcesVSSUI.PivotItemAriaLabel,className:"vss-PivotBar--dropdown",selectedKey:this.state.selectedPivot,options:s,onChanged:this._onDropDownSelected,dropdownWidth:e.dropdownWidth})}_pivotCompare(e,t){return(void 0===e?100:e)-(void 0===t?100:t)}_renderHorizontalTabs(){const e=this.state.items?this.state.items.sort((e,t)=>this._pivotCompare(e.order,t.order)):null,{pivotBarSize:s="compact",headerAriaLabel:o}=this.props;let n;if(this.state.items&&this.state.selectedPivot&&this.props.autoFocus){const e=this._getPivotBarItemByItemKey(this.state.selectedPivot);e&&(n=(0,t.Util.getSafeIdSelector)(e.id))}return i.createElement("div",{role:"navigation","aria-label":o},i.createElement(r.FocusZone,{key:n,className:(0,t.Util.css)("vss-PivotBar--pivots",s),role:"tablist",direction:r.FocusZoneDirection.horizontal,defaultActiveElement:n},e&&e.map(this._renderPivotItem)))}_renderVerticalTabs(){let e=[];const s={};let o;if(this.props.pivotRenderingModeOptions&&this.props.pivotRenderingModeOptions.props){const{groups:t,navAriaLabel:i}=this.props.pivotRenderingModeOptions.props;if(t){for(const e of t)s[e.key]=!0;e=t.sort((e,t)=>this._pivotCompare(e.rank,t.rank))}o=i}const n=[],a=this.state.items.reduce((e,t)=>(t.groupKey&&s[t.groupKey]?(e[t.groupKey]=e[t.groupKey]||[]).push(t):n.push(t),e),{}),c=[i.createElement(t.DeprecatedAccordion.Accordion,{key:"PivotBarVerticalAccordion",className:"pivot-bar--accordion",initiallyExpandAll:!0,items:e.map(e=>{let t;return a[e.key]&&(a[e.key].sort((e,t)=>this._pivotCompare(e.order,t.order)),t={key:e.key,title:e.name,onRenderContent:()=>i.createElement("div",{key:t.key,role:"tablist"},a[e.key].map((t,i)=>this._renderVerticalPivotItem(t,i,a[e.key].length)))}),t}).filter(e=>void 0!==e)})];let l;if(c.push(i.createElement("div",{className:"pivot-bar--ungrouped",key:"PivotBarVerticalUngrouped",role:"tablist"},n.map((e,t)=>this._renderVerticalPivotItem(e,t,n.length)))),this.state.items&&this.state.selectedPivot){const e=this._getPivotBarItemByItemKey(this.state.selectedPivot);e&&(l=(0,t.Util.getSafeIdSelector)(e.id))}return i.createElement(r.FocusZone,{key:l,direction:r.FocusZoneDirection.vertical,className:"vss-PivotBar--pivots vertical flex-column","aria-label":o,defaultActiveElement:l},c)}_renderVerticalPivotItem(e,s,o){const r=e.itemKey,n=this.state.selectedPivot===r;return i.createElement(t.Dynamic.DynamicLink,{url:e.url,className:(0,t.Util.css)("vss-PivotBar--itemLink-v",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:r},i.createElement(t.Button.Button,{subtle:!0,id:e.id,tooltipProps:{text:e.tooltip},className:(0,t.Util.css)("vss-PivotBar--button-v",n?"selected":""),onClick:this._onPivotClick.bind(this,r),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:n,ariaPosInSet:s+1,ariaSetSize:o},i.createElement(t.VssIcon.VssIcon,{className:(0,t.Util.css)("pivotbar-pivot--icon-v",e.iconProps&&e.iconProps.className),iconName:e.iconProps&&e.iconProps.iconName}),i.createElement(t.TooltipEx.Tooltip,{anchorOrigin:{horizontal:"center",vertical:"end"},overflowOnly:!0,text:e.name,tooltipOrigin:{horizontal:"center",vertical:"start"}},i.createElement("div",{className:"flex flex-grow text-ellipsis"},e.name))))}_renderPivotItemContent(e){const{name:o,iconProps:r,badgeCount:n,maxItemWidth:a}=e;let c=void 0,l=void 0;"string"==typeof n?c=n:"number"==typeof n&&(c=(0,t.UtilitiesFriendlyNumber.getFriendlyDisplayValue)(n))!==n.toString()&&(l=n.toString());let d=void 0;return c&&(d=i.createElement("span",{className:"badge"},c),l&&(d=i.createElement(t.TooltipEx.Tooltip,{text:l},d))),i.createElement("span",{className:"innerContainer"},void 0!==r&&i.createElement(t.VssIcon.VssIcon,Object.assign({className:"icon"},r)),void 0!==o&&i.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:o},i.createElement("span",{className:"text",style:{maxWidth:a||s}},o)),d)}_renderCommandBar(e,t,s){return i.createElement(x.PivotCommandBar,{componentRef:e=>{this._commandBar=e},className:"vss-PivotBar--commandBar",commands:this.state.commands,viewActions:this.state.viewActions,filterBar:e,showFilterAction:t,showFilterBarViewOptionKey:this.props.showFilterBarViewOptionKey,hasAppliedFilter:this.state.hasAppliedFilter,prependSeparator:s,viewOptions:this.props.viewOptions,onShowFilterBarClicked:this._onShowFilterBarClicked,role:"region",ariaLabel:this.props.headerAriaLabel,commandsMenuBarAriaLabel:this.state.commandsMenuBarAriaLabel,inlineFilterAriaLabel:this.props.inlineFilterAriaLabel})}_renderContent(){const e=[],s=(this.state.selectedPivot||"").toUpperCase(),o=void 0===this.props.isPivotBarContentScrollable||this.props.isPivotBarContentScrollable;for(const r of this.state.items){const n=r.itemKey.toUpperCase(),a=s===n,c=!a&&1===r.deselectionBehavior&&!0===this._pivotItemsRendered[n];(a||c)&&(e.push(i.createElement("div",{key:n,className:(0,t.Util.css)("vss-PivotBar--content",!o&&"vss-PivotBar--content-unscrollable",c&&"hide-content",this.props.pivotBarContentClassName),role:"tabpanel",tabIndex:-1,"data-is-scrollable":o,"aria-label":this.props.pivotBarContentAriaLabel},r&&(r.child||r.contributedItem.render((0,t.Util.css)("vss-PivotBarItem","content-host"))))),this._pivotItemsRendered[n]=!0)}return e}_makePivotBarItemId(e){return`${this._id}-Tab${e.index}`}_makeContributedPivotBarItemId(e,t){return`${this._id}-ContributedTab${t}`}_getPivotBarItemByItemKey(e,t=this.state.items){const i=(e||"").toUpperCase(),s=(0,c.findIndex)(t,e=>e.itemKey.toUpperCase()===i);return s>=0?t[s]:void 0}_getPivotBarItems(e){const i={},s=(0,t.UtilitiesChildrenUtils.childrenOfType)(e.children,w.PivotBarItem),o=e=>{const t=e.groupKey||"";let s=i[t];s||(s=[],i[t]=s),s.push(e)};let r=100;for(const e of s){const t=e.item.props;t.hidden||o({child:e.item,id:this._makePivotBarItemId(e),itemKey:t.itemKey,name:t.name,tooltip:t.tooltip,groupKey:t.groupKey,order:null!=t.order?t.order:r++,ariaLabel:t.ariaLabel,iconProps:t.iconProps,badgeCount:t.badgeCount,maxItemWidth:t.maxItemWidth,commands:t.commands,viewActions:t.viewActions,commandProviders:t.commandProviders,viewActionProviders:t.viewActionProviders,deselectionBehavior:t.deselectionBehavior,url:t.url,onBeforePivotChange:t.onBeforePivotChange,onRenderFilterBar:t.onRenderFilterBar,commandsMenuBarAriaLabel:t.commandsMenuBarAriaLabel})}return this._contributedPivots.forEach(e=>e.value.forEach(e=>{e.hidden||o(e)})),Object.keys(i).reduce((e,t)=>(i[t].forEach(t=>e.push(t)),e),[])}_setupPivotObservables(e){let i=0;const s=this._subscribedToPivotObservables;s&&this._unsubscribeFromPivotObservables(),this._contributedPivots=[],e.pivotProviders&&(e.pivotProviders.forEach(e=>{const s=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,e=>this._makeIPivotBarItemFromContribution(e,i++),this._getPivotBarItemId);this._contributedPivots.push(s)}),s&&this._subscribeToPivotObservables())}_unsubscribeFromPivotObservables(){this._contributedPivots.forEach(e=>e.unsubscribe(this._onContributedPivotsChanged)),this._subscribedToPivotObservables=!1}_subscribeToPivotObservables(){this._contributedPivots.forEach(e=>e.subscribe(this._onContributedPivotsChanged)),this._subscribedToPivotObservables=!0}_getFilterBarSettings(e){let s,{onRenderFilterBar:o,showFilterBarInline:r}=this.props;const n=this._getPivotBarItemByItemKey(this.state.selectedPivot);if(n&&n.onRenderFilterBar&&(s=n.onRenderFilterBar()),!s&&o&&(s=o()),!s){const o=(0,c.findIndex)(e,e=>"object"==typeof e&&e.type===t.FilterBar.FilterBar);if(o>=0){const t=e[o],n=i.Children.toArray(t.props.children);if(n&&n.length>=1&&(s=t,1===n.length&&!r)){const e=n[0];"object"==typeof e&&!0===e.props.isTextItem&&(r=!0)}}}if(s)return{filterBarElement:s,showInline:r}}_getHubTileRegionIndex(e){return(0,c.findIndex)(e,e=>"object"==typeof e&&e.type===y.HubTileRegion)}_isKeyValid(e,t=this.state.items){return void 0!==e&&void 0!==this._getPivotBarItemByItemKey(e,t)}_buildInitialPivotState(i=this.props,s,o=!1){const r=()=>{const e=s||this._getPivotBarItems(i);return e.length>0?e[0].itemKey:null};let n=null;return i.initialSelectedPivot||i.selectedPivot||(n=r()),!n&&i.initialSelectedPivot&&this._isKeyValid(i.initialSelectedPivot)&&(n=i.initialSelectedPivot),!n&&i.selectedPivot&&this._isKeyValid(i.selectedPivot)&&(n=i.selectedPivot),this._isKeyValid(n,s)||(n=null,this._contributedPivotWait||(this._contributedPivotWait=setTimeout(()=>{this._pivotSelected||(n=r())&&this._updateSelectedItem(n,null),this._contributedPivotWait=null},t[e].MAX_PIVOT_WAIT))),this._pivotSelected=null!==n,this._buildNewPivotState(i,n,s,o)}_buildNewPivotState(e,t,i,s=!1){const o=this._getPivotBarItemByItemKey(t,i),r=t&&o;return{selectedPivot:r?o.itemKey:"",commands:r?this._actionsManager.getCommandObservables(e.commands,o,s):[],viewActions:r?this._actionsManager.getViewActionObservables(e.viewActions,o,s):[],commandsMenuBarAriaLabel:r?o.commandsMenuBarAriaLabel:void 0}}_onPivotClick(e,t){let i=!0;if(t.ctrlKey){const t=this._getPivotBarItemByItemKey(e);t&&t.url&&("string"==typeof t.url||t.url.value)&&(i=!1)}i&&(t.preventDefault(),this._updateSelectedItem(e,t))}_updateSelectedItem(e,t){const i=this._getPivotBarItemByItemKey(e);if(i&&(this.props.onBeforePivotChange||i.onBeforePivotChange)){const s=i&&i.url&&("string"==typeof i.url?i.url:i.url.value);if(i.onBeforePivotChange&&!i.onBeforePivotChange(t,e,s))return;if(this.props.onBeforePivotChange&&!this.props.onBeforePivotChange(t,e,s))return}const s=this.props;this._pivotSelected=!0,this.setState(this._buildNewPivotState(s,e)),s.onPivotClicked&&s.onPivotClicked(t,e)}}t[e].PivotBar=o,o.defaultProps={autoFocus:!0};class n{constructor(){this._commands={},this._viewActions={},this._getPivotActionItemId=(e=>e.key)}getCommandObservables(e,i,s=!1){const o=i.id;if(!0===s&&delete this._commands[o],!this._commands[o]){const s=[];this._commands[o]=s,s.push(d.ObservableLike.isObservable(e)?e:new d.ObservableArray(e)),s.push(d.ObservableLike.isObservable(i.commands)?i.commands:new d.ObservableArray(i.commands)),i.commandProviders&&i.commandProviders.forEach(e=>{const i=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,e=>e,this._getPivotActionItemId);s.push(i)})}return this._commands[o]}getViewActionObservables(e,i,s=!1){const o=i.id;if(!0===s&&delete this._viewActions[o],!this._viewActions[o]){const s=[];this._viewActions[o]=s,s.push(d.ObservableLike.isObservable(i.viewActions)?i.viewActions:new d.ObservableArray(i.viewActions)),s.push(d.ObservableLike.isObservable(e)?e:new d.ObservableArray(e)),i.viewActionProviders&&i.viewActionProviders.forEach(e=>{const i=new t.UtilitiesItemContribution.ContributedItemArray(e,e=>e);s.push(i)})}return this._viewActions[o]}dispose(){this._commands=null,this._viewActions=null}}}("ComponentsPivotBarPivotBar"),E=t.ComponentsPivotBarindex={},__exportStar(O,t.ComponentsPivotBarindex),__exportStar(S,t.ComponentsPivotBarindex),__exportStar(w,t.ComponentsPivotBarindex),__exportStar(x,t.ComponentsPivotBarindex),A=t.PivotBar={},__exportStar(E,t.PivotBar),function(e){V=t.ComponentsHubHub={};class s extends c.BaseComponent{constructor(e){super(e),this._wireDataDidRender=(e=>i.cloneElement(e,{breadcrumbDataDidRender:(t,i)=>{this._dataDidRender(t,i);const s=e;s&&s.props&&s.props.breadcrumbDataDidRender&&s.props.breadcrumbDataDidRender(t,i)}})),this._dataDidRender=((e,t)=>{const{maxBreadcrumbWidth:i,canBreadcrumbShrink:s}=this.state,{minDisplayedBreadcrumbItems:o=0}=this.props;s&&e.renderedItems.length<=o?this.setState({canBreadcrumbShrink:!1}):!s&&e.renderedItems.length>o&&this.setState({canBreadcrumbShrink:!0});const r=e.renderedItems.length+e.renderedOverflowItems.length;this._breadcrumbItemCount&&r!==this._breadcrumbItemCount?this.setState({maxBreadcrumbWidth:void 0}):!i&&0===e.renderedOverflowItems.length&&t&&this.setState({maxBreadcrumbWidth:t+12}),this._breadcrumbItemCount=r}),this._onViewActionObservableChanged=(()=>{this._viewActionsObservable.value=[...this._underlyingViewActionsObservable.value,this._getFullScreenViewAction()]}),this._onSelectedPivotChanged=(e=>{this.setState({selectedPivot:e})}),this._onPivotClicked=((e,t)=>{if(t!==this.props.hubViewState.selectedPivot.value)if(this.props.hubViewState.canSwitchPivots(t))this.props.hubViewState.selectedPivot.value=t;else{const e=this.props.hubViewState.selectedPivot.value;this.pivotBar.selectPivot(e)}}),this._chromeless=document.body.classList.contains("chromeless"),this.state={viewActions:this._getViewActions(e),selectedPivot:this.props.hubViewState.selectedPivot.value,inFullScreenMode:this.props.hubViewState.viewOptions.getViewOption(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen),canBreadcrumbShrink:!0}}focus(e){switch(e){case 0:this.pivotBar&&this.pivotBar.focus(e)}}componentWillReceiveProps(e){this.props.viewActions!==e.viewActions&&this.setState({viewActions:this._getViewActions(e)})}componentDidMount(){this.props.hubViewState.selectedPivot.subscribe(this._onSelectedPivotChanged),this._events.on(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged)}componentDidUpdate(){this._exitingFullScreenMode&&(this._exitingFullScreenMode=!1,this.focus(0))}componentWillUnmount(){this.props.hubViewState.selectedPivot.unsubscribe(this._onSelectedPivotChanged),this._events.off(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged)}render(){const e=i.Children.toArray(this.props.children);this.validateChildren(e);const{className:s,commands:o,hideHeader:r,hubViewState:n,onRenderFilterBar:a,pivotProviders:c,onBeforePivotChange:l,onPivotBarRenderComplete:d,showFilterBarInline:m,showPivots:p,useShadowStyle:h,pivotRenderingModeOptions:u,onRenderSecondaryContent:b,splitterProps:v,scrollableRegion:g,pivotHeaderAriaLabel:_,breadcrumbIsExpandable:I,pivotBarContentAriaLabel:B,inlineFilterAriaLabel:f}=this.props,{selectedPivot:k,viewActions:C,inFullScreenMode:y,maxBreadcrumbWidth:w,canBreadcrumbShrink:S}=this.state;I&&(e[0]=this._wireDataDidRender(e[0]));const x={onPivotClicked:this._onPivotClicked,onBeforePivotChange:l,commands:o,selectedPivot:k,viewOptions:n.viewOptions,filter:n.filter,pivotProviders:c,showPivots:!y&&p,onRenderComplete:d,viewActions:C,onRenderFilterBar:a,showFilterBarInline:m,showFilterBarViewOptionKey:t.UtilitiesHubViewState.HubViewOptionKeys.showFilterBar,filterBarClassName:"vss-Hub--filterBar",pivotRenderingModeOptions:u,pivotBarContentClassName:this.props.pivotBarContentClassName,isPivotBarContentScrollable:1===g,isCommandBarSticky:0===g,pivotBarSize:"tall",headerAriaLabel:_,canBreadcrumbShrink:S,maxBreadcrumbWidth:w,pivotBarHeaderClassName:I&&"vss-PivotBar--header-with-expandable-breadcrumb",pivotBarContentAriaLabel:B,inlineFilterAriaLabel:f},O=i.createElement(A.PivotBar,Object.assign({},x,{className:(0,t.Util.css)("vss-HubPivotBar",0===g&&"vss-HubPivotBar--scrollable",h&&"shadowStyle",r&&"hideHeader",this.props.pivotBarClassName),componentRef:e=>{this.pivotBar=e}}),e);let E=O;return b&&(E=i.createElement(t.Splitter.Splitter,Object.assign({},v,{onRenderFarElement:()=>O,onRenderNearElement:b}))),i.createElement(P.Fabric,{className:(0,t.Util.css)("vss-Hub",s)},E)}validateChildren(e){const s=(0,t.UtilitiesChildrenUtils.childrenOfType)(e,y.HubHeader)[0];if(!s||0!==s.index)throw new Error("Expected first child of Hub to be HubHeader.");this.state.inFullScreenMode&&(e[s.index]=i.cloneElement(e[s.index],{collapseBreadcrumb:!0}))}_getFullScreenViewAction(){return{key:t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen,important:!0,viewActionRenderArea:2,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.ExitFullScreenAriaLabel,offAriaLabel:t.VSSResourcesVSSUI.EnterFullScreenAriaLabel,onIconProps:{iconName:"BackToWindow"},offIconProps:{iconName:"FullScreen"}}}}_getViewActions(e){if(d.ObservableLike.isObservable(e.viewActions)){if(!e.hideFullScreenToggle&&!this._chromeless){this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged);const t=e.viewActions,i=new d.ObservableArray([...t.value,this._getFullScreenViewAction()]);return this._underlyingViewActionsObservable=t,this._viewActionsObservable=i,t.subscribe(this._onViewActionObservableChanged),i}return e.viewActions}{const t=e.viewActions||[];return e.hideFullScreenToggle||this._chromeless||t.push(this._getFullScreenViewAction()),t}}_onViewOptionChanged(e){if(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen in e){const i=!0===e[t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen];i||(this._exitingFullScreenMode=!0),this.setState({inFullScreenMode:i})}}}t.ComponentsHubHub.Hub=s,s.defaultProps={scrollableRegion:1}}(),L=t.ComponentsHubindex={},__exportStar(V,t.ComponentsHubindex),T=t.ComponentsVssBreadcrumbindex={},__exportStar(_,t.ComponentsVssBreadcrumbindex),t.RegistrationPivotBarRegistration={},g.VssComponent.register("pivotBar",A.PivotBar),t.Hub={},__exportStar(L,t.Hub),t.VssBreadcrumb={},__exportStar(T,t.VssBreadcrumb)},["Components/VssBreadcrumb/VssBreadcrumb","Components/HubHeader/HubTitle","Components/HubHeader/HubHeader","Components/HubHeader/HubTextTile","Components/HubHeader/HubTileRegion","Components/HubHeader/index","HubHeader","Components/PivotBar/PivotBarItem","Components/PivotBar/PivotBarAction","Components/PivotBar/PivotCommandBar","Components/PivotBar/PivotBar","Components/PivotBar/index","PivotBar","Components/Hub/Hub","Components/Hub/index","Components/VssBreadcrumb/index","Registration/PivotBarRegistration","Hub","VssBreadcrumb"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-hub-content"}}));