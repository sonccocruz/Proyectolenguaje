"use strict";define("Tfs/Header/Components",["require","exports","react","VSS/Features/PlatformUI/ContributedBreadcrumb","VSS/Platform/Layout","VSSUI/Breadcrumb","VSSUI/Observer","VSSUI/Utilities/ScreenSize","VSSUI/Spinner","VSSUI/Callout","VSS/Platform/Context","VSS/Platform/FPS"],function(e,t,s,o,r,n,a,i,c,d,l,m){var p;p=t.Resources={},t.Resources.KeyboardShortcuts="Keyboard shortcuts",t.Resources.Loading="Loading...",t.Resources.MoreApplications="More",t.Resources.Marketplace="Marketplace",t.Resources.AppSwitcherHomeLink="Home",function(e){t.ComponentsHeaderBreadcrumbHeaderBreadcrumb={};class c extends r.VssComponent{constructor(e,t){super(e,t),this.onSearchExpanded=(()=>{this.setState({isVisible:!1})}),this.onSearchCollapsed=(()=>{this.setState({isVisible:!0})}),this._layoutManager=t.pageContext.getService("IVssLayoutManager"),this._headerComponents=this._layoutManager.getComponentsForRegion("headerBreadcrumb"),this._breadcrumbItemProvider=(0,o.getBreadcrumbItems)(this.context.pageContext,"ms.vss-tfs-web.vertical-header-breadcrumb"),this.state={isVisible:!0,breadcrumbItems:this._breadcrumbItemProvider,extraContentSelected:!1}}componentDidMount(){super.componentDidMount(),this.context.pageContext.getService("IVssPerformanceService").endScenario("tfs","WebPlatform.Frame",!1),this.addEventListener(window,"searchExpanded",this.onSearchExpanded),this.addEventListener(window,"searchCollapsed",this.onSearchCollapsed)}render(){let e;return this.state.isVisible?s.createElement(a.Observer,{items:this.state.breadcrumbItems,headerComponents:this._headerComponents},t=>(t.headerComponents.length&&(e=s.createElement(r.RegionComponent,{className:"flex-row",componentRegion:"headerBreadcrumb",childComponentProperties:{selected:this.state.extraContentSelected}})),s.createElement(i.ScreenSizeConditional,{condition:e=>e>0},s.createElement(n.Breadcrumb,{excludeTabStop:!0,className:"header-breadcrumb flex-grow",extraContent:e,items:t.items})))):s.createElement("div",{className:"flex-grow"})}}c.componentType="headerBreadcrumb",r.VssComponent.register(c.componentType,c)}(),function(e){t.ComponentsFpsLoadingFpsLoading={};class o extends r.VssComponent{constructor(e){super(e),this.onFpsLoading=(e=>{this.lastLoadingEvent=e.detail,this.loadingDelayTimeout||(this.loadingDelayTimeout=this.setTimeout(()=>{this.setState({showLoadingIndicator:!0}),this.loadingDelayTimeout=0},o.preProgressDelay))}),this.onFpsCompleted=(e=>{this.lastLoadingEvent&&this.lastLoadingEvent.data===e.detail.data&&(this.lastLoadingEvent=void 0,this.loadingDelayTimeout&&this.clearTimeout(this.loadingDelayTimeout),this.state.showLoadingIndicator&&this.setState({showLoadingIndicator:!1}))}),this.state={}}render(){return this.state.showLoadingIndicator?s.createElement(d.Callout,{className:"fps-loading-content-layer",contentClassName:"fps-loading-content font-size-m",contentLocation:1,contentJustification:1,contentOrientation:0,modal:!0},s.createElement(c.Spinner,{label:p.Loading,size:"large"})):null}componentDidMount(){super.componentDidMount(),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading),this.addEventListener(document.body,"fpsCompleted",this.onFpsCompleted)}}t.ComponentsFpsLoadingFpsLoading.FpsLoadingComponent=o,o.preProgressDelay=500,r.VssComponent.register("fpsLoading",o)}(),function(e){t.HeaderBreadcrumbService={};l.Services.add("header-breadcrumb-service",{serviceFactory:class extends l.VssService{constructor(){super(...arguments),this._onFPSItemClick=((e,t,s)=>{(0,m.onClickFPS)(this.pageContext,t,!0,e,{telemetrySource:"headerBreadcrumb",navigationId:s})})}getBreadcrumbItems(e){const t=[],s=this.pageContext.getService("IVssPageService").getData();s&&t.push({key:"Collection",text:s.hostName,href:s.hostPath,rank:10});const o=this.pageContext.getService("ITfsPageService").getData();if(o&&o.project){const e=o.project.url;t.push({key:"Project",text:o.project.name,href:e,onClick:t=>{this._onFPSItemClick(t,e||"","ms.vss-web.home-hub-group")},rank:20})}const r=this.pageContext.getService("IVssNavigationService"),n=r.getDisplayedNavigation(),a=r.getNavigation(n[2]),i=r.getNavigation(n[3]);return void 0!==a&&a.name&&t.push({key:"HubGroup",text:a.name,href:a.href,onClick:e=>{const t=i&&i.href===a.href?i.id:a.id;this._onFPSItemClick(e,a.href||"",t)},rank:30}),void 0!==i&&i.parentId&&i.name&&t.push({key:"Hub",text:i.name,href:i.href,onClick:e=>{this._onFPSItemClick(e,i.href||"",i.id)},rank:40}),t}}})}(),function(e){t.LegacyProfileDialogService={};l.Services.add("LegacyProfileDialogService",{serviceFactory:class extends l.VssService{show(){this.pageContext.getService("IVssLayoutManager").renderCallout(e=>s.createElement(r.WrappedComponent,{wrappedType:"legacy",dependencies:["ms.vss-web.legacy-content"],wrappedProps:{componentType:"legacyProfileDialog",modules:["Admin/Scripts/LegacyProfileDialogComponent"]}},null))}}})}(),function(e){t.ShortcutMenuProvider={};class o extends l.VssService{constructor(){super(...arguments),this.menuItems=[],this.getMenuItems=(()=>this.menuItems)}_serviceStart(e){super._serviceStart(e);const t=this.pageContext.getService("ITfsPageService").getData();this._shortcutsAvailable=!!t&&!!t.project,this._shortcutsAvailable&&this.menuItems.push({id:"tfsShortcutKeys",text:p.KeyboardShortcuts,rank:550,iconProps:{iconName:"KeyboardClassic"},groupKey:"other-actions",onActivate:()=>{this.showDialog()}})}showDialog(){this.pageContext.getService("IVssLayoutManager").renderCallout(e=>{const t={dependencies:["ms.vss-tfs-web.keyboard-shortcuts-ui-content"],wrappedType:"KeyboardShortcutsPanel",wrappedProps:{onDismiss:e}};return s.createElement(r.WrappedComponent,t)})}}t.ShortcutMenuProvider.ShortcutMenuProviderService=o,l.Services.add("ms.vss-tfs-web.shortcut-menu-provider",{serviceFactory:o})}()},["Resources","Components/HeaderBreadcrumb/HeaderBreadcrumb","Components/FpsLoading/FpsLoading","HeaderBreadcrumbService","LegacyProfileDialogService","ShortcutMenuProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.header-async-content"}}));